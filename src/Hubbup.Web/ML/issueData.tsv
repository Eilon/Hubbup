6147	area-servers	Check if the service is HTTP or HTTPS on IIS when running on Kestrel with AspNetCoreModule	I am developing running my application on Kestrel behind IIS.It is deployed in a way described [here](https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-2.1). ![image](https://user-images.githubusercontent.com/6485506/50490357-6533df00-0a15-11e9-9f50-7ccea6594514.png)The service is configured on IIS with preload enabled, therefore the service is up and running before I have any request routed to it.In the context of my application code I need to register to an external service discovery with an externally accessible URL. My challenge is concluding whether my URL is HTTP or HTTPS. Since the Kestrel always configured as HTTP (in this topology), and the HTTPS may be configured on IIS I don't see any way to extract this info.Any chance there is some place where can I get this information during run time?
6143	area-signalr	[SignalR] Unexpected behavior with `StreamAsChannelAsync` and `ReadAsync`	### Describe the bugHub method is called when `ChannelReader.ReadAsync` is called on the client side. I would've expected that calling `StreamAsChannelAsync` would call the hub method.  I have a integration test where I call the `StreamAs..` method to get the reader. Then I write a message to the channel on server side and then try to read the value from the reader. This does not work as expected as the actual hub method is not getting called when I call the `Stream..` but gets called later when I try to read the value.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core '2.2'2. Run this code 'todo'3. With these arguments 'todo'4. See error### Expected behaviorWhen calling `StreamAs...` method I get a ChannelReader. I would expect that when this call was made the actual hub method on the server side would be called at this point. Now it seems that the call is made when I call ChannelReader.ReadAsync method. ### Additional contextAdd any other context about the problem here.Include the output of `dotnet --info`
6142	area-signalr	@aspnet/signalr-protocol-msgpack NPM production build fails	### Describe the bugI'm using SignalR with message pack protocol, if i try to do a productin build of my NPM application, the following error is thrown:`node_modules/@aspnet/signalr-protocol-msgpack/dist/esm/MessagePackHubProtocol.d.ts(16,5): error TS2416: Property 'parseMessages' in type 'MessagePackHubProtocol' is not assignable to the same property in base type 'IHubProtocol'.  Type '(input: ArrayBuffer | Buffer, logger: ILogger) => HubMessage[]' is not assignable to type '(input: string | ArrayBuffer, logger: ILogger) => HubMessage[]'.    Types of parameters 'input' and 'input' are incompatible.      Type 'string | ArrayBuffer' is not assignable to type 'ArrayBuffer | Buffer'.        Type 'string' is not assignable to type 'ArrayBuffer | Buffer'.`### To ReproduceSteps to reproduce the behavior:package.json `    "@aspnet/signalr": "^1.1.0",    "@aspnet/signalr-protocol-msgpack": "^1.1.0",`### Expected behaviorNo compilation error caused by  @aspnet/signalr-protocol-msgpackThanks in advance for your help!
6140	area-servers	.net core 2.2 appends the environment variable value from web.config file and from user's system	_From @jsowndarrajan on Wednesday, 26 December 2018 07:17:54_# Issue TitleEnvironment variable in `web.config` file get appended into system environment variable # GeneralRecently, I'm facing a strange issue while hosting .net core 2.2 application on IIS.After hosting, I get "An error occurred while starting the application". In order to identify the root cause I enabled the log file and found that its because of environment variable issue.I configured the environment variable in my `web.config` file as like below, at the same time I also configured the same (ASPNETCORE_ENVIRONMENT) environment variable in my system.```<aspNetCore processPath="dotnet" arguments=".\PctrClient.Api.dll" stdoutLogEnabled="true" stdoutLogFile=".\logs\stdout" hostingModel="InProcess">    <environmentVariables>      <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Development" />    </environmentVariables>  </aspNetCore>```  But when I try to host this application in IIS, I get ASPNETCORE_ENVIRONMENT variable value as `Development;Development`, instead of `Development`. I think, application is now appending both system environment value and web.config variable value together.Program.cs```public class Program{    public static void Main(string[] args)    {        CreateWebHostBuilder(args).Build().Run();    }    public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>        WebHost.CreateDefaultBuilder(args)               .UseStartup<Startup>()               .UseIISIntegration();}```From my perceptive, `web.config` should override the system environment variable value.Please let me know if you need any other information from my end._Copied from original issue: dotnet/core#2184_
6134	area-mvc	Razor's GetRelatedDocuments does not work if a host documents TargetPath starts with / or \	### Describe the bugIf someone sets the target path of a Razor file to begin with a `/` or a `\` the [ProjectState](https://github.com/aspnet/AspNetCore-Tooling/blob/a04addb86f88cf1321e27d0e9f5440585934cffc/src/Razor/src/Microsoft.CodeAnalysis.Razor.Workspaces/ProjectSystem/ProjectState.cs#L444) will incorrectly track its related documents because it normalizes the target path on caching but doesn't re-normalize when trying to lookup a related document.
6131	area-signalr	Re-Enable AspNetCore-SignalR-Daily-Tests	
6127	area-servers	Graceful shutdown has problems	https://dnceng.visualstudio.com/public/_build/results?buildId=63309We need more logging to determine whats happening.```Starting test execution, please wait...2018-12-26T05:23:06.8651889Z   [xUnit.net 00:00:14.23]     EmitsConnectionStartAndStop [FAIL]2018-12-26T05:23:06.8657652Z   Failed   EmitsConnectionStartAndStop2018-12-26T05:23:06.8660915Z   Error Message:2018-12-26T05:23:06.8663498Z    The collection was expected to contain a single element, but it was empty.2018-12-26T05:23:06.8678877Z   Stack Trace:2018-12-26T05:23:06.8680079Z      at Microsoft.AspNetCore.Server.Kestrel.InMemory.FunctionalTests.EventSourceTests.EmitsConnectionStartAndStop() in /_/src/Servers/Kestrel/test/InMemory.FunctionalTests/EventSourceTests.cs:line 642018-12-26T05:23:06.8688487Z   --- End of stack trace from previous location where exception was thrown ---2018-12-26T05:23:06.8690531Z   Standard Output Messages:2018-12-26T05:23:06.8691414Z    | [0.001s] TestLifetime Information: Starting test EmitsConnectionStartAndStop at 2018-12-26T05:22:532018-12-26T05:23:06.8691822Z    | [0.003s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Hosting starting2018-12-26T05:23:06.8692254Z    | [0.004s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Hosting started2018-12-26T05:23:06.8692580Z    | [0.004s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Loaded hosting startup assembly testhost2018-12-26T05:23:06.8692958Z    | [0.004s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLJAU8N3AQEG" started.2018-12-26T05:23:06.8693451Z    | [0.520s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request starting HTTP/1.1 GET http:///  2018-12-26T05:23:06.8693839Z    | [0.520s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLJAU8N3AQEG" completed keep alive response.2018-12-26T05:23:06.8694341Z    | [0.533s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request finished in 12.9394ms 200 2018-12-26T05:23:06.8694802Z    | [4.383s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Hosting shutdown2018-12-26T05:23:06.8695120Z    | [9.412s] Microsoft.AspNetCore.Server.Kestrel Debug: Some connections failed to close gracefully during server shutdown.2018-12-26T05:23:06.8695520Z    | [9.415s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLJAU8N3AQEG" closing because: "The connection was aborted because the server is shutting down and request processing didn't complete within the time specified by HostOptions.ShutdownTimeout."2018-12-26T05:23:06.8696095Z    | [10.379s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLJAU8N3AQEG" closing because: "The client closed the connection."2018-12-26T05:23:06.8703112Z    | [10.379s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLJAU8N3AQEG" disconnecting.2018-12-26T05:23:06.8706229Z    | [10.429s] Microsoft.AspNetCore.Server.Kestrel Debug: Some connections failed to abort during server shutdown.2018-12-26T05:23:06.8711344Z    | [10.586s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLJAU8N3AQEG" stopped.2018-12-26T05:23:06.8714695Z    | [10.679s] TestLifetime Information: Finished test EmitsConnectionStartAndStop in 10.6787548s```
6126	area-mvc	Core MVC: Route based on query string	### Is your feature request related to a problem? Please describe.Actions which only differ by the query string parameters are not routing; I get a "multiple best matches" error.Example: I'm writing an API which returns "Today in History" data. The action names are the same.- One action takes no parameters, and returns all of our history data.- One takes a date parameter, and returns any data for that date- One takes a start and end parameter, and returns all historical data we have for that range (inclusive).I wrote the API, and expected it to work - but the 3 actions are considered the same for routing purposes, and I got a "multiple best matches" error.### Describe the solution you'd likeIf actions differ only by the query parameters they recieve, an action which best uses the request query string should be considered more of a match.### Describe alternatives you've consideredI wrote a custom `IActionConstraint`. It works great, and (kudos to the Core MVC team) it wasn't so crazy to write - I didn't even have to go to stackoverflow! But I think this is valuable functionality which should be accessible from "stock' Core MVC.I saw online reference to making a ViewModel, and that if you mark the desired properties as required and from the query string, it'll be taken into account vis a vis routing. I didn't look into it, because I didn't want to create countless models for trivial parameters.Also, one of my goals is that my action methods should look like normal methods. This helps readability/maintainability. A normal method takes e.g. a DateTime, not a ViewModel with a DateTime property.Another solution would be to have one action which takes all the valid query parameters, and then write logic to do the right thing based on the parameters which were used. I didn't want to do that, because one of the benefits of Core MVC is I can write declarative code rather than error prone and verbose imperative code.### Additional context[Here is a gist](https://gist.github.com/yringler/eb10736533f2e63e54fcbac6a95d752e) of the `IActionConstraint` I wrote to get the desired functionality.
6125	area-signalr	Trying to load signalr from static import module loader 	### Describe the bugI am trying to load signalr using the new browser feature in which they can load modules without using webpack. That way I will be able to work faster because I can just change the code, save, reload and see the new code working.I have copied from node_modules the esm folder and pointed from javascript to it. The problem I see is that using type="module" requires pointing to javascript files, no the name. For instance:export { HubConnection } from "./HubConnection.js"; <-- this would workexport { HubConnection } from "./HubConnection"; <-- this doesn't workThis explains it better:https://developers.google.com/web/fundamentals/primers/modules#specifiers ### To ReproduceSteps to reproduce the behavior:1. using asp.net core 2.1 and copied the signalr/esm folder into the wwwroot2. importing   <script src="~/js/signalr/esm/index.js" type="module" ></script>   3. fails with 404s because it can not find the modulesif I put .js at the end of the module names in the "~/js/signalr/esm/index.js" file, for instance export { HubConnectionBuilder } from "./HubConnectionBuilder";toexport { HubConnectionBuilder } from "./HubConnectionBuilder.js";it starts to work but I would need to change every internal reference.### Expected behaviorMaybe having another esm compilation with the file extensions could help.Thanks!
6123	area-servers	why does  AspNetCore.Hosting.Internal.WebHost|Hosting shutdown after App start ?	I run my asp net core by IIs, I find that Hosting shutdown when app has been started. I run a background task on asp.net core by using IHostedService feature. I has set the startMode of IIs  to AlwaysRunning.my asp net core version is 2.1. I attach img screenshot about my log output![tim 20181226180232](https://user-images.githubusercontent.com/29353661/50442511-33017f00-093a-11e9-91f7-f13b2eb58dcb.png)
6122	area-mvc	Investigate Mvc functional test failure	After converting to `Reference`, the test `RazorPagesWithBasePath.PagesFromClassLibraries_CanBeServed` fails with```Failed   Microsoft.AspNetCore.Mvc.FunctionalTests.RazorPagesWithBasePathTest.PagesFromClassLibraries_CanBeServed2018-12-22T02:49:00.4043550Z   Error Message:2018-12-22T02:49:00.4043660Z    System.Net.Http.HttpRequestException : Response status code does not indicate success: 404 (Not Found).2018-12-22T02:49:00.4043800Z   Stack Trace:2018-12-22T02:49:00.4043910Z      at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()2018-12-22T02:49:00.4044030Z      at System.Net.Http.HttpClient.GetStringAsyncCore(Task`1 getTask)2018-12-22T02:49:00.4044180Z      at Microsoft.AspNetCore.Mvc.FunctionalTests.RazorPagesWithBasePathTest.PagesFromClassLibraries_CanBeServed() in /_/src/Mvc/test/Microsoft.AspNetCore.Mvc.FunctionalTests/RazorPagesWithBasePathTest.cs:line 5272018-12-22T02:49:00.4045230Z   --- End of stack trace from previous location where exception was thrown ---```
6120	area-signalr	.Net Core Console connect signalR 401 under windows authentication	### Describe the bugWhen .net core signalR console app connect signalR server with Windows Authentication, receive 401.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core `netcoreapp2.1` with Windows Authentication enabled.```    [Authorize]    public class TimeHub: Hub    {        public async Task UpdateTime(string message)        {            if (Clients != null)            {                await Clients?.All.SendAsync("ReceiveMessage", message);            }        }    }```2. .Net Core Console App   ```    class Program    {        static Action<string> OnReceivedAction = OnReceived;        static void Main(string[] args)        {            Console.WriteLine(WindowsIdentity.GetCurrent().Name);            //WindowsIdentity.RunImpersonated(WindowsIdentity.GetCurrent().AccessToken, Connect);            Connect();            Console.WriteLine("Hello World!");            Console.ReadLine();        }        private static async void Connect()        {            var hubConnectionBuilder = new HubConnectionBuilder();            var hubConnection = hubConnectionBuilder.WithUrl("http://localhost:61045/timeHub",options => {                options.UseDefaultCredentials = true;            }).Build();            await hubConnection.StartAsync();            await hubConnection.SendAsync("UpdateTime", $"From Client");            var on = hubConnection.On("ReceiveMessage", OnReceivedAction);            Console.WriteLine($"Client is Start");            Console.ReadLine();            on.Dispose();            await hubConnection.StopAsync();        }        static void OnReceived(string message)        {            Console.WriteLine($"{ message }");        }    }``` ### Expected behaviorConsole App connect signalR server correctly.### Current behaviorReceive error 401 at console app.Update:After making a test with `https` and `http` url in client signalr, it works with https url, it seems ` app.UseHttpsRedirection();` at server side fail to redirect the client credential while redirecting http to https.
6118	area-servers	Inprocess application start problem	Hello!I'm trying to host web app using inprocess hosting model. And...Application can't start.IIS responses with 500.30.ANCM logs contains this.If i switch hostingModel to OutOfProcess — everything is ok.### My web.config```<?xml version="1.0" encoding="utf-8"?><configuration>    <system.webServer>      <handlers>        <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" />      </handlers>      <aspNetCore processPath=".\Dodo.ClientSite.exe" arguments="" stdoutLogEnabled="true" stdoutLogFile=".\logs\stdout" forwardWindowsAuthToken="false" hostingModel="InProcess">	  	     <handlerSettings>                  <handlerSetting name="debugFile" value=".\aspnetcore-debug.log" />                  <handlerSetting name="debugLevel" value="FILE,TRACE" />              </handlerSettings>      </aspNetCore>   </system.webServer></configuration>```### Logs```[aspnetcorev2.dll] ASPNET_CORE_GLOBAL_MODULE::OnGlobalConfigurationChange 'MACHINE/WEBROOT/APPHOST/RU-DEV-GS-GSITE.EXT.DEV.DODOIS.COM'[aspnetcorev2.dll] Stopping application '/LM/W3SVC/340/ROOT'[aspnetcorev2_inprocess.dll] Stopping file watcher thread[aspnetcorev2.dll] ASPNET_CORE_GLOBAL_MODULE::OnGlobalStopListening[aspnetcorev2.dll] ASPNET_CORE_GLOBAL_MODULE::Terminate[aspnetcorev2.dll] Initializing logs for 'C:\Program Files\IIS\Asp.Net Core Module\V2\aspnetcorev2.dll'. Process Id: 9476.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.[aspnetcorev2.dll] Resolving hostfxr parameters for application: '.\Dodo.ClientSite.exe' arguments: '' path: 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\'[aspnetcorev2.dll] Known dotnet.exe location: ''[aspnetcorev2.dll] Process path '.\Dodo.ClientSite.exe' is not dotnet, treating application as standalone or portable with bootstrapper[aspnetcorev2.dll] Checking application.dll at 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\Dodo.ClientSite.dll'[aspnetcorev2.dll] Checking hostfxr.dll at 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\hostfxr.dll'[aspnetcorev2.dll] hostfxr.dll found app local at 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\hostfxr.dll', treating application as portable with launcher[aspnetcorev2.dll] Resolving absolute path to dotnet.exe from 'dotnet'[aspnetcorev2.dll] Invoking where.exe to find dotnet.exe[aspnetcorev2.dll] where.exe invocation returned: 'C:\Program Files\dotnet\dotnet.exeC:\Program Files (x86)\dotnet\dotnet.exe'[aspnetcorev2.dll] Current process bitness type detected as isX64=1[aspnetcorev2.dll] Processing entry 'C:\Program Files\dotnet\dotnet.exe'[aspnetcorev2.dll] Binary type 6[aspnetcorev2.dll] Found dotnet.exe via where.exe invocation at 'C:\Program Files\dotnet\dotnet.exe'[aspnetcorev2.dll] Resolving absolute path to hostfxr.dll from 'C:\Program Files\dotnet\dotnet.exe'[aspnetcorev2.dll] hostfxr.dll located at 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll'[aspnetcorev2.dll] Parsed hostfxr options: dotnet location: 'C:\Program Files\dotnet\dotnet.exe' hostfxr path: 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll' arguments:[aspnetcorev2.dll] Argument[0] = 'C:\Program Files\dotnet\dotnet.exe'[aspnetcorev2.dll] Argument[1] = 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\Dodo.ClientSite.dll'[aspnetcorev2.dll] c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\commonlib\fileoutputmanager.cpp:142 Operation failed with LastError: 32 HR: 0x80070020[aspnetcorev2.dll] Loading request handler:  'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\aspnetcorev2_inprocess.dll'[aspnetcorev2.dll] Creating handler application[aspnetcorev2_inprocess.dll] Initializing logs for 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\aspnetcorev2_inprocess.dll'. Process Id: 9476.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.[aspnetcorev2_inprocess.dll] Waiting for initialization[aspnetcorev2_inprocess.dll] Starting in-process worker thread[aspnetcorev2_inprocess.dll] Resolving hostfxr parameters for application: '.\Dodo.ClientSite.exe' arguments: '' path: 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\'[aspnetcorev2_inprocess.dll] Known dotnet.exe location: 'C:\Program Files\dotnet\dotnet.exe'[aspnetcorev2_inprocess.dll] Process path '.\Dodo.ClientSite.exe' is not dotnet, treating application as standalone or portable with bootstrapper[aspnetcorev2_inprocess.dll] Checking application.dll at 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\Dodo.ClientSite.dll'[aspnetcorev2_inprocess.dll] Checking hostfxr.dll at 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\hostfxr.dll'[aspnetcorev2_inprocess.dll] hostfxr.dll found app local at 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\hostfxr.dll', treating application as portable with launcher[aspnetcorev2_inprocess.dll] Resolving absolute path to hostfxr.dll from 'C:\Program Files\dotnet\dotnet.exe'[aspnetcorev2_inprocess.dll] hostfxr.dll located at 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll'[aspnetcorev2_inprocess.dll] Parsed hostfxr options: dotnet location: 'C:\Program Files\dotnet\dotnet.exe' hostfxr path: 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll' arguments:[aspnetcorev2_inprocess.dll] Argument[0] = 'C:\Program Files\dotnet\dotnet.exe'[aspnetcorev2_inprocess.dll] Argument[1] = 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\.\Dodo.ClientSite.dll'[aspnetcorev2_inprocess.dll] Managed threw an exception -1073741819[aspnetcorev2_inprocess.dll] Starting shutdown sequence 1[aspnetcorev2_inprocess.dll] Clr thread wait ended: clrThreadExited: 1[aspnetcorev2_inprocess.dll] c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\commonlib\fileoutputmanager.cpp:142 Operation failed with LastError: 32 HR: 0x80070020[aspnetcorev2_inprocess.dll] Event Log: 'Application '/LM/W3SVC/340/ROOT' with physical root 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\' hit unexpected managed exception, exception code = '0xc0000005'. Please check the stderr logs for more information.' End Event Log Message.[aspnetcorev2_inprocess.dll] Stopping in-process worker thread[aspnetcorev2_inprocess.dll] Stopping CLR[aspnetcorev2_inprocess.dll] Event Log: 'Application '/LM/W3SVC/340/ROOT' with physical root 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\' failed to load clr and managed application. CLR worker thread exited prematurely' End Event Log Message.[aspnetcorev2_inprocess.dll] Exception 'InvalidOperationException' caught at c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\inprocessrequesthandler\inprocessapplication.cpp:350 [aspnetcorev2_inprocess.dll] Failed HRESULT returned: 0x8007023e at c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\inprocessrequesthandler\dllmain.cpp:120 [aspnetcorev2_inprocess.dll] Starting app_offline monitoring in application 'E:\sites\ru-dev-gs-gsite.ext.dev.dodois.com\'[aspnetcorev2_inprocess.dll] Starting file watcher thread[aspnetcorev2.dll] ASPNET_CORE_GLOBAL_MODULE::OnGlobalConfigurationChange 'MACHINE/WEBROOT/APPHOST/RU-DEV-GS-GSITE.EXT.DEV.DODOIS.COM'[aspnetcorev2.dll] Stopping application '/LM/W3SVC/340/ROOT'[aspnetcorev2_inprocess.dll] Stopping file watcher thread[aspnetcorev2.dll] ASPNET_CORE_GLOBAL_MODULE::OnGlobalStopListening[aspnetcorev2.dll] ASPNET_CORE_GLOBAL_MODULE::Terminate````
6117	area-servers	web.config AspNetCoreModuleV2 SQLite unable to open database file	### Unable to open database fileweb.config `AspNetCoreModuleV2` SQLite throw the exception "unable to open database file".### ConnectionString```"ConnectionString": "Data Source=Database.sqlite"```But when i change to use `AspNetCoreModule` or change the connection string to `Data Source=D:\\ZKEACMS\\Database.sqlite` the application run correctly.### web.config```<?xml version="1.0" encoding="utf-8"?><configuration>  <location path="." inheritInChildApplications="false">    <system.webServer>      <handlers>        <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" />      </handlers>      <aspNetCore processPath="dotnet" arguments=".\ZKEACMS.WebHost.dll" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" hostingModel="InProcess" />    </system.webServer>  </location></configuration>```
6113	area-mvc	Razor compiler crash in Regression_1068	Run the test `Regression_1068` in the Razor solution (after Blazor compiler is merged in). ```Test Name:	Microsoft.AspNetCore.Razor.Language.IntegrationTests.ComponentTypingTest.Regression_1068Test FullName:	Microsoft.AspNetCore.Razor.Language.IntegrationTests.ComponentTypingTest.Regression_1068Test Source:	C:\git\aspnet\AspNetCore-Tooling\src\Razor\test\Microsoft.AspNetCore.Razor.Language.Test\IntegrationTests\ComponentTypingTest.cs : line 81Test Outcome:	FailedTest Duration:	0:00:00.022Result StackTrace:	at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitRazorDirective(RazorDirectiveSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Main.Generated.cs:line 743   at Microsoft.AspNetCore.Razor.Language.Syntax.RazorDirectiveSyntax.Accept[TResult](SyntaxVisitor`1 visitor) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Syntax.Generated.cs:line 3269   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.Visit(SyntaxNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 19   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitListElement[TNode](TNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 165   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitList[TNode](SyntaxList`1 list) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 102   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitCSharpCodeBlock(CSharpCodeBlockSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Main.Generated.cs:line 664   at Microsoft.AspNetCore.Razor.Language.Syntax.CSharpCodeBlockSyntax.Accept[TResult](SyntaxVisitor`1 visitor) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Syntax.Generated.cs:line 2292   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.Visit(SyntaxNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 19   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitListElement[TNode](TNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 165   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitList[TNode](SyntaxList`1 list) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 102   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitMarkupBlock(MarkupBlockSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Main.Generated.cs:line 524   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperBlockRewriter.AttributeValueRewriter.VisitMarkupDynamicAttributeValue(MarkupDynamicAttributeValueSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperBlockRewriter.cs:line 563   at Microsoft.AspNetCore.Razor.Language.Syntax.MarkupDynamicAttributeValueSyntax.Accept[TResult](SyntaxVisitor`1 visitor) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Syntax.Generated.cs:line 1344   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.Visit(SyntaxNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 19   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitListElement[TNode](TNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 165   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitList[TNode](SyntaxList`1 list) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 102   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitGenericBlock(GenericBlockSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Main.Generated.cs:line 512   at Microsoft.AspNetCore.Razor.Language.Syntax.GenericBlockSyntax.Accept[TResult](SyntaxVisitor`1 visitor) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Syntax.Generated.cs:line 324   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.Visit(SyntaxNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 19   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperBlockRewriter.RewriteAttributeValue(TryParseResult result, RazorBlockSyntax attributeValue) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperBlockRewriter.cs:line 291   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperBlockRewriter.TryParseAttribute(String tagName, MarkupAttributeBlockSyntax attributeBlock, IEnumerable`1 descriptors, ErrorSink errorSink, HashSet`1 processedBoundAttributeNames) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperBlockRewriter.cs:line 263   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperBlockRewriter.GetRewrittenChildren(String tagName, Boolean validStructure, MarkupStartTagSyntax tagBlock, TagHelperBinding bindingResult, RazorParserFeatureFlags featureFlags, ErrorSink errorSink, RazorSourceDocument source) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperBlockRewriter.cs:line 88   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperBlockRewriter.Rewrite(String tagName, Boolean validStructure, RazorParserFeatureFlags featureFlags, MarkupStartTagSyntax tag, TagHelperBinding bindingResult, ErrorSink errorSink, RazorSourceDocument source) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperBlockRewriter.cs:line 23   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperParseTreeRewriter.Rewriter.TryRewriteTagHelperStart(MarkupStartTagSyntax startTag, MarkupTagHelperStartTagSyntax& rewritten, TagHelperInfo& tagHelperInfo) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperParseTreeRewriter.cs:line 270   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperParseTreeRewriter.Rewriter.VisitMarkupElement(MarkupElementSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperParseTreeRewriter.cs:line 107   at Microsoft.AspNetCore.Razor.Language.Syntax.MarkupElementSyntax.Accept[TResult](SyntaxVisitor`1 visitor) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Syntax.Generated.cs:line 1441   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.Visit(SyntaxNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 19   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitListElement[TNode](TNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 165   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitList[TNode](SyntaxList`1 list) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 102   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitMarkupBlock(MarkupBlockSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Main.Generated.cs:line 524   at Microsoft.AspNetCore.Razor.Language.Syntax.MarkupBlockSyntax.Accept[TResult](SyntaxVisitor`1 visitor) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Syntax.Generated.cs:line 472   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.Visit(SyntaxNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 19   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.VisitRazorDocument(RazorDocumentSyntax node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Main.Generated.cs:line 490   at Microsoft.AspNetCore.Razor.Language.Syntax.RazorDocumentSyntax.Accept[TResult](SyntaxVisitor`1 visitor) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\Generated\Syntax.xml.Syntax.Generated.cs:line 63   at Microsoft.AspNetCore.Razor.Language.Syntax.SyntaxRewriter.Visit(SyntaxNode node) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Syntax\SyntaxRewriter.cs:line 19   at Microsoft.AspNetCore.Razor.Language.Legacy.TagHelperParseTreeRewriter.Rewrite(RazorSyntaxTree syntaxTree, String tagHelperPrefix, IEnumerable`1 descriptors) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\Legacy\TagHelperParseTreeRewriter.cs:line 26   at Microsoft.AspNetCore.Razor.Language.DefaultRazorTagHelperBinderPhase.ExecuteCore(RazorCodeDocument codeDocument) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\DefaultRazorTagHelperBinderPhase.cs:line 61   at Microsoft.AspNetCore.Razor.Language.RazorEnginePhaseBase.Execute(RazorCodeDocument codeDocument) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\RazorEnginePhaseBase.cs:line 40   at Microsoft.AspNetCore.Razor.Language.DefaultRazorEngine.Process(RazorCodeDocument document) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\DefaultRazorEngine.cs:line 51   at Microsoft.AspNetCore.Razor.Language.DefaultRazorProjectEngine.ProcessCore(RazorCodeDocument codeDocument) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\DefaultRazorProjectEngine.cs:line 257   at Microsoft.AspNetCore.Razor.Language.RazorProjectEngine.ProcessDesignTime(RazorProjectItem projectItem) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\src\Microsoft.AspNetCore.Razor.Language\RazorProjectEngine.cs:line 66   at Microsoft.AspNetCore.Razor.Language.IntegrationTests.RazorIntegrationTestBase.CompileToCSharp(String cshtmlRelativePath, String cshtmlContent) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\test\Microsoft.AspNetCore.Razor.Test.Common\Language\IntegrationTests\RazorIntegrationTestBase.cs:line 233   at Microsoft.AspNetCore.Razor.Language.IntegrationTests.RazorIntegrationTestBase.CompileToCSharp(String cshtmlContent) in C:\git\aspnet\AspNetCore-Tooling\src\Razor\test\Microsoft.AspNetCore.Razor.Test.Common\Language\IntegrationTests\RazorIntegrationTestBase.cs:line 163   at Microsoft.AspNetCore.Razor.Language.IntegrationTests.ComponentTypingTest.Regression_1068() in C:\git\aspnet\AspNetCore-Tooling\src\Razor\test\Microsoft.AspNetCore.Razor.Language.Test\IntegrationTests\ComponentTypingTest.cs:line 86Result Message:	System.InvalidCastException : Unable to cast object of type 'Microsoft.AspNetCore.Razor.Language.Syntax.CSharpExpressionLiteralSyntax' to type 'Microsoft.AspNetCore.Razor.Language.Syntax.CSharpTransitionSyntax'.```
6112	area-mvc	Refactorings and Improvements after enabling components in Razor	I'm using this issue to track thoughts and feedback from the process of merging the Blazor compiler into the mainline Razor compiler.Tracking item for improvements and refactorings we should do now that Components are enabled in the mainline Razor compiler:- [ ] Represent components as their own concept instead of as tag helpers- [ ] Merge Component lowering into IR lowering- [ ] Remove redundant passes after components become first class- [ ] Investigate which passes should be specific/limited to components- [ ] Combine test infrastructure for components and legacy- [ ] Use new node formatting infrastructure for integration tests
6111	area-servers	HTTP Error 500.0 - ANCM In-Process Handler Load Failure	### Describe the bugHow to fix this problem in in-process hosting model?### Screenshots![problem](https://user-images.githubusercontent.com/46094177/50388102-85843680-06c1-11e9-8d29-a5d2500e26cd.png)web.config![sssssss](https://user-images.githubusercontent.com/46094177/50388104-959c1600-06c1-11e9-8660-1b95846f63e1.png).csproj![p2](https://user-images.githubusercontent.com/46094177/50388107-98970680-06c1-11e9-9c22-eb7548eb541f.png)### Additional contextSDK Version: 2.2.101
6103	area-mvc	Passing dynamic objects to MVC views causes RuntimeBinderException	### Describe the bugWhen passing a dynamic object to a View with a controller, trying to access a property of this object causes a RuntimeBinderExceptionThis has been reported and fixed before in the AspNet MVC 3 Framework as described by this [post](https://blogs.msdn.microsoft.com/davidebb/2009/12/18/passing-anonymous-objects-to-mvc-views-and-accessing-them-using-dynamic/) in 2009### To Reproduce#### Steps to reproduce the behavior:Using version ASP.NET Core 2.1Try passing a dynamic object to a view via the model:```public class HomeController : Controller {   public ActionResult Index() {      return View(model: new {            Message = "Welcome to ASP.NET Core!",            Date = DateTime.Now         });      }}```No try to read out the properties inside the View:```<h2>@Model.Message</h2><p>@Model.Date</p>```### Expected behaviorI expect to be able to read the different properties of the object### Screenshots![The Exception](https://i.imgur.com/JJcuI3N.png)![My own code while debugging](https://i.imgur.com/HBpoEt5.png)
6100	area-mvc	Input value always null on `onkeydown` or `onkeypress` event in Blazor	Input value always null on `onkeydown` or `onkeypress` event but have value on `onclick` event in Blazor.Here is my code:```<input onkeydown="@CheckInput" placeholder="Write To Do" bind="@NewToDo" /><button onclick="@AddToDo">Add todo</button><br /><span class="text-danger">@errorMessage</span>@functions {    List<TodoItem> todos = new List<TodoItem>();    private string NewToDo { get; set; }    private string errorMessage;    private void CheckInput()    {        Console.WriteLine(NewToDo); // Strangely input value always null here.    }    private void AddToDo()    {        if (!string.IsNullOrWhiteSpace(NewToDo)) // Here value is getting as expected        {            errorMessage = null;            todos.Add(new TodoItem() { Title = NewToDo, IsDone = false });            NewToDo = null;        }        else        {            errorMessage = "Please enter a To do item!";        }    }}```Why I am getting input field value always null on `onkeydown` or `onkeypress` while getting the value on `onclick`?
6097	area-servers	Internal error in the .NET Runtime at IP 00007FF8E1FDD149 (00007FF8E1E20000) with ASP.NET Core 2.2	### Describe the bugGetting below error msgs from Eventlog, after which application pool sometimes completely shuts down (no restarting). **Entry 1 (in event log)**> Application: w3wp.exe> CoreCLR Version: 4.6.27110.4> Description: The process was terminated due to an internal error in the .NET Runtime at IP 00007FF8E1FDD149 (00007FF8E1E20000) with exit code c0000005.**Entry 2**> Faulting application name: w3wp.exe, version: 10.0.14393.0, time stamp: 0x57899b8a> Faulting module name: coreclr.dll, version: 4.6.27110.4, time stamp: 0x5be75633> Exception code: 0xc0000005> Fault offset: 0x00000000001bd149> Faulting process id: 0x172c> Faulting application start time: 0x01d49964aeaaca09> Faulting application path: c:\windows\system32\inetsrv\w3wp.exe> Faulting module path: C:\Program Files\dotnet\shared\Microsoft.NETCore.App\2.2.0\coreclr.dll> Report Id: 9693a536-e15e-4c29-bb23-eee06a89815d> Faulting package full name: > Faulting package-relative application ID: **Entry 3** - note: WER and TEMP folders does not contain the stated files:> Fault bucket , type 0> Event Name: APPCRASH> Response: Not available> Cab Id: 0> > Problem signature:> P1: w3wp.exe> P2: 10.0.14393.0> P3: 57899b8a> P4: coreclr.dll> P5: 4.6.27110.4> P6: 5be75633> P7: c0000005> P8: 00000000001bd149> P9: > P10: > > Attached files:> \\?\C:\Windows\Temp\WER7FC4.tmp.appcompat.txt> \\?\C:\ProgramData\Microsoft\Windows\WER\Temp\WER8022.tmp.WERInternalMetadata.xml> WERGenerationLog.txt> > These files may be available here:> C:\ProgramData\Microsoft\Windows\WER\ReportQueue\AppCrash_w3wp.exe_9d888ac04d24e4ae9ba23c5f7762b4ddf95248f_ed19be39_cab_0b048031> > Analysis symbol: > Rechecking for solution: 0> Report Id: 9693a536-e15e-4c29-bb23-eee06a89815d> Report Status: 131076> Hashed bucket: **Entry 4**> Fault bucket 2071344263271118212, type 4> Event Name: APPCRASH> Response: Not available> Cab Id: 0> > Problem signature:> P1: w3wp.exe> P2: 10.0.14393.0> P3: 57899b8a> P4: coreclr.dll> P5: 4.6.27110.4> P6: 5be75633> P7: c0000005> P8: 00000000001bd149> P9: > P10: > > Attached files:> \\?\C:\Windows\Temp\WER7FC4.tmp.appcompat.txt> \\?\C:\ProgramData\Microsoft\Windows\WER\Temp\WER8022.tmp.WERInternalMetadata.xml> WERGenerationLog.txt> > These files may be available here:> C:\ProgramData\Microsoft\Windows\WER\ReportArchive\AppCrash_w3wp.exe_9d888ac04d24e4ae9ba23c5f7762b4ddf95248f_ed19be39_11f88503> > Analysis symbol: > Rechecking for solution: 0> Report Id: 9693a536-e15e-4c29-bb23-eee06a89815d> Report Status: 0> Hashed bucket: ba850d50d8e1d2fd9cbee4a20bd17584Now after 4th entry log, I see the specific application pool is restarted. This entire process happens 3 times in total - in about 2-3 minutes time total. In this particular case, 8 hours pass and we see a similar process repeating again.### To ReproduceSteps to reproduce the behavior:Using ASP.NET Core 2.2 on Windows 2016 Server. Running InProcessSite runs normally but suddenly we get this error - don't know what code triggers the error.From web.config:```<configuration>  <system.webServer>    <handlers>      <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" requireAccess="Script" />    </handlers>    <aspNetCore processPath=".\myproject.exe" arguments="exec &quot;C:\Web\myproject\myproject\bin\Release\netcoreapp2.2\myproject.dll&quot;" stdoutLogEnabled="true" stdoutLogFile=".\logs\log" hostingModel="InProcess">      <handlerSettings>        <handlerSetting name="debugLevel" value="file" />        <handlerSetting name="debugFile" value=".\logs\ancm.log" />      </handlerSettings>      <environmentVariables>        <environmentVariable name="ASPNETCORE_HTTPS_PORT" value="443" />        <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Production" />      </environmentVariables>    </aspNetCore>```We have a bunch of these errors in the stdout log - but they have been there in ASP.NET Core 2.1.x as well:```warn: Microsoft.AspNetCore.Antiforgery.Internal.DefaultAntiforgery[8]      The 'Cache-Control' and 'Pragma' headers have been overridden and set to 'no-cache, no-store' and 'no-cache' respectively to prevent caching of this response. Any response that uses antiforgery should not be cached.```FROM ANCM log> [aspnetcorev2_inprocess.dll] Starting app_offline monitoring in application 'C:\inetpub\sites\www.myproject.com\'> [aspnetcorev2_inprocess.dll] Starting file watcher thread> [aspnetcorev2.dll] Initializing logs for 'C:\Program Files\IIS\Asp.Net Core Module\V2\aspnetcorev2.dll'. Process Id: 2480.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.> [aspnetcorev2.dll] Resolving hostfxr parameters for application: '.\myproject.exe' arguments: 'exec "C:\Web\myproject\myproject\bin\Release\netcoreapp2.2\myproject.dll"' path: 'C:\inetpub\sites\www.myproject.com\'> [aspnetcorev2.dll] Known dotnet.exe location: ''> [aspnetcorev2.dll] Process path '.\myproject.exe' is not dotnet, treating application as standalone or portable with bootstrapper> [aspnetcorev2.dll] Checking application.dll at 'C:\inetpub\sites\www.myproject.com\.\myproject.dll'> [aspnetcorev2.dll] Checking hostfxr.dll at 'C:\inetpub\sites\www.myproject.com\.\hostfxr.dll'> [aspnetcorev2.dll] hostfxr.dll found app local at 'C:\inetpub\sites\www.myproject.com\.\hostfxr.dll', treating application as standalone> [aspnetcorev2.dll] Parsed hostfxr options: dotnet location: '' hostfxr path: 'C:\inetpub\sites\www.myproject.com\.\hostfxr.dll' arguments:> [aspnetcorev2.dll] Argument[0] = 'C:\inetpub\sites\www.myproject.com\.\myproject.exe'> [aspnetcorev2.dll] Argument[1] = 'exec'> [aspnetcorev2.dll] Argument[2] = 'C:\Web\myproject\myproject\bin\Release\netcoreapp2.2\myproject.dll'> [aspnetcorev2.dll] c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\commonlib\fileoutputmanager.cpp:142 Operation failed with LastError: 32 HR: 0x80070020> [aspnetcorev2.dll] Loading request handler:  'C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App\2.2.0\aspnetcorev2_inprocess.dll'> [aspnetcorev2.dll] Creating handler application> [aspnetcorev2_inprocess.dll] Initializing logs for 'C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App\2.2.0\aspnetcorev2_inprocess.dll'. Process Id: 2480.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.> [aspnetcorev2_inprocess.dll] Waiting for initialization> [aspnetcorev2_inprocess.dll] Starting in-process worker thread> [aspnetcorev2_inprocess.dll] Resolving hostfxr parameters for application: '.\myproject.exe' arguments: 'exec "C:\Web\myproject\myproject\bin\Release\netcoreapp2.2\myproject.dll"' path: 'C:\inetpub\sites\www.myproject.com\'> [aspnetcorev2_inprocess.dll] Known dotnet.exe location: ''> [aspnetcorev2_inprocess.dll] Process path '.\myproject.exe' is not dotnet, treating application as standalone or portable with bootstrapper> [aspnetcorev2_inprocess.dll] Checking application.dll at 'C:\inetpub\sites\www.myproject.com\.\myproject.dll'> [aspnetcorev2_inprocess.dll] Checking hostfxr.dll at 'C:\inetpub\sites\www.myproject.com\.\hostfxr.dll'> [aspnetcorev2_inprocess.dll] hostfxr.dll found app local at 'C:\inetpub\sites\www.myproject.com\.\hostfxr.dll', treating application as standalone> [aspnetcorev2_inprocess.dll] Parsed hostfxr options: dotnet location: '' hostfxr path: 'C:\inetpub\sites\www.myproject.com\.\hostfxr.dll' arguments:> [aspnetcorev2_inprocess.dll] Argument[0] = 'C:\inetpub\sites\www.myproject.com\.\myproject.exe'> [aspnetcorev2_inprocess.dll] Argument[1] = 'exec'> [aspnetcorev2_inprocess.dll] Argument[2] = 'C:\Web\myproject\myproject\bin\Release\netcoreapp2.2\myproject.dll'> [aspnetcorev2_inprocess.dll] In-process callbacks set> [aspnetcorev2_inprocess.dll] Event Log: 'Application 'C:\inetpub\sites\www.myproject.com\' started the coreclr in-process successfully.' > End Event Log Message.Attached is WER file I managed to find.[Report.wer.log](https://github.com/aspnet/AspNetCore/files/2705176/Report.wer.log)We are using the temp bug fix for getting CurrentDirectory (see https://github.com/aspnet/AspNetCore/issues/4206#issuecomment-445612167) in Program.cs```using Microsoft.AspNetCore;using Microsoft.AspNetCore.Hosting;using myproject.Helpers;namespace myproject{    public static class Program    {        public static void Main(string[] args)        {            CurrentDirectoryHelpers.SetCurrentDirectory(); // asp.net core 2.2 hack. In 3.0 this will be fixed: https://github.com/aspnet/AspNetCore/issues/4206#issuecomment-445612167            CreateWebHostBuilder(args).Build().Run();        }        public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>           WebHost.CreateDefaultBuilder(args)                .UseStartup<Startup>();    }}```### Additional context`dotnet --info`> .NET Core SDK (reflecting any global.json):>  Version:   2.2.100>  Commit:    b9f2fa0ca8> > Runtime Environment:>  OS Name:     Windows>  OS Version:  10.0.14393>  OS Platform: Windows>  RID:         win10-x64>  Base Path:   C:\Program Files\dotnet\sdk\2.2.100\> > Host (useful for support):>   Version: 2.2.0>   Commit:  1249f08fed> > .NET Core SDKs installed:>   2.1.300 [C:\Program Files\dotnet\sdk]>   2.1.301 [C:\Program Files\dotnet\sdk]>   2.2.100 [C:\Program Files\dotnet\sdk]> > .NET Core runtimes installed:>   Microsoft.AspNetCore.All 2.1.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]>   Microsoft.AspNetCore.All 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]>   Microsoft.AspNetCore.All 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]>   Microsoft.AspNetCore.All 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]>   Microsoft.AspNetCore.All 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]>   Microsoft.AspNetCore.All 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]>   Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]>   Microsoft.AspNetCore.App 2.1.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]>   Microsoft.AspNetCore.App 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]>   Microsoft.AspNetCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]>   Microsoft.AspNetCore.App 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]>   Microsoft.AspNetCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]>   Microsoft.AspNetCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]>   Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]>   Microsoft.NETCore.App 2.0.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]>   Microsoft.NETCore.App 2.1.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]>   Microsoft.NETCore.App 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]>   Microsoft.NETCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]>   Microsoft.NETCore.App 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]>   Microsoft.NETCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]>   Microsoft.NETCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]>   Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]
6085	area-servers	Consider merging OutOfProcess handler back into shim	cc @shirhatti 
6077	area-mvc	Calling BadRequest in controller is inconsistent with attribute validation	### Describe the bugAfter upgrading to ASP.NET Core 2.2, I noticed that attribute-based model validation produces 400 response bodies like the following:```json{    "errors": {        "Model.Field": [            "error message"        ]    },    "title": "One or more validation errors occurred.",    "status": 400,    "traceId": "|e43bcb39071100489dc1590f71370445.4fc1232b_"}```I have some additional validation in my controller action based on a database lookup that looks something like this:```csharptry{    this.service.ServiceCall(model);}catch (InvalidModelException e){    this.ModelState.AddModelError(nameof(Model.Field), e.Message);    return this.BadRequest(this.ModelState);}```The resulting response body looks like this:```csharp{    "Model.Field": [        "error message"    ]}```### Expected behaviorI would expect that calling `ModelState.AddModelError` from a controller action, then passing `ModelState` to `BadRequest` would give a response body similar to that of attribute-based model validation.### Additional contextI noticed that calling```csharpreturn this.BadRequest(new ValidationProblemDetails(this.ModelState));```gives a response body very close to the desired one, minus the `traceId` field.
6076	area-infrastructure	Building source code fails	Build process fails with the message saying "Could not find a version of MSBuild which satisfies the requirements specified in korebuild.json."### To ReproduceSteps to reproduce the behavior:Using this version of ASP.NET Core 'v3.0.0-preview-18579-0056'1. git clone --recursive https://github.com/aspnet/AspNetCore2. git submodule update --init –recursive3. .\build.cmd### Expected behaviorAll the build processes complete.### Screenshots![image](https://user-images.githubusercontent.com/14340675/50347675-b9544480-0579-11e9-8361-25cc17a0e578.png)### Additional contextHere is the console output including error message.```C:\Users\Administrator\Documents\GitHub\AspNetCore>.\build.cmdWARNING: No default group of projects was specified, so building the 'managed' and 'native' subset of projects. Run`build.cmd -help` for more details.Using KoreBuild 3.0.0-build-20181214.1WARNING: dotnet found on the system PATH is 'C:\Program Files\dotnet\dotnet.exe' but KoreBuild will use'C:\Users\Administrator\.dotnet\x64\dotnet.exe'.WARNING: Adding 'C:\Users\Administrator\.dotnet\x64' to system PATH permanently may be required for applications likeVisual Studio or VS Code to work correctly.Adding C:\Users\Administrator\.dotnet\x64 to PATH.NET Core SDK 3.0.100-preview-009750 is already installed. Skipping installation.Could not find a version of MSBuild which satisfies the requirements specified in korebuild.json.発生場所 C:\Users\Administrator\.dotnet\buildtools\korebuild\3.0.0-build-20181214.1\scripts\KoreBuild.psm1:511 文字:5+     throw 'Could not find a version of MSBuild which satisfies the re ...+     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~    + CategoryInfo          : OperationStopped: (Could not find ...korebuild.json.:String) [], RuntimeException    + FullyQualifiedErrorId : Could not find a version of MSBuild which satisfies the requirements specified in korebu   ild.json.```The output of `dotnet --info````C:\Users\Administrator\Documents\GitHub\AspNetCore>dotnet --infoA compatible SDK version for global.json version: [3.0.100-preview-009750] from [C:\Users\Administrator\Documents\GitHub\AspNetCore\global.json] was not foundHost (useful for support):  Version: 2.2.0  Commit:  1249f08fed.NET Core SDKs installed:  1.0.4 [C:\Program Files\dotnet\sdk]  1.1.0 [C:\Program Files\dotnet\sdk]  2.1.4 [C:\Program Files\dotnet\sdk]  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.300 [C:\Program Files\dotnet\sdk]  2.1.402 [C:\Program Files\dotnet\sdk]  2.1.502 [C:\Program Files\dotnet\sdk]  2.1.600-preview-009426 [C:\Program Files\dotnet\sdk]  2.2.101 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 1.0.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 1.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]To install additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download```I refer to this thread https://gitter.im/aspnet/Home/~iframe and "Desktop development with C++" has been installed.
6075	area-servers	NullReferenceException in IISHttpContext	### Describe the bugSince updating a website running in Azure App Service to use ASP.NET Core 2.2.0 with in-process hosting, I've observed a small number of `NullReferenceException`s being thrown via Application Insights.```System.NullReferenceException:   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.GetOriginalPath (Microsoft.AspNetCore.Server.IIS, Version=2.2.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60)   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContext.InitializeContext (Microsoft.AspNetCore.Server.IIS, Version=2.2.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60)   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpContextOfT`1+<ProcessRequestAsync>d__2.MoveNext (Microsoft.AspNetCore.Server.IIS, Version=2.2.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60)   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw (System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification (System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult (System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e)   at Microsoft.AspNetCore.Server.IIS.Core.IISHttpServer+<HandleRequest>d__27.MoveNext (Microsoft.AspNetCore.Server.IIS, Version=2.2.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60)```### To ReproduceApplication experiencing the issue was built from this commit:  martincostello/website@ee2ca4ba02823b97062924b7dc8f313e6278a3f8### Expected behaviorHTTP request is processed successfully.### Screenshots![image](https://user-images.githubusercontent.com/1439341/50333665-fe3a9580-04fd-11e9-95e4-0aeec97d3466.png)### Additional contextAdd any other context about the problem here.Include the output of `dotnet --info`
6070	area-mvc	Mvc should reference Razor through project reference instead of a package reference	Note: This is only for release/2.1 and release/2.2 branchesFollow up to https://github.com/aspnet/AspNetCore/pull/6047We need to figure out a way to reference Razor as a project reference in Mvc. Right now doing that fails because of special needs of `Microsoft.AspNetCore.Razor.Design` and `Microsoft.AspNetCore.Mvc.Razor.Extensions`.cc @natemcmaster 
6069	area-security	Google+ shutdown will break OAuth provider	The Authentication.Google package implements OAuth2 with Google services. However, it uses Google+ to fetch additional user information.https://github.com/aspnet/AspNetCore/blob/5ab3c89be3e6342f2a39c666fd0aca708fc7ec8b/src/Security/Authentication/Google/src/GoogleDefaults.cs#L21https://github.com/aspnet/AspNetCore/blob/5ab3c89be3e6342f2a39c666fd0aca708fc7ec8b/src/Security/Authentication/Google/src/GoogleOptions.cs#L29-L34"The Google+ Sign-in feature is fully deprecated and is being shut down on March 7, 2019. This will be a progressive shutdown, with intermittent failures starting as early as January 28, 2019. Developers should migrate to the more comprehensive Google Sign-in authentication system." ~https://developers.google.com/+/web/signin/This is a patch candidate all the way down to 1.0 and Katana. @muratg @blowdart Proposals:- Find a new API that will give us basic information like name, e-mail, etc.. It's unlikely the transition would be seamless.- Deprecate the provider and show people how to use OpenIdConnect. This has the benefit of being a docs only change. It may not work for Katana though, we'll have to see if it supported enough ODIC features.
6061	area-mvc	API Analyzer doesn't recognize ControllerBase.ValidationProblem.	### Describe the bugThe Web API Analyzer doesn't recognize `ApiControllerBase.ValidationProblem()` and does not prompt a codefix to add a `[ProducesResponseType]` attribute like it does for `ApiControllerBase.BadRequest()`.### To ReproduceSteps to reproduce the behavior:1. Using ASP.NET Core 2.22. Install Microsoft.AspNetCore.Mvc.Api.Analyzers 2.2.03. Add `return ValidationProblem();` to a controller marked with `[ApiController]`.### Expected behaviorAnalyzer catches the issue and underlines `return ValidationProblem();`Codefix prompt to add appropriate attributes to action.### Additional contextUsing ASP.NET Core 2.2 and Microsoft.AspNetCore.Mvc.Api.Analyzers 2.2.0. Since the default `ModelStateInvalidFilter` uses `ValidationProblemDetails` to build a 400 response object, it makes sense that people may want to do the same for validation problems within actions so that the response format is consistent in both cases. Alternatively or additionally, there should be a way to opt into `ApiControllerBase.BadRequest(ModelState)` using `ValidationProblemDetails` to build its response object for consistency with `ModelStateInvalidFilter`.
6057	area-hosting	IHostedService in generic host can inject scoped dependencies, while IHostedService in webhost cannot	### Describe the bugIHostedServic implementation in generic host can inject scoped dependencies, while IHostedService in webhost crashes. ### To Reproduce.net core 2.2Inject a scoped dependency in a ihostedservice implementation in a generic host, the service starts and the dependency is available for use. ```            var host = new HostBuilder()                .ConfigureServices((hostContext, services) =>                {                    services.Configure<HostOptions>(option =>                    {                        option.ShutdownTimeout = System.TimeSpan.FromSeconds(20);                    });                    services.AddScoped(typeof(ScopedDependency));                    services.AddHostedService<Service>();                })                .Build();            host.Run();```Inject a scoped dependency in a ihostedservice implementation in a webhost, the host crashes on startup.  ```        public void ConfigureServices(IServiceCollection services)        {            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_2);            services.AddScoped(typeof(ScopedDependency));            services.AddHostedService<Service>();        }```### Expected behaviorI would expect the IHostedService under a webhost to function the same way as in a generic host.
6052	area-mvc	Set bind(ed) object before onkeyup fires	In this case when the operator presses 'a' in the input form:```<input type=text bind="@SomeString" onkeyup="@Validate" />@functions{   private string SomeString;   private void Validate()   {      if(SomeString == "a") { // do something }      StateHasChanged();   }}```SomeString is still "". It would be nice to have seen SomeString as "a". 
6048	area-mvc	Blazor page's OnInit/OnInitAsync not called for query string changes	Blazor page's OnInit/OnInitAsync is not called when navigated to the same page with different query string. I am little lazy to describe it using the bug report template but I can demonstrate the issue using a sample code if necessary.
6031	area-identity	iOS 12 Safari breaks ASP.NET Core OIDC authentication	When logging into a site using Azure AD B2C Auth flow on IOS 12 I get caught in an infinite loop between my site and login.microsoft.com.The application works fine on other browsers and operating systems.I believe the issue may be related to:- https://social.msdn.microsoft.com/Forums/en-US/5f0aa4a8-9bfe-4be2-a366-77e6939ae36d/ios-12-safari-breaks-aspnet-core-21-oidc-authentication?forum=WindowsAzureAD&prof=required- https://bugs.webkit.org/show_bug.cgi?id=188165- https://hajekj.net/2018/08/31/beware-of-samesite-cookie-policy-in-asp-net-core-and-upcoming-ios-12/As an interim fix I have set ```o.Cookie.SameSite = SameSiteMode.None;``` but this seems like a pretty suboptimal approach.Is there a better solution? 
6030	area-identity	ClientId is used by default instead of Audience Id in file AzureAdAuthenticationBuilderExtensions.cs in .Net core 2.0	_From @blowdart on September 17, 2018 18:38__From @jatingandhi28 on September 17, 2018 9:38_File name - AzureAdAuthenticationBuilderExtensions.cs[Note this code has moved [here](https://github.com/aspnet/AADIntegration/blob/28e81276582af23f4c616d9db900664960682074/src/Microsoft.AspNetCore.Authentication.AzureAD.UI/JwtBearerOptionsConfiguration.cs#L33)].            public void Configure(string name, JwtBearerOptions options)            {                options.Audience = _azureOptions.ClientId;                options.Authority = $"{_azureOptions.Instance}{_azureOptions.TenantId}";            }However It should be             public void Configure(string name, JwtBearerOptions options)            {                options.Audience = _azureOptions.AudienceId;                options.Authority = $"{_azureOptions.Instance}{_azureOptions.TenantId}";            }_Copied from original issue: aspnet/Home#3538__Copied from original issue: aspnet/Security#1859_
6029	area-identity	Please consider splitting the AzureAD package apart to reduce dependencies	I have a lightweight ASP.NET Core Web API project.  It has no front end, and thus doesn't need most of what is bundled with the `Microsoft.AspNetCore.Mvc` package.   I can generally use `Microsoft.AspNetCore.Mvc.Core` package instead.*Except* that I need AAD authentication, and when I pull in `Microsoft.AspNetCore.Authentication.AzureAD.UI` it takes `Microsoft.AspNetCore.Mvc` as a dependency...Looking through the code, it seems like there are some [controllers and pre-compiled Razor views](https://github.com/aspnet/AADIntegration/tree/master/src/Microsoft.AspNetCore.Authentication.AzureAD.UI/Areas/AzureAD) being included, so I understand why you need the full `Mvc` package to support those.It would be great if you could split out the core AAD auth from the UI components, such that those of us who don't need the UI don't need to take the dependency on the big Mvc package.  Something like this perhaps:- `Microsoft.AspNetCore.Authentication.AzureAD.UI`  - `Microsoft.AspNetCore.Mvc`  - `Microsoft.AspNetCore.Authentication.AzureAD.Core`    - `Microsoft.AspNetCore.Authentication.Cookies`    - `Microsoft.AspNetCore.Authentication.JwtBearer`    - `Microsoft.AspNetCore.Authentication.OpenIdConnect`Thanks.
5973	area-servers	2.2.0 IIS Hosting Bundle 500.30 error when setting web.config ASPNETCORE_ENVIRONMENT	### Describe the bugWe get a `HTTP Error 500.30 - ANCM In-Process Start Failure` after upgrading to asp.net core 2.2### To ReproduceSteps to reproduce the behavior:1. Install the latest Windows 2.2.0 hosting bundle (aspnetcore.dll 12.2.18316) on Windows server2. Create an asp.net core 2.2 web app with inprocess hosting3. Add a web.config:```<?xml version="1.0" encoding="utf-8"?><configuration>  <!-- To customize the asp.net core module uncomment and edit the following section.   For more info see https://go.microsoft.com/fwlink/?linkid=838655 -->  <system.webServer>    <handlers>      <remove name="aspNetCore" />      <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" />    </handlers>    <aspNetCore processPath="%LAUNCHER_PATH%" arguments="%LAUNCHER_ARGS%" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" hostingModel="InProcess"/>  </system.webServer></configuration>```4. Run the site using IIS Express5. Verify environment variables were added to your `web.config`:```<aspNetCore processPath="%LAUNCHER_PATH%" arguments="%LAUNCHER_ARGS%" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" hostingModel="InProcess">      <environmentVariables>        <environmentVariable name="ASPNETCORE_HTTPS_PORT" value="44368" />        <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Development" />      </environmentVariables>    </aspNetCore>```3. On the server, create the site in IIS and then set an `ASPNETCORE_ENVIRONMENT` variable in machine-wide IIS `applicationhost.config` for the site4. Publish to the server and hit the site5. See the error6. I verified that if I remove the web.config environmentVariable named `ASPNETCORE_ENVIRONMENT` the site loads. Adding other web.config environment variables does not cause any problems.### Expected behaviorThe site should start### Additional contextWe set our `ASPNETCORE_ENVIRONMENT` environment variables for our sites in IIS applicationhost.config. I got the error for a site with "STAGING" set in applicationhost.config. I verified that even if I set the same value to "STAGING" in web.config the site will not start.We use shared applicationhost.config, but I don't think that's pertinent. The issue could obviously be duplicated without running the site in IIS Express first - as long as the `ASPNETCORE_ENVIRONMENT` variable is in web.config the site will not be able to startup on the server if that variable is also set in applicationhost.config. I have not confirmed that the site works if there is no `ASPNETCORE_ENVIRONMENT` variable set for the site in applicationhost.config.If there is no web.config in the Visual Studio project or if a default one is added which is all commented out a web.config is not created or modified when running the site in IIS Express.This did not error in asp.net core 2.1.I enabled logging in web.config and added a `logs` folder and a stdout logfile was created but it was empty.I worked around this by removing the environment variable from web.config before publishing.Cross-reference: https://github.com/aspnet/Docs/issues/10046
5972	area-servers	ASP.Net Core using .Net 4.7.2 documentation	The documentation and Visual Studio support for "In-process" vs. "Out-of-process" is very confusing when you're using ASP.Net core with .Net Framework 4.7.2, instead of .Net Core.For example, on the following page:https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/aspnet-core-module?view=aspnetcore-2.2...it says that the "in-process" model uses the "HTTP.sys" driver.  However, every example (including the code inside `WebHost.CreateDefaultBuilder`, which every ASP.Net Core sample uses) is setting up a Kestrel server.  Is this wrong?  If you want to use "in-process", do you have to ditch the Kestrel server and start using the HTTP.sys server instead?Later on, that same page says that "the ASP.Net Core Module handles requests... [for] the out-of-process Kestrel server", which suggests that Kestrel is the out-of-process option.However, on the following page:https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/aspnet-core-module?view=aspnetcore-2.2... it says to use WebHost.CreateDefaultBuilder if you want "in-process", which, if you look at the source, internally uses Kestrel.  So those two pages seem to conflict. (As a side note, it says "CreateDefaultBuilder calls the UseIIS method, which isn't true - it calls UseIISIntegration").As another example, when you run an ASP.Net Core (.Net 4.7.2) application from Visual Studio using IIS or IIS Express, you're given an option to choose "in-process" or "out-of-process" in the Debug tab of the project settings.  ![image](https://user-images.githubusercontent.com/3098820/50244916-1cd64a80-039f-11e9-93f9-88fb3f4a37c4.png)However, even if you choose "in-process", the ASP.Net Core project's executable still shows up in the Task manager, in addition to "w3wp.exe" or "iisexpress.exe", suggesting that it's running "out-of-process".Add to that the following page:https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-2.2which *only* talks configuration options for .Net Core, not .Net 4.7.2.  And it says that only .Net Core 2.2 or later supports the "in-process" hosting model, without mention of .Net 4.7.2.For example, is says that the Process name will be "dotnet" in the out-of-process model, which I don't believe is correct when using .Net 4.7.2.And to add a little more, none of those mention anything about the "IISHttpServer" module mentioned here:https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/?view=aspnetcore-2.2&tabs=windows... which I think plays a role.I guess just in general: Is there a good full example Visual Studio project that uses "In-Process", "Framework dependent deployment", Net 4.7.2, Asp.Net Core Module, and IIS and that works completely as expected?
5971	area-mvc	ASP.NET Core 2.2 - [assembly: ApiConventionType(typeof(DefaultApiConventions))] doesnt make warnings go away	### Describe the bugASP.NET Core 2.2 - [assembly: ApiConventionType(typeof(DefaultApiConventions))] doesnt make warnings go away### To Reproduce1. Installed the package for Microsoft.AspNetCore.Mvc.Api.Analyzer2. Added [assembly: ApiConventionType(typeof(DefaultApiConventions))] to top of my controller namespace3. still get warnings without individually specifying ProducesResponseType### Expected behaviorExpects warnings to dissappear### Screenshotshttps://i.stack.imgur.com/rlW4D.png### Additional contextonly works if i put it directly on the method, also tried 3.0 preview version of the package, same problem    [ApiConventionMethod(typeof(DefaultApiConventions), nameof(DefaultApiConventions.Get))]    [HttpGet]    public ActionResult<IEnumerable<string>> Get()    {        return BadRequest();    }Also tried it on a different machine with vs 2017 enterprise vs pro that I was using, same issue that If  I have[assembly: ApiConventionType(typeof(DefaultApiConventions))]```namespace APIConventiontest.Controllers{    [Route("api/[controller]")]    [ApiController]    public class ValuesController : ControllerBase    {        // GET api/values        [HttpGet]        public ActionResult<IEnumerable<string>> Get()        {            return BadRequest();                }           }```I get a warning about "BadReqest" "Anction method returns undeclared status code '400'
5960	area-hosting	Make WebApplicationFactory work with the generic host	This is one of the things we need to make work end to end with the new generic host work. Specifically, I believe this line will explode https://github.com/aspnet/AspNetCore/blob/7b773324410cb075ea1821bcc50f018f86d8a0f6/src/Mvc/src/Microsoft.AspNetCore.Mvc.Testing/WebApplicationFactory.cs#L280We need to figure out what to do with this logic https://github.com/aspnet/AspNetCore/blob/425c196cba530b161b120a57af8f1dd513b96f67/src/Shared/Hosting.WebHostBuilderFactory/WebHostFactoryResolver.cs#L9. We may want to do this as a bigger re-design of the end to end test infrastructure.cc @javiercn @Tratcher 
5848	area-mvc	Razor completion for <text> tags	_From @vank-ms on Tuesday, 20 March 2018 17:18:42_I understand Razor gets opportunities to include C# completion items (like `@page`, `@inject`) and HTML items, which it currently does not participate in.  It would be nice if Razor contributed the <text> tag to HTML completion when appropriate._Copied from original issue: aspnet/Razor#2200_
5712	area-mvc	The new Endpoint routing behaves in unexpected and undocumented ways	### Describe the bugI'm migrating a website originally written in `asp.net` to `asp.net core`.In routing, I had minor problems until 2.1, but in 2.2 lots of things are broken.I cannot reproduce my original problem, but I've found other problems along the path to diagnose it.The original problem is that I get:```AmbiguousMatchException: The request matched multiple endpoints. Matches: MySite.Web.Controllers.HomeController.PermanentNotFound (MySite.Web)MySite.Web.Controllers.HomeController.Dashboard (MySite.Web)MySite.Web.Controllers.CompanyController.Index (MySite.Web)MySite.Web.Controllers.HomeController.Index (MySite.Web)```The `2.1` [docs on routing](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-2.1) say that:> When a request arrives, the routes in the collection are processed in the order that they exist in the collectionMaybe implying that once a route is matched, no further attempt is made.`2.2` [docs](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/routing?view=aspnetcore-2.2) lack such explanation. Btw, whatever I did to try and reproduce the problem, I failed, even by:```        routes.MapRoute(                    name: "default",                    template: "{controller}/{action}/{id?}",                    defaults: new { controller = "Home", action = "Index" });        routes.MapRoute( //intentionally creating a second, similar route, trying to cause AmbiguousMatchException            name: null,            template: "{controller}/{action}/{id?}",            defaults: new { controller = "Print", action = "Index" });```Reading the Routing source code, I could not understand the situation when the first match is chosen vs when such `AmbiguousMatchException` can occur. The compexity is in `DefaultEndpointSelector.ProcessFinalCandidates`:```        private static void ProcessFinalCandidates(            HttpContext httpContext,            EndpointSelectorContext context,            CandidateSet candidateSet)        {            Endpoint endpoint = null;            RouteValueDictionary values = null;            int? foundScore = null;            for (var i = 0; i < candidateSet.Count; i++)            {                if (!candidateSet.IsValidCandidate(i))                {                    continue;                }                ref var state = ref candidateSet[i];                if (foundScore == null)                {                    // This is the first match we've seen - speculatively assign it.                    endpoint = state.Endpoint;                    values = state.Values;                    foundScore = state.Score;                }                else if (foundScore < state.Score)                {                    // This candidate is lower priority than the one we've seen                    // so far, we can stop.                    //                    // Don't worry about the 'null < state.Score' case, it returns false.                    break;                }                else if (foundScore == state.Score)                {                    // This is the second match we've found of the same score, so there                     // must be an ambiguity.                    //                    // Don't worry about the 'null == state.Score' case, it returns false.                    ReportAmbiguity(candidateSet);                    // Unreachable, ReportAmbiguity always throws.                    throw new NotSupportedException();                }            }            if (endpoint != null)            {                context.Endpoint = endpoint;                context.RouteValues = values;            }        }```The problems with this code:- As soon as it finds two endpoints with the same score, it throws, but reporting on all endpoints in the set. Not all of them might have the same `Score`- The `Score` value in the comments is supposed to only show the order in a `CandidateSet`, but sometimes it's default (0) and only in one code path it has non-zero value. All in all, the above code looks like a very complex way of selecting the first `Valid` candidate.Now about constraints, consider this constraint:```public class MyConstraint : IRouteConstraint  {    public bool Match(HttpContext httpContext, IRouter route, string routeKey, RouteValueDictionary values, RouteDirection routeDirection)    {      return false;    }  }```And these routes:```routes.MapRoute(                    name: "default",                    template: "{controller}/{action}/{id?}",                    defaults: new { controller = "Home", action = "Index" },                    constraints: new { domain = new MyConstraint() });```If using `CompatibilityVersion.Version_2_1`, the `MyConstraint.Match` method **will be hit** and the route will match.With `CompatibilityVersion.Version_2_2`, the `MyConstraint.Match` **will not be  hit** and the route matches.With `CompatibilityVersion.Version_2_2`, and changing `constraints: new { action = new MyConstraint() })` the `MyConstraint.Match` **will be hit** but although it returns false, the `HomeController.Index` endpoint will be selected. With `CompatibilityVersion.Version_2_1`, none of the routes will match.Here are my suggestions:1. Improving the documentation by explicitly stating the expected behavior when multiple endpoints match (even more explicitly than the `2.1` docs)2. Fixing the code to avoid this strange behavior, or if it is by design, emphasizing it.3. Fixing endpoint routing constraints to act like the previous version, or documenting the difference.Thank you very much
5710	area-mvc	BrowserUriHelper is dead, right ?  	Dear friends, I guess you've killed BrowserUriHelper , right ? Unfortunately, in the comment at https://github.com/aspnet/AspNetCore/blob/ceb1c8e562562b2655622b571d2a9ad083806ad5/src/Components/blazor/src/Microsoft.AspNetCore.Blazor/Services/WebAssemblyUriHelper.cs, you still speaks of BrowserUriHelper in two places...Thanks...
5707	area-servers	Kestrel returns 415 if Content-Type header isn't provided for GET calls	_From @manish-panwar on Tuesday, 18 December 2018 19:21:20_# Issue TitleKestrel in net core 2.2 returns 415 if Content-Type header isn't provided for GET call# GeneralI am using .net core 2.2 and created a web api. When we make GET call with "Accept" header then Kestrel is  returning 415, it works fine if I pass the Content-Type header. In dotnet core 2.1.x it used to work fine even if I didn't pass Content-Type header. I am wondering what has changed in 2.2Generally one shouldn't need to pass Content-Type header for GET call, and Accept header should be enough.I hope this is the right place to raise this question. If not then if someone knows where I can raise this issue. Thanks a lot for your help!_Copied from original issue: dotnet/core#2166_
5702	area-mvc	@Html.Raw(Html.Partial("path")) does not work	### Describe the bugIf I use @Html.Partial("someview"), it works fine and returns the markup.  In my case I need to assign that markup to a javascript variable.  First I tried with just @Html.Raw(Html.Partial("path")), and it does not return markup.  It just returns "Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewBuffer" instead of raw markup.My final intention is this:var jsMarkup = "";jsMarkup = "@Html.Raw(Html.Partial("path"));even from the above the javascript variable "jsMarkup" just contains "Microsoft...ViewBuffer".  This is the case whether or not I use a js variable.  If I remove "Html.Raw" it works, but the markup is not js friendly string obviously.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core '2.1'2. Run this code '@Html.Raw(Html.Partial("path"))'3. Will result in:"Microsoft.AspNetCore.Mvc.ViewFeatures.Internal.ViewBuffer"### Expected behaviorHas to render the markup in a raw way.
5700	area-security	.NET Core 3.0 Preview 1 makes app fail to start	_From @godrose on Tuesday, 18 December 2018 06:44:00_# Issue TitleUsing latest version of .NET Core 3.0.0 SDK (009812) introduces regression into an existing app# GeneralUpgrading to the preview version and using it instead of 2.2.0 results in the following exception during app start:```Application startup exception: System.InvalidOperationException: Scheme already exists: ASOS   at Microsoft.AspNetCore.Authentication.AuthenticationOptions.AddScheme(String name, Action1 configureBuilder)   at Microsoft.Extensions.Options.OptionsFactory1.Create(String name)   at System.Lazy1.ViaFactory(LazyThreadSafetyMode mode)   at System.Lazy1.ExecutionAndPublication(LazyHelper executionAndPublication, Boolean useDefaultConstructor)   at System.Lazy1.CreateValue()   at Microsoft.AspNetCore.Authentication.AuthenticationSchemeProvider..ctor(IOptions1 options, IDictionary2 schemes)```_Copied from original issue: dotnet/core#2160_
5699	area-servers	Occasional 'address already in use' error when starting an app hosted in an Azure App Service	### Describe the bugWe have a number of ASP.NET Core apps hosted inside a single Azure App Service, as Virtual Applications. Occasionally after a restart (e.g. due to deploying), one or more apps will fail to start correctly and return HTTP 400 Bad Request to all requests. This appears to be due to a socket binding error.### To Reproduce1. Create one or more ASP.NET Core 2.1.1 applications. I target .NET Framework due to a dependency, I don't know if the issue also occurs when targetting .NET Core. I use a modified version of `CreateDefaultBuilder` that deals with configuration sources, it does not apply any non-default hosting or binding settings.2. Deploy the applications to an Azure App Service, as Virtual Applications. I use an Azure DevOps pipeline for this. (see screenshot below)3. Stop and Start the App Service until at some point one of the applications returns a HTTP 400.### Expected behaviorAll applications start successfully.### Screenshots![screenshot of the Virtual Applications configuration](https://user-images.githubusercontent.com/1618054/50167390-5b113280-02e9-11e9-9ebd-65241ae67c80.png)### Additional contextThe problem never occurs when running the application locally via Visual Studio.This is the captured log:```info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[0]      Azure Web Sites environment detected. Using 'D:\home\ASP.NET\DataProtection-Keys' as key repository; keys will not be encrypted at rest.crit: Microsoft.AspNetCore.Server.Kestrel[0]      Unable to start Kestrel.System.IO.IOException: Failed to bind to address http://127.0.0.1:23222: address already in use. ---> Microsoft.AspNetCore.Connections.AddressInUseException: Only one usage of each socket address (protocol/network address/port) is normally permitted ---> System.Net.Sockets.SocketException: Only one usage of each socket address (protocol/network address/port) is normally permitted   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)   at System.Net.Sockets.Socket.Bind(EndPoint localEP)   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()   --- End of inner exception stack trace ---   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass22_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.<BindEndpointAsync>d__3.MoveNext()   --- End of inner exception stack trace ---   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.<BindEndpointAsync>d__3.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.<BindAsync>d__43.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.<BindAsync>d__2.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.<BindAsync>d__0.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<StartAsync>d__22`1.MoveNext()```Could there be some race condition in deciding the port to use, when multiple apps try to start at the same time? Is this a supported scenario?
5698	area-mvc	[Blazor] Improve the heritability of components	### Is your feature request related to a problem? Please describe.**BtnDefault.cshtml**```<button class="btn @Class" onclick="@onclick">@Name</button>@functions{    [Parameter]    protected string Name { get; set; }	    [Parameter]    protected string Class { get; set; }    [Parameter]    protected Func<Task> onclick { get; set; }}```**BtnForm.cshtml**```<div class="@Class">    <BtnDefault Name="@Name" Class="@BtnClass" onclick="@onclick" /></div>@functions{    [Parameter]    protected string Class { get; set; }	    [Parameter]    protected string Name { get; set; }	    [Parameter]    protected string BtnClass { get; set; }    [Parameter]    protected Func<Task> onclick { get; set; }}```**Main.cshtml**```<BtnForm Class="sort" Name="Test" BtnClass="white" onclick="@addUser" />```### Describe the solution you'd like**BtnDefault.cshtml**```<button class="btn @Class" onclick="@onclick">@Name</button>@functions{    [Parameter]    protected string Name { get; set; }	    [Parameter]    protected string Class { get; set; }    [Parameter]    protected Func<Task> onclick { get; set; }}```**BtnForm.cshtml**```inject BtnDefault Btn<div class="@Class">    <BtnDefault Value="@Btn"/></div>@functions{    [Parameter]    protected string Class { get; set; }}```**Main.cshtml**```<BtnForm Class="sort" Btn.Name="Test" Btn.Class="white" Btn.onclick="@addUser" />```### Describe alternatives you've considered**Main.cshtml**```<BtnForm Class="sort" Btn.Value="@btn" />@functions{    [Parameter]    protected BtnDefault btn { get; set; } = new BtnDefault()     {         Name="Test",        Class="white",        onclick="@addUser"     };}```### Additional contextI want to inherit components and also use their properties without duplicating variables.
5697	area-mvc	[Blazor] Poor component flexibility.	### Is your feature request related to a problem? Please describe.I have a component **modal.cshtml**```<div id="mb-@Id" class="modal" data-backdrop="true">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title">@Title</h5>            </div>            <div class="modal-body p-lg">                @Body            </div>            <div class="modal-footer">                @Footer            </div>        </div>    </div></div>@functions{    [Parameter]    protected string Id { get; set; }    [Parameter]    protected string Title { get; set; }    [Parameter]    protected RenderFragment Body { get; set; }    [Parameter]    protected RenderFragment Footer { get; set; }}```**BtnModal.cshtml**```@DynamicFragment@functions{    [Parameter]    protected BtnModalType Type { get; set; } = BtnModalType.Default;    [Parameter]    protected string Name { get; set; }    [Parameter]    protected Func<Task> onclick { get; set; }    RenderFragment DynamicFragment;    protected override void OnParametersSet()    {        DynamicFragment = builder =>        {            builder.OpenElement(1, "button");            builder.AddAttribute(1, "onclick", onclick);            builder.AddAttribute(1, "class", $"btn btn-raised {(Type == BtnModalType.Theme ? "theme" : (Type == BtnModalType.Left ? "danger" : "white"))} p-x-md");            if (Type == BtnModalType.Left)                builder.AddAttribute(1, "style", "margin-right: auto;");            builder.AddContent(2, Name);            builder.CloseElement();        };        base.OnParametersSet();    }}```**main.cshtml**```<Modal Id="adduser" Title="new usser">    <Body>        body content...    </Body>    <Footer>        <BtnModal Type="@BtnModalType.Left" Name="Remove" onclick="@RemoveUser" />        <BtnModal Name="Close" />        <BtnModal Type="@BtnModalType.Theme" Name="Save" onclick="@AddUser" />    </Footer></Modal>```### Describe the solution you'd likeI want to use typed variables.**BtnDefault.cshtml**```<button class="btn btn-raised p-x-md @Class" style="@style" onclick="@onclick">@Name</button>@functions{    [Parameter]    protected string Name { get; set; }	    [Parameter]    protected string Class { get; set; }	    [Parameter]    protected string style { get; set; }    [Parameter]    protected Func<Task> onclick { get; set; }}```**modal.cshtml**```<div id="mb-@Id" class="modal" data-backdrop="true">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title">@Title</h5>            </div>            <div class="modal-body p-lg">                @Body            </div>            <div class="modal-footer">                @LeftBtn                 @LastBtn                 @FirstBtn             </div>        </div>    </div></div>@functions{    [Parameter]    protected string Id { get; set; }    [Parameter]    protected string Title { get; set; }    [Parameter]    protected RenderFragment Body { get; set; }    [Parameter]    protected RenderFragment<BtnDefault> LeftBtn { get; set; }	    [Parameter]    protected RenderFragment<BtnDefault> FirstBtn { get; set; }    [Parameter]    protected RenderFragment<BtnDefault> LastBtn { get; set; }    protected override void OnParametersSet()    {        LeftBtn.Class = "danger";        LeftBtn.style="margin-right: auto;"        LastBtn.Class ="white";        base.OnParametersSet();    }}```**main.cshtml**```<Modal Id="adduser" Title="new usser">    <Body>        body content...    </Body>    <LastBtn Name="Close" />    <LeftBtn Name="Remove" onclick="@RemoveUser" />    <FirstBtn Name="Save" onclick="@AddUser" Class="theme"/></Modal>```### Describe alternatives you've considered**BtnDefault.cshtml**```<button class="btn btn-raised p-x-md @Class" style="@style" onclick="@onclick">@ChildContent</button>@functions{    [Parameter]    protected RenderFragment ChildContent { get; set; }	    [Parameter]    protected string Class { get; set; }	    [Parameter]    protected string style { get; set; }    [Parameter]    protected Func<Task> onclick { get; set; }}```**modal.cshtml**```<div id="mb-@Id" class="modal" data-backdrop="true">    <div class="modal-dialog">        <div class="modal-content">            <div class="modal-header">                <h5 class="modal-title">@Title</h5>            </div>            <div class="modal-body p-lg">                @Body            </div>            <div class="modal-footer">                <BtnDefault Class="danger" style="margin-right: auto;" onclick="@LeftBtn.onclick">@LeftBtn.ChildContent</BtnDefault>                <BtnDefault Class="white">@LastBtn.ChildContent</BtnDefault>                <BtnDefault Class="@FirstBtn.Class" onclick="@FirstBtn.onclick">@FirstBtn.ChildContent</BtnDefault>            </div>        </div>    </div></div>@functions{    [Parameter]    protected string Id { get; set; }    [Parameter]    protected string Title { get; set; }    [Parameter]    protected RenderFragment Body { get; set; }    [Parameter]    protected Component<BtnDefault> LeftBtn { get; set; }	    [Parameter]    protected Component<BtnDefault> FirstBtn { get; set; }    [Parameter]    protected Component<BtnDefault> LastBtn { get; set; }}```**main.cshtml**```<Modal Id="adduser" Title="new usser">    <Body>        body content...    </Body>    <LastBtn>Close</LastBtn>    <LeftBtn onclick="@RemoveUser">Remove</FirstBtn>    <FirstBtn onclick="@AddUser" class="theme">Save</FirstBtn></Modal>```### Additional context**In the first example**:1) I had to create BtnModal.cshtml which practically duplicates BtnDefault.cshtml so that in main.cshtml not duplicate Class="theme" in the <BtnModal /> component2) Need to use Type="@BtnModalType.Theme" or Class="theme" if you remove BtnModalType from BtnModal.cshtml3) You can add any content not related to BtnModal.cshtml to Modal.Footer.4) It is necessary to remember the name of the component used in Modal.Footer as well as their sequence.5) Studio will tell you about Modal.Footer but will not tell you the sequence and type of components that should be used inside.**In the second and third example**:1) Used by BtnDefault.cshtml without creating an additional component BtnModal.cshtml2) No need to specify Class="theme/danger" as well as style="margin-right: auto;"3) No need to follow the sequence of buttons4) The studio will tell you about the components of Modal.*Btn and about the fields for each Modal.*Btn5) You can re-classify Class="theme/danger" and style="margin-right: auto;" on each button, if necessary, without creating additional controls and variables6) More complex implementations will give more benefits.
5694	area-mvc	Combine multiple shared localization resources into one	In our project, we have multiple shared localization resources which we classified them logically. Like; EnumResource, MessageResource etc.This is the helper object which we inject as singleton on startup.```public class GenericSharedResourceService<T> where T :class    {        private readonly IStringLocalizer _localizer;        public string this[string key] {            get            {                if (_localizer != null)                    return _localizer[key];                else                    return null;            }        }        public GenericSharedResourceService(IStringLocalizerFactory factory)        {            //foreach T run below            var type = typeof(T);            var assemblyName = new AssemblyName(type.GetTypeInfo().Assembly.FullName);            _localizer = factory.Create(type.GetTypeInfo().Name, assemblyName.Name);             //at the end combine all _localizers into one localizer object        }        public LocalizedString GetLocalizedString(string key) => _localizer[key];    }```This is how we call them from views as an example ```@inject GenericSharedResourceService<MessageResource> ML@inject GenericSharedResourceService<EnumResource> EL```So what we want is to be able to combine multiple shared resource into one resource in this helper object, so call just one shared resource object instead multiple in controllers and views. I searched the api (`IStringLocalizerFactory.Create` and `IStringLocalizer`) but couldn't find anything useful. Is there any way to do this?
5693	area-servers	Is InProcess hosting mode supported with .net framework aspnetcore apps	Hello,I try to figure out if aspnetcore on .Net Framework can be hosted on IIS with in-process mode.It's not seems to be the case but It's not clear in the documentation. Thank you.
5692	area-mvc	[Blazor] Call on application startup	### Is your feature request related to a problem? Please describe.I'm am trying to do a HttpClient call during app init but the result is load after the app is load or the blocking call stop and crash browser.### Describe the solution you'd likeA posibility to call async during app loading and app wait the call is over to continuous the process.For example in Angular : https://hackernoon.com/hook-into-angular-initialization-process-add41a6b7e### Describe alternatives you've consideredI try to add a component with async init in App.cshtml but the result is load after the page is render.
5683	area-mvc	Blazor, How to Invoke .NET methods from JavaScript functions use js timer	blazor : How to Invoke .NET methods and get values from JavaScript functions use js timer. and It goes on and on.and How to Invokeand JavaScript functions and delivery Mass data from .NET methods  use C# timer. when I do it, chrome run 1 hour later , crash.https://github.com/aspnet/AspNetCore/issues/4365
5681	area-mvc	Parent ViewModel is not bound (null) when error occurs in child VM	_From @montella1507 on Monday, 17 December 2018 22:24:34_# GeneralWhen error occurs in binding of child viewmodel, parent ViewModel is NULL. #Desired behaviorParent ViewModel should not be NULL, only Child VM.How to simulate:```c#public class ParentVM {   public string FirstName { get; set; }   public string LastName { get; set; }   public ChildVM Xyz { get; set; }}public class ChildVM     {        public string A { get; set; }        public string B { get; set; }}Request payload:{    "firstName": "PETER",    "lastName": "PARKER",    "xyz":  "kldqwjkld"  <<<< should be { "a": "qddq", "b": "dqdd" }}```Result in controller is, VM is NULL:![image](https://user-images.githubusercontent.com/10418323/50119343-c9ef7c80-0252-11e9-86c6-356a32326bad.png)Version info:Microsoft.AspnetCore.App (2.1.1) Win 10 x64  .NET Core runtime._Copied from original issue: dotnet/core#2156_
5343	area-signalr	javadoc warnings for Java client	Two warnings:1. Need to set some HTML setting (presumably set to HTML5)2. Some bad doc on an API```[12:30:41][Step 2/2]   > Task :javadoc[12:30:41][Step 2/2]   javadoc: warning - You have not specified the version of HTML to use.[12:30:41][Step 2/2]   The default is currently HTML 4.01, but this will change to HTML5[12:30:41][Step 2/2]   in a future release. To suppress this warning, please specify the[12:30:41][Step 2/2]   version of HTML used in your documentation comments and to be[12:30:41][Step 2/2]   generated by this doclet, using the -html4 or -html5 options.[12:30:41][Step 2/2]   D:\b\w\33bdfc1cae7b2a38\modules\SignalR\clients\java\signalr\src\main\java\com\microsoft\aspnet\signalr\HubConnection.java:217: warning: no @return[12:30:41][Step 2/2]       public CompletableFuture start() throws Exception {[12:30:41][Step 2/2]                                ^[12:30:42][Step 2/2]   2 warnings[12:30:42][Step 2/2]   [12:30:42][Step 2/2]   > Task :javadocJar```Full log here: http://aspnetci/viewLog.html?buildId=565722&buildTypeId=Coherence_UpdateRepos&tab=buildLog
5164	area-mvc	[Blazor] Blazor client-side BrowserHttpMessageHandler uses Uri.ToString() which unescapes characters	### SymptomsSending a HTTP Request with URI containing escaped ``{``, ``:`` or ``}`` characters (``%7B``, ``%3A``, ``%7D``) through HttpClient in Blazor client-side causes the browser to request a resource on the URI with those characters unescaped.### ReproductionUsing Blazor 0.7.0 client-side, execute the following:``` C#string complexParameter = @"{""key"":""value""}";string encodedParameter = WebUtility.UrlEncode(complexParameter); // %7B%22key%22%3A%22value%22%7D"string uri = $"https://contoso.com?parameter={encodedParameter}";await _httpClient.SendAsync(new HttpRequestMessage(HttpMethod.Get, uri));```**Actual behavior**The browser sends `GET https://contoso.com?parameter={%22key%22:%22value%22}` to which some webservers respond with HTTP 400 Bad Request as that URI contains invalid characters according to [RFC-3986](https://tools.ietf.org/html/rfc3986). This is somewhat complicated by the fact that browsers also attempt to neaten the URI and unescape the characters.**Expected behavior**The browser sends `GET https://contoso.com?parameter=%7B%22key%22%3A%22value%22%7B`, which is [RFC-3986](https://tools.ietf.org/html/rfc3986)-compliant.### Further detailsBlazor's client-side [BrowserHttpMessageHandler.SendAsync](https://github.com/aspnet/AspNetCore/blob/cc899e2be729364589ba7f4392bce9942e4faca4/src/Components/src/Microsoft.AspNetCore.Components.Browser/Http/BrowserHttpMessageHandler.cs#L40) uses [HttpRequestMessage.RequestUri.ToString()](https://github.com/aspnet/AspNetCore/blob/cc899e2be729364589ba7f4392bce9942e4faca4/src/Components/src/Microsoft.AspNetCore.Components.Browser/Http/BrowserHttpMessageHandler.cs#L66) to supply the URI to JavaScript's Fetch API. [Uri.ToString()](https://docs.microsoft.com/en-us/dotnet/api/system.uri.tostring?view=netstandard-2.0) is specified in the .NET Standard as "All characters are unescaped except #, ?, and %.". This basically undoes any escaping done so far on the C#-side, which is all the escaping a developer using Blazor might do.Passing into JavaScript realm, the [Fetch API is invoked](https://github.com/aspnet/AspNetCore/blob/cc899e2be729364589ba7f4392bce9942e4faca4/src/Components/src/Microsoft.AspNetCore.Components.Browser.JS/src/Services/Http.ts#L27) with the unescaped URI, attempting to escape it as best as it can before sending it, escaping back many of the previously unescaped characters (see [Fetch API URL spec/URL Parsing](https://url.spec.whatwg.org/#url-parsing)).Therefore, a lot of escaping cases still work as the unescaping is covered up by the Fetch API. In the case of ``:``, ``{`` and ``}`` characters, however, the unescaped form is kept and sent as part of the HTTP request.
5163	area-mvc	Blazor: Error: Cannot write embedded resource from assembly 'Blazor.Extensions.SignalR.JS'	I am just setting up a project with ASP.NET as server and Blazor as client. I also use a `Directory.Build.props` file to load another .props file whose purpose is to redirect `bin` and `obj` folders into artifacts folder. This redirection causes the following error:Cannot write embedded resource from assembly 'Blazor.Extensions.SignalR.JS' to C:\Users\wilvin\Desktop\IBOW\artifacts\obj\xx\Debug\netstandard2.0\blazor\_content\Blazor.Extensions.SignalR.JS because it is outside the expected directoryC:\Users\wilvin\Desktop\IBOW\build\..\artifacts\obj\xx\Debug\netstandard2.0\blazorThe difference is: `IBOW\build\..\artifacts` vs `IBOW\artifacts`, which is the same path. If I normalize the path with msbuild first, there is no problem. Example:```<ArtifactsPath>$([MSBuild]::NormalizePath($(MSBuildThisFileDirectory)../artifacts))</ArtifactsPath><BaseIntermediateOutputPath>$(ArtifactsPath)/obj/$(MSBuildProjectName)</BaseIntermediateOutputPath><IntermediateOutputPath>$(BaseIntermediateOutputPath)/$(Configuration)</IntermediateOutputPath><OutputPath>$(ArtifactsPath)/bin/$(MSBuildProjectName)/$(Configuration)</OutputPath>```I think the best way to solve it in general is if [this](https://github.com/aspnet/AspNetCore/blob/master/src/Components/src/Microsoft.AspNetCore.Components.Build/Core/EmbeddedResources/EmbeddedResourcesProcessor.cs#L79-L82) code block is normalizing the paths before comparison, so that no msbuild normalization is required.
5160	area-middleware	Double compression when response returns ContentEncoding header	When the back-end returns a compressed response, Microsoft.AspNetCore.ResponseCompression is double-compressing the response unnecessarily.My sugestion is to check the response header ContentEncoding before begin to write and compress the content.Here how I fix the problem locally:```csharp        private async void InternalWriteAsync(byte[] buffer, int offset, int count, AsyncCallback callback, TaskCompletionSource<object> tcs)        {            // Avoid to compress responses with any ContentEncoding header.            if (_context.Response.Headers.ContainsKey(HeaderNames.ContentEncoding))                _compressionChecked = true;            try            {                await WriteAsync(buffer, offset, count);                tcs.TrySetResult(null);            }            catch (Exception ex)            {                tcs.TrySetException(ex);            }            if (callback != null)            {                // Offload callbacks to avoid stack dives on sync completions.                var ignored = Task.Run(() =>                {                    try                    {                        callback(tcs.Task);                    }                    catch (Exception)                    {                        // Suppress exceptions on background threads.                    }                });            }        }```Please consider those changes.Regards
5159	area-mvc	Microsoft.AspNetCore.Mvc.ControllerBase.Content method does not set StatusCode of returned ContentResult object	### Describe the bugWhen using the `Microsoft.AspNetCore.Mvc.ControllerBase.Content(string content)` method to create a `ContentResult` object in a WebApi project, the object returned has a `null` value for the `int? StatusCode` property. This contradicts the description of the method, which states that the method:> "Creates a Microsoft.AspNetCore.Mvc.ContentResult object with Microsoft.AspNetCore.Http.StatusCodes.Status200OK by specifying a content string."Note that this seems to be turned into a 200 somewhere in the pipeline between the API Controller and a browser client, so this is not visible in normal operation. However, if you are unit testing the Controller and checking the value of the `StatusCode`, this will result in tests failing incorrectly.As a workaround, I'm just manually creating my own `ContentResult` objects with `StatusCode` set appropriately, rather than using the `Content` method.### To ReproduceUsing `ASP.NET Core 2.2.0`, run the following code as a method in an `ApiController` class:```[HttpGet]public IActionResult GetContentResult(){	var response = Content("Foo");	if (response.StatusCode.HasValue == false) {		throw new Exception("StatusCode is not set");	}	return response;}```Send a get request to this method. The exception will be thrown.### Expected behaviorMethod should return a `ContentResult` with `StatusCode` set as per the method description, consistent with behaviour of other `ControllerBase` methods like `Ok(string)`### Additional context`dotnet --info` output:```.NET Core SDK (reflecting any global.json): Version:   2.2.101 Commit:    236713b0b7Runtime Environment: OS Name:     Windows OS Version:  10.0.16299 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.2.101\Host (useful for support):  Version: 2.2.0  Commit:  1249f08fed.NET Core SDKs installed:  1.0.0-preview2-003131 [C:\Program Files\dotnet\sdk]  1.1.10 [C:\Program Files\dotnet\sdk]  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.302 [C:\Program Files\dotnet\sdk]  2.1.402 [C:\Program Files\dotnet\sdk]  2.1.403 [C:\Program Files\dotnet\sdk]  2.1.500 [C:\Program Files\dotnet\sdk]  2.1.502 [C:\Program Files\dotnet\sdk]  2.2.101 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 1.0.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 1.0.12 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 1.1.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]```
5157	area-mvc	Model Validation: FromQueryAttribute has different behavior then FromBodyAttribute when used with BindRequiredAttribute or RequiredAttribute	### Describe the bugWhen `[BindRequiredAttribute]` or `[RequiredAttribute]` is used on the entire model, for a model marked with `[FromBodyAttribute]`, when the model is null, then `BadRequest` is returned which is the expected behavior. ```public async Task<IActionResult> Post(            [BindRequired, FromBody] MyMode model,            CancellationToken cancellationToken)HTTP/1.1 400 Bad Request```When `[BindRequiredAttribute]` or `[RequiredAttribute]` is used on the entire model for a model marked with `[FromQueryAttribute]`, when the model is null, then `OK` is returned which is an *unexpected* behavior and inconsistent to `[FromBodyAttribute]`.```public async Task<IActionResult> Post(            [BindRequired, FromQuery] MyMode model,            CancellationToken cancellationToken)HTTP/1.1 200 OK```### To Reproduce1. Create new mvc project2. Add new controller with action methods defined as above### Expected behaviorWhen `[BindRequiredAttribute]` or `[RequiredAttribute]` is used on the entire model for a model marked with `[FromQuery]` when the model is null then `BadRequest` should be returned.### ScreenshotsNA### Additional contextNA
5156	area-servers	NullReferenceException in Microsoft.AspNetCore.Http.DefaultHttpContext.get_User()	Hello,We randomly experience exception System.NullReferenceException: Object reference not set to an instance of an object at Microsoft.AspNetCore.Http.DefaultHttpContext.get_User(), full stack below.Two custom middleware’s are only read header data and store them in HttpContext Items.I'm not able to reproduce this issue in testing or dev environment.We have two servers deployment in "farm" and using Redis for Distributed cache and for DataProtection Keys.May be it's similar issue as #2799 running on premise as IIS applicationOS: Windows Server 2012 R2, 6.3.9600dotnet:Host (useful for support):  Version: 2.1.6  Commit:  3f4f8eebd8.NET Core SDKs installed:  No SDKs were found..NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]```System.NullReferenceException: Object reference not set to an instance of an object.   at Microsoft.AspNetCore.Http.DefaultHttpContext.get_User()   at Microsoft.AspNetCore.Authorization.Policy.PolicyEvaluator.AuthenticateAsync(AuthorizationPolicy policy, HttpContext context)   at Microsoft.AspNetCore.Mvc.Authorization.AuthorizeFilter.OnAuthorizationAsync(AuthorizationFilterContext context)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext)   at Company.Client.Middleware.SsoTokenAuthMiddleware.Invoke(HttpContext httpContext) in d:\Client\Middleware\SsoTokenAuthMiddleware.cs:line 35   at Company.Client.Middleware.IsOutageChecker.Invoke(HttpContext httpContext) in d:\Client\Middleware\IsOutageChecker.cs:line 38   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)   at NWebsec.AspNetCore.Middleware.Middleware.CspMiddleware.Invoke(HttpContext context)   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)   at Company.Client.Middleware.HttpHeaderParserMiddleware.Invoke(HttpContext httpContext) in d:\Client\Middleware\HttpHeaderParserMiddleware.cs:line 50   at Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddleware.Invoke(HttpContext context)```
5154	area-security	Enforce multiple authentication schemes	### Is your feature request related to a problem? Please describe.A clear and concise description of what the problem is.Hi team,My issue is about authentication. I am trying to enforce two authentication schemes, My assumption is that the current behavior is that if you have more than one authentication scheme setup the framework will execute both and if any passes then the user will be authenticated.Is there a way to enforce both so if any of them fails then the authentication process fails?```c#services.AddAuthentication(options => {    options.DefaultAuthenticateScheme = SecurityConstants.CustomAuthenticationScheme;    options.DefaultChallengeScheme = SecurityConstants.CustomAuthenticationScheme; })     .AddScheme<AuthenticationSchemeOptions, CustomAuthenticationHandler>(SecurityConstants.CustomAuthenticationScheme,options => options. = "Bearer")     .AddIdentityServerAuthentication();```Just to be more clear, I've got a custom authentication scheme and identity server, if any of these fails I want to fail authentication. In short I would like that my action methods marked with [Authorize] and the default policy being RequiresAuthenticatedUser return 401 when authentication fails### Describe the solution you'd likeIt would be great if the DenyAnonymousAuthorizationRequirement can only verify that there is an authenticated user for the policy scheme### Describe alternatives you've consideredA clear and concise description of any alternative solutions or features you've considered.### Additional contextAdd any other context or screenshots about the feature request here.
5153	area-servers	ANCM In process: Managed exceptions before full initialization are too hard to look at	While testing out the generic host with the new ValidateOnBuild feature (which fails to build the host if there's an issue with services), I noticed that its really hard (even in development) to just get access to the managed exception when using ANCM in proc. If there's an exception in Program.cs, this is what you see:![image](https://user-images.githubusercontent.com/95136/50070452-dc01ea00-0182-11e9-93e4-8e7bc08c0c31.png)Then the event log shows this:![image](https://user-images.githubusercontent.com/95136/50070363-82012480-0182-11e9-9d25-c76b1475c7d4.png)This is a pretty bad experience for looking at a simple managed exception. Here are the steps we advertise to troubleshoot:```Troubleshooting steps:- Check the system event log for error messages- Enable logging the application process' stdout messages- Attach a debugger to the application process and inspect```- The event log tells me there's a manged exception, but nothing more.- Enabling stdout logging means I suddenly need a web.config file. Do we have a tooling gesture to turn this on? When I add a web.config it gives me this:    ```xml    <?xml version="1.0" encoding="utf-8"?>    <configuration>      <!-- To customize the asp.net core module uncomment and edit the following section.       For more info see https://go.microsoft.com/fwlink/?linkid=838655 -->      <!--      <system.webServer>        <handlers>          <remove name="aspNetCore"/>          <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModule" resourceType="Unspecified"/>        </handlers>        <aspNetCore processPath="%LAUNCHER_PATH%" arguments="%LAUNCHER_ARGS%" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" />      </system.webServer>      -->    </configuration>    ```    Which I am assuming isn't correct for inproc hosting.- The default debugger settings don't break when this exception occurs. The output window does show this obscure message though:    ```    Exception thrown: 'System.InvalidOperationException' in Microsoft.Extensions.DependencyInjection.dll    Exception thrown: 'System.InvalidOperationException' in Microsoft.Extensions.DependencyInjection.dll    Exception thrown: 'System.AggregateException' in Microsoft.Extensions.DependencyInjection.dll    ```- Changing the debugger settings to break on all exceptions does work.![image](https://user-images.githubusercontent.com/95136/50070823-76aef880-0184-11e9-8c71-6977c33c2c1b.png)We need to improve this. Here are some things I can think of:- We should re-think replacing the built in exception handler for .NET or finding a way to call into it when an unhandled exception happens. It logs the exception information to the event log with all of the details. Here's an example:![image](https://user-images.githubusercontent.com/95136/50070936-dad1bc80-0184-11e9-85f9-ac7d192a5d09.png)- We should show an error page with the exception in development.- We could potentially make our own managed entry point that we call into first in order to set things up such that we can get unhandled exceptions and handle them appropriately. Something like the following:```C#public static void HookExceptionHandler(){    AppDomain.CurrentDomain.UnhandledException += (sender, e) =>    {        if (e.IsTerminating)        {            // Log to the event log here        }    };}```We would call this delegate first (it would exist in the IIS integration assembly) so that before we called into main, we'd have logic in managed code to hook up the unhandled exception event handler.
5152	area-mvc	Global Filters Order	Filters of the same type (like `IResourceFilter`), with the same `IOrderedFilter.Order` are supposed to be ordered by their scope, which is working just fine. But when I add Global filters using the `Add<T>()` or `Add(Type)` method, it's not working correctly!Version: 2.1### To Reproduce1. Create some filters:```c#public class Global1 : Attribute, IResourceFilter, IOrderedFilter{    public int Order => 1;    public void OnResourceExecuted(ResourceExecutedContext context) { }    public void OnResourceExecuting(ResourceExecutingContext context)    {        Console.WriteLine("Global1");    }}public class Global2 : Attribute, IResourceFilter, IOrderedFilter{    public int Order => 2;    public void OnResourceExecuted(ResourceExecutedContext context) { }    public void OnResourceExecuting(ResourceExecutingContext context)    {        Console.WriteLine("Global2");    }}public class Controller1 : Attribute, IResourceFilter, IOrderedFilter{    public int Order => 1;    public void OnResourceExecuted(ResourceExecutedContext context) { }    public void OnResourceExecuting(ResourceExecutingContext context)    {        Console.WriteLine("Controller1");    }}public class Controller2 : Attribute, IResourceFilter, IOrderedFilter{    public int Order => 2;    public void OnResourceExecuted(ResourceExecutedContext context) { }    public void OnResourceExecuting(ResourceExecutingContext context)    {        Console.WriteLine("Controller2");    }}public class Action1 : Attribute, IResourceFilter, IOrderedFilter{    public int Order => 1;    public void OnResourceExecuted(ResourceExecutedContext context) { }    public void OnResourceExecuting(ResourceExecutingContext context)    {        Console.WriteLine("Action1");    }}public class Action2 : Attribute, IResourceFilter, IOrderedFilter{    public int Order => 2;    public void OnResourceExecuted(ResourceExecutedContext context) { }    public void OnResourceExecuting(ResourceExecutingContext context)    {        Console.WriteLine("Action2");    }}```2. Decorate an Action and a Controller with the appropriate filters:```c#[Controller1][Controller2]public class HomeController : Controller{    [Action1]    [Action2]    public IActionResult Index()    {        return View();    }}```3. Configure MVC with global filters:```c#services.AddMvc(cfg =>{    cfg.Filters.Add<Global1>();  // or cfg.Filters.Add(typeof(Global1));    cfg.Filters.Add<Global2>();  // or cfg.Filters.Add(typeof(Global2));});```### Expected behaviorI suppose the output should be something like this:> Global1  Controller1  Action1  Global2  Controller2  Action2but it's not! Something's wrong with the global filters. This is what I get:> Global1  Global2  Controller1  Action1  Controller2  Action2You can generate the correct result only if you pass an instance of global filters to the add method:```c#cfg.Filters.Add(new Global1());cfg.Filters.Add(new Global2());```
5149	area-servers	UseStartup on GenericWebHostBuilder should fail when Startup.ConfigureServices returns an IServiceProvider	Right now it's being ignored and it should throw instead.Program.cs```C#using System;using System.Collections.Generic;using System.IO;using System.Linq;using System.Threading.Tasks;using Microsoft.AspNetCore;using Microsoft.AspNetCore.Hosting;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.Hosting;using Microsoft.Extensions.Logging;namespace WebApplication44{    public class Program    {        public static void Main(string[] args)        {            CreateWebHostBuilder(args).Build().Run();        }        public static IHostBuilder CreateWebHostBuilder(string[] args) =>            Host.CreateDefaultBuilder(args)                .ConfigureWebHostDefaults(builder =>                {                    builder.UseStartup<Startup>();                });    }}```Startup.cs```C#using System;using System.Collections.Generic;using System.Linq;using System.Threading.Tasks;using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Http;using Microsoft.Extensions.DependencyInjection;namespace WebApplication44{    public class Startup    {        // This method gets called by the runtime. Use this method to add services to the container.        // For more information on how to configure your application, visit https://go.microsoft.com/fwlink/?LinkID=398940        public IServiceProvider ConfigureServices(IServiceCollection services)        {            return services.BuildServiceProvider();        }        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            app.Run(async (context) =>            {                await context.Response.WriteAsync("Hello World!");            });        }    }}```Here's the code that supposed to do that check.https://github.com/aspnet/AspNetCore/blob/cc899e2be729364589ba7f4392bce9942e4faca4/src/Hosting/Hosting/src/GenericHost/GenericWebHostBuilder.cs#L245-L249
5148	area-security	ASP.NET Core 2.2 Signature validation failed in JwtBearer Authentication (just in Linux/MacOS)	### Describe the bugAfter updating to 2.2 RSA signature cant' be verify in Linux and MacOS ( in windows it is ok).I use this code in the startup to set authentication:```csharp  services.AddAuthentication(options =>            {                options.DefaultAuthenticateScheme = JwtBearerDefaults.AuthenticationScheme;                options.DefaultSignInScheme = JwtBearerDefaults.AuthenticationScheme;                options.DefaultScheme = JwtBearerDefaults.AuthenticationScheme;            })            .AddJwtBearer(config =>            {                config.Events = new API.Core.Security.JwtBearerEvents();                config.RequireHttpsMetadata = !CurrentEnvironment.IsDevelopment();                config.IncludeErrorDetails = CurrentEnvironment.IsDevelopment();                config.SaveToken = true;                config.TokenValidationParameters = new TokenValidationParameters()                {                    RequireSignedTokens = true,                    ValidateIssuerSigningKey = true,                    ValidateLifetime = true,                    ValidateAudience = false,                    ValidateIssuer = false,                    IssuerSigningKey = new RsaSecurityKey(rsa)                };            });```After update in any endpoint with `[Authorize]` attribute in Linux or MacOS authentication middleware throw can't verify signature error.**in Older version or in windows it works just fine.**### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core '2.2.101'1. Add AddJwtBearer in Authentication2. Run in Linux/MacOs4. Call endpoint with `[Authorize]`5. See the error
5678	area-mvc	TypeLoadException	Type load error in deep library code of well known library.I attached project which demonstrates this bug.Also I added code (in Program.cs) which fixes bug, but it is hack. [BlazorExceptionExample.zip](https://github.com/aspnet/Blazor/files/2684016/BlazorExceptionExample.zip)Newtonsoft.Json.JsonSerializer serializer = new Newtonsoft.Json.JsonSerializer();serializer.Serialize(new StringWriter(new StringBuilder()), new SerializableClass()); // error herestacktrace:blazor.webassembly.js:1 WASM: System.TypeLoadException: Could not load type of field 'Newtonsoft.Json.Linq.JToken:_parent' (1) due to: Could not resolve type with token 010000f5 from typeref (expected class 'System.Collections.Specialized.INotifyCollectionChanged' in assembly 'mscorlib, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e') assembly:mscorlib, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e type:System.Collections.Specialized.INotifyCollectionChanged member:(null)blazor.webassembly.js:1 WASM:   at (wrapper delegate-invoke) System.Func`2[System.Type,Newtonsoft.Json.Serialization.JsonContract].invoke_TResult_T(System.Type)blazor.webassembly.js:1 WASM:   at System.Collections.Concurrent.ConcurrentDictionary`2[TKey,TValue].GetOrAdd (TKey key, System.Func`2[T,TResult] valueFactory) <0x1e98ed0 + 0x0007c> in <82fb964f98d945899c8c2aee07253463>:0 blazor.webassembly.js:1 WASM:   at Newtonsoft.Json.Utilities.ThreadSafeStore`2[TKey,TValue].Get (TKey key) [0x00000] in /_/Src/Newtonsoft.Json/Utilities/ThreadSafeStore.cs:64 blazor.webassembly.js:1 WASM:   at Newtonsoft.Json.Serialization.DefaultContractResolver.ResolveContract (System.Type type) [0x0000b] in /_/Src/Newtonsoft.Json/Serialization/DefaultContractResolver.cs:198 blazor.webassembly.js:1 WASM:   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.GetContractSafe (System.Object value) [0x00005] in /_/Src/Newtonsoft.Json/Serialization/JsonSerializerInternalWriter.cs:123 blazor.webassembly.js:1 WASM:   at Newtonsoft.Json.Serialization.JsonSerializerInternalWriter.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x00028] in /_/Src/Newtonsoft.Json/Serialization/JsonSerializerInternalWriter.cs:70 blazor.webassembly.js:1 WASM:   at Newtonsoft.Json.JsonSerializer.SerializeInternal (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value, System.Type objectType) [0x0023a] in /_/Src/Newtonsoft.Json/JsonSerializer.cs:1149 blazor.webassembly.js:1 WASM:   at Newtonsoft.Json.JsonSerializer.Serialize (Newtonsoft.Json.JsonWriter jsonWriter, System.Object value) [0x00000] in /_/Src/Newtonsoft.Json/JsonSerializer.cs:1076 blazor.webassembly.js:1 WASM:   at Newtonsoft.Json.JsonSerializer.Serialize (System.IO.TextWriter textWriter, System.Object value) [0x00000] in /_/Src/Newtonsoft.Json/JsonSerializer.cs:1033 blazor.webassembly.js:1 WASM:   at BlazorTypeLoadExceptionExample.Program.Main (System.String[] args) [0x00013] in C:\Data\git\BlazorExceptionExample\BlazorTypeLoadExceptionExample\Program.cs:31 
5677	area-mvc	MouseEvent does not adopt the properties	The Javascript function returns normal values like:> ClientX: 106, ClientY: 285The C# function only returns default values.> {"detail":0,"screenX":0,"screenY":0,"clientX":0,"clientY":0,"button":0,"buttons":0,"ctrlKey":false,"shiftKey":false,"altKey":false,"metaKey":false,"type":null}JavaScript Interop```javascript        document.onmouseup = function (event) {            console.log(event);            DotNet.invokeMethodAsync('DSA.App', 'JsMouseUp', event);        }```JavaScriptInteropClass```c# [JSInvokable]        public static Task<bool> JsMouseUp(UIMouseEventArgs eventArgs)        {            var found = false;            Console.WriteLine(Json.Serialize(eventArgs));            return Task.FromResult(found);        }```Is this an error? This is Blazor ServerSide
5144	area-servers	HttpContext property of HttpContextAccessor is null	![httpcontextaccessor_problem](https://user-images.githubusercontent.com/22634221/50058414-a1974d80-0180-11e9-9ca5-ccd675d6aca5.png)I have a REST API web application which worked perfectly with ASP.Net Core 2.1. Now the constructor injected IHttpContextAccessor returns a null value for HttpContext property.In Startup.cs class, in ConfigureServices method I have:```C#services.AddSingleton<IHttpContextAccessor, HttpContextAccessor>();          services.AddScoped<WorklistPagedTasksHalRepresentationConverter>();```This is the WorklistPagedTasksHalRepresentationConverter class```C#public class WorklistPagedTasksHalRepresentationConverter : TypeConverter<WorklistWithPagedTasks, WorklistPagedTasksHalRepresentation>    {        private readonly IHttpContextAccessor httpContextAccessor;        private readonly IMapper mapper;        public WorklistPagedTasksHalRepresentationConverter(IHttpContextAccessor httpContextAccessor, IMapper mapper)        {            this.httpContextAccessor = httpContextAccessor;            this.mapper = mapper;        }        public WorklistPagedTasksHalRepresentation Convert(WorklistWithPagedTasks source, WorklistPagedTasksHalRepresentation destination, ResolutionContext context)        {            var tasks = mapper.Map<IList<TaskSummaryHalRepresentation>>(source.Tasks.ResultPage.ToList());            var worklistPagedTasksHalRepresentation = new WorklistPagedTasksHalRepresentation(                new PaginatedResult<TaskSummaryHalRepresentation>                {                    ResultPage = tasks.AsQueryable(),                    TotalCount = source.Tasks.TotalCount,                    PageNumber = source.Tasks.PageNumber                },                httpContextAccessor.HttpContext.Request)            {                Id = source.Id,                OwnerId = source.OwnerId,                OwnerName = source.OwnerName            };            return worklistPagedTasksHalRepresentation;        }    }```The Convert method is called by a controller method.
5139	area-mvc	WebpackDevMiddleware and Nodejs version compatibility	### Describe the bugServing static files and HMR using WebpackDevMiddleware results in 400 Bad request error using Node.js LTS 10.14.2. Using Node.js LTS 8.12.0 works fine though.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core 2.1 or 2.2 and Node.js LTS version 10.14.2 or higher2. Run this code [https://github.com/jdebarochez/dotnet-webpack-hotreload-issue](https://github.com/jdebarochez/dotnet-webpack-hotreload-issue)3. With ```dotnet run```4. No files are served on the network### Expected behavior- Files in wwwroot folder should be served, even with WebpackDevMiddleware enabled- Updating frontend files should trigger hot module replacement in the browser. ### Screenshots![Chrome network tab screenshot](https://i.stack.imgur.com/OJnAq.png)### Additional contextHere is the output in the console:```info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:44350/dist/main.jstrce: Microsoft.AspNetCore.HostFiltering.HostFilteringMiddleware[0]      All hosts are allowed.dbug: Microsoft.AspNetCore.Server.Kestrel[9]      Connection id "0HLJ3B2FEC0E1" completed keep alive response.info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 12.8842ms 400```Commenting ```UseWebpackDevMiddleware``` in `Startup.cs` serve correctly our static files, but does not grant access to HotModuleReplacement.Downgrading Node.js to version 8.12.0 solved our issue. Is there anyway to troubleshoot/debug/trace the Nodejs instance created by WebpackDevMiddleware class?We found it by luck. We didn't find anything anywhere documenting such issue. Our SPA was rendering fine for some of our teammates and not for everyone. I'm still doubting Nodejs to be the only reason of our bug here. Output of `dotnet --info`:```bash.NET Core SDK (reflecting any global.json): Version:   2.2.100 Commit:    b9f2fa0ca8Runtime Environment: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.2.100\Host (useful for support):  Version: 2.2.0  Commit:  1249f08fed.NET Core SDKs installed:  1.1.0 [C:\Program Files\dotnet\sdk]  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.402 [C:\Program Files\dotnet\sdk]  2.1.403 [C:\Program Files\dotnet\sdk]  2.2.100 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 1.0.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 1.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]To install additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download```
5138	area-mvc	Model binding should use TryParse instead of Parse	### Describe the bugI have found root cause of a bug that was being reported by clients and could not replicate it.An Angular object is not being binded to the C# Object in the Controller. This throws Null Exception when this object is being used if the object that the user sends has a null value in a non-nullable C# property.I am developing an ASP.NET Core application with Angular as the user interface. Users were reporting that when they were trying to add a Product sometimes because it would throw an error (500 - internal server error) which it did because it was being caught and written in the Error table. The error was that the sent object to the Controller was null. I was unable to replicate this for months until yesterday.### To ReproduceSteps to reproduce the behavior:1. You need to have a C# object that has a non-nullable property.![image](https://user-images.githubusercontent.com/21820290/50053191-37a78580-0139-11e9-8ec5-81bcd97a5d78.png)2. Create a simple Angular form that has non-nullable C# properties as <input  type="number" ... /> for example. ```<div class="form-group has-success">      <h4 class="entity-info"><label for="grossWeight" class="label-has-success"> Greutate bruta {{measurementUnit}} </label></h4>           <div class="input-group">                  <div class="input-group-addon"><img [src]="serverBusyService.appName + '/images/Produs/grossWeight.svg'" alt="gross weight" class="img-responsive" /></div>                              <input type="number" id="grossWeight" name="grossWeight" class="form-control" placeholder="Greutate bruta" [(ngModel)]="produs.grossWeight">             </div>      </div>```2. Write something in this field and then delete it. After deleting it, Angular will make it null![image](https://user-images.githubusercontent.com/21820290/50053204-70475f00-0139-11e9-8639-9fa8020fca8b.png)3. With these arguments![image](https://user-images.githubusercontent.com/21820290/50053205-7b01f400-0139-11e9-9a45-339cff1f6b23.png)4. See errorAs it can be seen in the below image, ![image](https://user-images.githubusercontent.com/21820290/50053226-ea77e380-0139-11e9-8a1c-999772424e2e.png)the Net and Gross properties are null, which is not ok for C# and thus, the error is thrown at this line:![image](https://user-images.githubusercontent.com/21820290/50053230-1004ed00-013a-11e9-960b-ec0264eb8840.png)i.e. where the sent object is first used:![image](https://user-images.githubusercontent.com/21820290/50053244-42164f00-013a-11e9-951b-021b05808729.png)the produsResource is null. Which only happens in this type of situation.I think this is a problem with how C# tries to bind the received object because it sees there is a value for a double and tries to bind it, but since that value is null and since C# does not allow null on double, it quits from binding the object which is not ok.There workarounds to this of course:a. set the property as nullable in the resource classb. clean the object in Angular:```function clean(obj) {  var propNames = Object.getOwnPropertyNames(obj);  for (var i = 0; i < propNames.length; i++) {    var propName = propNames[i];    if (obj[propName] === null || obj[propName] === undefined) {      delete obj[propName];    }  }}```But in my opinion, C# should use TryParse for doubles (in this case), not Parse (as I assume it does) or it should not quit binding the object if something like this happens, not  only in this case, but object binding should never result in a null object, but bind what is possible.
5137	area-signalr	Unable to use SignalR HubConnectionBuilder.WithUrl and HttpConnectionOptions in Core 3.0	Using latest Core 3.0I'm trying:        hubConnection = new HubConnectionBuilder().WithUrl("http://localhost:5000/hubs/agenthub", options => options.Cookies.Add(myCookie)).Build();I get:`Error	CS0012	The type 'HttpTransportType' is defined in an assembly that is not referenced. You must add a reference to assembly 'Microsoft.AspNetCore.Http.Connections.Common, Version=3.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'.	VoyAdminAgent	`If I try to install package `Microsoft.AspNetCore.Http.Connections.Common`, the latest nuget version is 1.1.0 and I then get:`Error	CS1705	Assembly 'Microsoft.AspNetCore.SignalR.Client' with identity 'Microsoft.AspNetCore.SignalR.Client, Version=3.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60' uses 'Microsoft.AspNetCore.Http.Connections.Common, Version=3.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60' which has a higher version than referenced assembly 'Microsoft.AspNetCore.Http.Connections.Common' with identity 'Microsoft.AspNetCore.Http.Connections.Common, Version=1.1.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'`Any help ?```PM> get-packageMicrosoft.EntityFrameworkCore       {3.0.0-preview.18572.1}                  VoyAdminAgent                                                                       Microsoft.EntityFrameworkCore.Sq... {3.0.0-preview.18572.1}                  VoyAdminAgent                                                                       Microsoft.AspNetCore.SignalR.Client {3.0.0-preview-18579-0056}               VoyAdminAgent                                                                       Microsoft.NETCore.App               {3.0.0-preview-27122-01}                 VoyAdminAgent                                                                       ```
5132	area-mvc	Integration Test: API controller failed to call another controller via ASP.NET Core API 	I have a problem getting an API controller to call another API controller within the same project. Specifically, the integration project is able to call a controller in the production project, and the controller will make another call to a dummy controller within the same project, but the first controller failed with internal server error. However, the first controller can call google.com.Please note that it works when the production project is hosted via either console or windows services. It only happens when tests in integration project run.The production project is an ASP.NET CORE Web API project v2.1, and the integration test project, v2.1 via xUnit by following belowhttps://docs.microsoft.com/en-us/aspnet/core/test/integration-tests?view=aspnetcore-2.2Integration project with xUnit below:    public class RetryPolicyTests: IClassFixture&lt;WebApplicationFactory&lt;Startup&gt;&gt;        {            private readonly WebApplicationFactory&lt;Startup&gt; _factory;                public RetryPolicyTests(WebApplicationFactory&lt;Startup&gt; factory)            {                _factory = factory;            }                [Theory]            [InlineData("http://localhost:1234/api/v1/Book/")]                    public async Task Test(string url)            {                // Arrange                var client = _factory.CreateClient();                    // Act                               var body = "{}";                using (var content = new StringContent(body, Encoding.UTF8, "application/json"))                {    			                    var response = await client.PostAsync(url, content);                        // Assert                    response.EnsureSuccessStatusCode(); //Failed here with internal server error                    Assert.Equal(StatusCodes.Status200OK,                        (int) (response.StatusCode));                }            }        }	BookController		      [ApiVersion("1")]        [Route("api/v{version:apiVersion}/[controller]")]        [ApiController]        public class BookController : ControllerBase        {            private readonly ILog _logger;            private readonly IConfiguration _configuration;            private IHttpClientFactory _httpClientFactory;                public BookController(ILog logger , IConfiguration configuration, IHttpClientFactory httpClientFactory)            {                _logger = logger;                            _configuration = configuration;                _httpClientFactory = httpClientFactory;            }                    [HttpPost]            public async Task&lt;ActionResult&gt; Post()            {                           using (StreamReader reader = new StreamReader(Request.Body, Encoding.UTF8))                {                    string body = reader.ReadToEnd();                        var url = "http://localhost:1234/api/v1/Author/"                    using (var content = new StringContent(body, Encoding.UTF8, "application/json"))                    {                                            var _httpClient = _httpClientFactory.CreateClient();                        var s = _httpClient.GetAsync("http://google.com").Result;  //works here    					                        var response = await _httpClient.PostAsync(url, content);   //internal server error                         var statusCode = response.StatusCode;                        return StatusCode((int)statusCode);                    }                                }                  }            }AuthorController 		 [ApiVersion("1")]    [Route("api/v{version:apiVersion}/[controller]")]    [ApiController]            public class AuthorController : ControllerBase    {        ILog _logger;        public AuthorController(ILog logger)        {            _logger = logger;        }        [HttpPost]        public void Post()        {            using (StreamReader reader = new StreamReader(Request.Body, Encoding.UTF8))            {                var body = reader.ReadToEnd();            }    }	It works if integration test hits directly at Author controller.Error:    Result StackTrace:	    at System.Net.Http.HttpResponseMessage.EnsureSuccessStatusCode()       at IntegrationTests.xUnit.RetryPolicy.RetryPolicyTests.Test(String url) in C:\IntegrationTests.xUnit\RetryPolicy\RetryPolicyTests.cs:line 46    --- End of stack trace from previous location where exception was thrown ---    Result Message:	System.Net.Http.HttpRequestException : Response status code does not indicate success: 500 (Internal Server Error).Please note that after integration test hits the first controller and before hits the second controller, I tried to send the same data to the first controller via external tools, like Postman, or fiddler. But all controllers are not available to external tool, unlike if it is hosted on console or Windows service (In this case, all controllors can process requests).Cross-reference: https://github.com/aspnet/Docs/issues/10022**Update**I upgraded to 2.2, issue still exists**Update**System.Net.Http.HttpRequestException: No connection could be made because the target machine actively refused it ---> System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it   at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken)   --- End of inner exception stack trace ---   at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken)   at System.Threading.Tasks.ValueTask`1.get_Result()   at System.Net.Http.HttpConnectionPool.CreateConnectionAsync(HttpRequestMessage request, CancellationToken cancellationToken)   at System.Threading.Tasks.ValueTask`1.get_Result()   at System.Net.Http.HttpConnectionPool.WaitForCreatedConnectionAsync(ValueTask`1 creationTask)   at System.Threading.Tasks.ValueTask`1.get_Result()   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean doRequestAuth, CancellationToken cancellationToken)   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)   at System.Net.Http.DiagnosticsHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)   at Microsoft.Extensions.Http.Logging.LoggingHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)   at Microsoft.Extensions.Http.Logging.LoggingScopeHttpMessageHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)   at System.Net.Http.HttpClient.FinishSendAsyncBuffered(Task`1 sendTask, HttpRequestMessage request, CancellationTokenSource cts, Boolean disposeCts)   at Controllers.BookController.Post() in C:\src\Controllers\BookController.cs:line 84}	System.Exception {System.Net.Http.HttpRequestException}   InnerException	{System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it   at System.Net.Http.ConnectHelper.ConnectAsync(String host, Int32 port, CancellationToken cancellationToken)}	System.Exception {System.Net.Sockets.SocketException}
5130	area-identity	How could I use multiple UserManager<T> in a project?	### Is your feature request related to a problem? Please describe.I created two IdentityDbContext<T>, one is AdminIdentityDbContext:IdentityDbContext<Admin>, and another is StudentIdentityDbContext:IdentityDbContext<Student>. And I created two controllers, one is:```    public class AdminAccountController : Controller    {        private UserManager<Admin> _userManager;        private SignInManager<Admin> _signInManager;        public AdminAccountController(UserManager<Admin> userManager, SignInManager<Admin> signInManager)        {            _userManager = userManager;            _signInManager = signInManager;        }```Another is: ```public class StudentAccountController : Controller    {        private UserManager<Student> _userManager;        private SignInManager<Student> _signInManager;        public StudentAccountController(UserManager<Student> studentManager, SignInManager<Student> signInManager)        {            _userManager = studentManager;            _signInManager = signInManager;        }```My Startup.cs is as below:```using System;using System.Collections.Generic;using System.Linq;using System.Threading.Tasks;using LibraryDemo.Data;using LibraryDemo.Infrastructure;using LibraryDemo.Models.DomainModels;using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Http;using Microsoft.AspNetCore.HttpsPolicy;using Microsoft.AspNetCore.Identity;using Microsoft.AspNetCore.Mvc;using Microsoft.EntityFrameworkCore;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.DependencyInjection;namespace LibraryDemo{    public class Startup    {        public Startup(IConfiguration configuration)        {            Configuration = configuration;        }        public IConfiguration Configuration { get; }        // This method gets called by the runtime. Use this method to add services to the container.        public void ConfigureServices(IServiceCollection services)        {            services.Configure<CookiePolicyOptions>(options =>            {                // This lambda determines whether user consent for non-essential cookies is needed for a given request.                options.CheckConsentNeeded = context => true;                options.MinimumSameSitePolicy = SameSiteMode.None;            });            services.AddDbContext<LendingInfoDbContext>(options =>            {                options.UseSqlServer(Configuration.GetConnectionString("LendingInfoDbContext"));            });            services.AddDbContext<AdminIdentityDbContext>(options =>            {                options.UseSqlServer(Configuration.GetConnectionString("AdminIdentityDbContext"));            });            services.AddDbContext<StudentIdentityDbContext>(options =>            {                options.UseSqlServer(Configuration.GetConnectionString("StudentIdentityDbContext"));            });            services.AddIdentity<Student, IdentityRole>(opts =>                {                    opts.User.RequireUniqueEmail = true;                    opts.User.AllowedUserNameCharacters = "qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM0123456789";                    opts.Password.RequiredLength = 6;                    opts.Password.RequireNonAlphanumeric = false;                    opts.Password.RequireLowercase = false;                    opts.Password.RequireUppercase = false;                    opts.Password.RequireDigit = false;                }).AddEntityFrameworkStores<StudentIdentityDbContext>()                .AddDefaultTokenProviders();            services.ConfigureApplicationCookie(opts =>            {                opts.LoginPath = "/StudentAccount/Login";            });            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);        }        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            else            {                app.UseExceptionHandler("/Home/Error");                app.UseHsts();            }            app.UseAuthentication();            app.UseHttpsRedirection();            app.UseStaticFiles();            app.UseCookiePolicy();            app.UseMvc(routes =>            {                routes.MapRoute(                    name: "default",                    template: "{controller=Home}/{action=Index}/{id?}");            });            DatabaseInitiator.Initial(app.ApplicationServices).Wait();        }    }}```But when I got the site "/AdminAccount/Login", I got an error:> InvalidOperationException: Unable to resolve service for type 'Microsoft.AspNetCore.Identity.UserManager`1[LibraryDemo.Models.DomainModels.Admin]' while attempting to activate 'LibraryDemo.Controllers.AdminAccountController'.### Describe the solution you'd likeI don't feel like the Role feature, so what else can I do to resolve this problem? Thanks a lot.### Describe alternatives you've consideredI tried to change the schema of the DbContext but failed the same.### Additional contextI have put the project to github:https://github.com/NanaseRuri/LibraryDemo
5847	area-identity	Why is there a generic parameter definition TUser for PasswordHasher when it is not used?	Not sure if this is the place for this type of question, but I'm curious as to why TUser generic type parameter is used in PasswordHasher<TUser> class when TUser is not used internally in the class anywhere. https://github.com/aspnet/Identity/blob/master/src/Core/PasswordHasher.cs#L17TUser is used to define a parameter [here](https://github.com/aspnet/Identity/blob/master/src/Core/PasswordHasher.cs#L94) and [here](https://github.com/aspnet/Identity/blob/master/src/Core/PasswordHasher.cs#L172), but those parameters are never used.
5118	area-hosting	Are hosted services guaranteed to run	I've created a hosted service that executes a recurring task in .Net-Core. (I'm using shared hosting so I don't have control over iis)    public class SchedulerService : IHostedService    {        private readonly ILogger _logger;        private Timer _timer;        public SchedulerService(ILogger<SchedulerService> logger)        {            this._logger = logger;        }        public Task StartAsync(CancellationToken cancellationToken)        {            this._timer = new Timer(ExecuteTask, null, TimeSpan.Zero,                TimeSpan.FromMinutes(30));            return Task.CompletedTask;        }        private void ExecuteTask(object state)        {        }        public Task StopAsync(CancellationToken cancellationToken)        {            this._timer?.Change(Timeout.Infinite, 0);            return Task.CompletedTask;        }    }I'd like to ensure that this task is always run.  But Hosted Service's are **NOT** [guaranteed to complete](https://stackoverflow.com/questions/51144048/net-core-hosted-services-guarenteed-to-complete) due to app-pool recycles etc.I'm a bit confused on this notion.  I'm under the impression now that Hosted services are only run in the background after a request is made and once the app pool is recycled the background task is killed (e.g 90 second limit from the older version of .net)If this is the case, and no request are made to my site, can I still be guaranteed that my SchedulerService will run?Or should I just have my scheduler service send a request every ~75 seconds to myself, to ensure that a new thread will restart the scheduler?
5116	area-mvc	Removing Support for loading precompiled views from MVC 2.0	Discussed offline with @DamianEdwards We want to remove support for loading precompiled view that were created using MVC 2.0 and the precompilation tool from that era. The compiler of that era used the `RazorViewAttribute` and `RazorPageAttribute` to denote views and pages.  In 2.1 along with the release of the Razor SDK we added a new set of attributes for views/pages that are used by the 2.1+ compilation systems. In 2.1/2.2 we still support loading and running views that were compiled in 2.0 era with the deprecated precompilation tool.I plan to leave these types around but mark them obsolete and remove all of the infrastructure that processes them. This is coming up because we're doing some work to relayer how action discovery for pages works - we either have the choice to make these old types show up in new code and new APIs despite their irrelevance or to drop support. 
5114	area-signalr	Configure Azure Pipelines to run SignalR daily tests on PRs that opt in	See #5056 for context
5113	area-security	OIDC should verify response_mode	"Only if supported_response_modes is present in the discovery doc and form_post is listed there, should the RP ever try to use it.  If our RP code is sending response_mode=form_post when the IdP doesn’t support that, that’s a bug in our RP code, and needs to be fixed." ~Mike Jones, OIDC spec masterWarn or fail if the OIDCOptions.ResponseMode value isn't listed in the discovery doc. Note we default to 'form_post' which isn't required to be supported in the spec. The spec default is 'query'.https://openid.net/specs/oauth-v2-multiple-response-types-1_0.html#ResponseModes@blowdart 
5055	area-mvc	Generating URL with page parameter fails with new endpoint routing (regression from 2.1)	This appears to be a regression due to the new endpoint routing system in 2.2. As per aspnet/Mvc#7876, using parameter names `action` and `page` is somewhat difficult, however using a `page` parameter inside an MVC action or using an `action` parameter inside of a Razor page does work fine. At least it did.With endpoint routing activated (through the MVC compatibility switch `CompatibilityVersion.Version_2_2`), generating an action link that has a `page` parameter will now fail **iff** Razor pages exist in the same project.### Steps to reproduce#### Without Razor pages1. Create new 2.2 application from standard MVC template.2. Add an action to the `HomeController`:    ```c#    public IActionResult Test(int page)    {        return Json(new        {            Url = Url.Action(nameof(Test), new { page = 123 }),            Page = page,        });    }    ```3. Launch the application and open `http://localhost:5000/Home/Test?page=4`4. Observe the result which shows a generated URL `/Home/Test?page=123`.#### Add Razor pages5. Now, create a Razor page at `Pages/Foo.cshtml` with the contents `@page`.6. Launch the application and open the previous URL again.7. Observe that the generated URL is now `null`.#### Disable endpoint routing8. Disable endpoint routing by changing the `AddMvc()` call in `Startup` to set the compatibility level switch back to 2.1:    ```c#    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);    ```9. Launch the application and open the previous URL again.10. Observe that the URL is generated properly again.---As you can see, endpoint routing breaks the URL generation here although the target URL exists just fine and although it also can be used properly the whole time (note that the JSON response always includes the passed `page` value). The mere presence of Razor pages should not make the URL generation treat any `page` parameter in a special way here.
4971	area-mvc	Consider changing WebAssemblyHostBuilder to use IHostBuilder	See comments at https://github.com/aspnet/AspNetCore/pull/4785#issuecomment-447389248
5676	area-mvc	ILLink does not work in Azure DevOps pipeline	I hope I select correct repository for this one issue.Something is wrong with either Azure pre-populated nuget cache, or ILLink task should better select assemblies.```2018-12-13T21:24:06.7067783Z Program.cs(12,18): warning CA1052: Type 'Program' is a static holder type but is neither static nor NotInheritable [D:\a\1\s\xxx\xxxx.csproj]2018-12-13T21:24:06.7783615Z   MedNotes.Diagnostics -> D:\a\1\s\xxxx\bin\Release\netstandard2.0\xxx.dll2018-12-13T21:24:08.3878656Z   Fatal error in IL Linker2018-12-13T21:24:08.3879398Z   Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'C:\Users\VssAdministrator\.nuget\packages\system.xml.readerwiter\4.3.1\lib\netstandard1.3\System.Xml.ReaderWriter.dll, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' ---> Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'C:\Users\VssAdministrator\.nuget\packages\system.xml.readerwiter\4.3.1\lib\netstandard1.3\System.Xml.ReaderWriter.dll, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'2018-12-13T21:24:08.3879590Z      at Mono.Linker.DirectoryAssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)2018-12-13T21:24:08.3879689Z      at Mono.Linker.AssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)2018-12-13T21:24:08.3879764Z      at Mono.Linker.LinkContext.Resolve(IMetadataScope scope)2018-12-13T21:24:08.3879844Z      at Mono.Linker.LinkContext.Resolve(IMetadataScope scope)2018-12-13T21:24:08.3880117Z      at Mono.Linker.LinkContext.Resolve(String name)2018-12-13T21:24:08.3880182Z      at Mono.Linker.Steps.ResolveFromAssemblyStep.Process()2018-12-13T21:24:08.3880266Z      at Mono.Linker.Steps.BaseStep.Process(LinkContext context)2018-12-13T21:24:08.3880331Z      at Mono.Linker.Pipeline.ProcessStep(LinkContext context, IStep step)2018-12-13T21:24:08.3880412Z      at Mono.Linker.Pipeline.Process(LinkContext context)2018-12-13T21:24:08.3880576Z      at Mono.Linker.Driver.Run(ILogger customLogger)2018-12-13T21:24:08.3880641Z      at Mono.Linker.Driver.Execute(String[] args, ILogger customLogger)2018-12-13T21:24:08.3947633Z ```This happens when publish Blazor client side app on Azure devops. I think this is could be an issue even when Razor components go live
4966	area-mvc	Easier validation for Controller ModelState for unit tests	### Could model validation be improved for unit tests?We could get model automatically validated for any verb: GET POST when triggering a validate method.Now you have to call [controller.ModelState.AddError](https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/testing?view=aspnetcore-2.1) when you just could call controller.Validate(): ```[Fact]public async Task IndexPost_ReturnsBadRequestResult_WhenModelStateIsInvalid(){    // Arrange    var mockRepo = new Mock<IBrainstormSessionRepository>();    mockRepo.Setup(repo => repo.ListAsync())        .ReturnsAsync(GetTestSessions());    var controller = new HomeController(mockRepo.Object);    controller.ModelState.AddModelError("SessionName", "Required");    var newSession = new HomeController.NewSessionModel();    // Act    var result = await controller.Index(newSession);    // Assert    var badRequestResult = Assert.IsType<BadRequestObjectResult>(result);    Assert.IsType<SerializableError>(badRequestResult.Value);}```### Describe the solution you'd likeWhy not evaluate if model is valid in NET Core 2.1+ with `controller.Validate()` or `controller.ValidateModel()`?```[Fact]public async Task IndexPost_ReturnsBadRequestResult_WhenModelStateIsInvalid(){    // Arrange    var mockRepo = new Mock<IBrainstormSessionRepository>();    mockRepo.Setup(repo => repo.ListAsync())        .ReturnsAsync(GetTestSessions());    var controller = new HomeController(mockRepo.Object);    controller.ValidateModel(); // that would validate required fields or trigger ModelState.AddModelError("SessionName", "Required") to make ModelState.IsValid be false    var newSession = new HomeController.NewSessionModel();    // Act    var result = await controller.Index(newSession);    // Assert    var badRequestResult = Assert.IsType<BadRequestObjectResult>(result);    Assert.IsType<SerializableError>(badRequestResult.Value);}```### Additional contextIn unit tests I am not able to use ModelState.IsValid since it always returns true, whatever model I provide (valid or invalid with missing data).If there is any workaround or correct way of validating model in unit tests in netcore 2.1 and higher please let me know
4964	area-mvc	ComponentBase needs proper async error reporting	Currently, `ComponentBase` is hard-coded to deal with async lifecycle exceptions just by logging them to the console. This is understandable (albeit limited) in the WebAssembly case, since the developer console is the only place people are going to look for errors anyway, but it's no good for the server-side execution case.We might want to have an `event` on `ComponentBase` that reports async lifecycle task failures. Then the WebAssembly host can set up a listener that just logs to console, whereas the server-side executor can wire it into the ASP.NET logging system.
4959	area-mvc	Asp Core custom Modelbinder DateTime not working in post	### Describe the bugMy custom DateTimeModelBinder is working on HttpGet but not binding on HttpPost (DateTime value is always null ). How can i fix this?```csharp /// <summary>    /// Нужен для привязки даты формата 31-01-2018 и 31.01.2018 к дате в любой модели    /// </summary>    public class DateTimeModelBinder : IModelBinder    {        string[] _customDateFormats = { "dd.M.yyyy", "dd/M/yyyy", "dd-M-yyyy" };        private string GetModelName(ModelBindingContext bindingContext)        {            // The "Name" property of the ModelBinder attribute can be used to specify the            // route parameter name when the action parameter name is different from the route parameter name.            // For instance, when the route is /api/{birthDate} and the action parameter name is "date".            // We can add this attribute with a Name property [DateTimeModelBinder(Name ="birthDate")]            // Now bindingContext.BinderModelName will be "birthDate" and bindingContext.ModelName will be "date"            if (!string.IsNullOrEmpty(bindingContext.BinderModelName))            {                return bindingContext.BinderModelName;            }            return bindingContext.ModelName;        }        public Task BindModelAsync(ModelBindingContext bindingContext)        {            if (bindingContext == null)            {                throw new ArgumentNullException(nameof(bindingContext));            }            if (bindingContext.ModelType != typeof(DateTime?))            {                return Task.CompletedTask;            }            var modelName = GetModelName(bindingContext);            var valueProviderResult = bindingContext.ValueProvider.GetValue(modelName);            if (valueProviderResult == ValueProviderResult.None)            {                return Task.CompletedTask;            }            bindingContext.ModelState.SetModelValue(modelName, valueProviderResult);            var dateToParse = valueProviderResult.FirstValue;            if (string.IsNullOrEmpty(dateToParse))            {                return Task.CompletedTask;            }            var dateTime = ParseDate(bindingContext, dateToParse);            bindingContext.Result = ModelBindingResult.Success(dateTime);            return Task.CompletedTask;        }        private DateTime? ParseDate(ModelBindingContext bindingContext, string dateToParse)        {            if (DateTime.TryParseExact(dateToParse, _customDateFormats, CultureInfo.InvariantCulture,DateTimeStyles.None, out DateTime dateValue))                 return dateValue;             else             {                 bindingContext.ModelState.AddModelError(bindingContext.ModelName, "Passed date is in incorrect format");                 return null;             }                }    }}```
4956	area-servers	Crit: Microsoft.AspNetCore.Server.Kestrel.Unable to start Kestrel.	First when I deploy the API to the localhost:5001, all work fine until I put everything together in the server. I did dotnet publish the project. before this I sudo scp - r the (all files) relevant project to the server's /home . dotnet build && dotnet run, and all work fine. I came to mind that that wasn't a good idea for uploading all files without compounding it. Then I did only upload the 'Publish' folder which had already a 'compound' . \I'm planning to deploy in my server ![asdas](https://user-images.githubusercontent.com/44691957/49983170-f9c12a80-ff9b-11e8-9f95-70287578287c.png)```root@Ubuntu:/tmp/myserver/publish# lsappsettings.Development.json  johnTestBO.deps.json  johnTestBO.pdb                 web.configappsettings.json              johnTestBO.dll        johnTestBO.runtimeconfig.jsonroot@Ubuntu:/tmp/myserver/publish# ASPNETCORE_URLS=http://209.97.160.230:5001/api/value dotnet johnTestBO.dllcrit: Microsoft.AspNetCore.Server.Kestrel[0]      Unable to start Kestrel.System.InvalidOperationException: A path base can only be configured using IApplicationBuilder.UsePathBase().   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.ParseAddress(String address, Boolean& https)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)Unhandled Exception: System.InvalidOperationException: A path base can only be configured using IApplicationBuilder.UsePathBase().   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.ParseAddress(String address, Boolean& https)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Hosting.Internal.WebHost.StartAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token, String shutdownMessage)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.Run(IWebHost host)   at johnTestBO.Program.Main(String[] args) in /home/example/johnTestBO/Program.cs:line 18Aborted (core dumped)root@Ubuntu:/tmp/myserver/publish#  
4953	area-mvc	ProblemDetails is not returned for 404NotFound and 500Exception	### Describe the bugGiven a new ASPNET Core 2.2 "API" Website, `ProblemDetails` are not returned when:- the route _doesn't exist_ (404 Not found)- an exception is thrown from _inside_ an `ActionMethod`.I understand that _currently_ `ProblemDetails` are provided when a `Controller` is decorated with `ApiController`. So the first scenario (route doesn't exist/match) can't currently be handled. The second scenario (exeception thrown) is inside an `Controller/ActionMethod` that has been decorated.*`ProblemDetails` should apply globally, not just on a half-specific set of scenario's. This breaks application-consistency.*Currently, the only workaround is to use @khellang 's `ProblemDetails` nuget library ([part of his 'Middleware' repo](https://github.com/khellang/Middleware)). Would be very helpful to either consider:a) implementing the *full functionality*b)  just removing it because the current implementation feels inconsistent / half-complete.  (NOTE: please don't remove it! lets complete it!!)### To Reproduce- Open Visual Studio 2018- File -> New -> Project -> Visual C# -> Web -> NET Core -> ASP.NET Core Web Application -> API- Edit `Startup.cs`. Comment out `\\ app.UseDeveloperExceptionPage();`- Edit `Controllers\ValuesController` to (more or less) the following:```[Route("api/[controller]")][ApiController]public class ValuesController : ControllerBase{    // GET api/values    [HttpGet]    public ActionResult<IEnumerable<string>> Get()    {        return new string[] { "value1", "value2" };    }    // GET api/values/5    [HttpGet("{id}")]    public ActionResult<string> Get(int id)    {        return Ok(id);    }    // GET api/values/notfound    [HttpGet("notfound")]    public ActionResult<string> Get2()    {        return NotFound();    }    // GET api/values/notfound/aaaa    [HttpGet("notfound/{text}")]    public ActionResult<string> Get3(string text)    {        return NotFound(text);    }    // GET api/values/exception    [HttpGet("exception")]    public ActionResult<string> Get4()    {        throw new Exception("pew pew");    }}```I've just added some specific routes to test problem details. (look below 😎  )- Test the following routes:  - ✅ https://localhost:7001/api/values/a  (400 Bad Request)  - ✅  https://localhost:7001/api/values/notfound (404 Not Found)  - ❌ https://localhost:7001/api/values/notfound/aaaaaa (404 Not Found)  - ❌ https://localhost:7001/api/values/exception (500 Server Error)  - ❌ https://localhost:7001/api/values/sdfkdsjfhksdfh (404 Not Found and route doesn't exist)### Expected behavior- At any time the response is 4xx/5xx I would expect the `ProblemDetails` to be returned.- Would love to have the option to specify wether exception details are included (default is not). This just helps when `IsDevelopment` mode.- Assumption would be to wire this up in `Startup.cs`.### Additional context```.NET Core SDK (reflecting any global.json): Version:   2.2.100 Commit:    b9f2fa0ca8Runtime Environment: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.2.100\Host (useful for support):  Version: 2.2.0  Commit:  1249f08fed```Also using `Visual Studio 15.9.4`polite cc @glennc Thank you kindly for your awesome work and here's Dwayne/TheRock singing sweet nothings to help persuade the decision process, here. Like, who would say 'no' to TheRock?? ![](https://media.giphy.com/media/fiqgPIfhtIsQAoxmQs/giphy.gif)
5675	area-mvc	Referenced Component can not be used in a cascading value	When using a combination of both a component reference and cascading value, that value is not sent to child elementsExample```@inherits BlazorLayoutComponent<div class="sidebar">    <NavMenu/></div><Modal ref="modalTest"/><div class="main">    <CascadingValue Value="@modalTest">        <div class="content px-4">            @Body        </div>    </CascadingValue></div>@functions{    Modal modalTest;}```When accessing the modal in the following component, I am always getting a null reference exception```@page "/Admin"@inject HttpClient Http<h3>Students</h3>@functions{    IList<Models.Student> _students;        [CascadingParameter] Modal _modal { get; set; }    protected override async Task OnInitAsync()    {        _students = await Http.GetJsonAsync<IList<Models.Student>>("api/Student/GetStudentsWithGoalsAndAvailableAnswers");    }    protected override void OnAfterRender()    {        _modal.ElementId = "This is a test";    }}```The only thing that would not make this throw an error was to define the modal in the following way in the layout `Modal modalTest = new Modal`
4809	area-mvc	Empty project template in VS 2019 preview shows an informational message about unused parameter in Startup.ConfigureServices	Filing this just to track this. There is no clear plan about what the templates in 3.0 will look like.
4808	area-servers	ANCM 2.2 In-Process Restart Issue	Adding/Removing an application to/from ```<fastCgi>``` (applicationHost.config) restarts ASP.NET Core applications.
4804	area-mvc	Razor SDK build errors with MVC-3.0 configuration	**Repro:**Open MVC.sln in VSEdit https://github.com/aspnet/AspNetCore/blob/master/src/Mvc/test/WebSites/RazorPagesClassLibrary/RazorPagesClassLibrary.csproj#L4 to use **MVC-3.0** instead of **MVC2-1**Build in VSYou will see an error like:```The "FindInList" task was not given a value for the required parameter "ItemSpecToFind".```
4800	area-mvc	Components Build - error : rzc generate exited with code -2147450730	> C:\DEV\AspNetCore\src\Components\src\Microsoft.AspNetCore.Components.Build\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\samples\StandaloneApp\StandaloneApp.csproj]> C:\DEV\AspNetCore\src\Components\src\Microsoft.AspNetCore.Components.Build\targets\RazorCompilation.targets(236,5): error : rzc discover exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\samples\MonoSanityClient\MonoSanityClient.csproj]> C:\DEV\AspNetCore\src\Components\src\Microsoft.AspNetCore.Components.Build\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\samples\HostedInAspNet.Client\HostedInAspNet.Client.csproj]> C:\Users\local.user\.nuget\packages\microsoft.aspnetcore.components.build\0.8.0-preview1-20181122.3\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\src\Microsoft.AspNetCore.Blazor.Templates\content\BlazorLibrary-CSharp\BlazorLibrary-CSharp.csproj]> C:\DEV\AspNetCore\src\Components\src\Microsoft.AspNetCore.Components.Build\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\benchmarks\Microsoft.AspNetCore.Blazor.E2EPerformance\Microsoft.AspNetCore.Blazor.E2EPerformance.csproj]> C:\Users\local.user\.nuget\packages\microsoft.aspnetcore.components.build\0.8.0-preview1-20181122.3\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\src\Microsoft.AspNetCore.Blazor.Templates\content\BlazorHosted-CSharp\BlazorHosted-CSharp.Client\BlazorHosted-CSharp.Client.csproj]> C:\DEV\AspNetCore\src\Components\src\Microsoft.AspNetCore.Components.Build\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\samples\ComponentsApp.App\ComponentsApp.App.csproj]> C:\Users\local.user\.nuget\packages\microsoft.aspnetcore.components.build\0.8.0-preview1-20181122.3\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\src\Microsoft.AspNetCore.Blazor.Templates\content\Components-CSharp\Components-CSharp.App\Components-CSharp.App.csproj]> C:\DEV\AspNetCore\src\Components\src\Microsoft.AspNetCore.Components.Build\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\test\testapps\TestContentPackage\TestContentPackage.csproj]> C:\Users\local.user\.nuget\packages\microsoft.aspnetcore.components.build\0.8.0-preview1-20181122.3\targets\RazorCompilation.targets(184,5): error : rzc generate exited with code -2147450730. [C:\DEV\AspNetCore\src\Components\blazor\src\Microsoft.AspNetCore.Blazor.Templates\content\BlazorStandalone-CSharp\BlazorStandalone-CSharp.csproj]>     0 Warning(s)>     10 Error(s)
4799	area-infrastructure	Cloning this repo creates files that exceed MAX_PATH on Windows	> git.exe clone --progress --recursive -v "https://github.com/.../AspNetCore.git" "C:\Users\...\source\repos\...\AspNetCore"> > Cloning into 'C:\Users\...\source\repos\...\AspNetCore'...> POST git-upload-pack (gzip 6575 to 3130 bytes)> remote: Enumerating objects: 210, done.> remote: Counting objects: 100% (210/210), done.> remote: Compressing objects: 100% (172/172), done.> remote: Total 385056 (delta 101), reused 89 (delta 37), pack-reused 384846> Receiving objects: 100% (385056/385056), 189.84 MiB | 6.77 MiB/s, done.> Resolving deltas: 100% (297534/297534), done.> error: unable to create file src/Mvc/test/Mvc.Api.Analyzers.Test/TestFiles/ApiActionsDoNotRequireExplicitModelValidationCheckAnalyzerIntegrationTest/NoDiagnosticsAreReturned_ForApiActionsReturning400FromNonModelStateIsValidBlocks.cs: **Filename too long**> error: unable to create file src/Mvc/test/Mvc.Api.Analyzers.Test/TestFiles/ApiActionsDoNotRequireExplicitModelValidationCheckAnalyzerIntegrationTest/NoDiagnosticsAreReturned_ForApiActionsReturningNot400FromNonModelStateIsValidBlock.cs: **Filename too long**> error: unable to create file src/Mvc/test/Mvc.Api.Analyzers.Test/TestFiles/ApiConventionAnalyzerIntegrationTest/DiagnosticsAreReturned_IfAsyncMethodReturningValueTaskWithProducesResponseTypeAttribute_ReturnsUndocumentedStatusCode.cs: **Filename too long**> Checking out files: 100% (12222/12222), done.> fatal: unable to checkout working tree> warning: Clone succeeded, but checkout failed.> You can inspect what was checked out with 'git status'> and retry the checkout with 'git checkout -f HEAD'> 
5272	area-mvc	Angular Template - WebSocket connection failed: Error during WebSocket handshake with Windows 7	Using the latest `dotnet new angular` template, I get this error message in my browser console:```WebSocket connection to 'ws://localhost:4200/sockjs-node/507/xg3xa0xl/websocket' failed: Error during WebSocket handshake: Unexpected response code: 500WebSocketBrowserDriver @ sockjs.js:1679```I'm aware WebSockets isn't supported on Windows 7, however, if I just host the SPA using `npm start` from the `ClientApp` directory then I don't get this error. What is the reason for this, and is there a way to stop this error when hosting via Visual Studio's debug launch?
4793	area-servers	Using AspNetCoreModuleV2 and hostingModel="InProcess" gives 200 OK, but no content in response 	Hi!Trying to run my self-contained web api with .NET Core 2.2 on IIS as InProcess. I doing a GET request to the server, I get an 200 OK, but with no content / payload. Only switching the hostingModel to "OutOfProcess", the web api starts returning content again.I have done the following:1. Added this in the project file:```<PropertyGroup>  <AspNetCoreHostingModel>InProcess</AspNetCoreHostingModel></PropertyGroup>```2. Installed .NET Core Runtime 2.2.0 on Windows Server 2008 R23. Changed web.config```<?xml version="1.0" encoding="utf-8"?><configuration>  <location path="." inheritInChildApplications="false">    <system.webServer>      <handlers>        <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModuleV2" resourceType="Unspecified" />      </handlers>      <aspNetCore processPath=".\NAS.AppsProxy.Api.exe" stdoutLogEnabled="true" stdoutLogFile=".\logs\stdout" hostingModel="InProcess">        <environmentVariables>          <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Stage" />        </environmentVariables>      </aspNetCore>    </system.webServer>  </location></configuration><!--ProjectGuid: BEB1A5AA-1DA2-4CBA-80DD-30EEEB3AD047-->```4. The runtimeIdentifier is set to win7-x64, the app pool has enable 32-bit set to false, and the .NET Core Runtime is x64 (but x86 is also installed on server).5. Verified that the AspNetCoreModuleV2, %ProgramFiles%\IIS\Asp.Net Core Module\V2\aspnetcorev2.dll is visible under Modules on IISSetting hostingModel="InProcess" to hostingModel="OutOfProcess" made things work.The stdout does not log any errors, and this is the output enabling the enhanced diagnostic logs:```[aspnetcorev2_inprocess.dll] Initializing logs for 'C:\www\appsproxynetcore\aspnetcorev2_inprocess.dll'. Process Id: 4604.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.[aspnetcorev2_inprocess.dll] Waiting for initialization[aspnetcorev2_inprocess.dll] Starting in-process worker thread[aspnetcorev2_inprocess.dll] Resolving hostfxr parameters for application: '.\NAS.AppsProxy.Api.exe' arguments: '' path: 'C:\www\appsproxynetcore\'[aspnetcorev2_inprocess.dll] Known dotnet.exe location: ''[aspnetcorev2_inprocess.dll] Process path '.\NAS.AppsProxy.Api.exe' is not dotnet, treating application as standalone or portable with bootstrapper[aspnetcorev2_inprocess.dll] Checking application.dll at 'C:\www\appsproxynetcore\.\NAS.AppsProxy.Api.dll'[aspnetcorev2_inprocess.dll] Checking hostfxr.dll at 'C:\www\appsproxynetcore\.\hostfxr.dll'[aspnetcorev2_inprocess.dll] hostfxr.dll found app local at 'C:\www\appsproxynetcore\.\hostfxr.dll', treating application as standalone[aspnetcorev2_inprocess.dll] Parsed hostfxr options: dotnet location: '' hostfxr path: 'C:\www\appsproxynetcore\.\hostfxr.dll' arguments:[aspnetcorev2_inprocess.dll] Argument[0] = 'C:\www\appsproxynetcore\.\NAS.AppsProxy.Api.exe'[aspnetcorev2_inprocess.dll] In-process callbacks set[aspnetcorev2_inprocess.dll] Event Log: 'Application 'C:\www\appsproxynetcore\' started the coreclr in-process successfully.' End Event Log Message.```Does anyone else experience the same? I have tired to follow the [https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/aspnet-core-module?view=aspnetcore-2.2](url), but I may have missed something?Any help is much appreciated. Thanks in advance!
4792	area-mvc	SuppressUseValidationProblemDetailsForInvalidModelStateResponses not working	### Describe the bugI am unsure if defaulting to Problem Details is a safe choice right now. After upgrading to 2.2, some of my tests failed because my http client was unable to handle "application/problem+json" (it works fine with "application/json" responses). It is trivial to fix my client, but this made me think if it's wise to change this behavior now since it may cause troubles to existing clients out in the wild (Bonus Question: any considerations on this?).So I've tried to disable the behavior but keep 2.2 features in this way:```services.AddMvc()	.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)	.ConfigureApiBehaviorOptions(options =>	{		options.SuppressUseValidationProblemDetailsForInvalidModelStateResponses = true;	})	.AddJsonOptions(options =>	{		options.SerializerSettings.ContractResolver = new DefaultContractResolver();		options.SerializerSettings.Converters.Add(new StringEnumConverter());	});```This is also explained in the official documentation [here](https://docs.microsoft.com/it-it/aspnet/core/web-api/?view=aspnetcore-2.2#annotation-with-apicontroller-attribute), but nothing changes. Setting the flag does nothing regarding handling of 4xx responses.### To Reproduce1. Create a new default ASP NET Core 2.2 API project from VS20172. In startup.cs add to AddMvc():```	.ConfigureApiBehaviorOptions(options =>	{		options.SuppressUseValidationProblemDetailsForInvalidModelStateResponses = true;	})```3. Make a POST request to /api/values endpoint with some invalid json### Expected behaviorShould return a the old json validation error format with "application/json" as content type.### Additional context```.NET Core SDK (reflecting any global.json): Version:   2.2.100 Commit:    b9f2fa0ca8Runtime Environment: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.2.100\Host (useful for support):  Version: 2.2.0  Commit:  1249f08fed.NET Core SDKs installed:  1.1.10 [C:\Program Files\dotnet\sdk]  1.1.11 [C:\Program Files\dotnet\sdk]  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.302 [C:\Program Files\dotnet\sdk]  2.1.400 [C:\Program Files\dotnet\sdk]  2.1.401 [C:\Program Files\dotnet\sdk]  2.1.402 [C:\Program Files\dotnet\sdk]  2.1.403 [C:\Program Files\dotnet\sdk]  2.1.500 [C:\Program Files\dotnet\sdk]  2.1.502 [C:\Program Files\dotnet\sdk]  2.2.100 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 1.0.12 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 1.0.13 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 1.1.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 1.1.10 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.3-servicing-26724-03 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]```
5674	area-mvc	making StateHasChanged virtual	https://github.com/aspnet/Blazor/pull/1716
4784	area-mvc	Razor Components Throttling support for development	### Is your feature request related to a problem? Please describe.No browser currently supports throttling for WebSockets to emulate slow network.### Describe the solution you'd likeAdd support for throttling directly to Razor Components so that developer can emulate slow network during development.### Describe alternatives you've consideredNo alternatives.
4602	area-servers	IIS Integration With VS on same machine	### Describe the bugI have a solution downloaded on my local Windows 10 machine with an ASP.Net Core 2.1 project in it. I have configured IIS to host the site on a particular port (changing the .NET CLR version to No Managed Code) This is so I don't have to have Visual Studio open and debugging this site when i'm working on the front end. But i want to be able to open Visual Studio and set this project as the startup project and debug it without having to use attach to process constantly.The issue is whenever I reboot my machine and the web site isn't running, when i try to load the website i get the HTTP Error 502.5 - Process Failure error page initially.  If i open Visual Studio and run the project 1 time, the site will load from there on without having Visual Studio open and attached.If you deploy this same website to a server where Visual Studio is not installed, it will startup just fine.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core 2.1.12. Create a blank site in IIS with No Managed Code configured in the app pool3. Run this code: create an ASP.net core website and configure the site for IIS integration on the port configured in step 24. Reboot your machine5. Try to load the web site in the browser without opening Visual Studio and hitting F5 to debug4. See error### Expected behaviorThe website should startup without issue### ScreenshotsIf applicable, add screenshots to help explain your problem.### Additional contextThe following error is reported in the event logApplication 'MACHINE/WEBROOT/APPHOST/SOMESITE' with physical root 'C:\dev\development\SOMESITE' created process with commandline 'C:\dev\development\SOMESITE\bin\IISSupport\VSIISExeLauncher.exe -argFile IISExeLauncherArgs.txt' but failed to listen on the given port '47860'Include the output of `dotnet --info`.NET Core SDK (reflecting any global.json): Version:   2.1.502 Commit:    c74ce8f29fRuntime Environment: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.1.502\Host (useful for support):  Version: 2.1.6  Commit:  3f4f8eebd8.NET Core SDKs installed:  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.403 [C:\Program Files\dotnet\sdk]  2.1.500 [C:\Program Files\dotnet\sdk]  2.1.502 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]To install additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download
4598	area-hosting	Replacing a service from IHostedService	I have a service registered in a WebAPI project startup. This service is registered with an implementation factory, and reads off of `IHttpContextAccessor`, returning an object that implements this interface. This gives me a way to inject some information about the current user and request into other registered services. This works well, however, there's no HttpContext to read from when executing within an `IHostedService`. How can I replace/instantiate a new ServiceCollection such that other consumed interfaces would use this different implementation? 
4597	area-mvc	.net Core 2.2 -  Generate RouteData from Url path	Hello,I'm looking for documentation on the new endpoint routing system. I'm upgrading from .net core 2.1 to 2.2. I have a scenario where I need to generate the RouteData object from a url path.I could not get it to work with IUrlHelper.Thanks!
4593	area-mvc	Razor Components hitting F12 key in Razor markup doesn't take you to other components	### Describe the bugF12 key doesn't take you to other components in Razor markup. Also hitting F12 over a component's type in `.cs` only component doesn't take me to Razor markup but to components generated `.cs` file. For `BasicField` component it took me to `BasicField.g.i.cs`.### To ReproduceLet's say you have two components `Component1` and `Component2` and you have `<Component2></Component2>` in `Component1`'s markup.  Then you move your cursor over `<Component2>` and hit F12 key. Nothing happens.I'm using `Microsoft.AspNetCore.Components` NuGet version `0.8.0-preview1-20181126.4` , Blazor extension version `15.7.20181126.4` and Visual Studio 2017 `15.9.4`### Expected behaviorHitting F12 key takes me to `Component2`'s markup or code if `Component2` only has `.cs` file.
5401	area-signalr	Does android have Signal R Android client library with sample 	I like to have android version for SignalR 
4588	area-mvc	Razor Class Library dynamic loading as ApplicationParts. Views can't use models	### Describe the bugCan not use dynamic loading RCL. because the views can't find the models.### To ReproduceSteps to reproduce the behavior:1. netcore2.22. https://aqua-wirbellose.visualstudio.com/HostingPanel Open Branche: 33_Implementierung_Plugin_System3. Start Project and open: https://localhost:44397/Wiki/Wiki/Create4. System.IO.FileNotFoundException: Could not load file or assembly 'HostingPanel.Wiki, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'. Das System kann die angegebene Datei nicht finden.File name: 'HostingPanel.Wiki, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' ---> System.IO.FileNotFoundException: Could not load the specified file.### Expected behaviorI want to use mvc in a "Razor Class Library". All looks good. I have ony one problem, when i open the view, the view can't find the model. When i reference all RCL ther is no error. Only an dynamic loading the error exist. How can i resolve it ?### Screenshotshttps://upload.crunkbass.de/big486f7374696e6750616e656c5f57696b695f4372656174655f457863657074696f6e2e6a7067.jpg### Additional contextI want to use dynamic loaded RCLs. I Use ApplicationParts for that.What i have:I have a RCL that named Wiki and i need EFCore and AutoMigration.PM> dotnet --info.NET Core SDK (gem„á "global.json"): Version:   3.0.100-preview-009812 Commit:    e3abf6e935Laufzeitumgebung: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\3.0.100-preview-009812\Host (useful for support):  Version: 3.0.0-preview-27122-01  Commit:  00c5c8bc40.NET Core SDKs installed:  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.400-preview-009171 [C:\Program Files\dotnet\sdk]  2.1.400 [C:\Program Files\dotnet\sdk]  2.1.500-preview-009297 [C:\Program Files\dotnet\sdk]  2.1.500-preview-009335 [C:\Program Files\dotnet\sdk]  2.1.500-preview-009404 [C:\Program Files\dotnet\sdk]  2.1.500 [C:\Program Files\dotnet\sdk]  2.2.100 [C:\Program Files\dotnet\sdk]  3.0.100-preview-009812 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 3.0.0-preview-18579-0056 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 3.0.0-preview-27122-01 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.WindowsDesktop.App 3.0.0-alpha-27128-4 [C:\Program Files\dotnet\shared\Microsoft.WindowsDesktop.App]
4585	area-tooling	Razor Extension version is incorrect in latest insertion	### Describe the bugThe latest RazorExtension insertion has a version of 3.0.0.1860703+COMMITHASh when it should be 16.0.XYZ. This indirectly causes issues when attempting to run the VSIX locally### To ReproduceSteps to reproduce the behavior:1. Get d16.0stg2. Open the About dialog### Expected behaviorRazor extension version 16.0.XYZ### Screenshots![image](https://user-images.githubusercontent.com/2008729/49842183-61def900-fd6f-11e8-9f37-8c64956c2ddb.png)
4584	area-tooling	Latest Razor tooling source link not working in VS	### Describe the bugWe did a VS insertion yesterday (12/10) which had new Razor tooling bits from our AspNetCore-Tooling repo. I tried debugging those bits and found that I could download symbols for the binary and upon doing so would be prompted to download the source file. In VS after clickign "Download source and continue" it attempts to do it multiple times and then fails.### To ReproduceSteps to reproduce the behavior:1. Open d16.0stg2. Open a web project3. Open a Razor file4. Add a function breakpoint for `RazorDirectiveCompletionProvider.ProvideCompletionsAsync`.5. At the top of the Razor file type `@p`6. Your breakpoint will hit, at which point it will attempt to load the sources.### Expected behaviorSource file is properly downloaded
4582	area-identity	Refactor Microsoft.Extensions.Identity.Core and Identity.Stores as netstandard2 packages	@blowdart @PinpointTownes https://github.com/aspnet/AspNetCore/pull/4523#issuecomment-446323776There's some desire for these as standalone packages. Unfortunately they were never properly factored for that.- The packages depended on AspNetCore DataProtection- The namespaces inside the packages are all AspNetCore, not Extensions
4579	area-mvc	Outbound route parameter transformer should support dependency injection	### Is your feature request related to a problem? Please describe.When I register an outbound route parameter transformer, I should be able to register it as a type and not an implementation. This way, I could leverage ASP.NET Core dependency injection. Infact, I might need to read configuration or the database to decide how to do transformations.### Describe the solution you'd likeI register the route parameter transformer like this.```services.AddMvc(options =>{    var routeParameterTransformer = new MyParameterTransformer();    var routeConvention = new RouteTokenTransformerConvention(routeParameterTransformer);    options.Conventions.Add(routeConvention);}).SetCompatibilityVersion(CompatibilityVersion.Version_2_2);```Instead, I'd like to register it like this, by just providing its type.```services.AddMvc(options =>{    var routeParameterTransformer = typeof(MyParameterTransformer);    var routeConvention = new RouteTokenTransformerConvention(routeParameterTransformer);    options.Conventions.Add(routeConvention);}).SetCompatibilityVersion(CompatibilityVersion.Version_2_2);```This way, ASP.NET Core would inject any dependencies when constructing the transformer.### Describe alternatives you've consideredI don't want to use the ServiceProvider directly.
5400	area-signalr	signalr-protocol-msgpack 1.1.0 TS definitions are incompatible with signalr 1.1.0	>Error	TS2345	(TS) Argument of type 'MessagePackHubProtocol' is not assignable to parameter of type 'IHubProtocol'.  Types of property 'parseMessages' are incompatible.    Type '(input: ArrayBuffer | Buffer, logger: ILogger) => HubMessage[]' is not assignable to type '(input: string | ArrayBuffer, logger: ILogger) => HubMessage[]'.      Types of parameters 'input' and 'input' are incompatible.        Type 'string | ArrayBuffer' is not assignable to type 'ArrayBuffer | Buffer'.          Type 'string' is not assignable to type 'ArrayBuffer | Buffer'.	https://github.com/aspnet/AspNetCore/blob/master/src/SignalR/clients/ts/signalr-protocol-msgpack/src/MessagePackHubProtocol.ts#L33https://github.com/aspnet/AspNetCore/blob/master/src/SignalR/clients/ts/signalr/src/IHubProtocol.ts#L184
4570	area-platform	Change logging site extension package name/description	as noted by @guardrex > It's named "ASP.NET Core Logging Extensions" but only a single service extension, so it seems a little strange when I write in the topic ...> >     ... by the ASP.NET Core Logging Extensions. This extension enables ...> > plural 👉 singular mismatch> > Second thing is the description:> >     This extension enables additional functionality for ASP.NET Core on Azure WebSites, such as enabling Azure logging.> > I might be wrong, but didn't "Azure WebSites" (naming) fall out-of-favor with marketing? Should it be "Azure Apps" or "Azure App Service"? I can make the doc state the description that way. If I should go that way, let me know if I should open an engineering issue for it (perhaps for the extension name, too ☝️).> > [EDIT] Noticed one thing in the portal ... they DO use "Web App" quite a bit.> > Last thing while I'm here ..... description is "such as" ... is there anything else you would like the Azure Apps topic to say about what this extension does besides supplying logging scenarios.I think he is correct about all of them, we should fix it before 3.0
5673	area-mvc	Mono.Cecil.AssemblyResolutionException because of typo in assembly name	I am trying to build (Ctrl + F5) on Windows 7 with VS2017 using the following Blazor Nuget Packages:```XML  <ItemGroup>    <DotNetCliToolReference Include="Microsoft.AspNetCore.Blazor.Cli" Version="0.7.0" />  </ItemGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore.Blazor" Version="0.7.0" />    <PackageReference Include="Microsoft.AspNetCore.Blazor.Browser" Version="0.7.0" />    <PackageReference Include="Microsoft.AspNetCore.Blazor.Build" Version="0.7.0" />  </ItemGroup>```The `BlazorLinkOnBuild` property in the csproj file is set to `true`:```XML<BlazorLinkOnBuild>true</BlazorLinkOnBuild>```The build fails with ```Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'C:\Users\XXX\.nuget\packages\microsoft.extensions.logging.configration\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Logging.Configuration.dll```Note the typo in the assembly folder name: it says "configration" instead of "config**u**ration" in the path (missing 'u'). The strange thing is, I've seen the same message with another version of that typo, where it was "cofiguration" (missing 'n'). I've checked, the misspelled folder does not exist, the correctly spelled one does.The full call stack is```Fatal error in IL LinkerMono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'C:\Users\XXX\.nuget\packages\microsoft.extensions.logging.configration\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Logging.Configuration.dll, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' ---> Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'C:\Users\XXX\.nuget\packages\microsoft.extensions.logging.configration\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Logging.Configuration.dll, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'   at Mono.Linker.DirectoryAssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)   at Mono.Linker.AssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)   at Mono.Linker.LinkContext.Resolve(IMetadataScope scope)   at Mono.Linker.LinkContext.Resolve(IMetadataScope scope)   at Mono.Linker.LinkContext.Resolve(String name)   at Mono.Linker.Steps.ResolveFromAssemblyStep.Process()   at Mono.Linker.Steps.BaseStep.Process(LinkContext context)   at Mono.Linker.Pipeline.ProcessStep(LinkContext context, IStep step)   at Mono.Linker.Pipeline.Process(LinkContext context)   at Mono.Linker.Driver.Run(ILogger customLogger)   at Mono.Linker.Driver.Execute(String[] args, ILogger customLogger)```Even more strange, a second attempt to build succeeds but fails at runtime with```Unhandled Exception: System.ArgumentException: The directory name '[output dir]\bin\Debug\netstandard2.0\dist\' does not exist.Parameter name: path   at System.IO.FileSystemWatcher..ctor(String path, String filter)   at System.IO.FileSystemWatcher..ctor(String path)   at Microsoft.Extensions.FileProviders.PhysicalFileProvider.CreateFileWatcher(String root, ExclusionFilters filters)   at Microsoft.AspNetCore.Builder.BlazorApplicationBuilderExtensions.UseBlazor(IApplicationBuilder app, BlazorOptions options)   at Microsoft.AspNetCore.Blazor.Cli.Server.Startup.Configure(IApplicationBuilder app, IConfiguration configuration)--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()   at Microsoft.AspNetCore.Hosting.Internal.WebHost.StartAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token, String shutdownMessage)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.Run(IWebHost host)   at Microsoft.Extensions.CommandLineUtils.CommandLineApplication.Command(String name, Action`1 configuration, Boolean throwOnUnexpectedArg)   at Microsoft.AspNetCore.Blazor.Cli.Program.Main(String[] args)```I can only get it to work using```XML<BlazorLinkOnBuild>false</BlazorLinkOnBuild>```but that pushes out the assemblies in their unmodified size (a total of 14.5 MB).I am stumped, what am I doing wrong?
4566	area-servers	Duplicate ASPNETCORE_Environment present for InProcess hosting causes ASPNET CORE 2.2 fails to load appsettings	After 2 days trying to figure out, i think i discovered a bug:1) I already had set manually the ASPNETCORE_ENVIRONMENT on Windows Server 2016 environment variables.2) After 2.2 release, i decided to update the publish profile .pubxml to include the desired environment, for instance: `<EnvironmentName>Development</EnvironmentName>`**This generates the web.config:**```<aspNetCore processPath="dotnet" arguments=".\TJPA.CentralBoletos.API.dll" stdoutLogEnabled="true" stdoutLogFile=".\logs\stdout" hostingModel="inprocess">   <environmentVariables>           <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Development" />   </environmentVariables></aspNetCore>``` 3) When i published the application, the application wont startup, specifically when reading the connection string for the HangfireDB schema i was using. **In Web browser says:**> An error occurred while starting the application.> .NET Core 4.6.27110.04 X64 v4.0.0.0    |   Microsoft.AspNetCore.Hosting version 2.2.0-rtm-35687    |    Microsoft Windows 10.0.14393    |   Need help?**In std logs:**> Application startup exception: System.ArgumentNullException: Value cannot be null.> Parameter name: nameOrConnectionString>    at Hangfire.SqlServerStorageExtensions.UseSqlServerStorage(IGlobalConfiguration configuration, String nameOrConnectionString, SqlServerStorageOptions options)>    at TJPA.CentralBoletos.API.Startup.<>c__DisplayClass5_0.<ConfigureServices>b__2(IGlobalConfiguration config) in C:\GIT\central-boletos\api-central-boletos\TJPA.CentralBoletos.API\Startup.cs:line 52>    at Hangfire.HangfireServiceCollectionExtensions.<>c__DisplayClass0_0.<AddHangfire>b__9(IServiceProvider serviceProvider)>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteRuntimeResolver.VisitScoped(ScopedCallSite scopedCallSite, ServiceProviderEngineScope scope)>    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetService[T](IServiceProvider provider)>    at Hangfire.HangfireApplicationBuilderExtensions.ThrowIfNotConfigured(IApplicationBuilder app)>    at Hangfire.HangfireApplicationBuilderExtensions.UseHangfireServer(IApplicationBuilder app, BackgroundJobServerOptions options, IEnumerable`1 additionalProcesses, JobStorage storage)>    at TJPA.CentralBoletos.API.Startup.ConfigurarHangfireServer(IApplicationBuilder app, IServiceProvider serviceProvider) in C:\GIT\central-boletos\api-central-boletos\TJPA.CentralBoletos.API\Startup.cs:line 149>    at TJPA.CentralBoletos.API.Startup.Configure(IApplicationBuilder app, IServiceProvider serviceProvider) in C:\GIT\central-boletos\api-central-boletos\TJPA.CentralBoletos.API\Startup.cs:line 79> --- End of stack trace from previous location where exception was thrown --->    at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)>    at Microsoft.AspNetCore.Server.IIS.Core.IISServerSetupFilter.<>c__DisplayClass2_0.<Configure>b__0(IApplicationBuilder app)>    at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()> **Hosting environment: Development;Development**> Content root path: C:\inetpub\wwwroot\central-boletos> Application started. Press Ctrl+C to shut down.> **The ancm log:**> [aspnetcorev2.dll] Initializing logs for 'C:\Program Files\IIS\Asp.Net Core Module\V2\aspnetcorev2.dll'. Process Id: 10784.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.> [aspnetcorev2.dll] Resolving hostfxr parameters for application: 'dotnet' arguments: 'TJPA.CentralBoletos.API.dll' path: 'C:\inetpub\wwwroot\central-boletos\'> [aspnetcorev2.dll] Known dotnet.exe location: ''> [aspnetcorev2.dll] Process path 'dotnet.exe' is dotnet, treating application as portable> [aspnetcorev2.dll] Resolving absolute path to dotnet.exe from 'dotnet.exe'> [aspnetcorev2.dll] Invoking where.exe to find dotnet.exe> [aspnetcorev2.dll] where.exe invocation returned: 'C:\Program Files\dotnet\dotnet.exe> C:\Program Files (x86)\dotnet\dotnet.exe> '> [aspnetcorev2.dll] Current process bitness type detected as isX64=1> [aspnetcorev2.dll] Processing entry 'C:\Program Files\dotnet\dotnet.exe'> [aspnetcorev2.dll] Binary type 6> [aspnetcorev2.dll] Found dotnet.exe via where.exe invocation at 'C:\Program Files\dotnet\dotnet.exe'> [aspnetcorev2.dll] Resolving absolute path to hostfxr.dll from 'C:\Program Files\dotnet\dotnet.exe'> [aspnetcorev2.dll] hostfxr.dll located at 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll'> [aspnetcorev2.dll] Converted argument 'TJPA.CentralBoletos.API.dll' to 'C:\inetpub\wwwroot\central-boletos\TJPA.CentralBoletos.API.dll'> [aspnetcorev2.dll] Parsed hostfxr options: dotnet location: 'C:\Program Files\dotnet\dotnet.exe' hostfxr path: 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll' arguments:> [aspnetcorev2.dll] Argument[0] = 'C:\Program Files\dotnet\dotnet.exe'> [aspnetcorev2.dll] Argument[1] = 'C:\inetpub\wwwroot\central-boletos\TJPA.CentralBoletos.API.dll'> [aspnetcorev2.dll] c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\commonlib\fileoutputmanager.cpp:142 Operation failed with LastError: 32 HR: 0x80070020> [aspnetcorev2.dll] Loading request handler:  'C:\inetpub\wwwroot\central-boletos\runtimes\win-x64\nativeassets\netcoreapp2.2\aspnetcorev2_inprocess.dll'> [aspnetcorev2.dll] Creating handler application> [aspnetcorev2_inprocess.dll] Initializing logs for 'C:\inetpub\wwwroot\central-boletos\runtimes\win-x64\nativeassets\netcoreapp2.2\aspnetcorev2_inprocess.dll'. Process Id: 10784.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2 Request Handler. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.> [aspnetcorev2_inprocess.dll] Waiting for initialization> [aspnetcorev2_inprocess.dll] Starting in-process worker thread> [aspnetcorev2_inprocess.dll] Resolving hostfxr parameters for application: 'dotnet' arguments: 'TJPA.CentralBoletos.API.dll' path: 'C:\inetpub\wwwroot\central-boletos\'> [aspnetcorev2_inprocess.dll] Known dotnet.exe location: 'C:\Program Files\dotnet\dotnet.exe'> [aspnetcorev2_inprocess.dll] Process path 'dotnet.exe' is dotnet, treating application as portable> [aspnetcorev2_inprocess.dll] Resolving absolute path to hostfxr.dll from 'C:\Program Files\dotnet\dotnet.exe'> [aspnetcorev2_inprocess.dll] hostfxr.dll located at 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll'> [aspnetcorev2_inprocess.dll] Converted argument 'TJPA.CentralBoletos.API.dll' to 'C:\inetpub\wwwroot\central-boletos\TJPA.CentralBoletos.API.dll'> [aspnetcorev2_inprocess.dll] Parsed hostfxr options: dotnet location: 'C:\Program Files\dotnet\dotnet.exe' hostfxr path: 'C:\Program Files\dotnet\host\fxr\2.2.0\hostfxr.dll' arguments:> [aspnetcorev2_inprocess.dll] Argument[0] = 'C:\Program Files\dotnet\dotnet.exe'> [aspnetcorev2_inprocess.dll] Argument[1] = 'C:\inetpub\wwwroot\central-boletos\TJPA.CentralBoletos.API.dll'> [aspnetcorev2_inprocess.dll] In-process callbacks set> [aspnetcorev2_inprocess.dll] Event Log: 'Application 'C:\inetpub\wwwroot\central-boletos\' started the coreclr in-process successfully.' > End Event Log Message.> [aspnetcorev2_inprocess.dll] Starting app_offline monitoring in application 'C:\inetpub\wwwroot\central-boletos\'> [aspnetcorev2_inprocess.dll] Starting file watcher threadWhen i removed the lines in web.config solved the problem:```   <environmentVariables>           <environmentVariable name="ASPNETCORE_ENVIRONMENT" value="Development" />   </environmentVariables>```
4562	area-signalr	Microsoft.AspNetCore.Signalr 1.1.0 cannot be install via NuGet	### Describe the bugMicrosoft.AspNetCore.Signalr 1.1.0 cannot be installed with a simple web api projectbecause of version not compatible vserion of Microsoft.AspNetCore.App 2.1.1### To ReproduceSteps to reproduce the behavior:1. Create new WebAPI project with vs20172. Open NuGet Manager3. Search Microsoft.AspNetCore.Signalr4. Install Microsoft.AspNetCore.Signalr5. Error### Expected behaviorSuccess install. As a new project, it should be easy and success install via NuGet Manager. Should not have conflict because i expected everything should be the latest and compatible. Or Should block install version Microsoft.AspNetCore.Signalr 1.1.0.### Screenshots![image](https://user-images.githubusercontent.com/8042599/49790629-aebfd100-fd69-11e8-9982-0dc3104a162f.png)### Additional context
5672	area-mvc	Missing VSIXAssemblyInfo.cs in BlazorExtension output	Hi! After removing all errors during the build of the Components solution, I have one pending error that I do not understand how to fix. I keep getting this error:---CS2001	Source file '[myrootfolderhere]\src\Components\artifacts\obj\Microsoft.VisualStudio.BlazorExtension\\Debug\Microsoft.VisualStudio.BlazorExtension.VSIXAssemblyInfo.cs' could not be found.---(fyi, note that there's a double backslash after DEBUG in the error message but this github editor is not showing it)I tried searching for the VSIXAssemblyInfo.cs in the solution and the only instance it is mentioned is in the Microsoft.VisualStudio.RazorExtension.csproj file itself (note that it's another project) and not in the BlazorExtension project. The other one is in the FileListAbsolute.txt file itself which was created during the build. It has the following entry in the FileListAbsolute.txt: [myrootfolderhere]\src\Components\artifacts\obj\Microsoft.VisualStudio.BlazorExtension\Debug\Microsoft.VisualStudio.BlazorExtension.VSIXAssemblyInfo.cs.The problem is I don't see anyway for this file to be excluded during the build since it was not there in the first place. Is this file, VSIXAssemblyInfo.cs, really intended to be there?
4559	area-signalr	Refactor streaming from client to server	Fixes https://github.com/aspnet/SignalR/issues/2592Fixes https://github.com/aspnet/AspNetCore/issues/4401TODO:- [x] Couple more tests- [ ] Update spec with new behavior
4556	area-mvc	Investigate reported change in link generation behaviour 	See: https://github.com/aspnet/Docs/issues/9886#issuecomment-445507613https://github.com/nimeshdhruve/WebAPIRoutingDemo
4550	area-mvc	Enable Execution of Server-side Razor Logic on the Client (without needing all of the SPA features from Blazor)	What I am asking for is the ability to run C# code as a replacement for JavaScript, but in the context of a Razor Pages app, and without the Single Page Application features that Blazor provides, such as routing and the component model. Ideally, it'd be great to extend the logic that already exists in my .cshtml file to execute throughout the page lifecycle on the Client as well as on the initial page render from the Server.For example, say we have a block of Razor that looks like this (super-trivial):```<input type="checkbox" asp-for="SelectedStudent.IsAbsent"  />@if(!Model.SelectedStudent.IsAbsent) {    <div id="woot">The student is here! Woo-hoo!</div>}```This works great on the initial page render, but if my user checks that checkbox, then in order to display the "woot" element I either need to reload the whole page after saving the new state of the student, or I have to replicate that "if" logic in JavaScript. But if we could just use the Razor logic that already exists in the page to execute on the Client, then we don't have to add any extra code to make this work, be it JavaScript code or otherwise.I know that we are getting Razor Components in ASP.NET Core 3, which is promising, but my understanding of Razor Components is that we are still building an SPA style app, we are just moving the SPA from the client to the server.This approach would allow for existing Razor Pages apps to be able to leverage the advancements that we are getting from WebAssembly and Blazor, but in a way that we don't have to change how we write our existing Razor Pages apps, other than we no longer have to mix and match what runs on the initial render vs what runs throughout the lifecycle of the page.The only reason I bring this up is because I would love to continue using Razor Pages, but I would also like to add some nice client-side interactivity without having to switch contexts to JavaScript and without having to do a network hop (via a SignalR connection or otherwise). This probably sounds petty considering the example I proposed above could be accomplished easily with even vanilla JavaScript, but the applications here could be taken a lot further than this trivial example. I believe that this would be very friendly with the Razor Pages ecosystem we already have, because any AJAX requests we may need within that page lifecycle could be provided by Page Handlers within the PageModel for that page. We still get the nice MVVM page-based approach, where we can still use the server-side routing that MVC/Razor Pages already provides us, but without having to ship our entire application to the client or rely too much on SignalR (which I also love) to provide all the functionality. Thanks for reading and keep up the good work!
4549	area-mvc	IUrlHelper behave strange for new version of .net core 2.2	_From @benzhi2011 on Wednesday, 05 December 2018 15:00:37_IUrlHelper behave strange for new version of .net core 2.2Helper method that is working for all early version```c#    public static string AbsoluteRouteUrl(    this IUrlHelper url,    string routeName,    object routeValues = null)    {        return url.RouteUrl(routeName, routeValues, url.ActionContext.HttpContext.Request.Scheme);     }    string serviceUrl = Url.AbsoluteRouteUrl("default");```about one line of code return the Url of the executing MVC controller, in my case here it should return DNS + /Login/SSO and this code has been working for .core 1.1 and 2.1After I updated to 2.2 this  serviceUrl return DNS + /Contact/SSO when I call it from Login controller method SSO. This is really weird._Copied from original issue: dotnet/core#2107_
5399	area-signalr	How does DI work in regard to DbContext and hubs?	According to the documentation at https://docs.microsoft.com/en-us/aspnet/core/fundamentals/dependency-injection?view=aspnetcore-2.2:> Entity Framework contexts should be added to the service container using the scoped lifetime. This is handled automatically with a call to the AddDbContext method when registering the database context. Services that use the database context should also use the scoped lifetime.And the definition for a scoped lifetime:> Scoped lifetime services are created once per request.What does that mean when injecting scoped instances into hubs, e.g. DbContexts? Are they disposed of at the end of the request - i.e. when the websocket gets closed? Or when a method call ends?
4545	area-mvc	Microsoft.AspNetCore.Mvc, Version=2.2.0.0 is giving an error "System.IO.FileNotFoundException"	I have started using .Net Core 2.2 recently and I got one WebApp related test cases there, where I am using > TestServer from > Microsoft.AspNetCore.TestHost. While executing the test cases I am seeing below error:```System.IO.FileNotFoundException : Could not load file or assembly 'Microsoft.AspNetCore.Mvc, Version=2.2.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'. The system cannot find the file specified.   at <my code related to Startup.ConfigureServices>--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.ConfigureServices(IServiceCollection services)   at Microsoft.AspNetCore.Hosting.Internal.WebHost.EnsureApplicationServices()   at Microsoft.AspNetCore.Hosting.Internal.WebHost.Initialize()   at Microsoft.AspNetCore.Hosting.WebHostBuilder.Build()   at Microsoft.AspNetCore.TestHost.TestServer..ctor(IWebHostBuilder builder, IFeatureCollection featureCollection)   at <my test>```My Visual studio version is: Professional 2017 15.9.3. The same piece of code used to work with .Net Core 2.0. Is it kind of regression? 
4543	area-mvc	Microsoft.Aspnetcore ModelBinding throw Cannot access a closed Stream with .NET Core 2.1	```System.ObjectDisposedException: Cannot access a closed Stream.   at System.IO.MemoryStream.Read(Byte[] buffer, Int32 offset, Int32 count)   at System.IO.MemoryStream.ReadAsync(Byte[] buffer, Int32 offset, Int32 count, CancellationToken cancellationToken)--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.WebUtilities.FileBufferingReadStream.ReadAsync(Byte[] buffer, Int32 offset, Int32 count, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.StreamHelperExtensions.DrainAsync(Stream stream, ArrayPool`1 bytePool, Nullable`1 limit, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Mvc.Formatters.JsonInputFormatter.ReadRequestBodyAsync(InputFormatterContext context, Encoding encoding)   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder.BindModelAsync(ModelBindingContext bindingContext)   at Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder.BindModelAsync(ActionContext actionContext, IModelBinder modelBinder, IValueProvider valueProvider, ParameterDescriptor parameter, ModelMetadata metadata, Object value)   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Builder.Extensions.MapMiddleware.Invoke(HttpContext context)   at Micro.AspNetCore.Middleware.RequestHandlerMiddleware.Invoke(HttpContext context)   at Micro.AspNetCore.Middleware.ErrorLogMiddleware.Invoke(HttpContext context)```When I using under code , modelbinding throw System.ObjectDisposedException: Cannot access a closed Stream exception。```C#var postRequest = new HttpRequestMessage(HttpMethod.Post, "/Supplier/Goods/SaveSpec");            postRequest.Headers.Add("User-Agent", "csharp");            postRequest.Headers.Add("Accept", "application/json, text/plain, */*");            postRequest.Content = new StringContent(                JsonConvert.SerializeObject(new GoodsSpecModel                {                    Name = "TestName",                    Sort = 1                }), Encoding.UTF8, "application/json");            postRequest.Content.Headers.ContentType = new MediaTypeHeaderValue("application/json");            var response = _fixture.Client.SendAsync(postRequest).Result;            response.EnsureSuccessStatusCode();            Assert.Equal(HttpStatusCode.OK, response.StatusCode);            var content = await response.Content.ReadAsStringAsync();            Assert.NotEmpty(content);```
4539	area-identity	ASP.NET Core 2.2  after scaffolding Identity Autogenerated Login.cshtml.cs file provides _signInManager.PasswordSignInAsync with wrong parameters!	Using this version of ASP.NET Core '2.2'Here is my configuration for using Identity.            services.AddIdentity<SuperCharactersUser, IdentityRole>(options =>               {                   options.Password.RequireDigit = false;                   options.Password.RequiredLength = 3;                   options.Password.RequiredUniqueChars = 0;                   options.Password.RequireLowercase = false;                   options.Password.RequireNonAlphanumeric = false;                   options.Password.RequireUppercase = false;               })                .AddDefaultTokenProviders()                .AddDefaultUI(UIFramework.Bootstrap4)                .AddEntityFrameworkStores<SuperCharactersAppDbContext>();I have also custom IdentityUser.     public class SuperCharactersUser : IdentityUser    {        public  Score Score { get; set; }    }Already created IdentityDbContext:    public class SuperCharactersAppDbContext : IdentityDbContext<SuperCharactersUser>    {        //public DbSet<Score> Scores { get; set; }        public DbSet<SecretIdentity> SecretIdentities { get; set; }        public DbSet<SuperCharactersUser> AppUsers { get; set; }        public DbSet<Character> Characters { get; set; }        public DbSet<SuperPower> SuperPowers { get; set; }        public DbSet<Team> Teams { get; set; }                public SuperCharactersAppDbContext()        {        }        public SuperCharactersAppDbContext(DbContextOptions<SuperCharactersAppDbContext> options)            : base(options)        {        }        protected override void OnModelCreating(ModelBuilder builder)        {            base.OnModelCreating(builder);            //builder.Entity<TeamsCharacters>().HasKey(tc => new { tc.CharacterId, tc.TeamId });        }    }I have a middleware which seeds two roles called Admin and Creator and two users for these roles public class PowerUsersAndRolesSeedMiddleware    {        private readonly RequestDelegate next;        private readonly Dictionary<string, SuperCharactersUser> powerUsers = new Dictionary<string, SuperCharactersUser>()        {            {"Admin",new SuperCharactersUser{Email = "admin@admin.ad",PasswordHash="admin123",UserName ="Admin" } },            {"Creator",new SuperCharactersUser{ Email="creator@creator.cr",PasswordHash="creator123",UserName = "Creator"} },        };        public PowerUsersAndRolesSeedMiddleware(RequestDelegate next)        {            this.next = next;        }        public async Task InvokeAsync(HttpContext context, IServiceProvider provider)        {            var roleManager = provider.GetRequiredService<RoleManager<IdentityRole>>();            var userManager = provider.GetRequiredService<UserManager<SuperCharactersUser>>();            await SeedRoles(roleManager);            await SeedUsers(userManager);            await next(context);        }        private async Task SeedRoles(RoleManager<IdentityRole> roleManager)        {            foreach (var roleName in powerUsers.Keys)            {                if (await roleManager.FindByNameAsync(roleName) == null)                {                    var result = await roleManager.CreateAsync(new IdentityRole(roleName));                    if (!result.Succeeded)                    {                        ExceptionCatcher(result);                    }                }            }        }        private async Task SeedUsers(UserManager<SuperCharactersUser> userManager)        {            foreach (var user in powerUsers)            {                if (await userManager.FindByNameAsync(user.Key) == null)                {                    var result = await userManager.CreateAsync(user.Value, user.Value.PasswordHash);                    if (!result.Succeeded)                    {                        ExceptionCatcher(result);                    }                    var isAdded = await userManager.AddToRoleAsync(user.Value, user.Key);                    if (!isAdded.Succeeded)                    {                        ExceptionCatcher(isAdded);                    }                }            }        }        private void ExceptionCatcher(IdentityResult result)        {            throw new Exception(string.Join(Environment.NewLine, result.Errors.Select(e => e.Description)));        }    }After scaffolding Identity to an existing ASP.NET Core 2.2 , I receive failed log in message even though I am logging with correct credentials The following code was generated for me within the Login.cshtml.cs RazorPage->    [AllowAnonymous]    public class LoginModel : PageModel    {        private readonly SignInManager<SuperCharactersUser> _signInManager;        private readonly ILogger<LoginModel> _logger;        public LoginModel(SignInManager<SuperCharactersUser> signInManager, ILogger<LoginModel> logger)        {            _signInManager = signInManager;            _logger = logger;        }        [BindProperty]        public InputModel Input { get; set; }        public IList<AuthenticationScheme> ExternalLogins { get; set; }        public string ReturnUrl { get; set; }        [TempData]        public string ErrorMessage { get; set; }        public class InputModel        {            [Required]            //[EmailAddress]   //No longer an EmailType            public string UserName { get; set; }  //Renamed to UserName            [Required]            [DataType(DataType.Password)]            public string Password { get; set; }            [Display(Name = "Remember me?")]            public bool RememberMe { get; set; }        }        public async Task OnGetAsync(string returnUrl = null)        {            if (!string.IsNullOrEmpty(ErrorMessage))            {                ModelState.AddModelError(string.Empty, ErrorMessage);            }            returnUrl = returnUrl ?? Url.Content("~/");            // Clear the existing external cookie to ensure a clean login process            await HttpContext.SignOutAsync(IdentityConstants.ExternalScheme);            ExternalLogins = (await _signInManager.GetExternalAuthenticationSchemesAsync()).ToList();            ReturnUrl = returnUrl;        }        public async Task<IActionResult> OnPostAsync(string returnUrl = null)        {            returnUrl = returnUrl ?? Url.Content("~/");            if (ModelState.IsValid)            {                // This doesn't count login failures towards account lockout                // To enable password failures to trigger account lockout, set lockoutOnFailure: true                var result = await _signInManager.PasswordSignInAsync(Input.Email, Input.Password, Input.RememberMe, lockoutOnFailure: true);   **// Here is the problem**                if (result.Succeeded)                {                    _logger.LogInformation("User logged in.");                    return LocalRedirect(returnUrl);                }                if (result.RequiresTwoFactor)                {                    return RedirectToPage("./LoginWith2fa", new { ReturnUrl = returnUrl, RememberMe = Input.RememberMe });                }                if (result.IsLockedOut)                {                    _logger.LogWarning("User account locked out.");                    return RedirectToPage("./Lockout");                }                else                {                    ModelState.AddModelError(string.Empty, "Invalid login attempt.");                    return Page();                }            }            // If we got this far, something failed, redisplay form            return Page();        }    }   var result = await _signInManager.PasswordSignInAsync(Input.Email, Input.Password, Input.RememberMe, lockoutOnFailure: true); -> **### // here is the problem. It seems PasswordSignInAsync can receive only UserName as parameter not Email. When I changed it to Input.UserName, then the result is true and login is sucessfull.**This is autogenerated code from Identity which provides PasswordSignInAsync with wrong parameters.If needed more information can be provided !Best Regards,Pavel Savov
5398	area-signalr	How to properly reconnect signalr without memory leak	In  angular6 website  with ASP.NET server application , I want the singnalR client should always stay connected with Hub(Server). For that purpose started the connection on disconnected event with below code snap.          this.connection.start().done((data: any) => {            console.log('Now connected');            this.connectionId = this.connection.id;            this.connectionEstablished.emit(true);            this.connectionExists = true;        }).fail((error: any) => {            this.connectionEstablished.emit(false);        });        this.connection.reconnecting(() => {            this.tryingToReconnect = true;        });        this.connection.reconnected(() => {            this.tryingToReconnect = false;        });        this.connection.error((error: any) => {            this.initialize();        });        this.connection.disconnected(() => {            if (this.tryingToReconnect) {                setTimeout(() => {                    this.initialize();                }, 5000);            }        });;   Because of that above code, signalr creates the problem such as**crashes the client browser and memory leaks** in below cases such as,1.If there is problem in client internet connection for some hours , that time singalr continuously tries to create the connection with hub. Because of internet problem , **logging the connection error in browser console infinitely** until the successful connection with hub2.If i close the server, that time  also singalR **logging the connection error in browser console infinitely** until the successful connection with hub![image](https://user-images.githubusercontent.com/21965691/49694631-b9d10080-fbb3-11e8-87ee-3ffcf685e34c.png)**Kindly provide me a solution to rectify the above mentioned problem for signalr  always stay connected with Hub** 
5671	area-mvc	How to get self referenz from events?	Hello,how can i get the self referenz by blazor/c# events like javascript?```html<a href="" id="someId" onclick="SomeMethod(this);"></a>```
4532	area-security	Microsoft.Aspnetcore.Authorization namespace is missing with .NET Core 2.2	Microsoft.Aspnetcore.Authorization namespace is missing when using .NET Core 2.2**To Reproduce**1. Set TargetFramework of .csproj file to "netcoreapp2.2"2. Set RuntimeFrameworkVersion to "2.2.0"2. Include PackageReference "Microsoft.AspNetCore.App"3. Try to use Authorize attribute or to Microsoft.AspNetCore.Authorization namespace in any controller.4. Namespace is not found.```<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp2.2</TargetFramework>    <RuntimeFrameworkVersion>2.2.0</RuntimeFrameworkVersion>    <DebugType>Full</DebugType>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore.App"/>  </ItemGroup></Project>```**Expected behavior**Running the same project with net core 2.1 works fine. Tried to include Microsoft.AspNetCore.Authorization package explicitly using nuget with no success. Error appears to be the same.**Screenshots**![image](https://user-images.githubusercontent.com/28928275/49615480-58900e00-f9b6-11e8-8a22-e9b12631073d.png)**Desktop:** - OS: Windows 10 x64 - IDE: Visual Studio 15.9.3
5846	area-identity	Registration Page with Mobile Number (OTP) & Name  Asp.Net Identity	Hi,I am using Asp.Net Identity. But as per my business requirement, I want change my Registration page with below fields:                  ----------------------------------1. NAME    |                                                |                  ----------------------------------                                                   --------------------------2. Mobile Number (with OTP)    |                                     |                                                   ------------------------------------------ | Create User |----------------
4951	area-mvc	Api analyzer does't recognize `ApiConventionType` on a base controller	#### Is this a Bug or Feature request?:Bug.#### Steps to reproduce:```cs[ApiConventionType(typeof(DefaultApiConventions))]public abstract class MyBaseController : ControllerBase``````cspublic class SomeController : MyBaseController{	[HttpGet]	public async Task<ActionResult<SomeDto>> Get(string id)	{		var result = await GetData(id);		if (result == null)		{			return NotFound(); // WARNING: undocumented 		}		return Ok(result);	}}```#### Description of the problem:In child controllers, the analyzer doesn't realize that there is an api convention being applied and it produces warnings. A workaround is to apply the convention on assembly level.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:Using Asp.Net Core 2.2.<!--                                    --- NOTE ---1.  Try enabling logging (in the most verbose level) and see if the details help you in fixing    the issue you are seeing. Share the logs too if it helps in diagnosing the issue faster.    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging2.  If you are seeing an exception, include the full exceptions details (message and stack trace).    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/error-handling3.  If you believe you have an issue that affects the security of the platform please do    not create an issue, instead email your issue to 'secure@microsoft.com'. Your report may    be eligible for our bug bounty. More info: https://technet.microsoft.com/en-us/mt764065.aspx-->
4690	area-servers	How to get the current total number of requests？	
4522	area-infrastructure	Automate VS PR Creation from pipelines	- [x] Automate Symbol Publishing (Windows Symbols)- [x] Automate VSDrop Creation- [ ] Automate PR Creation
4521	area-infrastructure	Automate AspNetCore-Tooling dependency flow with DARC	
5670	area-mvc	Exposing the inner ref of an element via BlazorComponent returns an emtpy(?) ref	I have a component that inherits from BlazorComponent with this code:```protected override void BuildRenderTree(RenderTreeBuilder builder)        {            base.BuildRenderTree(builder);            builder.OpenElement(0, TagName);            foreach (var param in _attributesToRender)            {                builder.AddAttribute(1, param.Key, param.Value);            }            if (_classname != null) builder.AddAttribute(1, "class", _classname);            builder.AddElementReferenceCapture(2, capturedRef => { ElementRef = capturedRef; });            builder.AddContent(3, _childContent);            builder.CloseElement();        }```It's used like so:```<form onSubmit={this.alertValue}>    <Dynamic TagName="input" ElementRef="@inputRef" />        <button type="button" onclick="@OnClick">            Submit        </button></form>@functions {    ElementRef inputRef;    async void OnClick()    {        await inputRef.AlertValue();    }}```Which ultimately prints out to the console what the ref is. Like so:``` public static class ElementRefExtensions    {        public static async Task AlertValue(this ElementRef elementRef)        {            await JSRuntime.Current.InvokeAsync<bool>("blazorousSample.alertValue", elementRef);        }    }window.blazorousSample = {    alertValue: function (element) {        console.log("element: %O", element);        alert(element.value);    }};```One the javascript console I get:```{  "_blazorElementRef": null}```
4514	area-mvc	Add [FromQuery] Constructor to make parameter name assignment more simple	### Describe the solution you'd likeThe `FromQuery` attribute is great, though it could be helpful to have an optional constructor for the attribute to allow use like this:`[FromQuery("a_param_name")]` instead of having to use the constructor like this:`[FromQuery(Name = "<a_param_name")]`, similar to the pattern used in the `HttpMethodAttribute`'s template parameter.I would like to offer my time to make the change. Can I make a PR for this feature change?
4508	area-security	Angular 4 with .Net core 2.1 role based authorization issue	I am using Angular 4 with dot net core 2.1(project skeleton is the one which gets created by default in visual studio 2017). I am doing claim based policy validation as below in my startup.cs :```c#services.AddAuthorization(options =>            {                options.AddPolicy("ReaderRole", policy => policy.RequireClaim("role", "READER"));            }); ```and along with this I am decorating my API controller action with the attribute as shown below:```c#[Authorize(Policy = "ReaderRole")][HttpGet("{id}")]public async Task<JsonResult> Get(string id){}```Now authorization is working as expected and in case if user is not authorized controller is throwing below error but the response is in HTTP which browser(chrome) is blocking and I am not able to proceed further. My angular is not receiving the repose of the api call(.Net api) and it breaks in between.Mixed Content: The page at 'https://myURL/home' was loaded over HTTPS, but requested an insecure XMLHttpRequest endpoint 'http://myURL/Account/AccessDenied?returnUrl=%2Fapi%2FAccount%2Frandomemail@xxx.com'. This request has been blocked; the content must be served over HTTPS.
4506	area-mvc	JsonConverter Deserializing Polymorphic List and ModelState Error Context	### DescriptionWhen using a Polymorphic JsonConverter on a list of objects in a request to an Asp.Net Core Web app ModelStateValidation for properties of the objects in that list lose their context.  For example if i have an object Person and that object has a property Friends which is a List<Person>, if I set the Gender enum to an invalid enum value when using  JsonConverter i get a response like:```json{    "gender": [        "The input was not valid."    ]}but if you take the JsonConverter off of the model you get:{    "friends[0].gender": [        "The input was not valid."    ]}```I tried to place JsonConverters in the AddJsonOptions extension method on IServiceCollection, or directly on the model with the same result, not that I expected it to change.### To Reproduce1. Using this version of ASP.NET Core 2.1 or 2.22. Open the solution contained inside of the Stuffies.zip file.3. Hit Debug4. Make a request via postman or whatever tool you like and post to https://localhost:5001/api/values.using the following json:```json{	"name":"Bob Jones",	"gender":"Male",	"friends":[		{			"name":"Steven",			"gender":"cat"		}	]}```5. You'll see that the context of the response exists in the response: friends[0].gender6. Now go into the ValuesController and uncomment the Attributes on the Person class7. Debug again and do the same Post4. See the differences in the previously mentioned responses between when you add or remove the Attributes from the Person class.  Now the response will have : gender without the context.### Expected behaviorI expected the response to have the context on the ModelState error.### Screenshots/Sample ProjectIf applicable, add screenshots to help explain your problem.![stuffies](https://user-images.githubusercontent.com/32906437/49656041-ee04bf80-fa01-11e8-8c0d-ea593812a4d0.PNG)[Stuffies.zip](https://github.com/aspnet/AspNetCore/files/2657774/Stuffies.zip)
4504	area-mvc	RequestLocalizationMiddleware logs at warning	### Describe the bugWhen the RequestLocalizationMiddleware detects an unsupported language, it logs at the warning level.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core 2.12. Setup the localization as documented.3. Set the culture/uiculture values to something that isn't added supported collections.4. Observe warning error messages. See: RequestCultureProviderLoggerExtensions.cs### Expected behaviorThis seems a bit severe given that this value is passed by the client, for instance if Spanish is requested but only French is specified, every requests gets 1 or more warnings.Perhaps make this configurable and/or reduce it to a debug level.
4503	area-mvc	asp.net core2.2 Custom Binders For array property not work	show code:action:        [HttpPost]        public ActionResult SaveCustomer(Customer customer)        {            return View("Index");        }    public class Address    {        [ModelBinder(BinderType = typeof(TestBinder))]        public string Street { get; set; }        [ModelBinder(BinderType = typeof(TestBinder))]        public string City { get; set; }    }    public class Customer    {              public Address[] Addresses { get; set; }    } Custom Binders:    public class TestBinder : IModelBinder    {        public Task BindModelAsync(ModelBindingContext bindingContext)        {            if (bindingContext == null)            {                throw new ArgumentNullException(nameof(bindingContext));            }            var Name = bindingContext.ModelName;            var ValueStr = GetValue(bindingContext, Name);            bindingContext.ModelState.SetModelValue(bindingContext.ModelName, "Test", bindingContext.ModelName);            bindingContext.Result = ModelBindingResult.Success("Test");            return Task.CompletedTask;        }        private string GetValue(ModelBindingContext context, string name)        {            ValueProviderResult result = context.ValueProvider.GetValue(name);            return result.FirstValue;        }    } BindModelAsync Function is not working...
4501	area-mvc	[Blazor] Referencing the project name	This issue is intended for project maintainers and developers that are building custom tooling and/or projects for _Blazor_. Now that _Blazor_ is going to be renamed to _Razor Components_, how are we going to reference the _Blazor_ when describing our project? Are we going to reference to the _Blazor_ or _Razor Components_?As I can see the _Blazor_ is mentioned in [README](https://github.com/aspnet/AspNetCore/tree/master/src/Components) along with Razor Components. Also what will happen with the [web page](https://blazor.net/)?
5845	area-identity	Nuget Package Dependencies NETCoreApp 3.0, please change to NETStandard 2.0	https://www.nuget.org/packages/Microsoft.AspNetCore.Identity.EntityFrameworkCore/3.0.0-preview-18579-0056
5397	area-signalr	feat: in-memory stub for local development	### Please include as much of the following as you can in your bug report* Versions of Client-Side NPM Packages: 1.1.0* Are you using the C# client or the JavaScript client: JS/TS* The Operating System on the Client (Windows/Linux/macOS): Windows* The Browser on the client, if using the JavaScript client (IE/Chrome/Edge/Firefox/etc.): All### ProposalHave you considered developing an in-memory stub which, if enabled, simulates websocket connection with a developer-given dataset using observables?Something like [this](https://github.com/angular/in-memory-web-api) (not necessarily built on Angular as the example).If no, are you interested into making one and what do you think will be the effort to build it (if it's doable at all)?Would you accept a PR for that?
4498	area-servers	Simplify usage of distributed tracing on by default in ASP.NET Core and HttpClient	Today ASP.NET Core and HttpClient can be configured to flow a hierarchical request id throughout the stack (incoming and outgoing). Doing this properly is fragile and not very approachable. The goal of this issue is to make that turn key and on by default.
5271	area-mvc	Update Docs for 2.2 Template	The Asp.Net Core Angular SPA Template in Asp.Net Core 2.2 has finally been updated to Angular 6, which is great since we can simply use ng update to go to Angular 7 now.But the docs are still for an older Angular Version. So the required configuration for SSR is missing.Could you please update the docs?https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/angular?view=aspnetcore-2.2&tabs=visual-studio 
5669	area-mvc	Support for Visual Studio 2019	Make `ASP.NET Core Blazor Language Services` available for VS 2019.
5844	area-identity	RefreshSignInAsync could happen with a different user	Related: https://github.com/aspnet/Identity/issues/1900Instead of reiterating what was already said there, we're using it for a different goal, we allow delegated requests in certain cases, these however end up in the same code path which will call refresh.Could we think about a way to guard the SignInAsync call inside RefreshSignInAsync, e.g. check in an agnostic as possible way that the currently logged in user is the same as the passed in user, and throw otherwise? That wouldn't solve my problem per se, I'd want to introduce a condition around this anyway if it'll throw but it will make people aware of this api's pitfalls.  /cc @blowdart (I'm obviously not the first one that finds this api highly unprincipled and frankly dangerous, mixing in the previous auth properties with any new user you pass in, and to call it  "Refresh")
4483	area-signalr	donetcore 2.2 broke signalr	I have the latest aspnetcore 2.2.0 locally, and no longer get OnConnected events in SignalR (authenticated hub). Still using SignalR 1.0.4 on server, client is angular, and doesn't work with either 1.0.4 or 1.1.0. Same client works with the previous aspnetcore version (2.1.6) with SignalR 1.0.3 and 1.0.4. I get the same problem with both regular SignalR and Azure SignalR.Client side`"@aspnet/signalr": "^1.1.0",`
4480	area-mvc	Api Analyzer crashes, when trying to see potential fixes	Create a new ASP.NET Core API project, and in the default controller add the following code:```csharp    public class Person    {        public int Id { get; set; }        public string Name { get; set; }    }public static List<Person> People = new List<Person>()        {            new Person { Id = 0, Name = "S1" },            new Person { Id = 1, Name = "S2"},            new Person { Id = 2, Name = "S3"}        };[HttpGet("{id}")]        public ActionResult<Person> Get(int id)        {            if (id < 0)            {                return NotFound();            }            var person = People.Where(p => p.Id == id);            if (person != null)            {                return Ok(person);            } else            {                return NotFound();            }        }```There will be a squiggle under the `NotFound()` method. Click to show potential fix and it will crash with the following error:```System.ArgumentException : An item with the same key has already been added.   at System.ThrowHelper.ThrowArgumentException(ExceptionResource resource)   at System.Collections.Generic.Dictionary`2.Insert(TKey key,TValue value,Boolean add)   at Microsoft.AspNetCore.Mvc.Api.Analyzers.AddResponseTypeAttributeCodeFixAction.CalculateStatusCodesToApply(CodeActionContext& context,IList`1 declaredResponseMetadata)   at async Microsoft.AspNetCore.Mvc.Api.Analyzers.AddResponseTypeAttributeCodeFixAction.GetChangedDocumentAsync(<Unknown Parameters>)   at async Microsoft.CodeAnalysis.CodeActions.CodeAction.GetChangedSolutionAsync(<Unknown Parameters>)   at async Microsoft.CodeAnalysis.CodeActions.CodeAction.ComputeOperationsAsync(<Unknown Parameters>)   at async Microsoft.CodeAnalysis.CodeActions.CodeAction.GetPreviewOperationsAsync(<Unknown Parameters>)   at async Microsoft.CodeAnalysis.Editor.Implementation.Suggestions.SuggestedAction.GetPreviewResultAsync(<Unknown Parameters>)   at async Microsoft.CodeAnalysis.Editor.Implementation.Suggestions.SuggestedActionWithNestedFlavors.<>c__DisplayClass11_0.<GetPreviewAsync>b__0(<Unknown Parameters>)   at async Microsoft.CodeAnalysis.Extensions.IExtensionManagerExtensions.PerformFunctionAsync[T](<Unknown Parameters>)```The issue doesn't reproduce, if one of the `NotFound` returns is removed.
4468	area-mvc	Cannot generate routes that are defined but not implemented in ASP.NET Core 2.2.0 compared to 2.1.x	### Describe the bugIn ASP.NET Core 2.1.x, it was possible to define routes without having to implement handlers for them and then use `IUrlHelper` to build URLs for these routes in the application.This was useful for microservice scenarios where multiple applications are deployed behind a load balancer for the same domain name and could generate URLs for other applications. For example, you could use them for `Location` HTTP response headers and other HATEOS/HAL-style scenarios where links to other resources servied by other applications are contained in the response.In ASP.NET Core 2.2.0, attempts to build such routes using `IUrlHelper` just return `null`.The previous behaviour can be restored by setting `MvcOptions.EnableEndpointRouting` to `false`.### To Reproduce```csharppublic void Configure(IApplicationBuilder app){    app.UseMvc(        (routes) =>        {            routes.MapRoute(                name: "default",                template: "{controller=Home}/{action=Index}/{id?}");            routes.MapRoute("foo", "/foo/foo");            routes.MapRoute("bar", "/bar/bar/{id}");        });}public IActionResult Index(){    var data =  new    {        foo = urlHelper.RouteUrl("foo", new { page = 1 }),    // Actual: null; Expected: "/foo/foo?page=1"        bar = urlHelper.RouteUrl("bar", new { id = "myId" }), // Actual: null; Expected: "/bar/bar/myId"    };    return Ok(data);}```### Expected behaviorRoutes can be defined and built with `IUrlHelper` or `LinkGenerator`, even if they do not map to an MVC action.
5668	area-mvc	Enhancement suggestion: Components as attributes in other components or tags	```Html<MyComponent Memoize="true" ComponentProperty="@SomeValue" />````Memoize` would be another component which defines the `Attribute` and had full access to the underlying component. As an example it could even prohibit rendering and inject a dynamic rendertree which could be stored in a cache. I believe `Taghelpers` can do something similar.More Examples:```Html<MyComponent Repeat="5" ComponentProperty="@SomeValue" /><MyComponent HideWhenEnvironment="Production" ComponentProperty="@SomeValue" /><MyComponent DisplayWhenEnvironment="Debug" ComponentProperty="@SomeValue" /><MyComponent LazyLoad="true" ComponentProperty="@SomeValue" /><MyComponent DataSourceWithCachingAndErrorHandling="/api/category/value/@value;bindto(ComponentProperty)" ComponentProperty="@SomeValue" />[...]```
5843	area-identity	Add AddClaimsAsync to RoleManager	`UserManager` has two methods for adding claims (`AddClaimsAsync` and `AddClaimAsync`) but `RoleManager` has only one method (`AddClaimAsync`).If I'm not wrong calling `AddClaimAsync` in a loop will result in multiple queries to the database?Calling `AddClaimsAsync` should add multiple claims in 1 query?
4464	area-identity	Reference to type 'IUserTwoFactorStore<>' claims it is defined in 'Microsoft.AspNetCore.Identity', but it could not be found	### Describe the bugA clear and concise description of what the bug is.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core '...'2. Run this code '....'3. With these arguments '....'4. See error### Expected behaviorA clear and concise description of what you expected to happen.I'm using ASP.Net Core Identity with MongoDB and I get error of reference of IUserTwoFactorStore### ScreenshotsIf applicable, add screenshots to help explain your problem.![devenv_2018-12-06_22-23-22](https://user-images.githubusercontent.com/13591213/49593195-920c4d80-f9a5-11e8-9d64-ea0dfff94ec1.png)### Additional contextAdd any other context about the problem here.Include the output of `dotnet --info`My package version```    <PackageReference Include="IdentityServer4" Version="2.3.2" />    <PackageReference Include="Microsoft.AspNetCore.App" />    <PackageReference Include="Microsoft.AspNetCore.Identity" Version="2.1.6" />    <PackageReference Include="Microsoft.AspNetCore.Identity.MongoDB" Version="1.0.2" />    <PackageReference Include="Microsoft.AspNetCore.Razor.Design" Version="2.1.2" PrivateAssets="All" />    <PackageReference Include="Microsoft.Extensions.Identity.Core" Version="2.1.6" />    <PackageReference Include="MongoDB.Driver" Version="2.7.2" />```
5842	area-identity	Checking if claim exist before adding to prevent duplicates	Proposition:add methods like `AddClaimIfNotExistAsync` and `AddClaimsIfNotExistAsync`, what do you think? Or should it be a responsibility of the caller?or add those checks inside `AddClaimsAsync` and `AddClaimAsync`. Because what's the sense in allowing to add duplicate claims?
4462	area-mvc	RedirectRoute and map route default values issue with AspNetCore 2.2	### Describe the bugWhen a default value is defined for a parameter in the route map, the values defined in redirect methods are ignored.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core '2.2'2. Run this code : `RedirectToRoute(new { action = nameof(Details), id=10 });`Or`RedirectToAction(nameof(Details), new {id=10 });`With route defined like this:```routes.MapAreaRoute(                   name: entityName,                   areaName: _moduleName,                   template: "App/" + _route + "/{controller}/{action}/{id?}",                   defaults: new { action = "Index", id="" },                   constraints: new { controller = entityName }               );```Controller action is :  `      public virtual Task<IActionResult> Details(int id) `When I use this code with AspNetCore 2.1 everything works. But with 2.2, the action is called with id = 0.If I remove the id in the map route definition, everything works:```routes.MapAreaRoute(                   name: entityName,                   areaName: _moduleName,                   template: "App/" + _route + "/{controller}/{action}/{id?}",                   defaults: new { action = "Index"},                   constraints: new { controller = entityName }               );```
5667	area-mvc	Json Data Annotations	Maybe I didn't find the correct method, but I faced an issue using Dtos.I'm doing some application with a backent and a frontend sharing the same dtos in a separate dll.I used to do like this`[JsonProperty("qnaList")] public List<KBEntry> Entries { get; set; } = new List<KBEntry>();`but it seems Blazor doesn't support NewtonSoft Data Annottions.What could be the good solution for that problem if there's one right now.Thanks.
5396	area-signalr	Question: using ClientWebsocket to connect to SignalR Hub	Hi all,not an issue but merely a question. I have a scenario where i need to use a websocketclient (ClientWebsocket, WebsocketSharp) to connect and communicate directly with a signalR hub and thus using "ws://......." to connect to and also being able to specify subprotocol. Is this possible at all?Thanks in advance,Riccard
4461	area-mvc	Endpoint Routing - IActionConstraint	According to https://blogs.msdn.microsoft.com/webdev/2018/08/27/asp-net-core-2-2-0-preview1-endpoint-routing/ we should open issues regarding our usage of ``IActionConstraint`` here. So this is neither a bug nor a feature request, but just for documentation purposes.In one of the applications I maintain we use a concept similar to the system described in http://byterot.blogspot.com/2012/12/5-levels-of-media-type-rest-csds.htmlThe interesting part is the table at the end.We offer the possibility to supply additional tokens in the Accept-Header and/or Content-Type header (depending on http method) and we use ``IActionConstraint`` to check for these tokens (specifically version and some model tokens) and route to the appropriate actions.
4451	area-servers	IIS: ASP.NET Core Module blocks install when Shared Configuration is used - 2.2.0-preview3 to RTM regression	When we tried to upgrade our 2.2.0-preview3 ASP.NET Core IIS hosting module to 2.2.0 via Puppet, we get an error:![image](https://user-images.githubusercontent.com/454813/49553603-7a11cc80-f8c6-11e8-8aa4-af51d7f51e88.png)It seems this is a [regression from the preview 3 release](https://twitter.com/sshirhatti/status/1070476319748571137) where it was allowed. This has changed our Puppet deploy from working to inoperable. Disabling and re-enabling Shared Configiuration is non-trivial and a ton more to automate for deploy of this module. My understanding from Twitter is that *some* configurations broke with this (ours was fine) and so as a result none are allowed.I'd imagine anyone using Chocolatey to install has the same issue with the scenario, so an extra arg to bypass the check shouldn't be the first solution here. Can we please only check for the error and present this message ***only if it's a problem***?We had several projects ready to go live on 2.2 and others that are on preview3, so suffice to say this is quite the killer to rollout plans and a real enthusiasm curber - it's currently blocking our rollout of 2.2 at Stack Overflow. We need 2.2 RTM for .exe naming, which affects service deploys and such...since that transition is painful from preview3, we've delayed releases until RTM lands (and now...indefinitely). A fix to this soon would be much appreciated.### To ReproduceSteps to reproduce the behavior:1. Enable shared configuration2. Install 2.2.0-preview 3 hosting module3. Attempt to install 2.2.0 RTM hosting module### Expected behaviorThis should be allowed as it was in 2.2.0-preview3.cc @DamianEdwards @shirhatti 
4447	area-servers	Wait to dispose RequestAborted CTS	Partially Addresses #4422
4444	area-servers	IIS Express in .NET Core 2.2 doesn't response if add .UseKestrel(options => options.AddServerHeader = false)	### Describe the bugIIS Express doesn't response in .NET Core 2.2 if use a options.AddServerHeader = falseIf remove this command, all work.### To ReproduceSteps to reproduce the behavior:1. Run dotnet new mvc2. In Program.cs add .UseKestrel(options => options.AddServerHeader = false)3. In launchSettings.json add "ancmHostingModel": "InProcess" to "IIS Express" profile (or do it via Visual Studio in project debug properties page)4. Run the program on IIS Express5. See infinite loading### Expected behaviorThe page opened.### Additional context.Net Core SDK version: 2.2.100Windows 10 1809
4439	area-mvc	Microsoft.AspNetCore.Mvc.Api.Analyzers not respecting XML comments.	### Describe the bugWhen I first installed `Microsoft.AspNetCore.Mvc.Api.Analyzers` I got a ton of: > Action method returns undeclared status code '404'.After clicking on them, they went away. Swashbuckle supports a nonstandard XML comment `<response ...` [as seen here.](https://github.com/domaindrivendev/Swashbuckle#response-codes). Is this supported?It also has an attribute for [`[SwaggerResponse(404...`](https://github.com/domaindrivendev/Swashbuckle.AspNetCore#enrich-response-metadata) is this support in lieu of `[ProducesResponseType]`? I assume so since [it inherits from `ProducesResponseTypeAttribute`](https://github.com/domaindrivendev/Swashbuckle.AspNetCore/blob/master/src/Swashbuckle.AspNetCore.Annotations/SwaggerResponseAttribute.cs). But i didn't see any of this information in the announcement [here](https://blogs.msdn.microsoft.com/webdev/2018/08/23/asp-net-core-2-20-preview1-open-api-analyzers-conventions/).Are we locked into using `[ProducesResponseType]` and/or `[SwaggerResponse]`?### To Reproduce```csharp/// <summary>/// Gets a single Product./// </summary>/// <param name="productId">The requested Product identifier.</param>/// <returns>The requested Product.</returns>/// <response code="200">The Product was successfully retrieved.</response>/// <response code="404">The Product does not exist.</response>[HttpGet("{productId}", Name = ITILLifecycleControllerRoute.GetProduct)][HttpHead("{productId}", Name = ITILLifecycleControllerRoute.HeadProduct)]public async Task<ActionResult<ProductViewModel>> Get(int productId){    var product = await _genericGetters.GetByIdAsync(productId);    if (product == null)    {        return NotFound();    }    return product;}```### Expected behaviorIf `/// <response ...`  XML tags are used to state we return a 404, then the `Microsoft.AspNetCore.Mvc.Api.Analyzers` should not complain about it because this is official supported by Swashbuckle and the correct Swagger doc will in fact be generated. Just as it would by using `[SwaggerResponse]` and `[ProducesResponseType]`.### ScreenshotsIf applicable, add screenshots to help explain your problem.![image](https://user-images.githubusercontent.com/2934507/49542206-8da73e00-f89a-11e8-9518-f00d411e964f.png)### Additional contextTo see why I want this, it might be helpful to see this discussion I had with @domaindrivendev https://github.com/domaindrivendev/Swashbuckle.AspNetCore/issues/816#issuecomment-405442154
4438	area-tooling	Removed unused app component css file	Summary of the changes (Less than 80 chars) - Removed unused css for app component
4432	area-servers	Add an event log message when hostfxr load fails with bitness missmatch	Original issue: https://github.com/aspnet/AspNetCore/issues/4413
4431	area-servers	AV when loading of hostfxr fails and stdout is enabled	Original issue:https://github.com/aspnet/AspNetCore/issues/4413Seems to be a problem with `fileoutputmanager`**Debug logs**```[aspnetcorev2.dll] Initializing logs for 'C:\Program Files\IIS\Asp.Net Core Module\V2\aspnetcorev2.dll'. Process Id: 3296.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.[aspnetcorev2.dll] Resolving hostfxr parameters for application: '.\myproject.exe' arguments: '' path: 'C:\inetpub\sites\myproject-2.2-test\'[aspnetcorev2.dll] Known dotnet.exe location: ''[aspnetcorev2.dll] Process path '.\myproject.exe' is not dotnet, treating application as standalone or portable with bootstrapper[aspnetcorev2.dll] Checking application.dll at 'C:\inetpub\sites\myproject-2.2-test\.\myproject.dll'[aspnetcorev2.dll] Checking hostfxr.dll at 'C:\inetpub\sites\myproject-2.2-test\.\hostfxr.dll'[aspnetcorev2.dll] hostfxr.dll found app local at 'C:\inetpub\sites\myproject-2.2-test\.\hostfxr.dll', treating application as standalone[aspnetcorev2.dll] Parsed hostfxr options: dotnet location: '' hostfxr path: 'C:\inetpub\sites\myproject-2.2-test\.\hostfxr.dll' arguments:[aspnetcorev2.dll] Argument[0] = 'C:\inetpub\sites\myproject-2.2-test\.\myproject.exe'[aspnetcorev2.dll] c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\aspnetcore\handlerresolver.cpp:224 Operation failed with LastError: 193 HR: 0x800700c1[aspnetcorev2.dll] Failed HRESULT returned: 0x800700c1 at c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\aspnetcore\handlerresolver.cpp:80 [aspnetcorev2.dll] Event Log: 'Could not find inprocess request handler. Captured output from invoking hostfxr: ' End Event Log Message.[aspnetcorev2.dll] Failed HRESULT returned: 0x80070002 at c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\commonlib\fileoutputmanager.cpp:119 [aspnetcorev2.dll] Throwing ResultException for HRESULT 0x80070002 at c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\commonlib\fileoutputmanager.cpp:119 [aspnetcorev2.dll] Initializing logs for 'C:\Program Files\IIS\Asp.Net Core Module\V2\aspnetcorev2.dll'. Process Id: 7796.. File Version: 12.2.18316.0. Description: IIS ASP.NET Core Module V2. Commit: ce8cf65589734f82b0536c543aba5bd60d0a5a98.[aspnetcorev2.dll] Resolving hostfxr parameters for application: '.\myproject.exe' arguments: '' path: 'C:\inetpub\sites\myproject-2.2-test\'[aspnetcorev2.dll] Known dotnet.exe location: ''[aspnetcorev2.dll] Process path '.\myproject.exe' is not dotnet, treating application as standalone or portable with bootstrapper[aspnetcorev2.dll] Checking application.dll at 'C:\inetpub\sites\myproject-2.2-test\.\myproject.dll'[aspnetcorev2.dll] Checking hostfxr.dll at 'C:\inetpub\sites\myproject-2.2-test\.\hostfxr.dll'[aspnetcorev2.dll] hostfxr.dll found app local at 'C:\inetpub\sites\myproject-2.2-test\.\hostfxr.dll', treating application as standalone[aspnetcorev2.dll] Parsed hostfxr options: dotnet location: '' hostfxr path: 'C:\inetpub\sites\myproject-2.2-test\.\hostfxr.dll' arguments:[aspnetcorev2.dll] Argument[0] = 'C:\inetpub\sites\myproject-2.2-test\.\myproject.exe'[aspnetcorev2.dll] c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\aspnetcore\handlerresolver.cpp:224 Operation failed with LastError: 193 HR: 0x800700c1[aspnetcorev2.dll] Failed HRESULT returned: 0x800700c1 at c:\b\w\e37dd45d8cd1eaf4\src\iisintegration\src\aspnetcoremodulev2\aspnetcore\handlerresolver.cpp:80 [aspnetcorev2.dll] Event Log: 'Could not find inprocess request handler. Captured output from invoking hostfxr: ' End Event Log Message.```
5949	area-hosting	Unable to use ConfigureTestServices with StructureMap	I'm using structure map which means I have to configure my `ConfigureServices` method to return a `IServiceProvider` as per the example here: https://github.com/structuremap/StructureMap.Microsoft.DependencyInjection#example-1.ConfigureTestServices registers a `IStartupConfigureServicesFilter`  which results in the following exception:A ConfigureServices method that returns an IServiceProvider is not compatible with the use of one or more IStartupConfigureServicesFilter. Use a void returning ConfigureServices method instead or a ConfigureContainer method.This is thrown here: https://github.com/aspnet/Hosting/blob/cfe9b26a34af15c4943240d790ee5d1a168290c9/src/Microsoft.AspNetCore.Hosting/Internal/StartupLoader.cs#L185I'm trying to register a test authentication schema which as far as I can tell should be done via ConfigureTestServices, but I'm using structuremap so I'm not sure how else I can go about this. My customer app factory looks like this:    public class CustomWebApplicationFactory<TStartup>: WebApplicationFactory<TStartup> where TStartup : class    {        protected override void ConfigureWebHost(IWebHostBuilder builder)        {            builder.ConfigureTestServices(services => {                services.AddScheme<TestAuthenticationOptions, TestAuthentication>("Test", null);            });        }   }Is there any way to achieve this without putting some testing code in my primary website (the SUT)?
5395	area-signalr	3.0.0 Milestone Doc Checklist	Below are the docs (with associated issues for docs and/or product) we'll need to add for 3.0.0. - [ ] Java Streaming Support #2927, #3301 - [ ] Client to server streaming .NET and TS clients
4425	area-signalr	Update repo links for SignalR TS client in package.json after move	The SignalR TS client sources were moved to aspnet/AspNetCore, however this change hasn’t been reflected in `package.json` that is used for showing the readme and repository links on npmjs.com.
4950	area-mvc	ApiConvention Analyzer behaviour for Non-200 Success messages	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):1. Create WebApp with 2.2 and paste the repro controller from below2. Add the analyzer package Microsoft.AspNetCore.Mvc.Api.Analyzers3. Look at the suggestions/warnings![screenshot](https://user-images.githubusercontent.com/7989549/49509714-66df0c80-f886-11e8-9434-247674fc9e22.PNG)#### Description of the problem:The analyzer apparently does not accept 204 NoContent as a valid success status code for controller actions which do not directly create the ``ActionResult`` object in the action method.Instead it shows: API1001:API1001	Action method returns a success result without a corresponding ProducesResponseType.See Action ``Delete`` and Convention ``Delete``It apparently works if you create the ``ActionResult`` directly (Convention ``AnotherDelete``) or if you add StatusCode.200OK to the API conventions (Convention ``MoreDelete``).Whatever you do to handle 200OK, you should do the same for 204 and probably 201 too.Please ignore the async hints, they are not related.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:2.2Repro:<details>```csharpusing System.Threading.Tasks;using Microsoft.AspNetCore.Http;using Microsoft.AspNetCore.Mvc;using Microsoft.AspNetCore.Mvc.ApiExplorer;namespace ApiConventionsDeletebug.Controllers{    [Route("api/[controller]")]    [ApiController]    [ApiConventionType(typeof(MyConventions))]    public class ValuesController : ControllerBase    {        [HttpDelete("{id}")]        public Task<ActionResult> Delete(int id)        {            return DeleteInternal(id);        }        private async Task<ActionResult> DeleteInternal(int id)        {            return NoContent();        }        [HttpDelete("/another/{id}")]        public async Task<ActionResult> AnotherDelete(int id)        {            return NoContent();        }        [HttpDelete("/More/{id}")]        public Task<ActionResult> MoreDelete(int id)        {            return MoreDeleteInternal(id);        }        private async Task<ActionResult> MoreDeleteInternal(int id)        {            return Ok();        }    }    public static class MyConventions    {        [ProducesResponseType(StatusCodes.Status204NoContent)]        [ProducesResponseType(StatusCodes.Status404NotFound)]        [ProducesResponseType(StatusCodes.Status400BadRequest)]        [ProducesDefaultResponseType]        public static void Delete(            [ApiConventionTypeMatch(ApiConventionTypeMatchBehavior.Any)]            int id)        {        }        [ProducesResponseType(StatusCodes.Status204NoContent)]        [ProducesResponseType(StatusCodes.Status404NotFound)]        [ProducesResponseType(StatusCodes.Status400BadRequest)]        [ProducesDefaultResponseType]        public static void AnotherDelete(            [ApiConventionTypeMatch(ApiConventionTypeMatchBehavior.Any)]            int id)        {        }        [ProducesResponseType(StatusCodes.Status200OK)]        [ProducesResponseType(StatusCodes.Status404NotFound)]        [ProducesResponseType(StatusCodes.Status400BadRequest)]        [ProducesDefaultResponseType]        public static void MoreDelete(            [ApiConventionTypeMatch(ApiConventionTypeMatchBehavior.Any)]            int id)        {        }    }}```</details>
5666	area-mvc	Update to SDK 2.2.100 throws "An item with the same key has already been added. Key: .wasm"	I updated my Blazor project from `2.2.100-preview3-009430` to `2.2.100` release. I now get the following exception:```C#System.ArgumentException : An item with the same key has already been added. Key: .wasmStack Trace:   at System.Collections.Generic.Dictionary`2.TryInsert(TKey key, TValue value, InsertionBehavior behavior)   at System.Collections.Generic.Dictionary`2.Add(TKey key, TValue value)   at Microsoft.AspNetCore.Builder.BlazorApplicationBuilderExtensions.CreateContentTypeProvider(Boolean enableDebugging)   at Microsoft.AspNetCore.Builder.BlazorApplicationBuilderExtensions.UseBlazor(IApplicationBuilder app, BlazorOptions options)   at Microsoft.AspNetCore.Builder.ServerSideBlazorApplicationBuilderExtensions.UseServerSideBlazor[TStartup](IApplicationBuilder builder)   at OpenGraphTilemaker.Web.Server.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\Users\flynn\Projects\OpenGraphTilemaker\src\OpenGraphTilemaker.Web.Server\Startup.cs:line 36--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()   at Microsoft.AspNetCore.Hosting.Internal.WebHost.StartAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.TestHost.TestServer..ctor(IWebHostBuilder builder, IFeatureCollection featureCollection)   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateServer(IWebHostBuilder builder)   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.EnsureServer()   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateDefaultClient(DelegatingHandler[] handlers)   at Microsoft.AspNetCore.Mvc.Testing.WebApplicationFactory`1.CreateClient(WebApplicationFactoryClientOptions options)   at OpenGraphTilemaker.Web.Client.Tests.FunctionalTests.Get_EndpointsReturnSuccessAndCorrectContentType(String url) in C:\Users\flynn\Projects\OpenGraphTilemaker\tests\OpenGraphTilemaker.Web.Client.Tests\FunctionalTests.cs:line 25--- End of stack trace from previous location where exception was thrown ---```The line`app.UseServerSideBlazor<Client.Startup>();`seems to be the reason. Any suggestions?
4418	area-mvc	Using UrlHelper with ViewContext resulting in exceptions	### Describe the bugAfter `2.1` to `2.2` update some instances of `UrlHelper` started throwing `ArgumentOutOfRangeException: Index was out of range.` exceptions.This happens when `UrlHelper` is initialized using `ViewContext`, for example in a view```@(new UrlHelper(ViewContext).Action("Index"))```or `HttpContext````var action = new ActionContext(context, context.GetRouteData(), new ActionDescriptor());new UrlHelper(action).Action("Index");```Using the same with compatibility mode `Version_2_1` doesn't throw.```services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);```### To Reproduce[Repro project](https://github.com/Muchiachio/ViewRouting)### Expected behaviorIndex page shows `/`.### Additional context```.NET Core SDK (reflecting any global.json): Version:   2.2.100 Commit:    b9f2fa0ca8Runtime Environment: OS Name:     Windows OS Version:  6.1.7601 OS Platform: Windows RID:         win7-x64 Base Path:   C:\Program Files\dotnet\sdk\2.2.100\Host (useful for support):  Version: 2.2.0  Commit:  1249f08fed.NET Core SDKs installed:  2.1.500 [C:\Program Files\dotnet\sdk]  2.2.100 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]```
5665	area-mvc	Can I do this with client-side only programming with Balzor	Hello:I want to know if I can do this with client-side only programming with Blazor.I need to monitor a remote web site"www.randomNum.com", (a fake domain name), which has a lot of JavaScript scripts, one of them is like this one:<!doctype html><title>Simple Random Generator</title> <script type="text/javascript"> document.getElementById("CurrentNumber").innerHTML = Math.random().toString(); </script></html> The web site will from time to time run the JavaScript to show a random number on its web site, the time, when the script run is totally random. I want to write a C# project using Blazor client-side to monitor the web site and get the random numbers generated by the JavaScript.As most of documents I read about Blazor are talking about using Blazor to build a web site using .cshtml as file name extension.  But here, what I want to do, the server side is totally out of my control, I can only do some client-side job.I want to know if Blazor on client-side can do this or not? Like visit a remote web site, and  render the HTML contents, and listen to the DOM events, i.e. DOMContentLoaded, etc.If it is possible, it is better to show me some sample code here for my current question: to get the dynamic contents generated by JavaScript.I am using VS2017 Version 15.9.3 and latest Blazor version on Windows 10.If Blazor can't do this at the moment, please also advice if Blazor could do this in the future.  I don't think many people need to build a Web Server using C#, they could build a Web Server using JavaScript for the dynamic contents, which is standard way nowadays.  But I believe, many people could like to use .NET based browser to visit web sites built by other people.Thanks,
4417	area-mvc	Resolve root cause of `DefaultApplicationModelProviderTest` test failures	### Describe the bugThe following Mvc tests have been failing for about a week:```Microsoft.AspNetCore.Mvc.ApplicationModels.DefaultApplicationModelProviderTest.CreateActionModel_RouteOnController_CreatesOneActionInfoPerRouteTemplateOnAction(controller: typeof(Microsoft.AspNetCore.Mvc.ApplicationModels.DefaultApplicationModelProviderTest+MultipleRouteAttributeController))Microsoft.AspNetCore.Mvc.ApplicationModels.DefaultApplicationModelProviderTest.CreateActionModel_RouteOnController_CreatesOneActionInfoPerRouteTemplateOnAction(controller: typeof(Microsoft.AspNetCore.Mvc.ApplicationModels.DefaultApplicationModelProviderTest+SingleRouteAttributeController))```I'm going to skip the test method (has only these two cases) in #4415 to resolve all four test failures in src/Mvc.### To Reproduce1. checkout `master` branch in this repo or 3cfa6c0526 commit  - use commit once #4415 is in `master`2. `cd src/Mvc`3. `./build.sh` or `.\build.cmd`#### Expected behaviorClean build#### ActualThe two test failures listed above. (Well, see two more failures already fixed in #4415.)### Additional contextRoot cause seems to be a behaviour change in CoreFx. The failing assertion checks whether two `[HttpGet]` attributes on an action are both found. This used to work and no longer does.`dotnet --info`:```.NET Core SDK (reflecting any global.json): Version:   3.0.100-preview-009750 Commit:    84dcc2bfd8Runtime Environment: OS Name:     Windows OS Version:  10.0.17763 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Users\dougbu\.dotnet\x64\sdk\3.0.100-preview-009750\Host (useful for support):  Version: 3.0.0-preview1-27029-03  Commit:  631e219c26...Microsoft.AspNetCore.All 3.0.0-alpha1-10663 [C:\Users\dougbu\.dotnet\x64\shared\Microsoft.AspNetCore.All]...Microsoft.AspNetCore.App 3.0.0-alpha1-10663 [C:\Users\dougbu\.dotnet\x64\shared\Microsoft.AspNetCore.App]...Microsoft.DesktopUI.App 3.0.0-alpha-27113-1 [C:\Users\dougbu\.dotnet\x64\shared\Microsoft.DesktopUI.App]...Microsoft.NETCore.App 3.0.0-preview1-27029-03 [C:\Users\dougbu\.dotnet\x64\shared\Microsoft.NETCore.App]```Using KoreBuild `3.0.0-build-20181120.4`
4412	area-mvc	ParameterAttribute Inherited = true	Can 'Inherited' of ParameterAttribute be set to 'true'?It is useful to be able to use parameters with inherited classes.
4410	area-mvc	Mvc.Api.Analyzers not recognizing methods from a Base Class	My app use a Base Controller to reuse some methods inside my Api controllers.![image](https://user-images.githubusercontent.com/20740261/49484559-9f4b0000-f81e-11e8-8eb5-84a4043c29db.png)The MVC.API.Analyzer library is looking at my controllers that inherit from this base controller, trying to found undocumented reponse codes. That is correct.But, inside my Base Controller, I have undocument methods. The swagger UI shows me correctly all the inherited methods, but the analyzers could not point me that I am missing something.The Controller that inherits from BaseController and its swagger doc. Correct.![image](https://user-images.githubusercontent.com/20740261/49484659-fc46b600-f81e-11e8-85c0-9b71308f70f3.png)![image](https://user-images.githubusercontent.com/20740261/49484631-e20cd800-f81e-11e8-8de6-0cbe9e1e18ff.png)The Base Controller. Wrong. (Im missing documentation for NotFound and BadRequest)![image](https://user-images.githubusercontent.com/20740261/49484503-6dd23480-f81e-11e8-9ce7-3f58133419fa.png)Any help on that??
4401	area-signalr	Fail Hub method invocation if stream sent from client to non-stream method	From https://github.com/aspnet/AspNetCore/pull/4300#discussion_r238765830If a client does:```var channel = new Channel.CreateUnbounded<string>();connection.SendAsync("Method", channel.Reader);```to a hub like below```class C{}class MyHub : Hub{    void Method(C c) { }}```the method will successfully be called even though the client is wanting to stream to the server. We should make this return an error to the client.
4400	area-signalr	Check HubConnection state before running invoke logic	Before calling methods that require the HubConnection to be connected we run a simple connection state check like https://github.com/aspnet/AspNetCore/blob/e310ccac7b30e901f657f81c86c4048fecfedf7b/src/SignalR/clients/java/signalr/src/main/java/com/microsoft/signalr/HubConnection.java#L464-L466Addresses #4393### DescriptionBefore being able to send invocations from a SignalR hub, it's important that we ensure that the current HubConnection is active and in the connected state. If the HubConnection isn't connected we should fail immediately without attmepting to send any invocations. Otherwise we could run into a case where users can write the connected```javaHubConnection hubConnection = new HubConnectionBuilder.create("Some hub url");// There should be an awaited call to start before invoke.hubConnection.invoke(String.class, "hubMethod", "arg")```### Customer ImpactWith this change, when a customer tries to invoke a hub method when their client is not connected, they will get a helpful error message letting them know that they are in the disconnected state.### RegressionN/A### RiskLow. This is purely a defensive change. We woul be adding a check to the HubConnection state before continuing to the rest of the invoke logic to ensure that we fail fast with a helpful error message. This also has an associate test. 
4399	area-signalr	Use a bounded channel for client->server streaming	Currently there is an unbounded channel on the server used for the client->server streaming.https://github.com/aspnet/AspNetCore/blob/e310ccac7b30e901f657f81c86c4048fecfedf7b/src/SignalR/src/Microsoft.AspNetCore.SignalR.Core/StreamTracker.cs#L81We should add some sort of bounds so if the client sends too fast it will get back-pressured.
4393	area-signalr	Need to check HubConnectionState for calls to Invoke	Before calling methods that require the HubConnection to be connected we run a simple connection state check like https://github.com/aspnet/AspNetCore/blob/e310ccac7b30e901f657f81c86c4048fecfedf7b/src/SignalR/clients/java/signalr/src/main/java/com/microsoft/signalr/HubConnection.java#L464-L466We don't have this check for the `invoke` method. 
5664	area-mvc	Populate JSRuntime.Current before invoking Startup.ConfigureServices	I have a library project that needs to do some initialization is the host project's Startup.cs that includes using javascript. This used to work prior to the JS syntax change. Now, however, JSRuntime.Current is null. I created a reproduction of the problem here: https://github.com/chanan/JSRuntimeRepro
4691	area-servers	BadHttpRequestException : Microsoft.AspNetCore.Server.Kestrel.Core : Request timed out. (Mvc Web Controller)	**Please find Detail Stack Trace Below****We have hosted our application with Load balancer.**>  at   Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.PipeCompletion.ThrowFailed()   at Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.Pipe.GetResult(ReadResult&   result) at   Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.Pipe.Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.IReadableBufferAwaiter.GetResult()   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.MessageBody.d__22.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at   Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.FrameRequestStream.d__21.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at   System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()   at System.IO.StreamReader.d__65.MoveNext() --- End of stack   trace from previous location where exception was thrown --- at   System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at System.Runtime.CompilerServices.ConfiguredTaskAwaitable`1.ConfiguredTaskAwaiter.GetResult()   at System.IO.StreamReader.d__63.MoveNext() --- End of   stack trace from previous location where exception was thrown --- at   System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.WebUtilities.FormReader.d__41.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.WebUtilities.FormReader.d__34.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.WebUtilities.FormReader.d__43.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.Http.Features.FormFeature.d__18.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.Mvc.ModelBinding.FormValueProviderFactory.d__1.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.d__3.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.d__2.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at   Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<g__Bind\|0>d.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.d__14.MoveNext()   --- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw() at   System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task   task) at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.d__23.MoveNext()**Thanks in Advance..**
4388	area-servers	When returning 205 it works with IISExpress, but takes 2 minutes with commandName": "Project"	When returning a 205 from an Api with return StatusCode(205); the Api hangs when using it from the cli, but works fine when using IISExpress. It works for the CLI when you change it to StatusCode(205, null).To reproduce is very simple.1. Create a new Api in VS 20172. Change the ValuesController to     [HttpGet]        public ActionResult<IEnumerable<string>> Get()        {            //return new string[] { "value1", "value2" };            return StatusCode(205);        }3. Launch it via IISExpress and call the end point, it will respond normally, as expected.4. Launch it via the CLI, either by launching WebApplication1 in VS, or dotnet run. It will take up to 2 minutes to respond.5. Change return StatusCode(205); to return StatusCode(205, null); and repeat step 4, it will now work as normal
4387	area-signalr	[SignalR/Java] JCenter version information not synchronized with Maven Central	A version of SignalR appears as a listing on [Bintray's JCenter](https://bintray.com/bintray/jcenter/com.microsoft.signalr%3Asignalr/1.0.0-preview3-35501). However it is very out of date and missing some important fixes. The latest version that appears there is `v1.0.0-preview3-35501`I do realise that I can just pull from central, but it was quite misleading seeing the package present in JCenter (I actually set up a private CD pipeline to publish Signal R to our maven before I realised it was in central).  It would probably be a good idea to either pull the listing, or ensure it's synchronized with Maven Central. 
4384	area-security	3.0 ForgotPassword regression in AzureB2C templates	https://github.com/aspnet/Security/pull/1887 added a new AccessDenied feature that breaks the ForgotPassword flow from 2.2.From @Tratcher Ah, this was a new feature to standardize error responses: https://github.com/aspnet/Security/pull/1887It looks like B2C used to handle this error themselves in OnRemoteFailure. This logic would need to move to the new OnAccessDenied event.https://github.com/aspnet/AspNetCore/blob/c7d63649005c4c2863b34794994eef57595e7bb7/src/AADIntegration/src/Microsoft.AspNetCore.Authentication.AzureADB2C.UI/AzureAdB2COpenIDConnectEventHandlers.cs#L68
4382	area-servers	Setting an invalid Transfer-Encoding response header sometimes kills the connection instead of responding with a 500 status	### Describe the bugSetting a Transfer-Encoding response header which is invalid for a given request or response (e.g. 204/205/304 responses and HEAD requests) without manually writing to or flushing the response body kills the connection instead of responding with a 500 status code.### To ReproduceSteps to reproduce the behavior:1. Targeting ASP.NET Core 2.2 (though this bug likely existed earlier), add the following middleware:```C#app.Run(context =>{    context.Response.StatusCode = 204;    context.Response.Headers["Transfer-Encoding"] = "chunked";    return Task.CompletedTask;});```2. Run the app and test the endpoint by making a GET request. If you have a project reference to Kestrel.Core, make sure you run the app in release mode to avoid a Debug.Assert.4. See a connection reset error.### Expected behaviorA 500 response. This can be observed if you make a slight change to the above middleware to manually flush the response body:```C#app.Run(context =>{    context.Response.StatusCode = 204;    context.Response.Headers["Transfer-Encoding"] = "chunked";    return context.Response.Body.FlushAsync();});```### Additional contextHere are what the server logs look like when this bug is hit:```dbug: Microsoft.AspNetCore.Server.Kestrel[1]      Connection id "0HLIPIMQJ59NK" started.dbug: Microsoft.AspNetCore.Server.Kestrel[1]      Connection id "0HLIPIMQJ59NL" started.info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET http://localhost:5000/fail: Microsoft.AspNetCore.Server.Kestrel[13]      Connection id "0HLIPIMQJ59NK", Request id "0HLIPIMQJ59NK:00000001": An unhandled exception was thrown by the application.System.InvalidOperationException: Setting the header Transfer-Encoding is not allowed on responses with status code 204.warn: Microsoft.AspNetCore.Server.Kestrel[0]      Connection processing ended abnormally.System.InvalidOperationException: StatusCode cannot be set because the response has already started.   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ThrowResponseAlreadyStartedException(String value) in C:\dev\aspnet\AspNetCore\src\Servers\Kestrel\Core\src\Internal\Http\HttpProtocol.cs:line 1209   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.set_StatusCode(Int32 value) in C:\dev\aspnet\AspNetCore\src\Servers\Kestrel\Core\src\Internal\Http\HttpProtocol.cs:line 207   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.SetErrorResponseHeaders(Int32 statusCode) in C:\dev\aspnet\AspNetCore\src\Servers\Kestrel\Core\src\Internal\Http\HttpProtocol.cs:line 1245   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.CreateResponseHeader(Boolean appCompleted) in C:\dev\aspnet\AspNetCore\src\Servers\Kestrel\Core\src\Internal\Http\HttpProtocol.cs:line 1171   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProduceEndAwaited()   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application) in C:\dev\aspnet\AspNetCore\src\Servers\Kestrel\Core\src\Internal\Http\HttpProtocol.cs:line 597   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application) in C:\dev\aspnet\AspNetCore\src\Servers\Kestrel\Core\src\Internal\Http\HttpProtocol.cs:line 465dbug: Microsoft.AspNetCore.Server.Kestrel[10]      Connection id "0HLIPIMQJ59NK" disconnecting.dbug: Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets[7]      Connection id "0HLIPIMQJ59NK" sending FIN because: "The Socket transport's send loop completed gracefully."dbug: Microsoft.AspNetCore.Server.Kestrel[2]```
4373	area-mvc	Mvc.Analyzers are no longer imported in 3.0 projects	As a part of #4061 and #3612, we removed Microsoft.AspNetCore.Mvc.Analyzers from Microsoft.AspNetCore.App since we do not plan to continue to ship AspNetCore.App as a metapackage. We should find a way to re-add these analyzers to netcoreapp3.0 projects.**Ideas*** Ship as a PackageReference. Projects must reference as a package   * Add the PackageRef to templates?   * Make the PackageRef implicit in the WebSDK?* Or, work with the SDK team to ship analyzers in-box without a package reference.cc @davidfowl @pranavkm @mkArtakMSFT 
4370	area-infrastructure	Ensure all of the SignalR client's dependencies are available on netstandard2.0 	In manually reviewing the list of packages we are shipping in 3.0 Preview 1, it appears we may be missing some dependencies required by the SignalR client in non-shared-framework scenarios.**Requirements*** Verify that all of Microsoft.AspNetCore.SignalR.Client's dependencies  - [ ] target netstandard2.0  - [ ] ship as packages* Add tooling to test for this scenario automaticallyNotably, it appears we need to fix the packaging for Microsoft.AspNetCore.Connections.Abstractions.cc @davidfowl 
5394	area-signalr	Cannot return public class with only internal constructors using MessagePack	If a SignalR hub has a method which returns a type which is public, but has only internal constructors, it fails silently, yielding no error messages on the server side nor on the client side. No exceptions are thrown. Nothing in the debug output window.Consider the following classes:```    public class ApiLogin    {        internal ApiLogin(...)        {            ...        }        public byte[] PrivateDetailsCiphertext { get; set; }    }    public class ApiLoginWithToken : ApiLogin    {        internal ApiLoginWithToken(...) : base(...)        {            ...        }        public byte[] Token { get; set; }    }```And the following hub method:`public ApiLoginWithToken LogIn(string username, string password) => new ApiLoginWithToken(...);`Fails silently.To get it working, I had to add a couple of public constructors.Assuming this has to do with reflection. Strictly speaking, the MessagePack component shouldn't have to know about constructors to serialize an existing instance. In any case, I would like to suggest that an error message should be displayed somewhere if something goes wrong :)Microsoft.AspNetCore.SignalR.Protocols.MessagePack, version 1.0.4
4366	area-mvc	Getting null values in API while using RestSharp on version 2.1.6	I'm using AspNetCore v.2.1.6 as an API app and when I try to send data through RestSharp, the parameters of a method are always being received as null. This don't happen when I use a client generated with AutoRest or AspNetCore v2.0, but I need to use RestSharp because my specific request size is too long and the last version of AspNetCore available. By the way, I'm testing the petition in a console app.Petition Code:        static void Main(string[] args)        {            Console.Write("id:");            var id = Console.ReadLine();            Console.Write("picture:");            var picture = Console.ReadLine();            RestClient _restClient = new RestClient("http://localhost:1012");            RestRequest request = new RestRequest("/api/SuperUser/UpdateProfilePicture", Method.PUT);            request.AddParameter("id", id);            request.AddParameter("picture", picture);                       var res = _restClient.Execute(request);            Console.WriteLine(res.Content);            Console.ReadKey();        }API Method:        [HttpPut]        [Route("UpdateProfilePicture")]        [Produces("application/json", Type = typeof(bool))]        [SwaggerOperation(OperationId = "SuperUserUpdateProfilePicture")]        public bool UpdateProfilePicture(Guid id, string picture)        {            SuperUser su = _repository.Get(id);            if (su != null)            {                su.ProfilePicture = picture;                return _repository.Edit(su); //This update the user and return a boolean.            }            else            {                return false;            }        }Parameters Sent:![console](https://user-images.githubusercontent.com/45568290/49384853-b1cc1900-f6fa-11e8-8055-895fb720e7f2.PNG)Result:![response](https://user-images.githubusercontent.com/45568290/49384876-bee90800-f6fa-11e8-8a73-61063c813ac2.png)
4365	area-mvc	WebAssembly-specific issue : chrome run 1 hour later , crash	### Describe the bugI use js interop , and memory still growth.1:c# code```<input type="button" class="btn btn-primary" onclick="Operate(this)" value="开始" /><div id="JsonContent">    </div>@functions {    static Rectifyf.FlowsheetBase Rectifyf = new Rectifyf.FlowsheetBase();    static Type t;    public static string result;    public static int total = 0;    protected override async Task OnInitAsync()    {        t = Rectifyf.GetType();    }    protected override void OnAfterRender()    {        base.OnAfterRender();    }    [JSInvokable]    public static string RUNRectifyf()    {        Rectifyf.Run();        result = "";        total = 0;        PropertyInfo[] pro2 = t.GetProperties();        foreach (PropertyInfo item in pro2)        {            string FieldName = item.Name;            PropertyInfo property = t.GetProperty(FieldName);            object o = property.GetValue(Rectifyf, null);            string Value = Convert.ToString(o);            if (property.PropertyType.Name.Contains("[]"))            {                Value = "";                double[] a = o as double[];                for (int i = 0; i < a.Length; i++) {                    Value += a[i] + ",";                }            }            result += item.Name + "--->" + item.MemberType + "--->" + item.PropertyType +"--->"+ Value +";";            total += 1;        }        return result;    }}```2: Javascript code```var count = 0; var GO;var r = function sfRun() {    window.clearTimeout(GO)    DotNet.invokeMethodAsync("BlazorApp1", 'RUNRectifyf').then(function (parm) {        count++;        $("#JsonContent").html(parm);        GO = window.setTimeout(function () {            r();        }, 500);            });}function Operate(obj) {    r();}```when I run my chrome , the memory still growth.maybe setTimeout function create a lot of DotNet, how to fix it?maybe it is out of memory, not memory leak?https://github.com/mono/mono/issues/10250
4364	area-servers	web.config is automatically modified to include <environmentVariables />	### Describe the bugThe `web.config` file for an ASP.NET Core project keeps being modified to insert a `<environmentVariables />` node and apply formatting.### To ReproduceI'm using Visual Studio 15.9.3 and the Microsoft.AspNetCore 2.1.3 package.When cleaning, building or rebuilding the solution, changes are automatically applied to the existing `web.config` file.This is the original file, it should be very similar or even identical to the default web.config file created by Visual Studio at some point in the past.```xml<?xml version="1.0" encoding="utf-8"?><configuration>  <!-- To customize the asp.net core module uncomment and edit the following section.   For more info see https://go.microsoft.com/fwlink/?linkid=838655 -->    <system.webServer>    <handlers>      <remove name="aspNetCore"/>      <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModule" resourceType="Unspecified"/>    </handlers>    <aspNetCore processPath="%LAUNCHER_PATH%" arguments="%LAUNCHER_ARGS%" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" />  </system.webServer>  </configuration>```This is the modified file:```xml<?xml version="1.0" encoding="utf-8"?><configuration>  <!-- To customize the asp.net core module uncomment and edit the following section.   For more info see https://go.microsoft.com/fwlink/?linkid=838655 -->  <system.webServer>    <handlers>      <remove name="aspNetCore" />      <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModule" resourceType="Unspecified" />    </handlers>    <aspNetCore processPath="%LAUNCHER_PATH%" arguments="%LAUNCHER_ARGS%" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout">      <environmentVariables />    </aspNetCore>  </system.webServer></configuration>```### Expected behaviorThe `web.config` file is not modified.### Additional contextThis issue is quite similar to a long-standing issue with NuGet, where automatic formatting is applied to the entire `web.config` file upon installing/updating a package. Perhaps NuGet also has something to do with this issue.
5663	area-mvc	Remove comments from html markup	When Blazor is building the html it also builds unnecessary comments along with the html tags.![image](https://user-images.githubusercontent.com/900302/49376286-10978f80-f707-11e8-90a2-57b782ad6c8b.png)Is there an option to turn this off? Or is it on your road-map to fix this?
4359	area-mvc	TempData is lost if using serviseworker preload navigationPreload.enable()	TempData is lost if using serviceworker preloadmakes two hits on index.cshtml but TempData is null on bothi use session instead         async function () {                // Feature-detect                if (self.registration.navigationPreload) {                    // Enable navigation preloads!                    await self.registration.navigationPreload.enable();                }            }(),
5662	area-mvc	Blazor server-side publish docker image failure	I am trying to publish a docker image of my blazor SSR app but i get this error when running buildError		The "Microsoft.AspNetCore.Razor.Tasks.RazorTagHelper" task could not be loaded from the assembly /root/.nuget/packages/microsoft.aspnetcore.razor.design/2.1.1/build/netstandard2.0/../../tasks/netstandard2.0/Microsoft.AspNetCore.Razor.Tasks.dll. Assembly with same name is already loaded Confirm that the <UsingTask> declaration is correct, that the assembly and all its dependencies are available, and that the task contains a public class that implements Microsoft.Build.Framework.ITask. [/src/testapp/testapp.Server.csproj]	The command '/bin/sh -c dotnet build "testapp.Server.csproj" -c Release -o /app' returned a non-zero code: 1C:\Users\agonzalez\.nuget\packages\microsoft.visualstudio.azure.containers.tools.targets\1.0.1916590\build\Container.targets(132,5): Error MSB3073: The command "docker build -t "testapp" -f "Dockerfile" ".."" exited with code 1.
5661	area-mvc	Move MainLayout to another folder	I use Blazor as server variant. If I put the file MainLayout.cshtml into another folder, the old namespace is still used in the .g.cs files. Creating a different layout file also seems to lead to the fact that it has to be present in the shared folder. 
5660	area-mvc	OrderbyDescending on AsQueryable throws exception	When I try use OrderByDescending on AsQueryable I receive the error message below.When I use OrderBy the code executes perfectly.  I stumbled onto this because I needed to pass an expression in my orderbyDescending and cannot do that on a list.blazor.webassembly.js:1 Uncaught (in promise) Error: System.NullReferenceException: Object reference not set to an instance of an object.  at Microsoft.JSInterop.DotNetDispatcher.InvokeSynchronously (System.String assemblyName, System.String methodIdentifier, System.Object targetInstance, System.String argsJson) <0x1f50b28 + 0x001b8> in <af36ed9192be4a95b907125ccf0c1e59>:0   at Microsoft.JSInterop.DotNetDispatcher.BeginInvoke (System.String callId, System.String assemblyName, System.String methodIdentifier, System.Int64 dotNetObjectId, System.String argsJson) <0x1f88730 + 0x00084> in <af36ed9192be4a95b907125ccf0c1e59>:0   at Microsoft.JSInterop.DotNetDispatcher.InvokeSynchronously (System.String assemblyName, System.String methodIdentifier, System.Object targetInstance, System.String argsJson) <0x1f50b28 + 0x001b8> in <af36ed9192be4a95b907125ccf0c1e59>:0   at Microsoft.JSInterop.DotNetDispatcher.BeginInvoke (System.String callId, System.String assemblyName, System.String methodIdentifier, System.Int64 dotNetObjectId, System.String argsJson) <0x1f88730 + 0x00084> in <af36ed9192be4a95b907125ccf0c1e59>:0     at endInvokeDotNetFromJS (blazor.webassembly.js:1)    at Object.invokeJSFromDotNet (blazor.webassembly.js:1)    at _mono_wasm_invoke_js_marshalled (mono.js:1)    at wasm-function[1450]:935    at wasm-function[762]:25085    at wasm-function[762]:23853    at wasm-function[762]:23853    at wasm-function[762]:23853    at wasm-function[762]:24468    at wasm-function[762]:24468My workaround for now is to perform a reverse on the List after the order by is called.For example: AsQueryable().OrderBy(expression).ToList().Reverse().ToList()
4355	area-tooling	Anchors in default _Layout should specify empty area	The automatically generated _Layout.cshtml contains anchor tags without specified area. This leads to inconsistent behavior of the Home and "AppName" links in the navigation bar when the default layout is used in areas. if they have a page named "Index". In this case, the anchor links to the main home page are modified to point to the area page.Steps to reproduce:1. Create an empty App with Razor Pages2. Add an area3. Add a page called Index to the Pages subfolder of the area, using the _Layout.cshtml in /Pages/Shared4. Navigate to the area5. Check the "Home" link in the navigation bar. It points to localhost/AreaName/ rather than to localhostA possible solution would be to explicitly specify asp-area="" in all anchors in /Pages/Shared/_Layout.cshtml. Identity seems to work around the issue by changing the path to the Index page, but that isn't a workable solution for areas in general.
5841	area-identity	RoleStore missing in AspNetCoreCompat	Is there a reason that [AspNetCoreCompat](https://github.com/aspnet/Identity/tree/master/src/AspNetCoreCompat) does not contain RoleStore<T> ?There is an implementation for `UserStore<T>`, `IdentityUser` and `IdentityRole` but not `RoleStore<T>`I actually have only a handful of users, so I could technically hardcode their user IDs - but I'm wondering if there's a reason it is not there.
5659	area-mvc	Multiple blazor apps in single website	I would like to be able to host multiple blazor apps in my website (at different base path).The idea is to provide multiple downloadable PWA apps and the user will be able to download one or more of them. I am currently using angular to do this. I would like to switch to blazor.
4351	area-servers	Create response body PipeWriter by decorating Kestrel's connection PipeWriter	This is the analogue of https://github.com/aspnet/KestrelHttpServer/issues/2340 but for the response.
4350	area-infrastructure	Enable Autobahn Test Suite on PR Validation	Currently our PR validation is skipping the Autobahn tests because it's missing the installation step. This is the [set up script that was being used before.](https://github.com/aspnet/AspNetCore/blob/master/src/Middleware/WebSockets/setup-wstest.ps1).We need to be able to install Python, then use pip to install the autobahntestsuite pacakge to be able to run the tests.
4344	area-servers	Cleanup remaining issues in StreamPipeReader/StreamPipeWriter	There are a few more issues that need to be addressed:- [ ] Add MaxBufferSize setting- [ ] OnReaderCompleted- [ ] OnWriterCompleted- [ ] Throw on overlapping Reads/Flush- [ ] Refactor ReadAsync to avoid an extra async state machine.- [ ] Creating a new tail segment if we have consumed a certain percentage of the segment.- [ ] Remove _completedSegments.RemoveAt(0); from StreamPipeWriter
4339	area-infrastructure	Switch package versions to SemVer 2.0	In 3.0, most other .NET Core packages have started using semver 2.0. This solves a common problem with semver v1, which sorts pre-release labels alphabetically instead of numerically. We've worked around this by zero padding, but still occasionally get this wrong.e.g. (semver 2) `3.0.0-preview.18572.1` vs (semver 1) `3.0.0-preview-18572-01`Depends on https://github.com/dotnet/core-setup/issues/4795**Requirements**- [ ] We used semver v1 in 3.0 preview 1. Ensure NuGet, npm, and Maven would sort preview 2 packages higher. e.g. ensure `3.0.0-preview.18580.1` > `3.0.0-preview-18579-0056`- [ ] Make sure corehost can handle semver2 - tracking https://github.com/dotnet/core-setup/issues/4795- [ ] Ensure Maven supports semver2.  If not, keep versioning .jar's with semver v1- [ ] Ensure npm supports semver2. If not, keep versioning npm packages with semver v1
5658	area-mvc	HTML-only templates or plugin-based templating engine	Blazor should remove the use of C# within the HTML templates and move to pure HTML Attribute logic like angular/vuejs/knockout.*Note: This is a follow-up action after asking for vuejs/angular-style templates during the community standup a while back [https://youtu.be/CWuIz9khK-o?list=PL1rZQsJPBU2StolNg0aqvQswETPcYnNKL&t=3857] (I know it was a super long time ago 🤦‍♂️ )My intent isn't to copy other popular frameworks but to take the learnings and knowledge that MS already has when developing UI frameworks. Notably the shift to having a declarative language like XAML which uses data binding on attributes like 'ItemSource' or 'Visibility' instead of allowing code to reside inside those templates. It promotes the separation of business logic from residing within the template and makes it more readable for programmers/designers. In the field, I've observed that pure web designers on teams are often discouraged or restricted from committing changes to templates that have languages injected into them which makes them more dependent on developers to make cosmetic changes. Personally, I don't enjoy having two languages in the same file (even in vuejs or angular) and wish it followed the XAML/XAML.cs style. On the other hand, I understand the convenience of having them within the same file, but I do not agree with mixing the languages (one of the main reasons I don't prefer react).I understand that Blazor uses the Razor templating engine and we are currently restricted to what it offers. IMO, since Razor templates only work on the server, I would relate them to server-side frameworks like jinja2 or Django templates. These frameworks address a different use case of back-end engineers optionally sending parts of HTML to the client and doesn't tool for SPAs. I understand the convience of using it as the engine but I do not think its practices migrate well to a client UI framework.Since there seems to be a strong tension to have a story for migrating Razor users and templates to Blazor, I would suggest investing in a layer of abstraction where other template engines may be exchanged from the one out of the box. I'd personally invest a large quantity of development time to make sure that a pure attribute option become available.
4949	area-mvc	TLS errors when using Microsoft.AspNetCore.Mvc.Testing	I don't know if this is a bug or if I'm doing something wrong but I've set up a WebApplicationFactory in my integration tests and from Visual Studio and "my" machine it works as it should, all tests pass. I can also run "dotnet test" and it's also working.When running on our build agent (Windows Server 2012R2) and I run the "dotnet test" command all testing freezes and at the same time the Event Log on the build agent is flooded with:`A fatal alert was received from the remote endpoint. The TLS protocol defined fatal alert code is 40.`dotnet grabs all CPU and I have to kill the process.Output from build server when running:```[16:10:42]	[test] Starting: "C:\Program Files\dotnet\dotnet.exe" test C:\BuildAgent\work\d2beb955800eba5e\src\IntegrationTests\IntegrationTests.csproj @C:\BuildAgent\temp\agentTmp\58b6fbf5329e49a6b20b095a9e5e5d41.rsp[16:10:42]	[test] in directory: C:\BuildAgent\work\d2beb955800eba5e[16:10:47]	[test] Build started, please wait...[16:10:50]	[test] Build completed.[16:10:50]	[test] [16:10:50]	[test] Test run for C:\BuildAgent\work\d2beb955800eba5e\src\IntegrationTests\bin\Debug\netcoreapp2.1\IntegrationTests.dll(.NETCoreApp,Version=v2.1)[16:10:50]	[test] Microsoft (R) Test Execution Command Line Tool Version 15.9.0[16:10:50]	[test] Copyright (c) Microsoft Corporation.  All rights reserved.[16:10:50]	[test] [16:10:50]	[test] Starting test execution, please wait...[16:10:53]	[test] NUnit Adapter 3.11.2.0: Test execution started[16:10:53]	[test] Running all tests in C:\BuildAgent\work\d2beb955800eba5e\src\IntegrationTests\bin\Debug\netcoreapp2.1\IntegrationTests.dll[16:10:54]	[test]    NUnit3TestExecutor converted 2 of 2 NUnit test cases```And debug log from NUnit 3.11 when "stuck" is:```TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:35.386, 1712926046472, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:36.404, 1712928432250, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:37.417, 1712930806948, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:38.419, 1712933155180, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:39.429, 1712935523193, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:40.441, 1712937893269, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:41.453, 1712940265099, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:42.464, 1712942636119, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450TpTrace Verbose: 0 : 2652, 7, 2018/11/29, 22:28:43.485, 1712945027550, testhost.dll, TcpClientExtensions.MessageLoopAsync: Polling on remoteEndPoint: 127.0.0.1:55449 localEndPoint: 127.0.0.1:55450```I'm using .net core 2.1 and Microsoft.AspNetCore.Mvc.Testing 2.1.3.dotnet --info output```.NET Core SDK (reflecting any global.json): Version:   2.1.500 Commit:    b68b931422Runtime Environment: OS Name:     Windows OS Version:  6.3.9600 OS Platform: Windows RID:         win81-x64 Base Path:   C:\Program Files\dotnet\sdk\2.1.500\Host (useful for support):  Version: 2.1.6  Commit:  3f4f8eebd8.NET Core SDKs installed:  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.500 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]To install additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download```
4332	area-mvc	Referencing 3.0 RCL project from 3.0 Web App results in 404	### Describe the bugAdd a Razor Class Library(RCL) and reference from Web App 3.0, then run the project got 404 error.### To ReproduceREPRO STEPS1. File > New Project > C# > ASP.NET Core Web Application > .NET Core ~ ASP.NET Core 3.0 > Web Application > NoAuth2. Right click the solution > Add > New project > ASP .NET Core Web Application > .NET Core ~ ASP.NET Core 3.0 > Razor Class Library3. Paste in Page1.cshtml file with the following code:   <h2>Hello World</h2>4. Right click the Razor ClassLib project to build it5. Right click the Web App project and select Add > Reference. In the Reference Manager dialog, check the Razor Class Library project > OK6. Rebuild solution and run the Web App project, navigate to /MyFeature/Page1 in a web browserA 404 error page shows up.![image](https://user-images.githubusercontent.com/34246760/49297381-7ec22500-f46f-11e8-9cf1-103e00e4049d.png)### Expected behaviorThe page loads just fine### Screenshots![image](https://user-images.githubusercontent.com/34246760/49297404-8c77aa80-f46f-11e8-9df6-81216872e77f.png)### Additional contexthttps://devdiv.visualstudio.com/DevDiv/_workitems/edit/738297
5657	area-mvc	[Suggestion] Add ability to rename Context in component itself	An attribute along the lines of```[Context="Item"]@SomeRenderFragment(someVariable)```would make the page using the component way cleaner in my opinion.
4329	area-signalr	Fix missing submodule	
5656	area-mvc	Component does not update DOM on a specific scenario	With the following component I'm trying to apply a transformation to the value in the input. The actual use case is more complicated and makes more sense but this is the simplest repro I could come up with.Reproduction steps:1. Enter a lowercase string in the input, e.g. "asd"1. Result: the string in the input is turned into its uppercase equivalent and the Message is updated correctly.1. Enter the **same** lowercase string in the input. _Notice that entering any other string works as expected._Expected:The string in the input **is turned into its uppercase equivalent** and the message is updated correctly.Actual:The string in the input **remains unchanged** and the message is updated correctly.```@page "/repro"<input type="text" bind="@RawValue" /><div>    Message: @Message</div>@functions{    protected string Message { get; set; }    protected int Count { get; set; }    private string _rawValue;    protected string RawValue    {        get => _rawValue;        set        {            _rawValue = value?.ToUpperInvariant();            Message = $"_rawValue was set to {_rawValue}. {Count++}";            StateHasChanged(); // I don't think this is necessary but I've added it trying to solve the problem. It still doesn't work without this line.        }    }}```It seems to me there is something wrong but please let me know if it's by design, in which case, could you also please explain how to achieve the behavior I want.
4321	area-tooling	Run Templating tests on PR-validation builds	Currently tests for Templating are not run on PR-validation builds because it requires the [previous shared runtime](https://github.com/aspnet/AspNetCore/blob/0cbfa9ce6dd03829199977bf8855021580c3171d/build/RepositoryBuild.targets#L74), which is not installed.It would be really good to start running those tests so templating can get test coverage on its PR's like anything else.
4320	area-mvc	View discovery is broken for 3.0 (F# only)	Steps:Get latest SDK from https://dotnetcli.blob.core.windows.net/dotnet/Sdk/master/dotnet-sdk-latest-win-x64.exe. Currently it is 3.0.100-preview-009806.dotnet new mvc -lang F#dotnet runNavigate to https://localhost:5001Expected:Index page loads successfullyActual:![image](https://user-images.githubusercontent.com/1579269/49051717-d590db80-f19d-11e8-80a0-df521406b863.png)Also for dotnet new webapp, I get a 404 when navigating to https://localhost:5001Originally filed:https://devdiv.visualstudio.com/DevDiv/_workitems/edit/733888
5655	area-mvc	[Suggestion] Better components inheritance	First let me explain my problem.I have a `Field `component inside of _MyComponents_ library. All it contains is just a basic div. For example:`Field.cshtml` in _MyComponents_```@inherits Base.BaseField<div class="@ClassMapper.Class">    @ChildContent</div>```Everything good so far, it renders, and it's all good.BUT, here is the problem, if I want to extend the Field component in another components library, let's say that this time I want it to contain a `Label`. I cannot do that. If I wan't custom logic in this new library then I must create a new `Field.cshtml` and write everything, than I have to delete `Field` from by base _MyComponents_ library because it will mess with the new component.This is an implementation of `Field.cshtml` in _MyComponents.Bootstrap_ library:```@inherits BootstrapBase.BaseBootstrapField<div class="@ClassMapper.Class">    @if ( Label != null )    {        <FieldLabel>@Label</FieldLabel>    }    @ChildContent</div>```It would be great If for example I could just inherit Field automatically, maybe if both libraries share the same component names that they would combine.I propose two way how to do it. Maybe :)First, here is the main `Field.cshtml` in _MyComponents_```@inherits Base.BaseField<div class="@ClassMapper.Class">    @ChildContent</div>```**Suggestion 1**: do it automatically based on the component name`Field.cshtml` in _MyComponents.Bootstrap_```@if ( Label != null ){    <FieldLabel>@Label</FieldLabel>}@ChildContent```**Suggestion 2**: explicitly say that it is inherited from `Field.cshtml` in _MyComponents.Bootstrap_```@inherits MyComponents.Field@if ( Label != null ){    <FieldLabel>@Label</FieldLabel>}@ChildContent```**Expected result:**```<div class="field">    <label class="label">Hello label</label>    Hello field</div>```
5654	area-mvc	Don't build if used any of not supported API	The Blazor FAQs says:> Yes, the .NET runtime used for Blazor supports .NET Standard 2.0. APIs that aren't supported in the browser throw Not Supported exceptions.There are any list with unsopported APIs of the .NET Standard? Can a MSBuild task used to interrumpt the build and mark as error if any of this APIs are used instead of detect the error in execution time when the exception is thrown?
4310	area-installers	aspnetcore-runtime exe installers are missing shared/Microsoft.NETCore.App/	The latest 3.0 daily builds of aspnetcore-runtime-3.0.0-preview-(buildnumber).exe are not installing shared/Microsoft.NETCore.App/. They only contain shared/Microsoft.AspNetCore.App/Spotted by @leecow in 3.0.0-preview-18572-0018cc @joeloff 
4296	area-mvc	Add CompatibilityVersion.Version_3_0	### Describe the bugWe need to add a new enum [here](https://github.com/aspnet/AspNetCore/blob/master/src/Mvc/src/Microsoft.AspNetCore.Mvc.Core/CompatibilityVersion.cs#L84) to reflect the new version. This also needs to be update in the templates.CC @mkArtakMSFT @DamianEdwards and @davidfowl who talked about this previously.
4294	area-mvc	Reconsider versioning story for rzc	see: https://github.com/aspnet/AspNetCore/pull/4290The Razor SDK tasks are a singleton and currently talk to all version of the rzc command line tool - the version depends on what project you're building. However, since we ship rzc in the SDK, it is also a singleton for 3.0 and future releases. This means that we already have to deal with the complexity of making all future release of rzc backwards compatible for 3.0. We might limit the overall complexity by making rzc that ships in the SDK backwards compatible all the down to 2.1 - or else it will always be possible to introduce this kind of bug. 
4292	area-mvc	Investigate why we didn't catch Razor SDK regressions building a 2.2 project	We have integration tests for building a 2.1 project with the latest Razor SDK in the Razor codebase - however we managed to regress this scenario (see https://github.com/aspnet/AspNetCore/pull/4290) without detecting it. This is an important test case because the newer SDK will be used by default by VS, and it needs to be able to build older versions.
4289	area-servers	Microsoft.AspNetCore.AspNetCoreModuleV2 doesn't have preview sufix in 2.2.1 build	http://aspnetci/viewLog.html?buildId=597957&tab=artifacts&buildTypeId=Releases_22xPublic_UniverseCoherence#!-8lo9sf546pu2,1u62nn99uqscm@jkotalik @natemcmaster 
4283	area-mvc	POST body is null intermittently on Linux self hosted app	### Describe the bugWe have two environments, one running on virtual Windows instance and another on AWS Linux instance.Configuration of both environment is as of below.**Windows:**Operating System: Windows Server 2012 R2,Dotnet Core: version 2.0.7Server: IIS 8.5.9600**AWS Linux:**Operating System: Amazon Linux release 2 (Karoo)Dotnet Core: version 2.0.6Dotnet Tools: version 2.1.101Server: Self hosted by `dotnet run <dll>`Same code has been hosted in both the environment. In Windows the app is able to get the request and request body has content. But on AWS Linux, app is getting the request, but the request body is null sometimes.### To Reproduce1. Have large request body. In our case it is somewhere around 10KB.2. Entire request is contained in single model in action using `[fromBody]`.3. Send the request.4. You should see null request body for some requests.### Expected behaviorRequest should contain a body.### Additional contextWe have multiple post calls from UI, written on Angular 6. For all post calls both environments are working fine. But the request body is less than a KB, except for this case.
5393	area-signalr	Redis reconnect problem	In our web application,when there is a problem with the redis cluster.The configcenter will automatically issue new cluster connections,and  old connections will be cleared.In this case, redis needs to reconnect.But there is no way to do this now, I have to restart the application.Therefore, I modified the following code  to solve this problem```_redisServerConnection.ConnectionFailed += (_, e) =>{        // We use the subscription connection type         // Ignore messages from the interactive connection (avoids duplicates)         if (e.ConnectionType == ConnectionType.Interactive)           {                   return;            }        RedisLog.ConnectionFailed(_logger, e.Exception);       // When ConnectionFailed ,try reconnect       _redisServerConnection = await _options.ConnectAsync(writer);       _bus = _redisServerConnection.GetSubscriber();};```Any Suggestions for this situation?
4267	area-infrastructure	Cleanup duplicate references to Internal.AspNetCore.Sdk	Follow-up to #4246 We have multiple places in our code where Internal.AspNetCore.Sdk is referenced. Let's reduce this to a single place. This should simplify the most common problem with using it -- ensuring the version is consistent across all projects.
4285	area-identity	AddEntityFrameworkStores expects a concrete implementation and AddDbContext<TContextService, TContextImplementation> does not bind the concrete implementation	I am not sure whether this is actually an issue or just a misunderstanding and I am not sure what the best fix for this would be but when using a service interface and an implementation for `AddDbContext` the actual context is not configured for injection so any attempt to use EntityFramework identity stores (e.g. `UserStore` via `UserManager`) results in an exception because the context cannot be injected. ```public void ConfigureServices(IServiceCollection services){    services.AddDbContext<IMyContext, MyContext>();    services.AddIdentity<ApplicationUser, ApplicationRole>()                .AddEntityFrameworkStores<MyContext>();}```You can work around this by manually binding the context ([as described here](https://stackoverflow.com/questions/52347535)) but it definitely does not feel ideal.
4264	area-infrastructure	Implement automated dependency flow using darc	See https://github.com/dotnet/arcade/blob/master/Documentation/DependencyFlowOnboarding.mdWe should implement automated dependency flow. This would replace using dotnet/versions and this script: https://github.com/aspnet/AspNetCore/blob/master/scripts/UpdateDependenciesCoreFx.ps1.Matching bug on the dotnet/arcade side: https://github.com/dotnet/arcade/issues/673
4260	area-platform	Remove Newtonsoft.Json from the shared framework	The following shared-framework libraries pull in Newtonsoft.Json:* Microsoft.AspNetCore.Mvc.ViewFeatures* Microsoft.Extensions.Configuration.Json* Microsoft.Extensions.DependencyModel* Microsoft.IdentityModel.JsonWebTokens* Microsoft.AspNetCore.SignalR.Protocols.Json* Microsoft.AspNetCore.Authentication.OAuthThese assemblies and dependencies need to be updated to remove their dependency on Newtonsoft.Json.
4259	area-infrastructure	Add tooling to ensure no API changes are made in patch updates	Follow-up to #3610 We should add tooling so we can ensure that 3.0.1, 3.0.2, etc do not change any public API in the reference assemblies. 
4257	area-infrastructure	3.0 Preview 1 packages require adding a FrameworkReference to the project	Depends on https://github.com/NuGet/Home/issues/7342.Follow up to https://github.com/aspnet/AspNetCore/pull/4178The packages we ship which reference the shared framework should be built using `FrameworkReference`. Once https://github.com/NuGet/Home/issues/7342 is resolved, the metadata for this item will be preserved in the nuspec, which should ensure consumers get all the necessary runtime settings and compiler references.**Workaround**Consumers using our AspNetCore packages, such as Microsoft.AspNetCore.NodeServices, need to make sure they also have `<FrameworkReference Include="Microsoft.AspNetCore.App" />`. This will be implicitly added with Microsoft.NET.Sdk.Web, but not other MSBuild SDKs. **Changes required**1. We need to change our own packages to build with `FrameworkReference`. (Related work #4246)2. Update our SDK in BuildTools to support using `FrameworkReference`
5840	area-identity	UserStore.UpdateAsync should not always attach TUser entity	If you set AutoSaveChanges to false and call more then one method of UserManager, you receive DbUpdateConcurrencyException.> DbUpdateConcurrencyException: Database operation expected to affect 1 row(s) but actually affected 0 row(s). Data may have been modified or deleted since entities were loaded. See http://go.microsoft.com/fwlink/?LinkId=527962 for information on understanding and handling optimistic concurrency exceptions.To reproduce exception, setup custom UserStore:```csharppublic class IdentityUserStore : UserStore<ApplicationUser>{  public IdentityUserStore(ApplicationDbContext context, IdentityErrorDescriber describer = null) : base(context, describer)  {    this.AutoSaveChanges = false;  }}// and register custom user store in Startup.csservices.AddIdentity<ApplicationUser, IdentityRole>()                .AddEntityFrameworkStores<ApplicationDbContext>()                .AddUserStore<IdentityUserStore>()                .AddDefaultTokenProviders();```Then call this example:```csharpvar user = await _userManager.FindByEmailAsync("test@user.cz");var claim1 = new Claim("TestClaim1", "one");var res1 = await _userManager.AddClaimAsync(user, claim1);var claim2 = new Claim("TestClaim2", "two");var res2 = await _userManager.AddClaimAsync(user, claim2);await _dbContext.SaveChangesAsync(); // DbUpdateConcurrencyException```Every call of UserManager.AddClaimAsync method internaly calls UserStore.UpdateAsync. This method Context.Attach() and updates ConcurrencyStamp. Because Context.Attach() always attach entity as Unchanged the second call of AddClaimAsync overrides "OriginalValue" of ConcurrencyStamp.And this cause exception on DbContext.SaveChangesAsync because generated SQL update query a use wrong value of ConcurrencyStamp in where clause.I think that this line:https://github.com/aspnet/Identity/blob/8003a5550e7c9b02de035de04b0758f898d8237f/src/EF/UserStore.cs#L185should by replaced by this:```csharpvar entry = Context.Entry(user);if (entry.State == EntityState.Detached)  Context.Attach(user);```What do you think? Thanks
5653	area-mvc	Tag helpers not working on virtual/override properties	I have a base class for my `ModalContent` component.```public abstract class BaseModalContent : BaseComponent{    [Parameter]    protected virtual bool IsCentered    {        get => isCentered;        set        {            isCentered = value;            ClassMapper.Dirty();        }    }    [Parameter]    protected virtual ModalSize Size    {        get => modalSize;        set        {            modalSize = value;            ClassMapper.Dirty();        }    }}```Then in my `BaseBootstrapModalContent` I have```public abstract class BaseBootstrapModalContent : Base.BaseModalContent{    protected override bool IsCentered    {        get => base.IsCentered;        set        {            DialogClassMapper.Dirty();            base.IsCentered = value;        }    }    protected override ModalSize Size    {        get => base.Size;        set        {            DialogClassMapper.Dirty();            base.Size = value;        }    }}```But when I try to use this fields they are not suggested or recognized by the Razor.![image](https://user-images.githubusercontent.com/900302/49085684-d9326a00-f252-11e8-8803-798b5b92427f.png)I must say that the code is working as expected, it's just that the intellisense is not working.
5839	area-identity	Bug: doesn't check duplicated email while changing user's email address	When I call UserManager.SetEmailAsync(), it doesn't validate whether there's duplicated email address in database which could cause more than one users having the same email address.If there're any duplicated email addresses in database, the UserManager.FindByEmailAsync() will not working properly -- it only return one result but not all matching results.Therefore, it's necessary to validate duplicated email address while creating user and changing user's email address.
4635	area-security	AzureADB2CBearer scheme and JwtBearer scheme	Hi,I want to add 2 JWT bearer authentication schemes to my authentication pipeline, one using azure B2C generated tokens and one using locally generated tokens.If I add the 'b2cBearer' scheme **BEFORE** I add the 'localBearer' scheme I **CAN** use _PostConfigure<JwtBearerOptions>("jwtB2cBearer")_ to configure the JwtBearerOptions for the 'b2cBearer' scheme. The correct JwtBearerOptions instance is returned.![image](https://user-images.githubusercontent.com/41360084/49068398-ec2f4500-f226-11e8-96bb-0b906b37a64f.png)If I add the 'b2cBearer' scheme **AFTER** I add the 'localBearer' scheme I **CANNOT** use _PostConfigure<JwtBearerOptions>("jwtB2cBearer")_ to configure the JwtBearerOptions for the 'b2cBearer' scheme. An empty JwtBearerOptions instance is returned.![image](https://user-images.githubusercontent.com/41360084/49068416-f9e4ca80-f226-11e8-8e18-10cb42094bb1.png)Why??Can someone explain in detail what is going on? Is this related to IOC container behavior? One singleton being replaced by another?Is there another way to get the JwtBearerOptions instance that is created within the 'AddAzureADB2CBearer' function call? Why isn't it simply a property member of 'AzureADB2COptions'??!My sample code:```using System;using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Mvc;using Microsoft.AspNetCore.Authentication;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.DependencyInjection;using Microsoft.AspNetCore.Authentication.JwtBearer;using Microsoft.IdentityModel.Tokens;using System.Text;using Microsoft.AspNetCore.Authorization;namespace WebApplication1{    public class Startup    {        public Startup(IConfiguration configuration)        {            Configuration = configuration;        }        public IConfiguration Configuration { get; }        public void ConfigureServices(IServiceCollection services)        {            var builder = services.AddAuthentication();            builder.AddAzureADB2CBearer("b2cBearer", "jwtB2cBearer", options =>            {                Configuration.Bind("AzureAdB2C", options);            });            builder.AddJwtBearer("localBearer", options =>            {                options.TokenValidationParameters = new TokenValidationParameters                {                    ValidateIssuerSigningKey = true,                    IssuerSigningKey = new SymmetricSecurityKey(Encoding.ASCII.GetBytes("MySymmetricSecurityKey")),                    ValidateIssuer = true,                    ValidIssuer ="MyIssuer",                    ValidateAudience = true,                    ValidAudience = "MyAudience",                    ValidateLifetime = true,                    ClockSkew = TimeSpan.Zero                };                options.SecurityTokenValidators.Clear();                options.SecurityTokenValidators.Add(new SecurityTokenHandlerLocal());            });            services.PostConfigure<JwtBearerOptions>("jwtB2cBearer", options =>            {                options.SecurityTokenValidators.Clear();                options.SecurityTokenValidators.Add(new SecurityTokenHandlerB2C());            });            services.AddAuthorization(options =>            {                var defaultAuthorizationPolicyBuilder = new AuthorizationPolicyBuilder("localBearer", "b2cBearer");                defaultAuthorizationPolicyBuilder = defaultAuthorizationPolicyBuilder.RequireAuthenticatedUser();                options.DefaultPolicy = defaultAuthorizationPolicyBuilder.Build();            });            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);        }        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            else            {                app.UseHsts();            }            app.UseHttpsRedirection();            app.UseAuthentication();            app.UseMvc();        }    }}```
6033	area-identity	multiple JWT bearer schemes	Hi,I want to add 2 JWT bearer authentication schemes to my authentication pipeline, one using azure B2C generated tokens and one using locally generated tokens.If I add the 'b2cBearer' scheme **BEFORE** I add the 'localBearer' scheme I **CAN** use _PostConfigure<JwtBearerOptions>("jwtB2cBearer")_ to configure the JwtBearerOptions for the 'b2cBearer' scheme. The correct JwtBearerOptions instance is returned.![image](https://user-images.githubusercontent.com/41360084/49068398-ec2f4500-f226-11e8-96bb-0b906b37a64f.png)If I add the 'b2cBearer' scheme **AFTER** I add the 'localBearer' scheme I **CANNOT** use _PostConfigure<JwtBearerOptions>("jwtB2cBearer")_ to configure the JwtBearerOptions for the 'b2cBearer' scheme. An empty JwtBearerOptions instance is returned.![image](https://user-images.githubusercontent.com/41360084/49068416-f9e4ca80-f226-11e8-8e18-10cb42094bb1.png)Why??Can someone explain in detail what is going on? Is this related to IOC container behavior? One singleton being replaced by another?Is there another way to get the JwtBearerOptions instance that is created within the 'AddAzureADB2CBearer' function call? Why isn't it simply a property member of 'AzureADB2COptions'??!My sample code:```using System;using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Mvc;using Microsoft.AspNetCore.Authentication;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.DependencyInjection;using Microsoft.AspNetCore.Authentication.JwtBearer;using Microsoft.IdentityModel.Tokens;using System.Text;using Microsoft.AspNetCore.Authorization;namespace WebApplication1{    public class Startup    {        public Startup(IConfiguration configuration)        {            Configuration = configuration;        }        public IConfiguration Configuration { get; }        public void ConfigureServices(IServiceCollection services)        {            var builder = services.AddAuthentication();            builder.AddAzureADB2CBearer("b2cBearer", "jwtB2cBearer", options =>            {                Configuration.Bind("AzureAdB2C", options);            });            builder.AddJwtBearer("localBearer", options =>            {                options.TokenValidationParameters = new TokenValidationParameters                {                    ValidateIssuerSigningKey = true,                    IssuerSigningKey = new SymmetricSecurityKey(Encoding.ASCII.GetBytes("MySymmetricSecurityKey")),                    ValidateIssuer = true,                    ValidIssuer ="MyIssuer",                    ValidateAudience = true,                    ValidAudience = "MyAudience",                    ValidateLifetime = true,                    ClockSkew = TimeSpan.Zero                };                options.SecurityTokenValidators.Clear();                options.SecurityTokenValidators.Add(new SecurityTokenHandlerLocal());            });            services.PostConfigure<JwtBearerOptions>("jwtB2cBearer", options =>            {                options.SecurityTokenValidators.Clear();                options.SecurityTokenValidators.Add(new SecurityTokenHandlerB2C());            });            services.AddAuthorization(options =>            {                var defaultAuthorizationPolicyBuilder = new AuthorizationPolicyBuilder("localBearer", "b2cBearer");                defaultAuthorizationPolicyBuilder = defaultAuthorizationPolicyBuilder.RequireAuthenticatedUser();                options.DefaultPolicy = defaultAuthorizationPolicyBuilder.Build();            });            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);        }        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            else            {                app.UseHsts();            }            app.UseHttpsRedirection();            app.UseAuthentication();            app.UseMvc();        }    }}```
4249	area-servers	HTTP/2: Server Push support	Support the **[HTTP/2 Server Push](https://en.wikipedia.org/wiki/HTTP/2_Server_Push)** feature with the now previewed and for .Net Core 2.2 most likely GA HTTP/2 implementation.> HTTP/2 Server Push allows an HTTP/2-compliant server to send resources to a HTTP/2-compliant client before the client requests them. It is, for the most part, a performance technique that can be helpful in loading resources pre-emptively.
4248	area-infrastructure	Enable running tests on Helix (distributed workload platform)	Currently, running all ASP.NET Core tests can take hours, even with assembly parallelization. Other large .NET repos have used Helix, a platform for distributing and running workloads in parallel. We should setup our PRs and CI builds to use this.## Scenarios1. Running tests without helix.   This must continue to work so contributors do not need to run tests on Helix. This should work via `dotnet test` for most projects (and/or Visual Studio Test Explorer).2. Microsoft developers: running tests on Helix. Those with an access token to Helix should be able to run tests on Helix with a few simple parameters, such as `build.cmd -helixTest /p:HelixApiToken=xyz123`3. CI: by default, PRs and CI builds run tests on Helix. `build.cmd -ci`.4. Configuring Helix test settings can be done in the test's .csproj file. ```xml<!-- MyTests.csproj --><Project Sdk="Microsoft.NET.Sdk">    <PropertyGroup>        <TargetFramework>netcoreapp3.0</TargetFramework>        <!-- Projects can opt-out of Helix -->        <DisableDistributedTests>true</DisableDistributedTests>        <!-- By default, all test projects would run on the same set of platforms, as defined in $(DefaultTestPlatforms). Exact platform names TBD. -->        <DefaultTestPlatforms>Windows10.x64;macOS.x64;Ubuntu16.x64</DefaultTestPlatforms>    </PropertyGroup>    <ItemGroup>        <!-- Most projects should not need to specify. This would be set by default for all test projects. $(DisableDefaultTestPlatforms) can be used to opt-out. -->        <DistributedTestPlatform Include="$(DefaultTestPlatforms)" Condition=" '$(DisableDefaultTestPlatforms)' != 'false' " />        <!-- For special cases, projects can configure additional platforms -->        <DistributedTestPlatform Include="Windows10.x86" />        <!-- Projects can also Include/Exclude to filter the defaults -->        <DistributedTestPlatform Include="$(DefaultTestPlatforms)" Exclude="macOS.x64" />    </ItemGroup></Project>```cref https://github.com/aspnet/AspNetCore-Internal/issues/981 - additional details for the implementer
4246	area-infrastructure	Convert projects in this repo to use ProjectReference	Follow-up to #3598.The first phase of reducing repos was to merge the source code into a single repo. The second phase is to convert them from isolated folders of code with PackageReference across repo boundaries, to projects which use `ProjectReference`.We've already started some of this work. See https://github.com/aspnet/AspNetCore/pull/4013 for example and https://github.com/aspnet/AspNetCore/tree/master/src/DataProtection.As done in #4013, we implement this using `<Reference>` items in .csproj and custom Reference resolution targets. This is done so we can automatically pick the right versions of assemblies to used based on conditions such as, is this a test project? is this branch building a patch or a new minor release? what versions were used in the last stable release? etc.See also https://github.com/aspnet/specs/blob/master/runtime/design-notes/2018-10-03-mondo-source-org.md for the spec on source code organization.## Repo groups to convert- [x] Razor @ajaybhargavb  - [x] HttpSysServer https://github.com/aspnet/AspNetCore/pull/4335- [x] Antiforgery - Justin- [x] IISIntegration https://github.com/aspnet/AspNetCore/pull/4311- [x] CORS - Justin- [x] StaticFiles - Justin- [x] Routing @natemcmaster - [x] ResponseCaching -Justin- [x] Session @JunTaoLuo - [x] ServerTests @JunTaoLuo @jkotalik - [x] Localization @natemcmaster - [x] Security @jkotalik - [x] MetaPackages @JunTaoLuo - [ ] Mvc @ajaybhargavb - [ ] JavaScriptServices @jkotalik - [ ] AADIntegration @natemcmaster - [ ] Identity @JunTaoLuo - [ ] MvcPrecompilation @JunTaoLuo - [ ] AzureIntegration- [ ] SignalR- [ ] Components- [ ] MusicStore- [ ] AuthSamples- [ ] Templating
5652	area-mvc	How does one do nested child content in the compnent derivation chain?	So, how do you go about dealing with multiple levels of child content? Lets say you have this sequence of components deriving from each other:Modal -> DialogBox -> MyPersonalDialogBoxSo DialogBox wants to put the child content of MyPersonalDialogBox inside a DIV, with a title bar on top and buttons on the bottom. Modal wants to put DialogBox's content inside himself so that he can present that content modally.Obviously we can use containment instead of derivation, and have that working fine, so DialogBox USES a modal component, and my dialog box USES a DialogBox component. But ultimately that's not how OO should work. My dialog box 'is a' dialog box which 'is a' modal component, and we want to have virtual methods that can be called from baser classes up to more derived classes, and helper methods that can accept any modal component or any dialog box and so forth.But I can't figure out how to deal with the layered child content when doing it this way. No matter what I do, the content ends up not rendered within the parent class' embrace but outside of it, or I end up with one ChildContent hiding the other and so forth. It's probably something so utterly obvious I can't see it. 
4243	area-mvc	MVC client-side validation issues with Edge input field auto-complete	Reproduced this with 2.2.0 RTM bits, VS 2017 15.9.2, and Edge (build). See output of `dotnet --info` below.## OverviewIt seems the Edge field auto-completion implementation is firing DOM events in such a way that it results in usability issues for our client-side validation story (jQuery Validate). None of these issues appear to reproduce in Chrome.## Reproduction Steps1. In VS, create an app using the "ASP.NET Core Web Application" template, targeting .NET Core, using ASP.NET Core 2.2, and using Individual User Accounts:   ![image](https://user-images.githubusercontent.com/249088/49046663-b5efb800-f189-11e8-92bb-7d043315e24f.png)1. Launch it without debugging (Ctrl+F5) in Edge1. Once the home page appears, open the Edge Dev Console (F12)1. Click the "Accept" link in the cookie/privacy policy alert1. Click the "Register" link in the main nav bar1. Give the email field focus and type the first 2 or 3 characters of an email **that has been entered previously** (i.e. it must appear in the auto-complete drop-down that Edge shows)1. Select the suggested full email address from the drop-down by using the arrow keys to navigate to it and hit `Tab`## Expected ResultsThe value is populated in the field, no error message is displayed, and the next field is selected.## Actual ResultsThe value is populated in the field, the next field is selected, but an validation error message is displayed stating that the email address is not valid. It seems the validation ran before the field was populated with the value from the auto-complete list.![image](https://user-images.githubusercontent.com/249088/49054691-eb0c0280-f1a9-11e8-957a-60adb085cce4.png)@mkArtakMSFT @rynowak  ## Output of `dotnet --info`:```.NET Core SDK (reflecting any global.json): Version:   2.2.100 Commit:    51868761f2Runtime Environment: OS Name:     Windows OS Version:  10.0.17763 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.2.100\Host (useful for support):  Version: 2.2.0  Commit:  1249f08fed.NET Core SDKs installed:  2.1.500 [C:\Program Files\dotnet\sdk]  2.1.600-preview-009426 [C:\Program Files\dotnet\sdk]  2.2.100 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 1.1.10 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.2.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]```
5392	area-signalr	Use the updated HubConnection builder pattern in all the clients	In the Java client we introduced a new `HubConnection` builder pattern where `HubConnectionBuilder` was an abstract base class for builder implementations. The most common of which being the `HttpHubConnection` builder.https://github.com/aspnet/SignalR/blob/c852bdcc332ffb998ec6a5b226e35d5e74d24009/clients/java/signalr/src/main/java/com/microsoft/signalr/HubConnectionBuilder.java#L16-L21We should use this pattern across the different clients. 
4948	area-mvc	Add IDocumentProvider service to Swashbuckle	#### Is this a Bug or Feature request?Enhancement related to #7947#### Steps to reproduce (preferably a link to a GitHub repo with a repro project)The overall aim of in-progress work in ASP.NET Core 3.0 is to give customers simple ways to annotate their project files for automated code generation during every build (as source API descriptions change). This issue is about including Swashbuckle in that new goodness.The ASP.NET Core work includes a "generic" document-fetching tool which can get the Open API / Swagger document from a web site project. This tool can download from a service implementing `Microsoft.Extensions.ApiDescription.IDocumentProvider`.Specific work in the https://github.com/domaindrivendev/Swashbuckle.AspNetCore repo would include:- define chosen `IDocumentProvider` interface in the Swashbuckle.AspNetCore package or one of its dependencies  - the supported signature of the invoked method is `Task GenerateAsync(string documentName, TextWriter writer)`  - the generic tool in the Microsoft.Extensions.ApiDescription.Design package does not define this `interface` and the full name of this service type as well as the method name may be overridden in MSBuild- implement `IDocumentProvider` in the same package- update the `AddSwagger(...)` extension methods to register the new `IDocumentProvider` service  - may require additional supporting services in DI though Swashbuckle seems to already register what's needed#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`3.0-preview2
5651	area-mvc	'bind' does not accept values of type System.DateTimeOffset	If I try to bind the type `System.DateTimeOffset` I get a> System.ArgumentException: 'bind' does not accept values of type System.DateTimeOffset. To read and write this value type, wrap it in a property of type string with suitable getters and setters.Example:`<input type="date" class="form-control" bind=@Timestamp />`
5650	area-mvc	Question about future on ASP.NET Core 3.0 & Components	Currently we use an static html file with an <app /> tag and a script which does the magic. I am making a PWA for my nextgen product and i am wondering how it will be to integrate Components (Blazor) into Razor pages (Or MVC pages).Talking about Server-side Rendering specifically, Ideally i am thinking of putting some components tags (e.g using tag helpers?!) directly into the razor pages and i will get those parts of my pages updated in-place.Is there any overview as we are currently in version 0.8 ? I appreciate any enlightenment.
4229	area-servers	Don't allocate a closure for IO callbacks in IIS in proc	https://github.com/aspnet/AspNetCore/blob/4d57528704d7ec54570f5960b3b9ddca503d5c89/src/IISIntegration/src/Microsoft.AspNetCore.Server.IIS/Core/IO/AsyncIOOperation.cs#L154While we're at it we should not capture the ExecutionContext. Lets make the switch to UnsafeQueueUserWorkItem as well.cc @pakrym @jkotalik 
5391	area-signalr	How to benchmark my signalR?	I want to benchmark my signalr, I dose not find Microsoft doc that about benchmark signalr. can you give some advice to me . Tks very .  my  version of asp.net core  is  2.1
5390	area-signalr	Server error 502 - Web server received an invalid response while acting as a gateway or proxy server	Hi,I have written a Console application to do load testing and I am using c# Microsoft.AspNetCore.SignalR.Client.Core.**HubConnectionBuilder** for creating connections to AspNet Core SignalR application, which is hosted on IIS running on a Windows Server 2012 R2 having 8 Cores and 32 GB RAM. We have a single Hub in the project, with below method.```public async Task Send(string name, string message){         await Clients.All.SendAsync("BroadcastMessage", name, message);}```.Net Clr Version of Application pool has been set to No Managed Code.We are able to reach up to 16000 connections approx. Any subsequent request to the IIS leads to below error:![image](https://user-images.githubusercontent.com/8132553/48888089-87a36d00-ee57-11e8-90bf-b710575240e9.png)The application targets .Net Core 2.1![image](https://user-images.githubusercontent.com/8132553/48888417-a7876080-ee58-11e8-97c4-663e7ac8e149.png)We have tried deploying the applction on a Azure VM (8 Cores, 32 Gb RAM, Windows Server 2016) as well, but the result is same. IIS configuration **appConcurrentRequestLimit** has been set to 80000`appcmd.exe set config /section:system.webserver/serverRuntime /appConcurrentRequestLimit:80000`We also tried modifying below Kestrel settings, but ended up in vain.```.UseKestrel(options =>        {            options.Limits.MaxConcurrentConnections = 80000;            options.Limits.MaxConcurrentUpgradedConnections = 80000;        });```Are we missing anything?
4947	area-mvc	Add support for runtime compilation in 3.0	Currently supported features:* [ ] Changes to file or `_ViewImports` cause recompilation* [ ] Changes to cshtml file cause route table to rebuilt. Required for Razor Pages* [ ] Files on disk with different checksum during MVC initialization are preferred* [ ] Disable PreserveCompilationContext by default in the SDK and reenable with the runtime compilation package* [ ] Support for `IFileProvider` as sources for raw (uncompiled views).
4187	area-tooling	Move templates to generic web host	A major 3.0 effort is to replat webhost on generic host. Before we can update the templates we need to split up WebHost.CreateDefaultBuilder to generic and web specific items. https://github.com/aspnet/MetaPackages/pull/298 added a new extension for the web specific elements.
5112	area-mvc	2-phase compile in SDK follow up items	* [ ] Make `ComponentTagHelperDescriptorProvider` not public.* [ ] `GenerateCommand` uses `IImportFeature` to locate imports. There is only one implementation of the interface today that returns `_ViewImports.cshtml`.* [ ] Need a nicer way to set `RazorCodeGenerationOptions`
5111	area-mvc	Figure out how ComponentDocumentClassifierPass knows what files are components	The Sdk uses an `ItemGroup` to determine what constitutes a `RazorComponent`. By default, it's populated with files with a `.razor` extension, but we want this information to come from MSBuild evaluation. `ComponentDocumentClassifierPass` needs to know this information. In the 2-phase compile PR, this is done by adding a feature that sets a value `RazorCodeDocument.SetInputDocumentKind` and the classifier uses this to figure out if it needs to do a component. This needs to be designed correctly. Using this issue to track this work
5270	area-mvc	import not working in NodeServices	I'm using `Microsoft.AspNetCore.NodeServices v2.1.1` to call a js script from c#, and I'm able to do that successfully, but when I change```var React = require('react');```to```import React from 'react';```I get an exception:```NodeInvocationException: Unexpected token import[...]/Scripts/Render.js:2import React from 'react';^^^^^^SyntaxError: Unexpected token importat createScript (vm.js:74:10)at Object.runInThisContext (vm.js:116:10)at Module._compile (module.js:533:28)at Object.Module._extensions..js (module.js:580:10)at Module.load (module.js:503:32)at tryModuleLoad (module.js:466:12)at Function.Module._load (module.js:458:3)at Module.require (module.js:513:17)at require (internal/module.js:11:18)at /private/var/folders/sv/fh862tvn1mb0hy3h71x3y4_c0000gn/T/kcwjl1il.fmt:109:34```Are `import` & `export` ES6 features not supported?
4176	area-mvc	Considering adding an implicit FrameworkReference in Microsoft.NET.Sdk.Razor	We updated Microsoft.NET.Sdk.Web to add an implicit FrameworkReference to Microsoft.AspNetCore.App. in netcoreapp3.0 https://github.com/aspnet/websdk/issues/424.Does it make sense to also do this for Microsoft.NET.Sdk.Razor? Currently, users must still add an explicit FrameworkReference item.Users could opt-out with `DisableImplicitFrameworkReferences`. cref https://github.com/aspnet/websdk/pull/428cc @DamianEdwards @pranavkm @rynowak @livarcocc @dsplaisted 
4212	area-mvc	Link generation behaviour change: page to controller in area	Linking from a page in an area to a controller in the same area, without specifying the area is changing.* Succeeded in 2.1* Succeeded in 2.2 (unintentionally)* Fails in 3.0 (current behaviour)We could make 3.0 succeed with a moderate amount of additional work. The question is whether anyone is doing this and if it is important to customers.This issue is something to evaluate near the end of 3.0 to make a decision.Affected test: PagesInAreas_CanGenerateLinksToControllersAndPages```cs<a asp-controller="Home" asp-action="Index">Link to area action</a>```PR that is changing this - https://github.com/aspnet/Routing/pull/914
5269	area-mvc	UseWebpackDevMiddleware with latest version of Angular	Since angular does not use webpack.config.js anymore, it is impossible to make HMR working with only aspnetcore. When trying to use it it complains that `webpack.config.js` does not exist, but it's not supposed to exist on the latest angular version. 
4946	area-mvc	JsonInputFromatter validation issue	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):1. You have an action in a Controller2. The action has a requestModel with array of integers3. You send a request to the action with invalid model - for example array with string.Empty instead integers4. You expect to receive BadRequest, but you will receive Http Ok after a long period of timeI've attached the repo to reproduce this issue https://github.com/ArtemAstashkin/JsonInputFormatterTest1) The repo has 2 projects (Web and Web.Tests). Web has HomeController and Post action with RequestModel ```C#    public class RequestModel    {        public string Key { get; set; }        [FromBody]        [Required]        public PostRequestModelBody Body { get; set; }    }```2) The Web.Tests project has only one specific test to reproduce the issue```C#        [Fact]        public async Task ShouldReturnBadRequest()        {            var itemIds = Enumerable.Repeat(string.Empty, 621).ToArray();            var body = JSON.SerializeDynamic(new { ItemIds = itemIds });            var request = new HttpRequestMessage            {                Method = HttpMethod.Post,                RequestUri = new Uri("/api/home?key=test", UriKind.Relative),                Content = new StringContent(body, Encoding.UTF8, "application/json"),            };            var sut = await Sut.AsyncInstance;            var response = await sut.SendAsync(request);            Assert.Equal(                expected: HttpStatusCode.BadRequest,                actual: response.StatusCode);        }```The test will fail. But, if you change 621 to 199 it will pass.#### Description of the problem:The issue is related to the JsonInputFormatter which tries to mark validation errors as handled and validate all items in arrays and all properties in a model. But it take a lot of time. Moreover it has a limit of exceptions (200 as default). Eventually if somebody sends invalid model with 600 string.Empty (for example, 201 - enough) in array instead of integers, the formatter will spend a lot of time to parse it without any expected result - because it will fail after 200th error and return status OK instead of BadRequest.It has 2 problems:1) validation doesn't work properly2) performance issue - formatter spends a lot of time to try to parse all invalid values so a malefactor can cause serious performance issues on online high-load services#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:2.1.1
4137	area-mvc	Can not catch HttpMethod: OPTIONS on a http request	I'm writing an ActionFilterAttribute where I check userId route/query parameters and compare it against the subject of a jwt token. I noticed that my Action Filter gets triggered twice. In chrome I can see that an OPTIONS request is sent to the server and in my debug console output I can see the call with the correct http method:```Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 OPTIONS http://localhost:5000/api/v1/users/33417Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:5000/api/v1/users/33417 application/json```But when it hits my Action Filter, Http Method is always set as GET so I can not make my filter return on an OPTIONS call. Here is a basic OnActionExecutionAsync override method:```public override Task OnActionExecutionAsync(ActionExecutingContext context, ActionExecutionDelegate next){	Debug.WriteLine("URL CALL: " + context.HttpContext.Request.GetDisplayUrl());	Debug.WriteLine("HTTP METHOD: " + context.HttpContext.Request.Method);	    if (HttpMethods.IsOptions(context.HttpContext.Request.Method))    {        Debug.WriteLine("HTTP METHOD: OPTIONS");        return base.OnActionExecutionAsync(context, next);    }    // Other Code ....}```The debug log:```URL CALL: http://localhost:5000/api/v1/users/33417HTTP METHOD: GETURL CALL: http://localhost:5000/api/v1/users/33417 HTTP METHOD: GET```Another interesting point is that if I request OPTIONS from Postman tool my API returns this error message:```    {        "error": {            "code": "UnsupportedApiVersion",            "message": "The HTTP resource that matches the request URI 'http://localhost:5000/api/v1/users/33417' with API version '1' does not support HTTP method 'OPTIONS'.",            "innerError": null        }    }```Here is my Cors Configuration in Startup:```services.AddCors(options => options.AddPolicy(_constants.CorsPolicy,                    builder => builder.AllowAnyOrigin()                        .AllowAnyMethod()                        .AllowAnyHeader()                        .AllowCredentials()                        .Build()));```Is this an issue or is there any other way I can get the OPTIONS http method. I have searched the issues and googled it with no results.Thanks.
5110	area-mvc	Discussion: bringing back @helper for views	In porting some existing applications (from ASP.NET MVC 5), we're seeing immense amounts of pain with views that use `@helper` today. `@helper`, from the user view point, is a very simple way to use Razor templating to re-use some code. Perhaps to render a date a certain way, or a chart, or a graph, or whatever. As an example, Stack Overflow's codebase has 458 `@helper`s today.Some history:- [`@helper` was removed in #281](https://github.com/aspnet/Razor/issues/281) after findings in https://github.com/aspnet/Mvc/issues/1130- Parser errors were added in https://github.com/aspnet/Razor/issues/472,- A lot of user discussion in https://github.com/aspnet/Razor/issues/715, ultimate closed as "We have no plans to do this"But `@helper` still lacks an equally (or even close) usable replacement. The alternatives I'm aware of today are:- [Tag Helpers](https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro?view=aspnetcore-2.1) which involve writing C# per helper- [View Components](https://docs.microsoft.com/en-us/aspnet/core/mvc/views/view-components?view=aspnetcore-2.1) which involve writing C# and a view per helper- Using [a `dynamic` workaround](https://github.com/aspnet/Razor/issues/715#issuecomment-198456302) which isn't type safe and I'm not sure on the performance implications of- Build the string yourself, and hope you encode everything correctlyThere are 2 ways `@helper` worked in ASP.NET MVC 5: globally from App_Data and in individual views. **I am only advocating for support of the latter**. IMO, Tag Helpers or view components (pick your flavor!) are excellent replacements for the global use case. That makes total sense and having another view file is also reasonable.Let's say we have a view today with 5 `@helper` sections in ASP.NET MVC 5. In ASP.NET Core, it's a regression. We have a few options:- Copy the code everywhere- Write a function rendering HTML strings (basically no Razor or safety for the helper)- Have a child view per helper, going from 1 view to 6, and 1 file to 6- Create a tag helper for each (5 classes...and again mostly removing HTML safety, or suffering overhead)- Use the `dynamic` approach, eat the performance, and hope it doesn't go boom at runtimeNote: I am not sure about the performance differences on these. That needs to be tested. I'll try and get benchmarks going when time allows. I have a hard time imagining any of these would be as fast as what `@helper` used to do, though. But I take nothing for a given here...we need to benchmark, even if `@helper` isn't a candidate yet.A lot of users have chimed in on closed issues above. A lot of migration pain is being felt. Probably much more than was envisioned when `@helper` was removed. This is one of the largest issues I see in our migrations and it's something I'm really feeling right now. Is there a possibility we bring `@helper` or equivalent functionality (re-using some Razor templating inside the same view) back?cc @DamianEdwards @rynowak 
5109	area-mvc	Directive completion when overlapping an existing Razor directive	Razor directive completion doesn't work if you try and trigger auto-complete on an existing Razor directive. aka `@add|TagHelper` doesn't trig completion to show all of the TagHelper completions.
4945	area-mvc	Change default document directory to obj	Today the directory that we store the API document is empty, meaning that we put it in the root of the project. For this type of asset, one that is purely used to make sure we don't redo work we don't need to, I think obj is a better default.
4146	area-servers	Refactor Internal.WebHostBuilderFactory.Sources to account for generic host	Once we figure out what the new template pattern will be for generic host, update Internal.WebHostBuilderFactory.Sources to account for it and then make sure it works in EF. See https://github.com/aspnet/EntityFrameworkCore/blob/779d43731773d59ecd5f899a6330105879263cf3/src/EFCore.Design/Design/Internal/AppServiceProviderFactory.cs#L49
4944	area-mvc	Generated files re-appearing without explicit build	If I delete a generated client file then it will reappear immediately. My theory for this was that changing the files in the project was causing a design-time build to happen.
4081	area-servers	Kestrel default certificate store is invalid	### Describe the bugThe JSON examples in [Kestrel web server implementation in ASP.NET Core]https://docs.microsoft.com/en-us/aspnet/core/fundamentals/servers/kestrel?view=aspnetcore-2.1#listenoptionsusehttps section *ListenOptions.UseHttps* suggest the following:```JSON"Store": "<cert store; defaults to My>",```However, that is not the case. If "Store" is left out from the app settings, `Internal.Cryptography.CryptoThrowHelper.WindowsCryptographicException: 'The parameter is incorrect'` exception is thrown. Stack suggests that the store's default is not "My":`Microsoft.AspNetCore.Server.Kestrel.Core.dll!Microsoft.AspNetCore.Server.Kestrel.Https.Internal.CertificateLoader.LoadFromStoreCert(string subject = "...", string storeName = null, System.Security.Cryptography.X509Certificates.StoreLocation storeLocation = CurrentUser, bool allowInvalid = true)`### Expected behaviorFix the configuration loader to supply "My" as default for "Store" or eventually fix the documentation so that it says something like```JSON"Store": "<cert store; required>",```### Additional context```.NET Core SDK (reflecting any global.json): Version:   2.1.500 Commit:    b68b931422Runtime Environment: OS Name:     Windows OS Version:  10.0.18272 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.1.500\Host (useful for support):  Version: 2.1.6  Commit:  3f4f8eebd8.NET Core SDKs installed:  1.0.0-preview3-003788 [C:\Program Files\dotnet\sdk]  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.500-preview-009404 [C:\Program Files\dotnet\sdk]  2.1.500 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]To install additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download```
5389	area-signalr	Consider changing project structure to be shorter	Moving to Mondo repo could potentially cause long path issues. We should make our project structure have shorter path length. We can't really do this for java since the folder structure needs to match the package name. This could be mitigated by having a separate SignalR clients repo.
4692	area-servers	Kestrel doesn't end connections timely when pulling the network cable	I have a page with an active SignalR connection based on WebSockets and a large file upload post request (~180 MiB) in `netcoreapp2.1` version `2.1.6`. While these things are running, I pull the network cable on my USB RNDIS connection, which results in a carrier loss in Linux. Now I look at the active connections using `netstat`:Initially, all connection are still `ESTABLISHED`, there's the POST request, the WebSocket and a couple of remaining keep-alive connections.After around two minutes, the keep-alive connections go away.After 15 minutes (!) the WebSocket closes with a timeout. Before that, the Send-Q was filling up (probably with SignalR PINGs).Now, after about 30 minutes, the POST request is still `ESTABLISHED` and there is no progress whatsoever. This is especially annoying as the request holds on to an open file handle. When I reconnect the network (USB) cable and re-run the POST request, it fails with a proper IOException.The only way it seems to get rid of the POST request is to stop the application. Only then, I can see in the logs that the `CancellationToken` of the that request has actually fired.I haven't configured any of the limits explicitly, so I am expecting the `MinRequestBodyDataRate` of 240 bytes/second to trigger and actually close the connection much sooner. The only configuration is on my Controller method (`RequestSizeLimitAttribute`).
5388	area-signalr	Add Func<T1...Tn, Task> extension methods to HubConnectionExtensions	The Action<T1...Tn> extension methods in HubConnectionExtension that wrap around the base Func<object[], object, Task> On method are very handy. It would be very useful to have Func<T1...Tn, Task> extension methods, allowing async delegates to be registered using the higher level API.
4943	area-mvc	FileResult returns 500 instead of 416 when requesting an invalid range.	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):* Return any type of FileResult with enableRangeProcessing = true from a controller.* Request an invalid Range form the client (e.g. after the end of file)* Http StatusCode is "500 Internal Server Error" instead of "416 Range Not Satisfiable"Example: https://github.com/MatthiasLaroche/AspNetInvalidRangeBug#### Description of the problem:Kestrel throws this exception: System.InvalidOperationException: Response Content-Length mismatch: too few bytes writtenIt's thrown from line 913 in HttpProtocol.cs in the method VerifyResponseContentLength.https://github.com/aspnet/AspNetCore/blob/74dbb4ff4f380f093981c97c88a8c80d687db7e7/src/Servers/Kestrel/Core/src/Internal/Http/HttpProtocol.cs#L896-L916The response generated is invalid because an header for Content-Length was set from the length of the file, but the response length is 0 byte long because of the invalid range request and 416 status.The content length seems to be set at line 93 of FileResultExecutorBase.cs in the method SetHeadersAndLog.https://github.com/aspnet/AspNetCore/blob/74dbb4ff4f380f093981c97c88a8c80d687db7e7/src/Mvc/src/Microsoft.AspNetCore.Mvc.Core/Infrastructure/FileResultExecutorBase.cs#L86-L108And the status 416 for invalid range is set at line 323 of FileResultExecutorBase.cs in the method SetRangeHeaders.https://github.com/aspnet/AspNetCore/blob/74dbb4ff4f380f093981c97c88a8c80d687db7e7/src/Mvc/src/Microsoft.AspNetCore.Mvc.Core/Infrastructure/FileResultExecutorBase.cs#L317-L327When 416 status code is set, the content length header is not reset or removed, so the response end up invalid for Kestrel and a 500 is issued.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:Microsoft.AspNetCore.App v2.1.1
5649	area-mvc	Js initialization in OnAfterRender stopped working with 0.7.0	After I upgraded to Blazor 0.7.0 I noticed that initialization scripts of 3rd party JavaScript libraries which I usually call in OnAfterRender stopped working.E.g. I use select2 (https://github.com/select2/select2) to apply a custom style for my select fields. But it seems like something has changed with Blazor 0.7.0, because the following code (which used to work in 0.6.0) dosn't work anymore:```protected override void OnAfterRender(){  base.OnAfterRender();  JsInterop.InitializeSelect2();}```My JavaScript function:```window.JsFunctions = {  initializeSelect2: function() {    $('select').select2();  }}```The control style will get applied when I call StateHasChanged() after JsInterop.InitializeSelect2(), but this will end up in an endless loop. Is there a better place to call InitializeSelect2() than OnAfterRender?**Edit:**I found the following statement about lifecycle methods in the official documentation:> OnAfterRenderAsync and OnAfterRender are called each time after a component has finished rendering. Element and component references are populated at this point. **Use this stage to perform additional initialization steps using the rendered content, such as activating third-party JavaScript libraries that operate on the rendered DOM elements.**After doing a bit of research I can say that the corresponding field is not accessible in OnAfterRender.
5648	area-mvc	Problem deserializing dictionary with object keys	I'm trying to send an object of type `Dictionary<Node, decimal>` from my controller to a page, where `Node `is a custom class I've written. When I first attempted this, I got the following error:`WASM: [System.ArgumentException] The value "App.Shared.Graph.Node" is not of type "App.Shared.Graph.Node" and cannot be used in this generic collection.`I learned that there is a more general problem of deserializing dictionaries with complex keys, and sure enough I found that if I attempted to serialize and deserialize one of my dictionaries in a unit test using Json.NET, it failed. With this in mind, I implemented the `TypeConverter` solution suggested [here](https://stackoverflow.com/questions/24504245/not-ableto-serialize-dictionary-with-complex-key-using-json-net). Now I can successfully serialize and deserialize my dictionaries in unit tests, but this still fails in my Blazor app. I now get a different error:`WASM: [System.ArgumentException] The value "{"Username":"123","Name":null,"Degree":0}" is not of type "App.Shared.Graph.Node" and cannot be used in this generic collection.`(The value cited above corresponds to one of my `Node` objects.)
5647	area-mvc	Override/add to the auto-genrated IIS rewrite rules for standalone apps	When using the standalone hosting model, The publish process generates a swanky `web.config` for us with some rewrite rules to make sure static files and urls are handled correctly in the SPA context.I'm trying to add an initial redirect to HTTPS on top of that. Following [this](https://www.hanselman.com/blog/HowToEnableHTTPStrictTransportSecurityHSTSInIIS7.aspx) article, for example, means that i want to add two rules to my web.config - one for HTTP->HTTPS redirection and one for adding an HSTS header to better protect such a redirect.Right now, The only way is to inject it into the web.config after the build/publish process is done. I'm wondering if there could be a way to define/add to the generated content as part of the process rather than outside of it.
5268	area-mvc	How to properly load an EventSource polyfill for HMR?	Hello,to use HMR on Edge an EventSource polyfill is required.What is the proper way to load one with webpack itself?Most polyfills require some form of initialization: I can put the polyfill package in the webpack entries but then, what ever JS file I put the initialization code in gets actually executed after the HMR tries to load and fail. How can configure webpack to work with this?Thank you.
5838	area-identity	How to translate Identity Core 2.1 DefaultUI to german	I'm trying to switch the Identity Core 2.1 Default UI to another language.In the startup.cs I forced the app to german but the default UI still shows up in englisch:            services.Configure<RequestLocalizationOptions>(options =>            {                options.DefaultRequestCulture = new RequestCulture("de-CH");                options.SupportedCultures = new List<CultureInfo> { new CultureInfo("de-CH") };                options.RequestCultureProviders = new List<IRequestCultureProvider>();                options.RequestCultureProviders.Insert(0, new CustomRequestCultureProvider(                    async context => new ProviderCultureResult("de")                ));            });How can I a) switch to german texts for the default UI or b) do my own german translations for the texts in the default UI?I did research for several hours already without success. I read that one may can influence the texts like error messages with .resx files but I don't know what file with which content to put where. Further more I think there should be german translations already available as they are for the .Net since years.I'm using Visual Studio for Mac and deploy the app to Azure AppServer on Windows. I welcome any help to get german translations for Identity Core 2.1 into place.
5645	area-mvc	Router cannot find route in Blazor 0.7	I have [this page](https://github.com/Entroper/FF1Randomizer/blob/25b5f89dc34bcf7aefdcf7997a343ec322ac9c98/FF1Blazorizer/Pages/Randomize.cshtml) that was working in 0.6, and stopped working when I upgraded to 0.7:```Error: System.InvalidOperationException: 'Router' cannot find any component with a route for '/Randomize'.  at Microsoft.AspNetCore.Blazor.Routing.Router.Refresh () <0x204cb00 + 0x000b2> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Routing.Router.SetParameters (Microsoft.AspNetCore.Blazor.Components.ParameterCollection parameters) <0x1fefc70 + 0x0003e> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Rendering.ComponentState.SetDirectParameters (Microsoft.AspNetCore.Blazor.Components.ParameterCollection parameters) <0x1f79500 + 0x00084> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.InitializeNewComponentFrame (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 frameIndex) <0x1f84e68 + 0x00086> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.InitializeNewSubtree (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 frameIndex) <0x1f84c58 + 0x00086> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.InsertNewFrame (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 newFrameIndex) <0x1f84940 + 0x000c2> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.AppendDiffEntriesForRange (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 oldStartIndex, System.Int32 oldEndIndexExcl, System.Int32 newStartIndex, System.Int32 newEndIndexExcl) <0x1f84050 + 0x0024a> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.ComputeDiff (Microsoft.AspNetCore.Blazor.Rendering.Renderer renderer, Microsoft.AspNetCore.Blazor.Rendering.RenderBatchBuilder batchBuilder, System.Int32 componentId, Microsoft.AspNetCore.Blazor.RenderTree.ArrayRange`1[T] oldTree, Microsoft.AspNetCore.Blazor.RenderTree.ArrayRange`1[T] newTree) <0x1f83a98 + 0x000a6> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Rendering.ComponentState.RenderIntoBatch (Microsoft.AspNetCore.Blazor.Rendering.RenderBatchBuilder batchBuilder, Microsoft.AspNetCore.Blazor.RenderFragment renderFragment) <0x1f7dc60 + 0x000b8> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Rendering.Renderer.RenderInExistingBatch (Microsoft.AspNetCore.Blazor.Rendering.RenderQueueEntry renderQueueEntry) <0x1f7d888 + 0x00040> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Rendering.Renderer.ProcessRenderQueue () <0x1f7d0a8 + 0x00050> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Rendering.Renderer.AddToRenderQueue (System.Int32 componentId, Microsoft.AspNetCore.Blazor.RenderFragment renderFragment) <0x1f7c630 + 0x0006c> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Components.RenderHandle.Render (Microsoft.AspNetCore.Blazor.RenderFragment renderFragment) <0x1f7c398 + 0x0003a> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Components.BlazorComponent.StateHasChanged () <0x1f7c2a0 + 0x00048> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Components.BlazorComponent.SetParameters (Microsoft.AspNetCore.Blazor.Components.ParameterCollection parameters) <0x1f6b270 + 0x000d8> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Rendering.ComponentState.SetDirectParameters (Microsoft.AspNetCore.Blazor.Components.ParameterCollection parameters) <0x1f79500 + 0x00084> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Rendering.Renderer.RenderRootComponent (System.Int32 componentId) <0x1f78930 + 0x00024> in <7ccdd79bd655431387991356cc8bce62>:0   at Microsoft.AspNetCore.Blazor.Browser.Rendering.BrowserRenderer.AddComponent (System.Type componentType, System.String domElementSelector) <0x1f111b0 + 0x00084> in <6e8b4c57aeeb4593b71c0de6d0ce9454>:0   at Microsoft.AspNetCore.Blazor.Hosting.WebAssemblyBlazorApplicationBuilder.CreateRenderer () <0x1ef1820 + 0x00078> in <6e8b4c57aeeb4593b71c0de6d0ce9454>:0   at Microsoft.AspNetCore.Blazor.Hosting.WebAssemblyHost.StartAsync (System.Threading.CancellationToken cancellationToken) <0x1ed0628 + 0x000f8> in <6e8b4c57aeeb4593b71c0de6d0ce9454>:0   at Microsoft.AspNetCore.Blazor.Hosting.WebAssemblyHostExtensions.Run (Microsoft.AspNetCore.Blazor.Hosting.IWebAssemblyHost host) <0x1ecfdb0 + 0x00020> in <6e8b4c57aeeb4593b71c0de6d0ce9454>:0   at FF1Blazorizer.Program.Main (System.String[] args) <0x1d7fd68 + 0x00014> in <396b29f170474361b9513c314eda4230>:0 ```I tried lots of things to isolate the error.  Eventually, I added a new .cshtml file and started copying bits of Randomize.cshtml over to it until it stopped working.  It stopped working when I added what is now [line 278](https://github.com/Entroper/FF1Randomizer/blob/25b5f89dc34bcf7aefdcf7997a343ec322ac9c98/FF1Blazorizer/Pages/Randomize.cshtml#L278).Line 278 refers to a `ViewModelFlags` class in another project `FF1Lib`.  If you look [here](https://github.com/Entroper/FF1Randomizer/blob/25b5f89dc34bcf7aefdcf7997a343ec322ac9c98/FF1Blazorizer/Shared/ViewModelFlags.cs) you'll see that I've copied all of the code for `ViewModelFlags` into the `FF1Blazorizer` project.  When I did that and referenced the "new" class, the application started working again.So I went back to line 278 and changed `FF1Blazorizer.Shared.ViewModelFlags` to `FF1Lib.ViewModelFlags` -- and it **still worked.**So I deleted ViewModelFlags.cs from the Blazor project.  **It stopped working again.**  The mere presence of a copy of the `ViewModelFlags` class in the same project "cures" the bug, even though I'm not actually referencing it.  I tried this a couple of times to make sure I hadn't messed something up, but it was consistent.
4074	area-security	Add test coverage to ensure interop with Microsoft.Owin.Security and aspnetcore 3.0+ works	In https://github.com/aspnet/Security/pull/1916, we had to entirely disable Owin cookie interop tests as a result of changing target framework support. We should re-write these tests in a way that lets us test the supported scenarios without requiring a hack to run aspnetcore assemblies on .NET Framework.The scenarios we need to ensure continue to work are:* Cookies and keys created by ASP.NET Core 3.0+ interop with Owin/Katana using Microsoft.Owin.Security.Interop 2.1.* Vice versa* Any changes to cookie formats and key formats made in 3.0+ stay backwards compatible with DataProtection 2.1
5108	area-mvc	Update components build icrementalism test to check if the component definition cache is regenerated when the component definition changes	Add a variant to  `BuildComponents_RegeneratesComponentDefinition_WhenFilesChange` that checks if the manifest.json is regenerated if the definition is updated
5107	area-mvc	Avoid recompiling \ resolving components if the declaration files are identical	When doing a declaration-only build, we can often end up with file content that is identical to existing content (i.e. only the body of `BuildRenderTree` changed, but nothing outside of it). In such a case, we could avoid the work of recompiling the temp assembly and doing component discovery which should speed up things since resolving components tends to be fairly expensive.
4070	area-servers	[Kestrel] Allow HTTP/2 stream drain timeout during trailers	aspnet/KestrelHttpServer#3077
4069	area-infrastructure	wip: Switch agent queues used during PR validation	Addresses #4067 Depends on https://github.com/dotnet/core-eng/issues/4674
5449	area-mvc	Remove <AspNetCoreHostingModel> project property from 3.0 templates	We've already changed the websdk defaults(https://github.com/aspnet/websdk/pull/407), so at this point it's redundant.cc @Eilon 
5106	area-mvc	Use namespace specified in project system \ MSBuild to calculate default namespace for components	The current code uses the path to calculate the base namespace for RazorComponents. We should instead use the `RootNamespace` property specified in MSBuild
4067	area-infrastructure	Pull request builds run out of disk space in Azure Pipelines	PRs against the master branch currently fail because the Hosted VS2017 image has limited disk space>  System.IO.IOException : There is not enough space on the diskOptions:* Switch to a new queue. I tried `dotnet-external-temp`, but this doesn't have VS C++ tooling installed* Work with @dotnet/dnceng to create a new pool* Don't run tests on PRs?cc @chcosta @Chrisboh - in case you have other ideas for options available to us.
4065	area-mvc	Razor tooling tracks which projection buffer to use	Enables partial class support for Razor Components.Improves tooling experience around tooltips.
5644	area-mvc	Json variables names	Maybe I didn't find the correct method, but I faced an issue using Dtos.I'm doing some application with a backent and a frontend sharing the same dtos in a separate dll.I used to do like this`     [JsonProperty("qnaList")]    public List<KBEntry> Entries { get; set; } = new List<KBEntry>();`but it seems Blazor doesn't support NewtonSoft Data Annottions.What could be the good solution for that problem if there's one right now.Thanks.
4942	area-mvc	Stop setting name attribute in DefaultHtmlGenerator.GenerateHiddenForCheckbox	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):See https://github.com/CXuesong/AspNetCoreAppTest2/blob/master/WebApplication2/Pages/Test.cshtml .#### Description of the problem:If I specify the `name` for `<checkbox>`, like [this](https://github.com/CXuesong/AspNetCoreAppTest2/blob/b4a609e43009c414c4a0a404b2b27d3c2f605d91/WebApplication2/Pages/Test.cshtml#L17)```cshtml<input type="checkbox" asp-for="Input.CheckBox" name="check" />```The generated hidden will still keep the default field name, i.e. `Input.CheckBox`, like this```html<input type="checkbox" name="check" data-val="true" data-val-required="The CheckBox field is required." id="Input_CheckBox" value="true">......<input name="Input.CheckBox" type="hidden" value="false">```I think the reason why a hidden is here, is to [provide "false" value for unchecked checkbox](https://stackoverflow.com/questions/2697299/asp-net-mvc-why-is-html-checkbox-generating-an-additional-hidden-input). Thus it's nonsense to generate a hidden with default field name, while we have already overridden the checkbox's `name` in razor code.It seems that in [`InputTagHelper.GenerateCheckBox`](https://github.com/aspnet/Mvc/blob/7c6823312540c72a0579f4a4b2e8357b1df42de8/src/Microsoft.AspNetCore.Mvc.TagHelpers/InputTagHelper.cs#L313), it's assumed that `GenerateHiddenForCheckbox` will return a hidden without `name` attribute, if the `Generator` won't bother to provide a non-empty fallback name. However, in [`DefaultHtmlGenerator.GenerateHiddenForCheckbox`](https://github.com/aspnet/Mvc/blob/7c6823312540c72a0579f4a4b2e8357b1df42de8/src/Microsoft.AspNetCore.Mvc.ViewFeatures/DefaultHtmlGenerator.cs#L278), the generated hidden's `name` is set to the default model name explicitly. Perhaps we need to remove this statement so that InputTagHelper.GenerateCheckBox will use the `Name` specified by the razor code.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:2.1.1
5643	area-mvc	UseUrl Option	Is it possible set a UseUrl like WebApi?`.UseUrls("http://localhost:7001/")`Because in Blazor doesn´t has this option:```public static IWebAssemblyHostBuilder CreateHostBuilder(string[] args) =>            BlazorWebAssemblyHost.CreateDefaultBuilder()                .UseBlazorStartup<Startup>();```
4941	area-mvc	Make it possible to prevent code generation per-reference	#### Is this a Bug or Feature request?Enhancement that's part of #7947#### Description of the problemUsers can currently set the `$(ServiceUriReferenceCheckIfNewer)` property to `false` (default is `true`) and disable downloading for all `<ServiceUriReference>` items in their project. However1. The existing `$(ServiceProjectReferenceCheckIfNewer)` and `$(ServiceFileReferenceCheckIfNewer)` properties aren't wired up (oops).2. Would be better to be able to disable document retrieval and code generation on a per-item basis e.g. `<ServiceUriReference ... CheckIfUriIsNewer="false" CheckIfDocumentIsNewer="true" />`.Should wire up the existing properties (renamed) as defaults for the new metadata. And, should use the new metadata in our glue code i.e. [Microsoft.Extensions.ApiDescription.Design.targets](https://github.com/aspnet/Mvc/blob/7c6823312540c72a0579f4a4b2e8357b1df42de8/src/Microsoft.Extensions.ApiDescription.Design/buildMultiTargeting/Microsoft.Extensions.ApiDescription.Design.targets).This issue is somewhat related to #8567.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the [Microsoft.Extensions.ApiDescription.Design](https://github.com/aspnet/Mvc/blob/7c6823312540c72a0579f4a4b2e8357b1df42de8/src/Microsoft.Extensions.ApiDescription.Design/) project which is scheduled to ship soon.
4062	area-servers	JWT and Windows mixed authentication. IISOptions.AutomaticAuthentication configuration not working.	### Describe the bugAssembly: Microsoft.AspNetCore.Server.IISIntegrationThe  "**AutomaticAuthentication**" boolean property of the "**Microsoft.AspNetCore.Builder.IISOptions**" class is not behaving as expected. When set to **false** the configured "**AuthenticationScheme**" is ignored and "WWW-Authenticate" response headers are sent back with "Negotiate" and "NTLM". This eventually makes the browser prompt for credentials.> Note that you have to enable "Windows Authentication" in your project properties or in IIS.> https://docs.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?view=aspnetcore-2.1> https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/iis/?view=aspnetcore-2.1```//The following is my "**ConfigureServices**" implementation.public void ConfigureServices(IServiceCollection services)        {            services.AddCors();            services.Configure<IISOptions>(o =>            {                o.AutomaticAuthentication = false;                o.ForwardClientCertificate = true;            });            services.AddMvc(config =>                {                    //Secure all controllers                    var policy = new AuthorizationPolicyBuilder()                    .RequireAuthenticatedUser()                    .Build();                    config.Filters.Add(new AuthorizeFilter(policy));                }).SetCompatibilityVersion(CompatibilityVersion.Version_2_1);            // In production, the Angular files will be served from this directory            services.AddSpaStaticFiles(configuration =>            {                configuration.RootPath = "ClientApp/dist";            });            var jwtTokenSettings = Configuration.GetSection("JwtToken");            var signKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtTokenSettings.GetValue<string>("SignKey")));            var encryptKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(jwtTokenSettings.GetValue<string>("EncryptKey")));            services.AddAuthentication(o =>            {                o.DefaultChallengeScheme = JwtBearerDefaults.AuthenticationScheme;                o.DefaultScheme = IISDefaults.AuthenticationScheme;            })            .AddJwtBearer(options =>            {                options.TokenValidationParameters = new TokenValidationParameters                {                    ValidateIssuer = true,                    ValidateAudience = true,                    ValidateLifetime = true,                    RequireExpirationTime = true,                    ValidateIssuerSigningKey = true,                    ValidIssuer = jwtTokenSettings.GetValue<string>("ValidIssuer"),                    ValidAudience = jwtTokenSettings.GetValue<string>("ValidAudience"),                    IssuerSigningKey = signKey,                    TokenDecryptionKey = encryptKey,                };            });``````[Route("api/[controller]")]    [ApiController]    public class ValuesController : ControllerBase    {        // The Authorize attribute with the "Bearer" AuthenticationScheme         [HttpGet]        [Authorize(AuthenticationSchemes = JwtBearerDefaults.AuthenticationScheme)]        public ActionResult<IEnumerable<string>> Get()        {            return new string[] { "value1", "value2" };        }}```### Expected behaviorWindows Authentication should not be automatically challenged when an "AuthenticationScheme" is configured for a different scheme.### Additional contextThe good news is that I was able to find a workaround.I've enabled IIS "Feature Delegation" for Windows authentication and added a "web.config" to the root of my project. The following configuration will only enable Windows authentication for the specified location path.```<location path="api" >        <system.webServer>      <security>        <authentication>          <windowsAuthentication enabled="false" />        </authentication>      </security>    </system.webServer>  </location>    <location path="api/account/login/windows">    <system.webServer>      <security>        <authentication>          <windowsAuthentication enabled="true" />        </authentication>      </security>    </system.webServer>  </location>```
4058	area-mvc	Investigate using connection handlers instead of SignalR hubs for interactive Razor Components	
4057	area-mvc	Tooling for Razor Component files (.razor)	Coordinate with partner teams (Web tools, Roslyn, etc.)
4056	area-mvc	Live reload	
4055	area-mvc	Publishing for Razor Components	
4054	area-mvc	Razor Components startup experience	
5642	area-mvc	"Fatal error in IL Linker" when adding reference to System.Reactive	I wanted to experiment with building a stand-alone Blazor app that utilizes some existing managed code we have which depends on `System.Reactive`. However, as soon as `System.Reactive` is added (either directly to the Blazor app project, or to any other project the Blazor app references) the following build error happens:```1>------ Rebuild All started: Project: RetrospectBlazorPoc, Configuration: Debug Any CPU ------1>RetrospectBlazorPoc -> C:\Data\Git\IDeliverable\RetrospectBlazorPoc\RetrospectBlazorPoc\bin\Debug\netstandard2.0\RetrospectBlazorPoc.dll1>Fatal error in IL Linker1>Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'System.Reactive, Version=4.1.0.0, Culture=neutral, PublicKeyToken=94bc3704cddfc263'1>   at Mono.Linker.DirectoryAssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)1>   at Mono.Linker.AssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)1>   at Mono.Linker.DirectoryAssemblyResolver.Resolve(AssemblyNameReference name)1>   at Mono.Cecil.MetadataResolver.Resolve(TypeReference type)1>   at Mono.Linker.Steps.ResolveFromAssemblyStep.ProcessLibrary(LinkContext context, AssemblyDefinition assembly, RootVisibility rootVisibility)1>   at Mono.Linker.Steps.ResolveFromAssemblyStep.ProcessLibrary(AssemblyDefinition assembly)1>   at Mono.Linker.Steps.ResolveFromAssemblyStep.Process()1>   at Mono.Linker.Steps.BaseStep.Process(LinkContext context)1>   at Mono.Linker.Pipeline.ProcessStep(LinkContext context, IStep step)1>   at Mono.Linker.Pipeline.Process(LinkContext context)1>   at Mono.Linker.Driver.Run(ILogger customLogger)1>   at Mono.Linker.Driver.Execute(String[] args, ILogger customLogger)1>C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0\targets\Blazor.MonoRuntime.targets(439,5): error MSB3073: The command "dotnet "C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0\targets\../tools/illink/illink.dll" -l none --verbose --strip-security true --exclude-feature com --exclude-feature sre -v false -c link -u link -b true -d "C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0\targets\../tools/mono/bcl/" -d "C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0\targets\../tools/mono/bcl/Facades/" -o "C:\Data\Git\IDeliverable\RetrospectBlazorPoc\RetrospectBlazorPoc\obj\Debug\netstandard2.0\blazor\linker/" -x "C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0\targets\BuiltInBclLinkerDescriptor.xml" -x "C:\Data\Git\IDeliverable\RetrospectBlazorPoc\RetrospectBlazorPoc\obj\Debug\netstandard2.0\blazor\linker.descriptor.xml" -a "C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor\0.7.0\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor.browser\0.7.0\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.Browser.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0\lib\netstandard1.0\Microsoft.AspNetCore.Blazor.TagHelperWorkaround.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\microsoft.extensions.dependencyinjection\2.1.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\microsoft.extensions.dependencyinjection.abstractions\2.1.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.Abstractions.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\microsoft.jsinterop\0.7.0\lib\netstandard2.0\Microsoft.JSInterop.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\mono.webassembly.interop\0.7.0\lib\netstandard2.0\Mono.WebAssembly.Interop.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\system.reactive\4.1.2\lib\netstandard2.0\System.Reactive.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\system.reactive.core\4.1.2\lib\netstandard2.0\System.Reactive.Core.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\system.runtime.compilerservices.unsafe\4.5.0\lib\netstandard2.0\System.Runtime.CompilerServices.Unsafe.dll" -a "C:\Users\DanielRosenberg\.nuget\packages\system.runtime.interopservices.windowsruntime\4.3.0\lib\netstandard1.3\System.Runtime.InteropServices.WindowsRuntime.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.threading.tasks.extensions\4.5.1\lib\netstandard2.0\System.Threading.Tasks.Extensions.dll" -a "C:\Data\Git\IDeliverable\RetrospectBlazorPoc\RetrospectBlazorPoc\obj\Debug\netstandard2.0\RetrospectBlazorPoc.dll"" exited with code 1.1>Done building project "RetrospectBlazorPoc.csproj" -- FAILED.========== Rebuild All: 0 succeeded, 1 failed, 0 skipped ==========```Any idea why this happens, and how to fix or work around this?
4052	area-mvc	Razor Components perf infrastructure and hello world perf test	
4050	area-mvc	Razor Components API cleanup	API review, visibility changes, etc.
4048	area-mvc	Authentication and authorization for Razor Components	
4047	area-mvc	Clean up circuits after disconnect	
4045	area-mvc	Routable components	Implement support for routable Razor ComponentsFigure out what if anything we want to do to align with endpoint routing
4044	area-mvc	Render component as HTML string	Should enable initial support for using a component from an MVC View or Page.
4041	area-mvc	Add component compilation support to the Razor SDK	
5837	area-identity	Make the presence of Identity UI more explicit in the starter template or documentation	I just started looking into authentication for Razor pages, and I found the experience with the starter template to be very confusing. I saw that there's already a couple of GitHub issues related to this, but I think the experience still needs some work. [This post on StackOverflow](https://stackoverflow.com/questions/50802781/where-are-the-login-and-register-pages-in-an-aspnet-core-scafolded-app) exemplifies exactly what I went through earlier today. I wanted to share some feedback.The idea of packaging UI in a library, especially UI as involved as authentication, is intriguing. But it hasn't been done in an ASP.net template before (that I'm aware of), so when you create a starter project and you see register and login forms that appear nowhere in your project files, it's quite disorienting. Like the poster in the StackOverflow question, I searched for that string to find the source, but found nothing. Other pages like the landing page, About, etc. do exist, but the account pages are there as if by magic.The source of the UI, the AddDefaultIdentity statement in Startup.cs, gives no hints that it comes with UI included. The previous method of including AddDefaultUI in your service configuration at least had UI in the name.Mentioning the existence of Identity UI in the documentation or somewhere in the template would help. I'm not sure what the main entry point to Razor pages is as far as documentation goes, but I was using this article: [Introduction to Identity on ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity). That might be a good place for a heads up about this new thing called Identity UI, which is the component that causing those authentication forms to appear. But you may be aware of a better place to put it.
5387	area-signalr	Add protocol package for System.Text.Json	
5386	area-signalr	Design a client experience for serverless	We never actually did this, it just happened. So let's review it and shore it up in 3.0. 
5641	area-mvc	CSSLint warnings from site.css	On a clean project if you open *site.css* you get the following warnings in VS 15.9:```Severity	Code	Description	Project	File	Line	Suppression StateWarning	overqualified-elements	(CssLint) Element (a.active) is overqualified, just use .active without element name.	WebApplication30.Client	C:\Users\user\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	69	Warning	import	(CssLint) @import prevents parallel downloads, use <link> instead.	WebApplication30.Client	C:\Users\user\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	1	Warning	fallback-colors	(CssLint) Fallback background-color (hex or RGB) should precede RGBA background-color.	WebApplication30.Client	C:\Users\daroth\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	33	Warning	fallback-colors	(CssLint) Fallback background-color (hex or RGB) should precede RGBA background-color.	WebApplication30.Client	C:\Users\user\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	70	Warning	fallback-colors	(CssLint) Fallback background-color (hex or RGB) should precede RGBA background-color.	WebApplication30.Client	C:\Users\user\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	75	Warning	fallback-colors	(CssLint) Fallback background-color (hex or RGB) should precede RGBA background-color.	WebApplication30.Client	C:\Users\user\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	84	Warning	important	(CssLint) Use of !important	WebApplication30.Client	C:\Users\user\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	111	Warning	user	(CssLint) Use of !important	WebApplication30.Client	C:\Users\daroth\Source\Repos\WebApplication30\WebApplication30.Client\wwwroot\css\site.css	112	```
4035	area-tooling	web.config is different between `dotnet new webconfig` and `dotnet publish`	dotnet new webconfig```xml<?xml version="1.0" encoding="utf-8"?><configuration>  <!-- To customize the asp.net core module uncomment and edit the following section.   For more info see https://go.microsoft.com/fwlink/?linkid=838655 -->  <!--  <system.webServer>    <handlers>      <remove name="aspNetCore"/>      <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModule" resourceType="Unspecified"/>    </handlers>    <aspNetCore processPath="%LAUNCHER_PATH%" arguments="%LAUNCHER_ARGS%" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" />  </system.webServer>  --></configuration>```and in `dotnet publish````xml<?xml version="1.0" encoding="utf-8"?><configuration>  <location path="." inheritInChildApplications="false">    <system.webServer>      <handlers>        <add name="aspNetCore" path="*" verb="*" modules="AspNetCoreModule" resourceType="Unspecified" />      </handlers>      <aspNetCore processPath="dotnet" arguments=".\webconfigtest.dll" stdoutLogEnabled="false" stdoutLogFile=".\logs\stdout" />    </system.webServer>  </location></configuration>```Is the web.config of `dotnet new webconfig` deprecated ?Please unify the web.config template.
4033	area-servers	[Question] Bootstrapping the ASP.NET Core app from multiple assemblies	I have an app composed from many Class Libraries (Plugins).My goal is to to add some components to `void Configure(IApplicationBuilder applicationBuilder)` and `void ConfigureServices(IServiceCollection services)` in each of them, at runtime.I've played with *IHostingStartup* that works pretty well as for runtime discovery and for services regitration but the `void Configure(IApplicationBuilder applicationBuilder)` is never called.In this case my goal is to register MVC in separate Assembly.Any help would be appriciated.    [assembly: HostingStartup(typeof(FrameworkStartup))]    public class FrameworkStartup : IHostingStartup    {        public void Configure(IWebHostBuilder webHostBuilder)        {            webHostBuilder.Configure(applicationBuilder =>            {                applicationBuilder.UseMvc(routeBuilder =>                {                    routeBuilder.MapRoute(                        name: "default",                        template: "{controller}/{action}",                        defaults: new {controller = "Home", action = "Index"});                });            });            webHostBuilder.ConfigureServices(serviceCollection =>            {                serviceCollection                    .AddMvcCore()                    .AddRazorViewEngine();            });        }    }}
5267	area-mvc	What about headers in RenderToStringResult	export interface RenderToStringResult {    html: string;    statusCode?: number;    globals?: { [key: string]: any };}i want set http StatusCode 303 and set response headers 'Location' for redirect...
5640	area-mvc	FormatException: Input string was not in a correct format	When working on replicating the `TabSet` component from the last Blazor community standup I got this exception with VS 2017 15.9 and the Blazor 0.7.0-preview1 build:```System.FormatException: Input string was not in a correct format. at System.Text.StringBuilder.AppendFormatHelper(IFormatProvider provider, String format, ParamsArray args) at System.String.FormatHelper(IFormatProvider provider, String format, ParamsArray args) at System.String.Format(IFormatProvider provider, String format, Object[] args) at Microsoft.AspNetCore.Razor.Language.DefaultRazorDiagnostic.GetMessage(IFormatProvider formatProvider) at Microsoft.VisualStudio.Web.Editors.Razor.RazorCodeGenerator.NotifyOnCodeGenerationComplete() at Microsoft.VisualStudio.Web.Editors.Razor.RazorCodeGenerator.<>c__DisplayClass67_0.<OnDocumentStructureChanged>b__0() at Microsoft.Web.Editor.Utility.GuardedOperations.InvokeExtensionPoint(Object errorSource, Action action) --- End of stack trace from previous location where exception was thrown --- at Microsoft.VisualStudio.Telemetry.WindowsErrorReporting.WatsonReport.GetClrWatsonExceptionInfo(Exception exceptionObject)```Here's the component file I was working on:```html<ul class="nav nav-tabs">    @foreach (var tab in tabs)    {        <li class="nav-item">            <a onclick="@(() => SelectTab(tab))" class="nav-link @(tab==)        </li>    }</ul>@functions {}```
4940	area-mvc	Determine the extensibility model for ValidationHtmlAttributeProvider	As a follow up to the [API review](https://github.com/aspnet/Mvc/issues/8694#issuecomment-438872471), the plan is to do a follow up to determine what the right extensibility needs to be  before determining what needs to be done with these types.
5948	area-hosting	WebHostBuilder appears to store two separate Configurations	HelloMy question revolves around my inability to change the configuration values used in a WebHostBuilder unless I provide a whole new IConfigurationBuilder. The issue seems to revolve around this line. https://github.com/aspnet/Hosting/blob/cfe9b26a34af15c4943240d790ee5d1a168290c9/src/Microsoft.AspNetCore.Hosting/WebHostBuilder.cs#L268Here, new configuration values are only updated in the _context, not the _config. This means in order for me to supply a new config file I now have to recreate all the settings provided by the CreateDefaultBuilder just to add a new config location/setting. Is this a mistake? If it was a design choice, can you provide some context on why this limitation was added?Thank you
4149	area-servers	Documentation: IHostLifetime.StopAsync	This issue is meant to go to this page, but unfortunately the Docs to GitHub connection is not there anymore (although now I probably have some "tech profile" I don't know what it's good for):https://docs.microsoft.com/en-us/dotnet/api/microsoft.extensions.hosting.ihostlifetime.stopasync?view=aspnetcore-2.1Since the documentation probably comes from the code, this place seems appropriate anyway.The wording "and clean up resources" sounds like wrong grammar. What does it refer to?
5639	area-mvc	Reconsider how rendering calls are run in series via sync context	In #1672, I made a change to `RemoteRenderer`'s `AddToRenderQueue` so that the rendering calls are always run in series within a given circuit. This worked by posting the rendering action to the circuit's sync context. [See code here](https://github.com/aspnet/Blazor/pull/1672/files#diff-4a18bde3a2af3f8ec6fe58b9f99c7ea2R109). This was a fix to the issue reported at #1573.However in retrospect I'm not certain this is the right fix. As per Ryan's comment:> I would expect the code after the await to resume on the sync contextWe have a test to show this does work, plus I've manually checked that our sync context *does* cause the lifecycle methods' `await` continuations to be run in series within a given circuit. So why was it necessary to make a further change to queue the render calls sequentally on the sync context? Why weren't they *already* running sequentially on the sync context?After some investigation, I think the reason is that in various places, we use `task.ContinueWith`, and surprisingly that does *not* honour `SynchonizationContext.Current` in the same way that `await` does. If we want `ContinueWith` to queue continuations on the sync context, we need to change the value of `TaskScheduler.Current` to something like `TaskScheduler.FromCurrentSynchronizationContext()`. I'm not certain where the right place to plug that in would be. If we can make this work, then we can remove the old workaround that explicitly marshals onto the sync context in `RemoteRenderer.AddToRenderQueue` (because we'll already be on it), which will be a good thing for perf.Additionally, I think we should consider being stricter about forcing all UI interactions (`Render` calls at least) to be running inside a queued work item on the renderer's corresponding sync context. In any case where that's not happening, we should consider throwing like other UI frameworks do. That would help earlier diagnosis of any weirdness we may have missed.cc @rynowak for any comments or opinions.**Repro steps**If you want to repro the original issue, go to `RemoteRenderer.cs` and remove its override of the `AddToRenderQueue` method (or comment out the call to `_syncContext.Post`, and just invoke `base.AddToRenderQueue` directly instead). Then run the E2E tests in server-side execution mode (launch `TestServer`, browse to http://localhost:port/subdir#server), open the "Concurrent renders" example, and see that the rendering has got all messed up because you removed the marshalling back onto the sync context.You can also set a breakpoint inside `RenderHandle`'s `Render` method and use the immediate window to observe that, after the `await`, the call is *not* on the circuit sync context any more.
5836	area-identity	Consider HasClaimAsync or GetClaimAsync	It is easy to get a claim from a logged in user, but not from a user that is not (yet) logged in.When generating a JWT token for my API, I want to check if the user for which the credentials are provided has the right claim to allow access to the API. Without such a check the token is provided, but than using the token fails because the access policy checks the claim. When using Roles you can use IsInRoleAsync(). But there is no equivalent for claims.So when getting the user:`  var user = await _userManager.FindByNameAsync(model.Email);          `I would like to do something like:```if (!await _userManager.HasClaimAsync(user, "IsApiUser", "true"))            {                               return BadRequest("Invalid user or password");            }```I have now written my own extension method: ```public static async Task<bool> HasClaimAsync(this UserManager<ApplicationUser> userManager,  ApplicationUser user, string claimType, string value)        {            var claims = await userManager.GetClaimsAsync(user);            var claim = claims.FirstOrDefault(c => c.Type == claimType);            return claim !=null &&  claim.Value == value;        }```I understand that HasClaim is based on cookies rather than database access, so much cheaper for logged in users:`var valid = User.HasClaim(c => c.Type == "IsApiUser" && c.Value == "true");`But I think the HasClaimAsync or an more generic GetClaimAsync is missing for cases such as the above. 
5947	area-hosting	Expose `TestServer` as public property on `RequestBuilder`	In order to make our integration tests cleaner, I've been all about adding extension methods to the [`RequestBuilder`](https://github.com/aspnet/Hosting/blob/2.1.1/src/Microsoft.AspNetCore.TestHost/RequestBuilder.cs). For example, to prevent issues around everyone learning for the first time that [HTTP methods are case-sensitive](https://tools.ietf.org/html/rfc2616#section-5.1.1), we can add a simple extension to make sure developers use method casing consistently.```cspublic static class RequestBuilderExtensions {    public static Task<HttpResponseMessage> PatchAsync(this RequestBuilder request) {        if (request == null) {            throw new ArgumentNullException(nameof(request));        }        return request.SendAsync("PATCH");    }    public static Task<HttpResponseMessage> PutAsync(this RequestBuilder request) {        if (request == null) {            throw new ArgumentNullException(nameof(request));        }        return request.SendAsync("PUT");    }    public static Task<HttpResponseMessage> DeleteAsync(this RequestBuilder request) {        if (request == null) {            throw new ArgumentNullException(nameof(request));        }        return request.SendAsync("DELETE");    }}```These are easy enough to do when the state of the `TestServer` is irrelevant for the construction of the `HttpRequestMessage`, but that's not always the case. For example, what if I want to create an extension method that sets a `Bearer` token in the `Authorization` header for a given `User`.Here's an example xUnit test:```cs[Fact]public void GetResource_ValidUser() {    // Arrange    var path = "path/to/resource";    var user = new User { EmailAddress = "me@example.com", Id = "i-am-unique" };    var request = this.TestServer.CreateRequest(path).SetUser(user);    // Act    var response = await request.GetAsync();    // Assert    Assert.Equal(HttpStatusCode.OK, response.StatusCode);}```In order to create a valid `Bearer` token, I need to be able to fetch the authentication configuration that is currently being used within the `TestServer`, but because `RequestBuilder` doesn't expose it, I can't do this. Here's what I _want_ to do:```cspublic static class RequestBuilderExtensions {    public static RequestBuilder SetUser(this RequestBuilder request, User user) {        if (user == null) {            request = request.And(message => message.Headers.Authorization = null);        } else {            // "request.TestServer" property does not exist at this time.            var server = request.TestServer;            var token = CreateToken(server.Host.Services, user);            var value = new AuthenticationHeaderValue("Bearer", token);            request = request.And(message => message.Headers.Authorization = value);        }        return request;    }    // example uses "JWT" nuget package: https://www.nuget.org/packages/JWT    private static string CreateToken(IServiceProvider services, User user) {        var config = services.GetRequiredService<IOptions<AuthenticationConfiguration>>.Value;        var now = DateTimeOffset.UtcNow;        var builder =            new JwtBuilder()                .WithAlgorithm(new HMACSHA256Algorithm())                .WithSecret(config.ClientSecret)                .AddClaim("iss", config.Issuer)                .AddClaim("sub", user.Id)                .AddClaim("aud", config.ClientId)                .AddClaim("exp", now.AddHours(1).ToUnixTimeSeconds())                .AddClaim("iat", now.AddHours(-1).ToUnixTimeSeconds())                .AddClaim("email", user.EmailAddress)                .AddClaim("email_verified", true);        return builder.Build();    }}```We get around this today by manually recreating the configuration within the static constructor of our `RequestBuilderExtensions` class rather than fetching it from the `TestServer`, but in my opinion that's a hack.I'm more than happy to submit a PR if Microsoft gives it the 👍 .
5946	area-hosting	Console.CancelKeyPress is not detach after RunAsync exits	When `WebHostExtensions.RunAsync` enters, it makes a call to `AttachCtrlcSigtermShutdown` that attaches to the `Console.CancelKeyPress` and `AppDomain.CurrentDomain.ProcessExit` event handlers. In my application, we can spin up and tear down more than one `IWebHost`. The problem is that when `RunAsync` completes and the `IWebHost` is disposed, it never removes the attached event handlers, which can cause an excessive number of `Application is shutting down...` messages when a user hits CTRL+C. 
4499	area-servers	Move diagnostics out of Hosting into a StartupFilter or middleware	This PR attempted to move the diagnostic logic into a middleware and default IStartupFilter but there were some breaking changes we were worried about making in a minor release. I think it's time to revisit this logic to see if we can move it out of the core hosting logic and into a replaceable component. There are a few goals:- Allow turning off these diagnostics- Allow customizing these diagnostics   - Setting a custom request id   - Adding/Removing data from the default log scope.Here's the original PR https://github.com/aspnet/Hosting/pull/1548. This was the main piece of feedback https://github.com/aspnet/Hosting/pull/1548#discussion_r218512835. It may require adding another event that servers fire so that this could be done from the middleware pipeline.
4016	area-servers	Emit ANCM version information as part of the build	In 2.2, we can modify the version of the produced internal ANCM package- https://github.com/dotnet/versions/blob/master/build-info/dotnet/product/cli/release/2.2/build.xml#L20We'll need a new approach for 3.0 which @natemcmaster will help define.
5266	area-mvc	How to pass environment variables to the react client?	I couldn't find any documentation on how to pass environment variables from the ASP.NET Core server to the React client when using the ASP.NET Core 2.1 React template.I know I can add an API endpoint to get the data, but I was wondering if there's something similar to [dotenv-webpack](https://www.npmjs.com/package/dotenv-webpack) so that we can use environment variables in the SPA and get them replaced by the build.
5265	area-mvc	How to have HMR with current version of the react template?	I've created a new ASP.NET Core 2.1 React project by doing `dotnet new react` which generated the following `Startup.cs` file.```    public class Startup    {        public Startup(IConfiguration configuration)        {            Configuration = configuration;        }        public IConfiguration Configuration { get; }        // This method gets called by the runtime. Use this method to add services to the container.        public void ConfigureServices(IServiceCollection services)        {            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);            // In production, the React files will be served from this directory            services.AddSpaStaticFiles(configuration =>            {                configuration.RootPath = "ClientApp/build";            });        }        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            else            {                app.UseExceptionHandler("/Error");                app.UseHsts();            }            app.UseHttpsRedirection();            app.UseStaticFiles();            app.UseSpaStaticFiles();            app.UseMvc(routes =>            {                routes.MapRoute(                    name: "default",                    template: "{controller}/{action=Index}/{id?}");            });            app.UseSpa(spa =>            {                spa.Options.SourcePath = "ClientApp";                if (env.IsDevelopment())                {                    spa.UseReactDevelopmentServer(npmScript: "start");                }            });        }    }```The documentation shown [here ](https://github.com/aspnet/JavaScriptServices/tree/master/src/Microsoft.AspNetCore.SpaServices#webpack-hot-module-replacement) seems to be outdated or doesn't seem to apply to the React template.Can we have HMR with the current version of the React template? If so, can we update the docs?
4939	area-mvc	Inifinite loop during model binding when using [ModelBinder] attribute	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):Link to repro: https://github.com/Costo/aspnetcore-binding-bug* Run project with `dotnet run`* Go to https://localhost:5001* Submit the FormExpected result:* Form is submitted and server responds with 200 OKActual result:* Server never responds. If you attach a debugger and add a breakpoint to `NumberModelBinder.BindModelAsync`, you can see that the program is in an inifinite loop (see screenshot below). ![](https://raw.githubusercontent.com/Costo/aspnetcore-binding-bug/master/screenshot.png)#### Description of the problem:The problem occurs when using a custom Model Binder for a decimal property in this model:```cspublic class TestModel{    public TestInnerModel[] InnerModels { get; set; } = new TestInnerModel[0];}public class TestInnerModel{    public TestInnerModel()    {    }    [ModelBinder(BinderType = typeof(NumberModelBinder))]    public decimal Rate { get; set; }}```During a POST, it seems that model binding is stuck in an infinite loop in [CollectionModelBinder](https://github.com/aspnet/Mvc/blob/5ed7658bf221fe136d8cedafe4c3466ed19726a3/src/Microsoft.AspNetCore.Mvc.Core/ModelBinding/Binders/CollectionModelBinder.cs#L340)The code of the `NumberModelBinder` class is actually the code of [DecimalModelBinder](https://github.com/aspnet/Mvc/blob/master/src/Microsoft.AspNetCore.Mvc.Core/ModelBinding/Binders/DecimalModelBinder.cs), with internal logging code stripped out, so nothing out of the ordinary.If the `[ModelBinder]` attribute is removed, the application works fine.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:`netcoreapp2.1` or `netcoreapp2.2` with SDK `2.2.100-preview3-009430`
5945	area-hosting	Design better server feature sniffing (e.g. are WebSockets supported)	The [design](https://github.com/aspnet/Hosting/issues/1241) we came up with for 2.1 is [not working](https://github.com/aspnet/KestrelHttpServer/issues/3081) out well.
5638	area-mvc	Allow ComponentFactory to be extended	When using a custom DI container that doesn't provide an IServiceProvider it's not possible to inject services into components.I'm using SimpleInjector as a DI container. Now I can't inject services into Views that were registered into that container.It would be great If the renderer wouldn't depend on the IServiceProvider but instead take an IComponentFactory that I can then override to provide my own implementation using my DI container. Here's a great post on the creator of SimpleInjector on this topic: https://simpleinjector.org/blog/2016/06/whats-wrong-with-the-asp-net-core-di-abstraction/
4012	area-middleware	Response caching authenticated vs non authenticated for the same page	### Is your feature request related to a problem? Please describe.I'm wondering if the following situation in asp.net core mvc can be handledhttp://www.cyberkruz.com/blog/2012/6/06/outputcache-for-unauthenticated-requests-aspnet-mvc### Describe the solution you'd likeBasically I want to have the ability to cache pages when a user isn't authenticated, but if they visit the same page while they are logged in then I don't want the cache to be used. Is this possible?### Describe alternatives you've consideredI could just use the taghelper for various sections of the page, but it's not the same as what I would really like
5835	area-identity	Problem with call UpdateSecurityStampAsync	I need to update user security stamp for logout user from system on all devices . For this purpose i wanna use UpdateSecurityStampAsync, but i get an exception and i cannot fix it```InvalidOperationException: The instance of entity type 'ApplicationUser' cannot be tracked because another instance with the same key value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached.Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap<TKey>.ThrowIdentityConflict(InternalEntityEntry entry)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap<TKey>.Add(TKey key, InternalEntityEntry entry, bool updateDuplicate)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap<TKey>.Add(TKey key, InternalEntityEntry entry)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.NullableKeyIdentityMap<TKey>.Add(InternalEntityEntry entry)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, bool acceptChanges)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, bool acceptChanges, Nullable<EntityState> forceStateWhenUnknownKey)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode node, bool force)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph<TState>(EntityEntryGraphNode node, TState state, Func<EntityEntryGraphNode, TState, bool> handleNode)Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState entityState, bool forceStateWhenUnknownKey)Microsoft.EntityFrameworkCore.DbContext.SetEntityState(InternalEntityEntry entry, EntityState entityState)Microsoft.EntityFrameworkCore.DbContext.SetEntityState<TEntity>(TEntity entity, EntityState entityState)Microsoft.EntityFrameworkCore.DbContext.Attach<TEntity>(TEntity entity)Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore<TUser, TRole, TContext, TKey, TUserClaim, TUserRole, TUserLogin, TUserToken, TRoleClaim>.UpdateAsync(TUser user, CancellationToken cancellationToken)Microsoft.AspNetCore.Identity.UserManager<TUser>.UpdateUserAsync(TUser user)Microsoft.AspNetCore.Identity.UserManager<TUser>.UpdateSecurityStampAsync(TUser user)WebAIS.Services.UserManager.UserManagerService.UpdateSecurityStampAsync(ApplicationUser user) in UserManagerService.cs``````c#/// Метод обновляет SecurityStamp для пользователя        /// </summary>        /// <param name="user">Пользователь</param>        public async Task<IdentityResult> UpdateSecurityStampAsync(ApplicationUser user)        {            var result = await _userManager.UpdateSecurityStampAsync(user);            await ResetUserRedisCacheAsync(user);            return result;        }```I changed the type of used services to the scoped and singleton, but this did not solve the problem
4693	area-servers	Consume SequenceReader from CoreFX	`SequenceReader<T>` is the CoreFX implementation of `BufferReader<T>`.  Any drop of CoreFX past https://github.com/dotnet/corefx/commit/9ae14ba629e7547b2d27180431cfd7f5a3c14709 will have this type.#3068 implements changes that are based on an API compatible `BufferReader<T>` that `SequenceReader<T>` should just drop in and replace.
5637	area-mvc	Problem of compiling a generic component	I have the following problem.The **MyClass** class is placed in the BlazorTest.Shared project and it's defined as:```namespace BlazorTest.Shared{    public class MyClass    {    }}```I have also created a simple component, called **MyComponent**:```@using BlazorTest.Shared@typeparam T<div></div>@functions {[Parameter] T PropertyToInferType { get; set; }[Parameter] MyClass MyProperty { get; set; }}```My page looks like this:```@using BlazorTest.Shared@page "/counter"<MyComponent PropertyToInferType="3" MyProperty="@MyObject" />@functions {    MyClass MyObject = new MyClass();}```I'm getting the compile-time errors:> The type or namespace name 'Shared' does not exist in the namespace '__Blazor.BlazorTest' (are you missing an assembly reference?)> Argument 6: cannot convert from 'BlazorTest.Shared.MyClass' to '__Blazor.BlazorTest.Shared.MyClass'If I remove the `@typeparam` directive and modify the component by removing the `PropertyToInferType`  property, then everything compiles without errors.Am I missing something?PS. Blazor is awesome.
4639	area-security	chunkingcookiemanager leaks unused chunks	There seems to be a bug in Microsoft.AspNetCore.Authentication.Cookies.ChunkingCookieManager when used in conjunction with CookieAuthentication.  What I've seen is that as the size of the Authentication cookie changes the number of chunks needed to the accommodate the cookie data will change as well.  If the number of cookies needed decreases, then chunks that are no longer needed are not being cleaned up.  Normally this isn't a big deal, but I'm currently running in a system that has a hard limit on the header size of 10240 bytes.  The specify scenario I'm running into has the Authentication cookies going from 2 chunks (3 total cookies) to 1 chunk (1 cookie).  This has the added bonus of replacing the value in the cookie that previously stored the chunk count (really small), to now storing the entire Authentication Ticket (relatively large), in turn nearly doubling the amount of header space consumed by the Authentication cookie.It seems like it could be beneficial to have ChunkingCookieManager  expire these "vestigial" as it's setting the new chunks on the response.
5944	area-hosting	Remove dependencies from the default set adding by ConfigureWebHost	Today we add a set of dependencies that mirror the WebHostBuilder https://github.com/aspnet/Hosting/blob/d7b9fd480765bdc01f06441f308fb288e6001049/src/Microsoft.AspNetCore.Hosting/WebHostBuilder.cs#L270-L285. Things we may want to remove:- ObjectPoolProvider- DiagnosticListener/DiagnosticSource@Tratcher @rynowak 
4003	area-tooling	Logout button logs out but does not refresh the icon to display Login/Register button	### Describe the bugLogout button logs out but does not refresh the icon to display Login/Register button after you add Area's to Project.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core 2.2 Preview 32. Run this code        a. Create a New Project with individual user account authentication and Scaffold Identity       b. Add A new Area "Customer" and move home controller inside the Area.       c. Move the Views for "Home" under "Customer" area.       d. Run the project and register for a new user. And then hit the logout button.3. See error : The logout button will still remain after you have logged out.This works fine if you have not added Areas.### Expected behaviorOnce you hit logout button, it should be modified to Login.
6016	area-middleware	Url rewrite should support option updates	Use case: I have a static files host application with some complex configuration and it should support updating the redirects config on the fly.Currently, RewriteMiddleware accepts IOptions and reads its value only once. It would be great to replace IOptions with IOptionsMonitor and use its CurrentValue for each request.Similar feature: https://github.com/aspnet/BasicMiddleware/issues/317
5636	area-mvc	Generic type bindings	I have the following component (myInput.cshtml):```@typeparam TProperty<div>    <input bind="@myValue" /></div>@functions{[Parameter]private TProperty myValue { get; set; }[Parameter]private Action<TProperty> myValueChanged { get; set; }}```and I'm trying to use it that way:`<myInput bind-myValue="@Test"></myInput>`where Test is defined as`public string Test { get; set; }`It results with the following error message:> 'bind' does not accept values of type System.String. To read and write this value type, wrap it in a property of type string with suitable getters and setters.I suppose this message comes from the BindMethods.SetValueHandler<T>(Action<T> setter, T existingValue) method.Is there any way to work it around to create a custom component that would be able to handle `string`, `bool`, and `int` bindings in the same code, or have I just simply create different components for different binding types at the moment?
3999	area-security	Remove AuthenticationManager in 3.0?	**Microsoft.AspNetCore.Http.Authentication.AuthenticationManager** has been marked obsolete in 2.0.Perhaps you should consider removing it (and related classes) in 3.0.
5834	area-identity	EmailConfirmationToken generated from UserManager does not reflect user's email address	The token generated by `UserManager.GenerateEmailConfirmationTokenAsync` does not reflect current email address of the user, and no email address assertion is performed when validating a  confirmation token.Therefore the user is able to "confirm" his/her updated email address (B) by following a link containing a token generated before the changing is made when the email address was actually (A) if he/she changes his/her email address to (B).This causes some risk that a user could "confirm" an email address doesn't really owned by him/her unless application blocks further email address changing before a pending confirmation completes.
5105	area-mvc	Whitespace between two RazorComments should be markup	```HTML<div>@* Comment1 *@|    |@* Comment2 *@</div>```In the above case, the whitespace between the two comments should be rendered but it is not.We did a related change years ago https://github.com/aspnet/Razor/issues/428. Also, this is a low priority issue as this has been the behavior forever and no one has asked for this.
4938	area-mvc	RazorPages do not respect HtmlFieldPrefix	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):In any RazorPage add: ```@{    ViewData.TemplateInfo.HtmlFieldPrefix = "Prefix";}<form>    <input asp-for="SomeModelProperty" /></form>```#### Description of the problem:The generated input tag helper does not respect the `Prefix` field prefix.This works: `ViewContext.ViewData.TemplateInfo.HtmlFieldPrefix = "Prefix";`@pranavkm said he had an idea as to why.
5264	area-mvc	Hide port of SPA server in console output	[Multiple](https://github.com/aspnet/Templating/issues/820) [people](https://github.com/aspnet/Templating/issues/666) [have been confused](https://github.com/aspnet/Templating/issues/821) about which port they should go to and end up going to the port for the SPA server directly instead of going to the AspNetCore server and letting it proxy them in, which can lead to problems with scenarios like the FetchData page.One way to resolve this would be to strip lines such as `Starting create-react-app server on port 49917...` out of the console output before copying them from the SPA process to the AspNetCore process, so that the only ports visible there are the (proper) AspNetCore ports.
5104	area-mvc	Investigate and update rzc test to react to netcoreapp3.0 changes	This test https://github.com/aspnet/Razor/blob/master/test/Microsoft.NET.Sdk.Razor.Test/IntegrationTests/BuildServerIntegrationTest.cs#L118 has started behaving differently and one of our assumptions about Mutex constructor no longer seems to be true. Need to investigate and update the test.
5385	area-signalr	CORS issue with latest SignalR with CORS and MVC with default routes	Hello,I'm on the latest version of SignalR Core and using this with Asp.Net Core, using CORS and MVC: On HttpSysServer for server and Angular 4 for client.I used to have everything running perfectly (system is in production), but I refactored how my routes are defined. I set them up now using UseMvcWithDefaultRoute. As soon as I switched to this, I got an error message enabling my SignalR connection. If I switch back to only UseMvc, the connection occurs correctly.Below I'll include the relevant code and error message.I'm wondering what I don't have correctly configured, but also why a preflight is sent to a websocket request? (Unless it's falling back on another protocol?)Thanks!```csharppublic void ConfigureServices(IServiceCollection services){            //...            #region  Setup CORS            var corsBuilder = new CorsPolicyBuilder();            //corsBuilder.AllowAnyOrigin(); // For anyone access.            corsBuilder.WithOrigins(new[] { "http://localhost:4200",                                            "http://productionSite.com" }); // for a specific url. Don't add a forward slash on the end!            corsBuilder.AllowAnyHeader();            corsBuilder.AllowCredentials();            corsBuilder.AllowAnyMethod();            services.AddCors(options =>            {                options.AddPolicy("SiteCorsPolicy", corsBuilder.Build());            });            #endregion            services.AddSignalR(options =>            {                options.EnableDetailedErrors = true;            });            services.AddMvc(config =>            {                // Add XML Content Negotiation                config.RespectBrowserAcceptHeader = true;                config.InputFormatters.Add(new XmlSerializerInputFormatter());                config.OutputFormatters.Add(new XmlSerializerOutputFormatter());                // Global exception handler                config.Filters.Add(typeof(Filters.GlobalExceptionFilterAttribute));            });            // ...}``````csharppublic void Configure(IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory, IServiceScopeFactory scopeFactory, IApplicationLifetime applicationLifetime)        {            // ...            app.UseCors("SiteCorsPolicy"); // UseCors() has to be called before UseMvcWithDefaultRoute() and before UseSignalR()            app.UseSignalR(routes =>            {                routes.MapHub<MainHub>("/MainHub");            }); // UseSignalR() has to be called after UseCors()            app.UseMvcWithDefaultRoute(); // UseMvcWithDefaultRoute() has to be called after UseCors()            // app.UseMvc(); // UseMvcWithDefaultRoute() has to be called after UseCors()            // app.UseMvc(routes => { routes.MapRoute("default", "{controller=Home}/{action=Index}/{id?}");             // ...});        }```And error message from the client connecting.`Access to XMLHttpRequest at 'http://serverUrl/v1/AppName/MainHub/negotiate' from origin 'http://localhost:4200' has been blocked by CORS policy: Response to preflight request doesn't pass access control check: No 'Access-Control-Allow-Origin' header is present on the requested resource.Utils.js:193 Warning: Error from HTTP request. 0: ConsoleLogger.log @ Utils.js:193xhr.onerror @ HttpClient.js:98wrapFn @ zone.js:1166ZoneDelegate.invokeTask @ zone.js:425onInvokeTask @ core.es5.js:3881ZoneDelegate.invokeTask @ zone.js:424Zone.runTask @ zone.js:192ZoneTask.invokeTask @ zone.js:499invokeTask @ zone.js:1540globalZoneAwareCallback @ zone.js:1566error (async)customScheduleGlobal @ zone.js:1666ZoneDelegate.scheduleTask @ zone.js:411onScheduleTask @ zone.js:301ZoneDelegate.scheduleTask @ zone.js:405Zone.scheduleTask @ zone.js:236Zone.scheduleEventTask @ zone.js:262(anonymous) @ zone.js:1832(anonymous) @ http.es5.js:1274Observable._trySubscribe @ Observable.js:172Observable.subscribe @ Observable.js:160(anonymous) @ datasvc.ts:28ZoneAwarePromise @ zone.js:890DataSvc.makeRequest @ datasvc.ts:27BorrowService.getAll@ borrow.service.ts:73BorrowGridComponent.initializeData @ borrow-grid.component.ts:236BorrowGridComponent.ngOnInit @ borrow-grid.component.ts:101checkAndUpdateDirectiveInline @ core.es5.js:10843checkAndUpdateNodeInline @ core.es5.js:12341checkAndUpdateNode @ core.es5.js:12284debugCheckAndUpdateNode @ core.es5.js:13141debugCheckDirectivesFn @ core.es5.js:13082(anonymous) @ BorrowPage.html:23debugUpdateDirectives @ core.es5.js:13067checkAndUpdateView @ core.es5.js:12251callViewAction @ core.es5.js:12599execComponentViewsAction @ core.es5.js:12531checkAndUpdateView @ core.es5.js:12257callViewAction @ core.es5.js:12599execEmbeddedViewsAction @ core.es5.js:12557checkAndUpdateView @ core.es5.js:12252callViewAction @ core.es5.js:12599execComponentViewsAction @ core.es5.js:12531checkAndUpdateView @ core.es5.js:12257callWithDebugContext @ core.es5.js:13467debugCheckAndUpdateView @ core.es5.js:13007ViewRef_.detectChanges @ core.es5.js:10174(anonymous) @ core.es5.js:4812ApplicationRef_.tick @ core.es5.js:4812(anonymous) @ core.es5.js:4684ZoneDelegate.invoke @ zone.js:392onInvoke @ core.es5.js:3890ZoneDelegate.invoke @ zone.js:391Zone.run @ zone.js:142NgZone.run @ core.es5.js:3821next @ core.es5.js:4684schedulerFn @ core.es5.js:3635SafeSubscriber.__tryOrUnsub @ Subscriber.js:239SafeSubscriber.next @ Subscriber.js:186Subscriber._next @ Subscriber.js:127Subscriber.next @ Subscriber.js:91Subject.next @ Subject.js:56EventEmitter.emit @ core.es5.js:3621checkStable @ core.es5.js:3855onHasTask @ core.es5.js:3903ZoneDelegate.hasTask @ zone.js:445ZoneDelegate._updateTaskCount @ zone.js:465Zone._updateTaskCount @ zone.js:289Zone.runTask @ zone.js:209drainMicroTaskQueue @ zone.js:602Promise.then (async)scheduleMicroTask @ zone.js:585ZoneDelegate.scheduleTask @ zone.js:414Zone.scheduleTask @ zone.js:236Zone.scheduleMicroTask @ zone.js:256scheduleResolveOrReject @ zone.js:871ZoneAwarePromise.then @ zone.js:981PlatformRef_._bootstrapModuleWithZone @ core.es5.js:4537PlatformRef_.bootstrapModule @ core.es5.js:4522(anonymous) @ main.ts:11./src/main.ts @ main.bundle.js:1135__webpack_require__ @ inline.bundle.js:550 @ main.bundle.js:1143__webpack_require__ @ inline.bundle.js:55webpackJsonpCallback @ inline.bundle.js:26(anonymous) @ main.bundle.js:1Utils.js:190 Error: Failed to complete negotiation with the server: ErrorConsoleLogger.log @ Utils.js:190(anonymous) @ HttpConnection.js:230step @ HttpConnection.js:33(anonymous) @ HttpConnection.js:14rejected @ HttpConnection.js:6ZoneDelegate.invoke @ zone.js:392onInvoke @ core.es5.js:3890ZoneDelegate.invoke @ zone.js:391Zone.run @ zone.js:142(anonymous) @ zone.js:873ZoneDelegate.invokeTask @ zone.js:425onInvokeTask @ core.es5.js:3881ZoneDelegate.invokeTask @ zone.js:424Zone.runTask @ zone.js:192drainMicroTaskQueue @ zone.js:602ZoneTask.invokeTask @ zone.js:503invokeTask @ zone.js:1540globalZoneAwareCallback @ zone.js:1566error (async)customScheduleGlobal @ zone.js:1666ZoneDelegate.scheduleTask @ zone.js:411onScheduleTask @ zone.js:301ZoneDelegate.scheduleTask @ zone.js:405Zone.scheduleTask @ zone.js:236Zone.scheduleEventTask @ zone.js:262(anonymous) @ zone.js:1832(anonymous) @ http.es5.js:1274Observable._trySubscribe @ Observable.js:172Observable.subscribe @ Observable.js:160(anonymous) @ datasvc.ts:28ZoneAwarePromise @ zone.js:890DataSvc.makeRequest @ datasvc.ts:27BorrowService.getAll@ borrow.service.ts:73BorrowGridComponent.initializeData @ borrow-grid.component.ts:236BorrowGridComponent.ngOnInit @ borrow-grid.component.ts:101checkAndUpdateDirectiveInline @ core.es5.js:10843checkAndUpdateNodeInline @ core.es5.js:12341checkAndUpdateNode @ core.es5.js:12284debugCheckAndUpdateNode @ core.es5.js:13141debugCheckDirectivesFn @ core.es5.js:13082(anonymous) @ BorrowPage.html:23debugUpdateDirectives @ core.es5.js:13067checkAndUpdateView @ core.es5.js:12251callViewAction @ core.es5.js:12599execComponentViewsAction @ core.es5.js:12531checkAndUpdateView @ core.es5.js:12257callViewAction @ core.es5.js:12599execEmbeddedViewsAction @ core.es5.js:12557checkAndUpdateView @ core.es5.js:12252callViewAction @ core.es5.js:12599execComponentViewsAction @ core.es5.js:12531checkAndUpdateView @ core.es5.js:12257callWithDebugContext @ core.es5.js:13467debugCheckAndUpdateView @ core.es5.js:13007ViewRef_.detectChanges @ core.es5.js:10174(anonymous) @ core.es5.js:4812ApplicationRef_.tick @ core.es5.js:4812(anonymous) @ core.es5.js:4684ZoneDelegate.invoke @ zone.js:392onInvoke @ core.es5.js:3890ZoneDelegate.invoke @ zone.js:391Zone.run @ zone.js:142NgZone.run @ core.es5.js:3821next @ core.es5.js:4684schedulerFn @ core.es5.js:3635SafeSubscriber.__tryOrUnsub @ Subscriber.js:239SafeSubscriber.next @ Subscriber.js:186Subscriber._next @ Subscriber.js:127Subscriber.next @ Subscriber.js:91Subject.next @ Subject.js:56EventEmitter.emit @ core.es5.js:3621checkStable @ core.es5.js:3855onHasTask @ core.es5.js:3903ZoneDelegate.hasTask @ zone.js:445ZoneDelegate._updateTaskCount @ zone.js:465Zone._updateTaskCount @ zone.js:289Zone.runTask @ zone.js:209drainMicroTaskQueue @ zone.js:602Promise.then (async)scheduleMicroTask @ zone.js:585ZoneDelegate.scheduleTask @ zone.js:414Zone.scheduleTask @ zone.js:236Zone.scheduleMicroTask @ zone.js:256scheduleResolveOrReject @ zone.js:871ZoneAwarePromise.then @ zone.js:981PlatformRef_._bootstrapModuleWithZone @ core.es5.js:4537PlatformRef_.bootstrapModule @ core.es5.js:4522(anonymous) @ main.ts:11./src/main.ts @ main.bundle.js:1135__webpack_require__ @ inline.bundle.js:550 @ main.bundle.js:1143__webpack_require__ @ inline.bundle.js:55webpackJsonpCallback @ inline.bundle.js:26(anonymous) @ main.bundle.js:1Utils.js:190 Error: Failed to start the connection: ErrorConsoleLogger.log @ Utils.js:190(anonymous) @ HttpConnection.js:191step @ HttpConnection.js:33(anonymous) @ HttpConnection.js:14rejected @ HttpConnection.js:6ZoneDelegate.invoke @ zone.js:392onInvoke @ core.es5.js:3890ZoneDelegate.invoke @ zone.js:391Zone.run @ zone.js:142(anonymous) @ zone.js:873ZoneDelegate.invokeTask @ zone.js:425onInvokeTask @ core.es5.js:3881ZoneDelegate.invokeTask @ zone.js:424Zone.runTask @ zone.js:192drainMicroTaskQueue @ zone.js:602ZoneTask.invokeTask @ zone.js:503invokeTask @ zone.js:1540globalZoneAwareCallback @ zone.js:1566error (async)customScheduleGlobal @ zone.js:1666ZoneDelegate.scheduleTask @ zone.js:411onScheduleTask @ zone.js:301ZoneDelegate.scheduleTask @ zone.js:405Zone.scheduleTask @ zone.js:236Zone.scheduleEventTask @ zone.js:262(anonymous) @ zone.js:1832(anonymous) @ http.es5.js:1274Observable._trySubscribe @ Observable.js:172Observable.subscribe @ Observable.js:160(anonymous) @ datasvc.ts:28ZoneAwarePromise @ zone.js:890DataSvc.makeRequest @ datasvc.ts:27BorrowService.getAll@ borrow.service.ts:73BorrowGridComponent.initializeData @ borrow-grid.component.ts:236BorrowGridComponent.ngOnInit @ borrow-grid.component.ts:101checkAndUpdateDirectiveInline @ core.es5.js:10843checkAndUpdateNodeInline @ core.es5.js:12341checkAndUpdateNode @ core.es5.js:12284debugCheckAndUpdateNode @ core.es5.js:13141debugCheckDirectivesFn @ core.es5.js:13082(anonymous) @ BorrowPage.html:23debugUpdateDirectives @ core.es5.js:13067checkAndUpdateView @ core.es5.js:12251callViewAction @ core.es5.js:12599execComponentViewsAction @ core.es5.js:12531checkAndUpdateView @ core.es5.js:12257callViewAction @ core.es5.js:12599execEmbeddedViewsAction @ core.es5.js:12557checkAndUpdateView @ core.es5.js:12252callViewAction @ core.es5.js:12599execComponentViewsAction @ core.es5.js:12531checkAndUpdateView @ core.es5.js:12257callWithDebugContext @ core.es5.js:13467debugCheckAndUpdateView @ core.es5.js:13007ViewRef_.detectChanges @ core.es5.js:10174(anonymous) @ core.es5.js:4812ApplicationRef_.tick @ core.es5.js:4812(anonymous) @ core.es5.js:4684ZoneDelegate.invoke @ zone.js:392onInvoke @ core.es5.js:3890ZoneDelegate.invoke @ zone.js:391Zone.run @ zone.js:142NgZone.run @ core.es5.js:3821next @ core.es5.js:4684schedulerFn @ core.es5.js:3635SafeSubscriber.__tryOrUnsub @ Subscriber.js:239SafeSubscriber.next @ Subscriber.js:186Subscriber._next @ Subscriber.js:127Subscriber.next @ Subscriber.js:91Subject.next @ Subject.js:56EventEmitter.emit @ core.es5.js:3621checkStable @ core.es5.js:3855onHasTask @ core.es5.js:3903ZoneDelegate.hasTask @ zone.js:445ZoneDelegate._updateTaskCount @ zone.js:465Zone._updateTaskCount @ zone.js:289Zone.runTask @ zone.js:209drainMicroTaskQueue @ zone.js:602Promise.then (async)scheduleMicroTask @ zone.js:585ZoneDelegate.scheduleTask @ zone.js:414Zone.scheduleTask @ zone.js:236Zone.scheduleMicroTask @ zone.js:256scheduleResolveOrReject @ zone.js:871ZoneAwarePromise.then @ zone.js:981PlatformRef_._bootstrapModuleWithZone @ core.es5.js:4537PlatformRef_.bootstrapModule @ core.es5.js:4522(anonymous) @ main.ts:11./src/main.ts @ main.bundle.js:1135__webpack_require__ @ inline.bundle.js:550 @ main.bundle.js:1143__webpack_require__ @ inline.bundle.js:55webpackJsonpCallback @ inline.bundle.js:26(anonymous) @ main.bundle.js:1signalr.service.ts:53 Error while establishing connectionsignalr.service.ts:54 Error    at new HttpError (Errors.js:25)    at XMLHttpRequest.xhr.onerror [as __zone_symbol__ON_PROPERTYerror] (HttpClient.js:99)    at XMLHttpRequest.wrapFn (zone.js:1166)    at ZoneDelegate.invokeTask (zone.js:425)    at Object.onInvokeTask (core.es5.js:3881)    at ZoneDelegate.invokeTask (zone.js:424)    at Zone.runTask (zone.js:192)    at ZoneTask.invokeTask [as invoke] (zone.js:499)    at invokeTask (zone.js:1540)    at XMLHttpRequest.globalZoneAwareCallback (zone.js:1566)`
5384	area-signalr	Native compile fails on UWP when adding Microsoft.AspNetCore.SignalR.Protocols.MessagePack reference	* Versions of Client-Side NuGet/NPM Packages: * Are you using the C# client client: 1.0.4* The Operating System on the Client (Windows/Linux/macOS): UWPNative compile fails on UWP when adding Microsoft.AspNetCore.SignalR.Protocols.MessagePack reference. I expect this is caused by a reference to `System.Reflection.Emit` in de `MessagePack` dependency.Repro:- Create new UWP app using the Blank App (Universal Windows) template in VS2017- Add NuGet package: Microsoft.AspNetCore.SignalR.Protocols.MessagePack- Switch to Release mode- Build- Build fails with the following error:```1>C:\Program Files (x86)\Microsoft Visual Studio\2017\Enterprise\MSBuild\15.0\Bin\Microsoft.Common.CurrentVersion.targets(2110,5): warning MSB3277: Found conflicts between different versions of "System.Threading.Tasks.Extensions" that could not be resolved.  These reference conflicts are listed in the build log when log verbosity is set to detailed.1>  App3 -> C:\Users\ismai\source\repos\App3\App3\bin\x86\Release\App3.exe1>  Processing application code1>  Computing application closure and generating interop code1>    Loading 110 modules...1>    Generating code...1>    Interop code generated.1>  Compiling interop code1>  Generating System.Reflection.DispatchProxy proxy code.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.FieldBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.ILGenerator' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.MethodBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildSerialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.LocalBuilder' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in method 'AutomataDictionary.EmitMatch(ILGenerator, LocalBuilder, LocalBuilder, LocalBuilder, Action<KeyValuePair<string, int>>, Action)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.AssemblyBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in type 'MessagePack.Internal.DynamicAssembly'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.ModuleBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in type 'MessagePack.Internal.DynamicAssembly'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.TypeBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicAssembly.DefineType(string, TypeAttributes)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.Label' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in type 'MessagePack.Resolvers.DynamicUnionResolver+<>c'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicEnumResolver.BuildType(Type)' will always throw an exception due to the missing method 'TypeBuilder.DefineMethod(string, MethodAttributes, Type, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.ConstructorBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildType(Type)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.BuildType(Type)' will always throw an exception due to the missing method 'TypeBuilder.DefineConstructor(MethodAttributes, CallingConventions, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.BuildSerialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.EmitOffsetPlusEqual(ILGenerator, Action, Action)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.BuildDeserialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.EmitOffsetPlusReadSize(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicAssembly..ctor(string)' will always throw an exception due to the missing method 'AssemblyBuilder.DefineDynamicAssembly(AssemblyName, AssemblyBuilderAccess)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicAssembly.DefineType(string, TypeAttributes)' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicAssembly.DefineType(string, TypeAttributes, Type)' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes, Type)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicAssembly.DefineType(string, TypeAttributes, Type, Type[])' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes, Type, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitLdloc(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitStloc(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitLdloca(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitLdc_I4(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitUnboxOrCast(ILGenerator, Type)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitBoxOrDoNothing(ILGenerator, Type)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitLdarg(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitLdarga(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitStarg(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitPop(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitCall(ILGenerator, MethodInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitLdfld(ILGenerator, FieldInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitLdsfld(ILGenerator, FieldInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitRet(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitIntZeroReturn(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitNullReturn(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitULong(ILGenerator, ulong)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, long)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitThrowNotimplemented(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ILGeneratorExtensions.EmitIncrementFor(ILGenerator, LocalBuilder, Action<LocalBuilder>)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.BuildType(DynamicAssembly, Type, bool, bool)' will always throw an exception due to the missing method 'TypeBuilder.DefineConstructor(MethodAttributes, CallingConventions, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0005: Type 'System.Reflection.Emit.DynamicMethod' from assembly 'System.Reflection.Emit.Lightweight' was not included in compilation, but was referenced in method 'DynamicObjectTypeBuilder.BuildFormatterToDynamicMethod(Type, bool, bool, bool)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.BuildFormatterToDynamicMethod(Type, bool, bool, bool)' will always throw an exception due to the missing method 'DynamicMethod..ctor(string, Type, Type[], Type, bool)' in assembly 'System.Reflection.Emit.Lightweight'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.BuildConstructor(Type, ObjectSerializationInfo, ConstructorInfo, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.BuildCustomFormatterField(TypeBuilder, ObjectSerializationInfo, ILGenerator)' will always throw an exception due to the missing method 'TypeBuilder.DefineField(string, Type, FieldAttributes)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.BuildSerialize(Type, ObjectSerializationInfo, ILGenerator, Action, Func<int, ObjectSerializationInfo.EmittableMember, Action>, int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.EmitOffsetPlusEqual(ILGenerator, Action, Action, ArgumentField, ArgumentField)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.BuildDeserialize(Type, ObjectSerializationInfo, ILGenerator, Func<int, ObjectSerializationInfo.EmittableMember, Action>, int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.EmitOffsetPlusReadSize(ILGenerator, ArgumentField, ArgumentField)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.EmitNewObject(ILGenerator, Type, ObjectSerializationInfo, DynamicObjectTypeBuilder.DeserializeInfo[])' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.<>c__DisplayClass11_0.<BuildSerialize>b__2(UnionAttribute)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.<>c__DisplayClass11_1.<BuildSerialize>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.<>c__DisplayClass11_1.<BuildSerialize>b__5()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicUnionResolver.<>c__DisplayClass13_0.<BuildDeserialize>b__0(UnionAttribute)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'AutomataDictionary.AutomataNode.EmitSearchNextCore(ILGenerator, LocalBuilder, LocalBuilder, LocalBuilder, Action<KeyValuePair<string, int>>, Action, AutomataDictionary.AutomataNode[], int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass4_2.<BuildFormatterToDynamicMethod>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass4_4.<BuildFormatterToDynamicMethod>b__6()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass7_3.<BuildSerialize>b__11()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass9_0.<EmitSerializeValue>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_0.<BuildDeserialize>b__2(int)' will always throw an exception due to the missing method 'ILGenerator.DeclareLocal(Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_1.<BuildDeserialize>b__3(ObjectSerializationInfo.EmittableMember)' will always throw an exception due to the missing method 'ILGenerator.DeclareLocal(Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_2.<BuildDeserialize>b__4(LocalBuilder)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_3.<BuildDeserialize>b__5(KeyValuePair<string, int>)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Label)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_3.<BuildDeserialize>b__6()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Label)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_4.<BuildDeserialize>b__7(LocalBuilder)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ObjectSerializationInfo.EmittableMember.EmitLoadValue(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'ObjectSerializationInfo.EmittableMember.EmitStoreValue(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'AutomataDictionary.AutomataNode.<>c__DisplayClass19_0.<EmitSearchNextCore>b__2(int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): warning : ILTransform : warning ILT0003: Method 'AutomataDictionary.AutomataNode.<>c__DisplayClass19_0.<EmitSearchNextCore>b__3(int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>  Cleaning up unreferenced code1>  Generating native code1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.FieldBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.FieldBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.ILGenerator' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.MethodBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildSerialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.LocalBuilder' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in method 'AutomataDictionary.EmitMatch(ILGenerator, LocalBuilder, LocalBuilder, LocalBuilder, Action<KeyValuePair<string, int>>, Action)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.AssemblyBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in type 'MessagePack.Internal.DynamicAssembly'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.ModuleBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in type 'MessagePack.Internal.DynamicAssembly'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.TypeBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicAssembly.DefineType(string, TypeAttributes)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.Label' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in type 'MessagePack.Resolvers.DynamicUnionResolver+<>c'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicEnumResolver.BuildType(Type)' will always throw an exception due to the missing method 'TypeBuilder.DefineMethod(string, MethodAttributes, Type, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.ConstructorBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildType(Type)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildType(Type)' will always throw an exception due to the missing method 'TypeBuilder.DefineConstructor(MethodAttributes, CallingConventions, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildSerialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.EmitOffsetPlusEqual(ILGenerator, Action, Action)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildDeserialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.EmitOffsetPlusReadSize(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly..ctor(string)' will always throw an exception due to the missing method 'AssemblyBuilder.DefineDynamicAssembly(AssemblyName, AssemblyBuilderAccess)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly.DefineType(string, TypeAttributes)' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly.DefineType(string, TypeAttributes, Type)' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes, Type)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly.DefineType(string, TypeAttributes, Type, Type[])' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes, Type, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdloc(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitStloc(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdloca(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdc_I4(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitUnboxOrCast(ILGenerator, Type)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitBoxOrDoNothing(ILGenerator, Type)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdarg(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdarga(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitStarg(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitPop(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitCall(ILGenerator, MethodInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdfld(ILGenerator, FieldInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdsfld(ILGenerator, FieldInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitRet(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitIntZeroReturn(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitNullReturn(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitULong(ILGenerator, ulong)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, long)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitThrowNotimplemented(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitIncrementFor(ILGenerator, LocalBuilder, Action<LocalBuilder>)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildType(DynamicAssembly, Type, bool, bool)' will always throw an exception due to the missing method 'TypeBuilder.DefineConstructor(MethodAttributes, CallingConventions, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.DynamicMethod' from assembly 'System.Reflection.Emit.Lightweight' was not included in compilation, but was referenced in method 'DynamicObjectTypeBuilder.BuildFormatterToDynamicMethod(Type, bool, bool, bool)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildFormatterToDynamicMethod(Type, bool, bool, bool)' will always throw an exception due to the missing method 'DynamicMethod..ctor(string, Type, Type[], Type, bool)' in assembly 'System.Reflection.Emit.Lightweight'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildConstructor(Type, ObjectSerializationInfo, ConstructorInfo, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildCustomFormatterField(TypeBuilder, ObjectSerializationInfo, ILGenerator)' will always throw an exception due to the missing method 'TypeBuilder.DefineField(string, Type, FieldAttributes)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildSerialize(Type, ObjectSerializationInfo, ILGenerator, Action, Func<int, ObjectSerializationInfo.EmittableMember, Action>, int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.EmitOffsetPlusEqual(ILGenerator, Action, Action, ArgumentField, ArgumentField)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildDeserialize(Type, ObjectSerializationInfo, ILGenerator, Func<int, ObjectSerializationInfo.EmittableMember, Action>, int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.EmitOffsetPlusReadSize(ILGenerator, ArgumentField, ArgumentField)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.EmitNewObject(ILGenerator, Type, ObjectSerializationInfo, DynamicObjectTypeBuilder.DeserializeInfo[])' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass11_0.<BuildSerialize>b__2(UnionAttribute)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass11_1.<BuildSerialize>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass11_1.<BuildSerialize>b__5()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass13_0.<BuildDeserialize>b__0(UnionAttribute)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'AutomataDictionary.AutomataNode.EmitSearchNextCore(ILGenerator, LocalBuilder, LocalBuilder, LocalBuilder, Action<KeyValuePair<string, int>>, Action, AutomataDictionary.AutomataNode[], int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass4_2.<BuildFormatterToDynamicMethod>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass4_4.<BuildFormatterToDynamicMethod>b__6()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass7_3.<BuildSerialize>b__11()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass9_0.<EmitSerializeValue>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_0.<BuildDeserialize>b__2(int)' will always throw an exception due to the missing method 'ILGenerator.DeclareLocal(Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_1.<BuildDeserialize>b__3(ObjectSerializationInfo.EmittableMember)' will always throw an exception due to the missing method 'ILGenerator.DeclareLocal(Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_2.<BuildDeserialize>b__4(LocalBuilder)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_3.<BuildDeserialize>b__5(KeyValuePair<string, int>)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Label)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_3.<BuildDeserialize>b__6()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Label)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_4.<BuildDeserialize>b__7(LocalBuilder)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ObjectSerializationInfo.EmittableMember.EmitLoadValue(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ObjectSerializationInfo.EmittableMember.EmitStoreValue(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'AutomataDictionary.AutomataNode.<>c__DisplayClass19_0.<EmitSearchNextCore>b__2(int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'AutomataDictionary.AutomataNode.<>c__DisplayClass19_0.<EmitSearchNextCore>b__3(int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.ILGenerator' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.MethodBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildSerialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.LocalBuilder' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in method 'AutomataDictionary.EmitMatch(ILGenerator, LocalBuilder, LocalBuilder, LocalBuilder, Action<KeyValuePair<string, int>>, Action)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.AssemblyBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in type 'MessagePack.Internal.DynamicAssembly'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.ModuleBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in type 'MessagePack.Internal.DynamicAssembly'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.TypeBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicAssembly.DefineType(string, TypeAttributes)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.Label' from assembly 'System.Reflection.Emit.ILGeneration' was not included in compilation, but was referenced in type 'MessagePack.Resolvers.DynamicUnionResolver+<>c'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicEnumResolver.BuildType(Type)' will always throw an exception due to the missing method 'TypeBuilder.DefineMethod(string, MethodAttributes, Type, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.ConstructorBuilder' from assembly 'System.Reflection.Emit' was not included in compilation, but was referenced in method 'DynamicUnionResolver.BuildType(Type)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildType(Type)' will always throw an exception due to the missing method 'TypeBuilder.DefineConstructor(MethodAttributes, CallingConventions, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildConstructor(Type, UnionAttribute[], ConstructorInfo, FieldBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildSerialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.EmitOffsetPlusEqual(ILGenerator, Action, Action)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.BuildDeserialize(Type, UnionAttribute[], MethodBuilder, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.EmitOffsetPlusReadSize(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly..ctor(string)' will always throw an exception due to the missing method 'AssemblyBuilder.DefineDynamicAssembly(AssemblyName, AssemblyBuilderAccess)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly.DefineType(string, TypeAttributes)' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly.DefineType(string, TypeAttributes, Type)' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes, Type)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicAssembly.DefineType(string, TypeAttributes, Type, Type[])' will always throw an exception due to the missing method 'ModuleBuilder.DefineType(string, TypeAttributes, Type, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdloc(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitStloc(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdloca(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdc_I4(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitUnboxOrCast(ILGenerator, Type)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitBoxOrDoNothing(ILGenerator, Type)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdarg(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdarga(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitStarg(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, byte)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitPop(ILGenerator, int)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitCall(ILGenerator, MethodInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdfld(ILGenerator, FieldInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitLdsfld(ILGenerator, FieldInfo)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitRet(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitIntZeroReturn(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitNullReturn(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitULong(ILGenerator, ulong)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, long)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitThrowNotimplemented(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ILGeneratorExtensions.EmitIncrementFor(ILGenerator, LocalBuilder, Action<LocalBuilder>)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildType(DynamicAssembly, Type, bool, bool)' will always throw an exception due to the missing method 'TypeBuilder.DefineConstructor(MethodAttributes, CallingConventions, Type[])' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Type 'System.Reflection.Emit.DynamicMethod' from assembly 'System.Reflection.Emit.Lightweight' was not included in compilation, but was referenced in method 'DynamicObjectTypeBuilder.BuildFormatterToDynamicMethod(Type, bool, bool, bool)'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildFormatterToDynamicMethod(Type, bool, bool, bool)' will always throw an exception due to the missing method 'DynamicMethod..ctor(string, Type, Type[], Type, bool)' in assembly 'System.Reflection.Emit.Lightweight'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildConstructor(Type, ObjectSerializationInfo, ConstructorInfo, FieldBuilder, ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildCustomFormatterField(TypeBuilder, ObjectSerializationInfo, ILGenerator)' will always throw an exception due to the missing method 'TypeBuilder.DefineField(string, Type, FieldAttributes)' in assembly 'System.Reflection.Emit'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildSerialize(Type, ObjectSerializationInfo, ILGenerator, Action, Func<int, ObjectSerializationInfo.EmittableMember, Action>, int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.EmitOffsetPlusEqual(ILGenerator, Action, Action, ArgumentField, ArgumentField)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.BuildDeserialize(Type, ObjectSerializationInfo, ILGenerator, Func<int, ObjectSerializationInfo.EmittableMember, Action>, int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.EmitOffsetPlusReadSize(ILGenerator, ArgumentField, ArgumentField)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.EmitNewObject(ILGenerator, Type, ObjectSerializationInfo, DynamicObjectTypeBuilder.DeserializeInfo[])' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, ConstructorInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass11_0.<BuildSerialize>b__2(UnionAttribute)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass11_1.<BuildSerialize>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass11_1.<BuildSerialize>b__5()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicUnionResolver.<>c__DisplayClass13_0.<BuildDeserialize>b__0(UnionAttribute)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'AutomataDictionary.AutomataNode.EmitSearchNextCore(ILGenerator, LocalBuilder, LocalBuilder, LocalBuilder, Action<KeyValuePair<string, int>>, Action, AutomataDictionary.AutomataNode[], int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass4_2.<BuildFormatterToDynamicMethod>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass4_4.<BuildFormatterToDynamicMethod>b__6()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass7_3.<BuildSerialize>b__11()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass9_0.<EmitSerializeValue>b__4()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, MethodInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_0.<BuildDeserialize>b__2(int)' will always throw an exception due to the missing method 'ILGenerator.DeclareLocal(Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_1.<BuildDeserialize>b__3(ObjectSerializationInfo.EmittableMember)' will always throw an exception due to the missing method 'ILGenerator.DeclareLocal(Type)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_2.<BuildDeserialize>b__4(LocalBuilder)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_3.<BuildDeserialize>b__5(KeyValuePair<string, int>)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Label)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_3.<BuildDeserialize>b__6()' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, Label)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'DynamicObjectTypeBuilder.<>c__DisplayClass10_4.<BuildDeserialize>b__7(LocalBuilder)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ObjectSerializationInfo.EmittableMember.EmitLoadValue(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'ObjectSerializationInfo.EmittableMember.EmitStoreValue(ILGenerator)' will always throw an exception due to the missing method 'ILGenerator.Emit(OpCode, FieldInfo)' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'AutomataDictionary.AutomataNode.<>c__DisplayClass19_0.<EmitSearchNextCore>b__2(int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : Method 'AutomataDictionary.AutomataNode.<>c__DisplayClass19_0.<EmitSearchNextCore>b__3(int)' will always throw an exception due to the missing method 'ILGenerator.DefineLabel()' in assembly 'System.Reflection.Emit.ILGeneration'. There may have been a missing assembly, or a dependency on a more recent Windows SDK release.1>C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\microsoft.net.native.compiler\2.1.8\tools\Microsoft.NetNative.targets(788,5): error : ILT0005: 'C:\Program Files (x86)\Microsoft SDKs\UWPNuGetPackages\runtime.win10-x86.microsoft.net.native.compiler\2.1.8\tools\x86\ilc\Tools\nutc_driver.exe @"C:\Users\ismai\source\repos\App3\App3\obj\x86\Release\ilc\intermediate\MDIL\App3.rsp"' returned exit code 1```
5383	area-signalr	can we still get the connection id in the latest version ?	_From @omuleanu on Thursday, 08 November 2018 18:07:22_I used to be getting the getting the connection id  (in signalr v1)  like this:```$.connection.hub.start().done(function () {            connId = $.connection.hub.id; // was getting different id (guid) for each browser tab...now, using the latest version:```        var connection = new signalR.HubConnectionBuilder().withUrl("/myHub").build();        connection.start().then(function () {            console.log(connection.id); // always 0 (zero)```is getting clientId possible, or is it not allowed  ?_Copied from original issue: SignalR/SignalR#4266_
4937	area-mvc	Allow throwing HttpResponseException from MVC (non WebApiCompatShim) controllers	Based on discussion in https://github.com/aspnet/Mvc/issues/8570#issuecomment-431892499
4936	area-mvc	Allow returning HttpResponseMessage from MVC (non-WebApiCompatShim) controllers	Based on discussion in https://github.com/aspnet/Mvc/issues/8570#issuecomment-431892499
5382	area-signalr	Make Client Proxies an abstract class	So that we can add new operators without breaking things. We'd keep the interface, but change the properties to use the abstract class (we could reargue keeping the interface later ;))
5381	area-signalr	Transport Fallback in Java Client	Depending on when we introduce a new transport to the Java client [(issue here)](https://github.com/aspnet/SignalR/issues/3281), we need to implement transport fallback. 
5379	area-signalr	Implement LongPolling for Java client	We currently only have support for WebSockets in the Java client. We should look at adding support for LongPolling as our next transport. 
3978	area-mvc	Clientvalidation for numbers with decimals are wrong, when using comma as separator	Apparently the Client validation, used by the MVC system, doesn't support comma as separator for decimals.Unfortunately, the browser does, which results in being unable to enter values correctly.Values are displayed correctly (with a comma), but validation rejects the value, when saving.![browsererror](https://user-images.githubusercontent.com/25054509/48209140-b52ae980-e374-11e8-9388-8b6c65f2dffe.PNG)Definition in the datamodel:`public decimal Price { get; set; }`I've tried Edge, Firefox and Chrome - same issue for all.It's an annoying problem, that makes it difficult to create otherwise simple pages
4640	area-security	AspNet.Identity doesn't respect LowercaseUrls	Hi,I have an application base on IdentityServer4 and AspNet.Identity. I use the following configuration to make all URLs lowercase:```csharpservices.Configure<RouteOptions>(options => options.LowercaseUrls = true);```But after the latest update (from Microsoft.AspNetCore.Identity v2.0.1 to v2.1.1) URL pointing to login page '/account/login' started to appear in pascal case like '/Account/Login'. After some investigation I found that exact place where this string comes from is [IdentityServiceCollectionExtensions.cs#L53](https://github.com/aspnet/Identity/blob/master/src/Identity/IdentityServiceCollectionExtensions.cs#L53):```csharp.AddCookie(IdentityConstants.ApplicationScheme, o =>            {                o.LoginPath = new PathString("/Account/Login");                o.Events = new CookieAuthenticationEvents                {                    OnValidatePrincipal = SecurityStampValidator.ValidatePrincipalAsync                };            })```
3977	area-mvc	Have a project-wide flag to disable MVC	Following from https://github.com/aspnet/AspNetCore/issues/3755#issuecomment-436764013If MVC is going to be in all "Microsoft.AspNetCore.App" projects it would be useful to have a project-wide flag to specify MVC is not used so all tooling enabled and metadata added because of MVC can check against this flag to prevent them from running.Issues I ran into when creating a non MVC project was needing to explicitly disable:    dotnet publish -c Release /p:MvcRazorCompileOnPublish=falseAnd to prevent non essential metadata to be generated with:     <PreserveCompilationContext>false</PreserveCompilationContext>Ideally this flag would prevent anything else that's only added or running because of MVC.
6015	area-middleware	UseRewriter does not allow redirecting empty path to "/"	Hello,I'm still new to ASP.net Core so I apologize if I'm understanding the pipeline wrong. I have an ASP.net Core 2.1 Web API + Angular 6 web application created using Visual Studio 2017 Angular project template. Both the api and the Angular app are in the same web project. In development it runs inside IIS Express, while in production it uses IIS.When I invoke my application as:* http://localhost:52000/AngularWebApp/* http://myserver.domain/AngularWebApp/Angular is able to build the relative paths correctly and the application loads fine.When I visit the URLs as (note the missing trailing slash):* http://localhost:52000/AngularWebApp* http://myserver.domain/AngularWebAppIIS serves the index.html web page (why? I would expect a 404!), but then Angular can't compute correctly the relative paths to the JS/CSS resources.I thought I could use the rewrite module to redirect an empty path to the `/` path, but the browser complains of a redirect loop, because it redirects both the empty path and the `/` path to the `/` path, even if the `^$` pattern does not match `/`.This is the UseRewriter call I tried:```app.UseRewriter(new RewriteOptions()   .AddRedirect(@"^$", "/", (int)HttpStatusCode.MovedPermanently));```Is this an unexpected scenario (bug) or is there a more appropriate solution for my problem?Meanwhile I used this workaround to get the expected behavior, but it seems a bit hackish and I found very little examples of supplying an action method to the rewrite method. Is this ok?```app.UseRewriter(new RewriteOptions().Add(rewriteContext =>{    var request = rewriteContext.HttpContext.Request;    if (request.Path == PathString.Empty)    {        rewriteContext.HttpContext.Response.Redirect(request.PathBase + '/', true);        rewriteContext.Result = RuleResult.EndResponse;    }}));```Thanks in advance for your help
3973	area-servers	Expose System.IO.Pipelines in ASP.NET Core	- [ ] Add IRequestBodyPipeFeature and IResponseBodyPipeFeature #3972- [ ] Add Pipe to Stream Adapter #3971- [ ] Add Stream to Pipe Adapter #3966- [ ] Re-implement the FormReader on top of the PipeReader #3967- [ ] Create response body PipeWriter by decorating Kestrel's connection PipeWriter #4351
3972	area-servers	Add IRequestBodyPipeFeature and IResponseBodyPipeFeature	The IRequestBodyPipeFeature and IResponseBodyPipeFeature will be used to detect if the HttpContext has an underlying Pipe behind the HttpRequest.Body/HttpResponse.Body.When calling HttpRequest.PipeReader/ HttpResponse.PipeWriter, instead of created an adapted stream, if the corresponding feature is set, it will return the pipe directly rather than creating an adapter.
3971	area-servers	Add Pipe to Stream Adapter	In a similar vein to #3966 , we need the ability to create a Stream from a Pipe too.
3967	area-servers	Re-implement the FormReader on top of the PipeReader	To verify that our pipe adapter actually works, we should change FormReader to use PipeReader and verify that the pipe adapter works. Eventually, we will optimize FormReader to not use an adapted pipe and obtain the PipeReader directly from a feature, but this will give us confidence that the PipeAdapter is usable.
3966	area-servers	Add Stream to Pipe Adapter	In 3.0, we will be starting to expose Pipes directly across the AspNetCore stack via PipeReader and PipeWriter. The initial design is to have new properties directly on the HttpContext to get `HttpRequest.Body` as a PipeReader and `HttpResponse.Body` as a PipeWriter. One of the first needs we have is the ability to adapt a Stream into a Pipe. For example, when a middleware overwrites the `Response.Body` with a new stream, like [ResponseCompression](https://github.com/aspnet/BasicMiddleware/blob/master/src/Microsoft.AspNetCore.Buffering/ResponseBufferingMiddleware.cs#L36), Calling `response.PipeWriter` should return a PipeWriter that reflects the change made to the stream. 
4694	area-servers	Abort HTTP/2 connection if a stream drain timeout fires while receiving trailers	Today, even though the stream is removed from Http2Connection._streams and _drainingStreams after a drain timeout, Kestrel will still accept request trailer continuation frames for the timed out stream indefinitely.
5635	area-mvc	Reaction to React Hooks?	Just wanted to open a discussion about the new React Hooks which was announced at ReactConf.  I reach for React when I do a SPA currently (although we have a non-critical IT only app we built in Blazor as well), and React Hooks have me pretty excited, because it groups similar logic together much like Feature Folders do for a folder structure.**Wrapper Hell**[One of the things they discussed](https://youtu.be/dpw9EHDh2bM?t=448) that React Hooks is solving is "Wrapper Hell" where you have tons of components nested beneath each other.  [Specifically they call out Context](https://youtu.be/dpw9EHDh2bM?t=1905), which is very close to how Cascading parameters work in Blazor with the `<CascadingValue>` wrapper component.Curious what the Blazor team thinks about this and if there are any thoughts around perhaps doing something similar to what the React team is moving to with Hooks and getting rid of the need for the wrapper component.My quick thoughts would be something like making global state injectable instead of using a wrapped component... or having access to some grab bag off of the BlazorComponent base class where you could do something like `.Get<T>` and have it magically grab your value for you.  Those are my crappy 1 minute ideas, but feels like Blazor could do something similar to remove the need for the wrapper component and keep the component trees less nested and easier to follow.**React is getting rid of lifecycle methods**[React is also moving away from lifecycle methods](https://youtu.be/dpw9EHDh2bM?t=480) like componentDidMount (OnInit/OnInitAsync in Blazor).  They're mostly doing this so that setup (addEventListener) and cleanup (removeEventListener) is wired up in the same spot instead of separate lifecycle methods which led to bugs when you forgot to cleanup for instance.  Curious to hear other's thoughts on this and how it would apply to Blazor.  I personally haven't done any cleanup of my Blazor components, but maybe I'm causing a memory leak I don't know about.Obviously it's very early days in React Hooks land, but the concepts behind them makes a lot of sense.  Just wanted to generate some discussion.  Thanks!
5378	area-signalr	Flaky test: ServerThrowsHubExceptionIfHubMethodCannotBeResolved	```2018-11-07T01:14:17.6673524Z   Failed   Microsoft.AspNetCore.SignalR.Client.FunctionalTests.HubConnectionTests.ServerThrowsHubExceptionIfHubMethodCannotBeResolved(hubProtocolName: "json", transportType: ServerSentEvents, hubPath: "/hubT")2018-11-07T01:14:17.7696292Z   Error Message:2018-11-07T01:14:17.8599913Z    System.Exception : 1 error(s) logged.2018-11-07T01:14:17.8604620Z   Microsoft.AspNetCore.SignalR.Client.FunctionalTests.HubConnectionTests - 0 - System.TimeoutException from test2018-11-07T01:14:17.9082298Z   ===================2018-11-07T01:14:17.9084668Z   System.TimeoutException: Operation in ServerThrowsHubExceptionIfHubMethodCannotBeResolved timed out at /_/test/Microsoft.AspNetCore.SignalR.Client.FunctionalTests/HubConnectionTests.cs:4772018-11-07T01:14:17.9085040Z      at System.Threading.Tasks.TaskExtensions.OrTimeout(Task task, TimeSpan timeout, String memberName, String filePath, Nullable`1 lineNumber) in /_/test/Microsoft.AspNetCore.SignalR.Tests.Utils/TaskExtensions.cs:line 382018-11-07T01:14:17.9085688Z      at Microsoft.AspNetCore.SignalR.Client.FunctionalTests.HubConnectionTests.ServerThrowsHubExceptionIfHubMethodCannotBeResolved(String hubProtocolName, HttpTransportType transportType, String hubPath) in /_/test/Microsoft.AspNetCore.SignalR.Client.FunctionalTests/HubConnectionTests.cs:line 4772018-11-07T01:14:17.9085957Z      at Microsoft.AspNetCore.SignalR.Client.FunctionalTests.HubConnectionTests.ServerThrowsHubExceptionIfHubMethodCannotBeResolved(String hubProtocolName, HttpTransportType transportType, String hubPath) in /_/test/Microsoft.AspNetCore.SignalR.Client.FunctionalTests/HubConnectionTests.cs:line 4902018-11-07T01:14:17.9086213Z   ===================2018-11-07T01:14:17.9086418Z   Stack Trace:2018-11-07T01:14:17.9086622Z      at Microsoft.AspNetCore.SignalR.Tests.VerifyNoErrorsScope.Dispose() in /_/test/Microsoft.AspNetCore.SignalR.Tests.Utils/VerifyNoErrorsScope.cs:line 652018-11-07T01:14:17.9087002Z      at Microsoft.AspNetCore.SignalR.Tests.FunctionalTestBase.MultiDisposable.Dispose() in /_/test/Microsoft.AspNetCore.SignalR.Tests.Utils/FunctionalTestBase.cs:line 672018-11-07T01:14:17.9087707Z      at Microsoft.AspNetCore.SignalR.Client.FunctionalTests.HubConnectionTests.ServerThrowsHubExceptionIfHubMethodCannotBeResolved(String hubProtocolName, HttpTransportType transportType, String hubPath) in /_/test/Microsoft.AspNetCore.SignalR.Client.FunctionalTests/HubConnectionTests.cs:line 4912018-11-07T01:14:17.9088030Z   --- End of stack trace from previous location where exception was thrown ---2018-11-07T01:14:17.9088244Z   Standard Output Messages:2018-11-07T01:14:17.9088501Z    | [0.001s] TestLifetime Information: Starting test ServerThrowsHubExceptionIfHubMethodCannotBeResolved-json-ServerSentEvents-/hubT at 2018-11-07T01:14:032018-11-07T01:14:17.9088765Z    | [0.000s] TestLifetime Information: Starting test ServerThrowsHubExceptionIfHubMethodCannotBeResolved_json_ServerSentEvents_hubT at 2018-11-07T01:14:032018-11-07T01:14:17.9089018Z    | [0.002s] Microsoft.AspNetCore.SignalR.Tests.InProcessTestServer Information: Starting test server...2018-11-07T01:14:17.9089272Z    | [0.008s] Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager Information: User profile is available. Using 'C:\Users\VssAdministrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.2018-11-07T01:14:17.9089545Z    | [0.042s] Microsoft.AspNetCore.SignalR.Tests.InProcessTestServer Information: Test Server started2018-11-07T01:14:17.9089793Z    | [2.539s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request starting HTTP/1.1 POST http://127.0.0.1:1951/hubT/negotiate  02018-11-07T01:14:17.9090051Z    | [2.540s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request finished in 1.443ms 200 application/json2018-11-07T01:14:17.9090305Z    | [5.472s] Microsoft.AspNetCore.Http.Connections.Client.Internal.ServerSentEventsTransport Information: DRAtsB9HHWP-FBwzHVmjEw - Starting transport. Transfer mode: Text.2018-11-07T01:14:17.9090787Z    | [5.473s] Microsoft.AspNetCore.SignalR.Client.FunctionalTests.HubConnectionTests Error: System.TimeoutException from test2018-11-07T01:14:17.9091000Z    | System.TimeoutException: Operation in ServerThrowsHubExceptionIfHubMethodCannotBeResolved timed out at /_/test/Microsoft.AspNetCore.SignalR.Client.FunctionalTests/HubConnectionTests.cs:4772018-11-07T01:14:17.9091537Z    |    at System.Threading.Tasks.TaskExtensions.OrTimeout(Task task, TimeSpan timeout, String memberName, String filePath, Nullable`1 lineNumber) in /_/test/Microsoft.AspNetCore.SignalR.Tests.Utils/TaskExtensions.cs:line 382018-11-07T01:14:17.9092054Z    |    at Microsoft.AspNetCore.SignalR.Client.FunctionalTests.HubConnectionTests.ServerThrowsHubExceptionIfHubMethodCannotBeResolved(String hubProtocolName, HttpTransportType transportType, String hubPath) in /_/test/Microsoft.AspNetCore.SignalR.Client.FunctionalTests/HubConnectionTests.cs:line 4772018-11-07T01:14:17.9092441Z    | [5.476s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request starting HTTP/1.1 GET http://127.0.0.1:1951/hubT?id=DRAtsB9HHWP-FBwzHVmjEw  2018-11-07T01:14:17.9092757Z    | [5.554s] Microsoft.AspNetCore.Http.Connections.Client.HttpConnection Information: DRAtsB9HHWP-FBwzHVmjEw - HttpConnection Started.2018-11-07T01:14:17.9092929Z    | [5.554s] Microsoft.AspNetCore.SignalR.Client.HubConnection Information: DRAtsB9HHWP-FBwzHVmjEw - Using HubProtocol 'json v1'.2018-11-07T01:14:17.9093126Z    | [5.560s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request starting HTTP/1.1 POST http://127.0.0.1:1951/hubT?id=DRAtsB9HHWP-FBwzHVmjEw  322018-11-07T01:14:17.9093284Z    | [5.560s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request finished in 0.3107ms 200 text/plain2018-11-07T01:14:17.9093477Z    | [5.560s] Microsoft.AspNetCore.SignalR.HubConnectionContext Information: DRAtsB9HHWP-FBwzHVmjEw - DRAtsB9HHWP-FBwzHVmjEw - Completed connection handshake. Using HubProtocol 'json'.2018-11-07T01:14:17.9093637Z    | [5.561s] Microsoft.AspNetCore.SignalR.Client.HubConnection Information: DRAtsB9HHWP-FBwzHVmjEw - HubConnection started.2018-11-07T01:14:17.9093817Z    | [5.561s] Microsoft.AspNetCore.Http.Connections.Client.Internal.ServerSentEventsTransport Information: DRAtsB9HHWP-FBwzHVmjEw - Transport is stopping.2018-11-07T01:14:17.9094105Z    | [5.562s] Microsoft.AspNetCore.Http.Connections.Client.HttpConnection Information: DRAtsB9HHWP-FBwzHVmjEw - HttpConnection Disposed.2018-11-07T01:14:17.9094274Z    | [5.562s] Microsoft.AspNetCore.SignalR.Tests.InProcessTestServer Information: Shutting down test server2018-11-07T01:14:17.9094456Z    | [5.564s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request finished in 88.099ms 200 text/event-stream2018-11-07T01:14:17.9094743Z    | [5.564s] Microsoft.AspNetCore.SignalR.Tests.InProcessTestServer Information: Test server shut down2018-11-07T01:14:17.9094930Z    | [5.564s] TestLifetime Information: Finished test ServerThrowsHubExceptionIfHubMethodCannotBeResolved_json_ServerSentEvents_hubT in 5.5634203s2018-11-07T01:14:17.9095104Z    | [5.733s] TestLifetime Information: Finished test ServerThrowsHubExceptionIfHubMethodCannotBeResolved-json-ServerSentEvents-/hubT in 5.7320045s```Flaked out in https://dnceng.visualstudio.com/public/_build/results?buildId=40811&view=logs
5448	area-mvc	Functional tests are slow	Our functional tests take 30 seconds to 3 minutes, and based on circumstantial evidence I don't think most of that time is spent in browser automation. We should profile the tests and see where we're spending time, and if it can be trimmed down.This would be helpful for release turn-around, but even more so for local development, where a full build can take quite a while, making it hard to develop with.
5634	area-mvc	Build error when parameter and child component have the same name	## Add support for `@tagHelperPrefix`### ProblemCurrent implementation of Blazor v0.6.0 does not have support for Razor `@tagHelperPrefix`### Functional impactTrying to Include a child component inside a **RenderFragment** of a parent component where both the child and the **RenderFragment** have the same name will result in compile time error. ### Minimal repro stepsLet us suppose we have a component in `Panel.cshtml` as follows: ```html<div class="panel panel-default">  <div class="panel-heading">@PanelHeader</div>  <div class="panel-body">@PanelBody</div></div>@functions{  [Parameter] private RenderFragment PanelHeader { get; set; }  [Parameter] private RenderFragment PanelBody { get; set; }}```and another component in `PanelHeader.cshtml` like this:```html<div>@Title</div><div>@SubTitle</div>@functions{  [Parameter] private string Title { get; set; }  [Parameter] private string SubTitle { get; set; }}```then using these two components in a page like below code will result in a compile time error: ```html<Panel>  <PanelHeader>       <PanelHeader Title="some title" SubTitle="sub title"></PanelHeader>  </PanelHeader>  <PanelBody>Some content ...</PanelBody><Panel>```### Proposal I would recommend to add support for `@tagHelperPrefix` so to simplify distinguishing components from RenderFragments. Above code could then can be re-written as follows: `Panel.cshtml` would be like this:```html@tagHelperPrefix "pre1:"<div class="panel panel-default">  <div  class="panel-heading">@PanelHeader</div>  <div  class="panel-body">@PanelBody</div></div>@functions{  [Parameter] private RenderFragment PanelHeader { get; set; }  [Parameter] private RenderFragment PanelBody { get; set; }}``` And `PanelHeader.cshtml` would look like this:```html@tagHelperPrefix "pre2:"<div>@Title</div><div>@SubTitle</div>@functions{  [Parameter] private string Title { get; set; }  [Parameter] private string SubTitle { get; set; }}```And finally both the child and the parent components can be used like this: ```html<pre1:Panel>  <PanelHeader>       <pre2:PanelHeader Title="some title" SubTitle="sub title"></pre2:PanelHeader>  </PanelHeader>  <PanelBody>Some content ...</PanelBody><pre1:Panel>```
5633	area-mvc	Dispose doesnt work when page is refreshed (server-side blazor)	Hello I was trying to make the fetchdata example update values without refreshing page or clicking buttons. And I found out that I can use timer which seemed like working ok. But after testing with different data it was acting strange and I found out that page doesnt dispose the timer when I go to different page and its not displayed anymore. That was solved by adding dispose but it didnt solve different issue.. When I press F5 while on /fetchdata page it reloads and doesnt dispose the timer. And then it runs twice. I tried it by adding int into ForecastService and it increment everytime GetForecastAsync is called. After 10 refreshes it increment +10 every second instead of +1. I hope it makes sense. ```@functions {WeatherForecast[] forecasts;Timer timer;private async void Update(){    forecasts = await ForecastService.GetForecastAsync(DateTime.Now);    StateHasChanged();}protected override async Task OnInitAsync(){    timer = new Timer(1000);    timer.Elapsed += (sender, args) => Update();    timer.Start();    Update();}public void Dispose(){    timer.Dispose();}}```
3961	area-middleware	Session's IdleTimeout - User based setting	As of now Session middleware works like singleton. Is there a way to set/update session idletimeout after user login?  I would like to match this with cookie-auth token's sliding expiration. 
4935	area-mvc	Custom naming when binding nested objects as properties of a model in controllers actions	Hi guys,I'm creating another API with .net core mvc 2.2.Every time we have some date as a parameter, we follow the same behavior. I need a date start, date end or a relative time info as parameter (today, yesterday, this month, last month, etc).So imagine a bill report and I want to bring all bills with reference date between X and Y, but I also want to filter by generated bill date between Z and W.A possible model for just the date related parameters:```cspublic class DateInfo {	public DateTime? DateStart { get; set; }	public DateTime? DateEnd { get; set; }	public RelativeTime? RelativeTime { get; set; }}```So far so good. My hope was to use that in my request models:```cspublic class MyModel {	[FromQuery]	public DateInfo Reference { get; set; } = new DateInfo();	[FromQuery]	public DateInfo Generated { get; set; } = new DateInfo();               //other}```Swagger will generate the api explorer correctly using the namespace to get to the properties. Binding works as well:- Reference.DateStart- Reference.DateEnd- Generated.DateStart- Generated.DateEndHowever:That's ok for Razor pages, but as this is an API, and it's not our standard to have "."s in our parameters. It's much more popular on REST APIs to use hyphen, not camelcase, dots or underscores as words delimiters.Also, I loose the ability to lowercase the property names. Ex:```cspublic class DateInfo {	[FromQuery(Name = "date-start")]	public DateTime? DateStart { get; set; }	public DateTime? DateEnd { get; set; }	public RelativeTime? RelativeTime { get; set; }}```That will break everything, as having two properties of this same class in a parent model object will combine both DateStart (parent property's name is not applied anymore).So the feature would be a way to:1 - ability to replace the "." with whatever I want (in my case, hyphen) when creating the map to the property2 - change the external property name to a custom one without breaking the classe hierarchySo with attributes like this:```cspublic class MyModel {	[FromQuery(Name = 'reference')]	public DateInfo Reference { get; set; } = new DateInfo();	[FromQuery(Name = 'generated')]	public DateInfo Generated { get; set; } = new DateInfo();}public class DateInfo {	[FromQuery(Name = "date-start")]	public DateTime? DateStart { get; set; }	[FromQuery(Name = "date-end")]	public DateTime? DateEnd { get; set; }}```The final endpoint parameters would be:- reference-date-start- reference-date-end- generated-date-start- generated-date-end
3959	area-mvc	Invalid client body encoding results in 500 response, while it should be 4** Error	### Describe the bugWhen client sends request with failed encoding 500 Exception is returned, but it's client fault and I believe it should be 400 Bad Request instead. ### To ReproduceDownload solution from https://github.com/sobanieca/AspNetCoreEncodingIssueOpen in Visual StudioRun WebApplication1 (ensure it listens on localhost:5000)Run Post-Request.ps1 powershell attached (ensure Powershell ISE working directory is the same as ps1 file, so it can read Request.json file)### Expected behaviorI would expect API to return 400 Bad Request, as client is sending request with invalid encoding### Additional contextInside Post-Request.ps1 script (line 12) one can see fix that client can apply to fix API issueException that is being thrown:```fail: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[1]      An unhandled exception has occurred while executing the request.System.Text.DecoderFallbackException: Unable to translate bytes [B2] at index 23 from specified code page to Unicode.   at System.Text.DecoderExceptionFallbackBuffer.Throw(Byte[] bytesUnknown, Int32 index)   at System.Text.DecoderExceptionFallbackBuffer.Fallback(Byte[] bytesUnknown, Int32 index)   at System.Text.DecoderFallbackBuffer.InternalFallback(Byte[] bytes, Byte* pBytes, Char*& chars)   at System.Text.UTF8Encoding.GetChars(Byte* bytes, Int32 byteCount, Char* chars, Int32 charCount, DecoderNLS baseDecoder)   at System.Text.DecoderNLS.GetChars(Byte[] bytes, Int32 byteIndex, Int32 byteCount, Char[] chars, Int32 charIndex, Boolean flush)   at System.Text.DecoderNLS.GetChars(Byte[] bytes, Int32 byteIndex, Int32 byteCount, Char[] chars, Int32 charIndex)   at Microsoft.AspNetCore.WebUtilities.HttpRequestStreamReader.ReadIntoBuffer()   at Microsoft.AspNetCore.WebUtilities.HttpRequestStreamReader.Read(Char[] buffer, Int32 index, Int32 count)   at Newtonsoft.Json.JsonTextReader.ReadData(Boolean append, Int32 charsRequired)   at Newtonsoft.Json.JsonTextReader.ParseValue()   at Newtonsoft.Json.JsonTextReader.Read()   at Newtonsoft.Json.JsonReader.ReadForType(JsonContract contract, Boolean hasConverter)   at Newtonsoft.Json.Serialization.JsonSerializerInternalReader.Deserialize(JsonReader reader, Type objectType, Boolean checkAdditionalContent)--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Mvc.Formatters.JsonInputFormatter.ReadRequestBodyAsync(InputFormatterContext context, Encoding encoding)   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder.BindModelAsync(ModelBindingContext bindingContext)   at Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder.BindModelAsync(ActionContext actionContext, IModelBinder modelBinder, IValueProvider valueProvider, ParameterDescriptor parameter, ModelMetadata metadata, Object value)   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```
5632	area-mvc	Passing object as parameter to component fails with implicit operator	Consider the following code:    namespace MyModels    {        public interface IField         {            Guid Id { get; set; }        }            public class StringField : IField        {            public Guid Id { get; set; }            public string Value { get; set; }            public static implicit operator string(StringField field)            {                return field.Value;            }        }    }I have a component for rendering a `StringField` in the UI that simplified looks like this:    <input type="text" bind="@Data.Value" />    @functions {        [Parameter]        private MyModels.StringField Data { get; set; }    }In my main page I operate on a collection of `IField` objects. Trying to invoke the component like this fails as runtime. This has worked fine for all previous components that didn't have the implicit operator.    <StringField Data="@((MyModels.StringField)Field)"></StringField>However changing the component to this and passing the param as an `IField` works just fine but is a bit messy.    <input type="text" bind="@(((MyModels.StringField)Data).Value)" />    @functions {        [Parameter]        private MyModels.IField Data { get; set; }    }It looks like the implicit operator converts the param before trying to set it in runtime making the app break.
4695	area-servers	Support QUIC	Support QUIC on Kestrel Page-load speed (and quality), and therefore QUIC, affect google-ranking. > Like HTTP/2, QUIC multiplexes multiple streams into one connection, so that a connection can serve several HTTP requests simultaneously. But HTTP/2 uses TCP as its transport, so all of its streams can be blocked when a single TCP packet is lost—a problem called head-of-line blocking. QUIC is different: Loss of a UDP packet within a QUIC connection only affects the streams contained within that packet. In other words, QUIC won’t let a problem with one request slow the others down, even on an unreliable connection.Source: https://cloudplatform.googleblog.com/2018/06/Introducing-QUIC-support-for-HTTPS-load-balancing.html
5377	area-signalr	message validation	We are currently using json schema in our API's and I was wondering if there was a hook we could use to run our validation prior to the message being deserialized into an object?
5376	area-signalr	Implement support for IAsyncEnumerable in the .NET client	Split from https://github.com/aspnet/SignalR/issues/3166Support for IAsyncEnumerable on the client (returning it from `HubConnection.StreamAsync()`). This is just a little thorny because of the open question of .NET Standard support for `IAsyncEnumerable`
3949	area-servers	App_Offline - Linux/Apache	_From @mbuchok on Tuesday, 06 November 2018 16:04:34_# Issue Titleapp_offline equivalent for Linux/Apache# GeneralPerhaps I'm still a little new to Linux, but is there an app_offline equivalent for dotnet core hosted in a Linux environment... specifically using CentOS and Apache?_Copied from original issue: dotnet/core#2039_
5631	area-mvc	Invoke Component by name instead of Tag	It would be very helpful to be able to invoke a component by its **name** instead of its **tagname**. If I for example create the component:`~/Components/MyComponent.cshtml`this is used from my page by writing.`<MyComponent></MyComponent>`Consider the use case where the data model I want to render using Blazor looks something like this:    public class MyDataModel    {        public IEnumerable<IField> Fields { get; set; }    }Fields are registered through code at Startup, for example like this:    MyApp.Fields.Register<StringField>();    MyApp.Fields.Register<IntegerField>();where both `StringField` and `IntegerField` implement `IField`. When rendering the page I want these fields to be handled by the components `StringField.cshtml` and `IntegerField.cshtml` but **without** actually knowing which components are available (as these are registered at startup by the main application). This would require the option to invoke a component with a syntax similar to this (example):    @foreach (var field in Data.Fields)    {        @Component(field.GetType().Name, new { InputParamName = field })    }This functionality would support the same use case as `@Html.Editor` does in MVC which is very useful for handling composite data models.Best regards
3890	area-servers	Performance issues and unusual CPU cycles in Middlewares	### Describe the bugI have used visual studio performance profiling tool to profile my asp.net core v2.0.7 api.we are seeing a lot of time being spent in the middle wares, and we cant really check whats causing it as the tool indicates that the time is being spent in the external code.<img width="635" alt="3" src="https://user-images.githubusercontent.com/7329422/48064369-7bfd4880-e1bf-11e8-8e48-220e09becaeb.PNG"><img width="634" alt="6" src="https://user-images.githubusercontent.com/7329422/48064367-7b64b200-e1bf-11e8-9ef7-8fb1e985f004.PNG"><img width="636" alt="2" src="https://user-images.githubusercontent.com/7329422/48064368-7bfd4880-e1bf-11e8-8ca1-328d0442e649.PNG"><img width="635" alt="4" src="https://user-images.githubusercontent.com/7329422/48064371-7bfd4880-e1bf-11e8-9f1c-ef6d8a8dc914.PNG"><img width="636" alt="5" src="https://user-images.githubusercontent.com/7329422/48064372-7bfd4880-e1bf-11e8-8bed-c01f7ffd0bcc.PNG">
5629	area-mvc	Make SignalR Service usage an aspect of deployment, not source code	For Razor Components (currently, server-side Blazor), the decision to use Azure SignalR Service or not shouldn't be hardcoded into the app code. Ideally it would be something determined by the deployment mechanism.Somehow we need sufficient abstraction to remove this from the project source code. The tricky bit is that we don't want to bring in a dependency on `Microsoft.Azure.SignalR` for all projects, so I'm not sure how we solve this.I seem to recall that @DamianEdwards mentioned this is just a one example of a broader class of requirements to make service usage determined by the deployment/hosting mechanism. So perhaps this is not something we need to solve in this repo, because we're going to inherit a broader solution that applies to all services. CC @davidfowl.
5628	area-mvc	Higher-level pattern for async data loading	We've had an internal request to consider ways of loading data without having to implement the usual `if (data == null) { loading... } else { show data }` in the markup, possibly also without overriding `OnInitAsync` or similar to put in the load logic.Sketch:```html<DataSource Url="people/@id" TResult=Person>    <BeforeLoaded>Loading person @id...</BeforeLoaded>    <OnError>Sorry, there was a problem. The response was @context.StatusCode.</OnError>    <AfterLoaded Context="person">        @person.Name is @person.Age years old    </AfterLoaded></DataSource>```This doesn't really have to be baked into the core, but we might want this to appear in the default project template.
3888	area-security	Cookie auth, client redirect on expiration	I have been using built in cookies auth since the previews and it has been great to date.  Recently I thought it would be nice to implement a feature that prompt the user a few minutes before their session will expire and assumed it would be a trivial task.  It turned out to be anything but that and the only approaches I could come up with were the following...1. Hack CookieManager to add a clear text cookie with nothing more than the expiration so I can get to it from the client via js 2. Hack an instance of DataProtector from a controller method and access it and decrypt it from the client like an API3. Use context.AuthorizeAsync to get at the ticket as an APII was able to get this working but it feels sloppy as the entire way AuthBuilders work ends up newing all of their dependencies so you can’t just DI the component you need to extend functionality like this easily.  Additionally I think I ran into a bug where when implementing an ITicketStore the CookieAuthHandler retrieves the current ticket, then invokes various middleware and matched routes and only after that is the ticket renewed.  This is problematic because when I access the ticket in middleware or an api or controller the value I get is potentially stale and different from what is actually in the current ticket so I had to make a second request to make sure it is in sync.So my questions are....1. Is this a bug?2. Is there a better way to do this?3. Any consideration to letting the framework inject some script into the client to do most of this for us?4. Was this a consideration during design or am I missing something?  It seems like redirecting the client on expiration would be a common use case instead of having the user clicking about wondering why all those buttons they click firing requests to APIs and hubs aren’t doing anything.
4696	area-servers	Kestrel ended slowly. And when I run it again, I get an error that the port is in use.	These events are left in the event viewer.Event ID : 16002Closing a TCP socket with local port number 50000 in process 3584 is taking longer than expected. The local port number may not be available until the close operation is completed. This happens typically due to misbehaving network drivers. Ensure latest updates are installed for Windows and any third-party networking software including NIC drivers, firewalls, or other security products.  These events are left in the event viewer.Event ID: 1002The program GameServer.exe version 0.0.0.0 stopped interacting with Windows and was closed. To see if more information about the problem is available, check the problem history in the Action Center control panel. Process ID: f78 Start Time: 01d4756a17377dab Termination Time: 4294967295 Application Path: C:\Server\GameServers\GameServer.exe Report Id: 87a58e30-e15d-11e8-8217-0ab6b219a55a Faulting package full name:  Faulting package-relative application ID: I need help with what to do.
3887	area-servers	Deadlock in the pipeline on Exception?	I've been trying to hunt down this issue for a while when our web application suddenly locks up with 100% CPU usage. I've finally acquired a full memory dump and analysis (fairly hard when the CPU is panicking).It appears that somehow Exception.RestoreExceptionDispatchInfo is somehow deadlocking itself?![image](https://user-images.githubusercontent.com/3247357/48036792-c354ec00-e161-11e8-9dcc-09ecb389cab1.png)This is using .NET Framework 4.7.1. I'm not quite sure if this is related to ASP.NET Core or just a bug in the framework overall, or if this is possible at all...EDIT: Opening the dump, the exception hanging in thread 151 is `An existing connection was forcibly closed by the remote host`
4934	area-mvc	Unwrap reflection exceptions when doing reflection on user code	See https://github.com/aspnet/Mvc/issues/8531#issuecomment-426850989The suggestion is to catch `LoaderExceptions` etc when loading user types and unwrap it to produce a more meaningful error.
4641	area-security	Sharing Auth Cookies between .NET 4.6.1 and NET Core (Cookies was not authenticated. Failure message: Unprotect ticket failed)	I'm having an incredibly difficult time getting auth cookies made in .NET 4.6.1 to work in .NET Core. I followed online microsoft documentation, but have not had any successs ( https://docs.microsoft.com/en-us/aspnet/core/security/cookie-sharing?view=aspnetcore-2.1 )I have a site url like site1.mysite.local that is in 4.6.1 and site2.mysite.local which is a .NET Core 2.1 siteI added the following code to the startup class of .NET 4.6.1 (site1.mysite.local). I also changed the constant values to string values to make it easier to follow in the examples below.```var cookieEncryptionKeyRing = "C:/Keyring";var authOptions = new CookieAuthenticationOptions{    CookieName = "theCookieName",    CookieDomain = ".mysite.local",    AuthenticationType = "Cookies",    LoginPath = new PathString("/default.aspx"),    LogoutPath = new PathString("/logout.aspx"),    ExpireTimeSpan = TimeSpan.FromMinutes(Convert.ToDouble(20)),    SlidingExpiration = true,    Provider = new CookieAuthenticationProvider()    {        OnValidateIdentity = (cic) => {            // Validate token and / or refresh it.                                    return Task.FromResult<object>(true);        },    },    TicketDataFormat = new AspNetTicketDataFormat(        new DataProtectorShim(            DataProtectionProvider.Create(new DirectoryInfo(cookieEncryptionKeyRing),                    (builder) => { builder.SetApplicationName("SharedCookieApp"); })                .CreateProtector(                    "Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationMiddleware",                    "Cookies",                    "v2"))),    CookieManager = new ChunkingCookieManager()};app.UseCookieAuthentication(authOptions);app.SetDefaultSignInAsAuthenticationType("Cookies");```This works well for the .NET 4.6.1  (site1.mysite.local) web app. I am able to log in and use the cookie to maintain authentication within site1.mysite.local.This doesn't work in the NET Core app and I get the error message "Cookies was not authenticated. Failure message: Unprotect ticket failed"I added the following code to the startup class of .NET Core (site2.mysite.local). ```public void ConfigureServices(IServiceCollection services){    var keyRing = "C:/Keyring";    var protectionProvider = DataProtectionProvider.Create(        new DirectoryInfo(keyRing), (action) =>        {            action.SetApplicationName("SharedCookieApp");        });    var dataProtector = protectionProvider.CreateProtector(        "Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationMiddleware",        "Cookies",        "v2");    var ticketFormat = new TicketDataFormat(dataProtector);    services.AddAuthentication("Cookies")        .AddCookie(CookieAuthenticationDefaults.AuthenticationScheme, options =>        {            options.LoginPath = "/Home/AccessDenied";            options.Cookie.Name = "theCookieName";                options.Cookie.Domain = ".mysite.local";            options.TicketDataFormat = ticketFormat;            options.Events.OnValidatePrincipal = (cic) =>            {                return Task.FromResult<object>(true);            };        });    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);}// This method gets called by the runtime. Use this method to configure the HTTP request pipeline.public void Configure(IApplicationBuilder app, IHostingEnvironment env){    if (env.IsDevelopment())    {        app.UseDeveloperExceptionPage();    }    else    {        app.UseExceptionHandler("/Home/Error");        app.UseHsts();    }    app.UseHttpsRedirection();    app.UseStaticFiles();                app.UseAuthentication();    app.UseMvc(routes =>    {        routes.MapRoute(            name: "default",            template: "{controller=Home}/{action=Index}/{id?}");    });}```I've gone over all the documentation I've been able to find and nothing has given me any clue on what to do. Any help you can give would be greatly appreciated. Thank you!
4932	area-mvc	[Discussion] Making "pubinternal" types in MVC internal	In ASP.NET Core, `pubinternal` types are types that are declared as `public` but put in an `.Internal` namespace. While these types are public they have no support policy and are subject to breaking changes. Unfortunately accidental use of these types has been common, resulting in breaking changes to these projects and limiting our ability to maintain the framework.In ASP.NET Core 3.0, we are updating all `pubinternal` types in MVC to either be `public` in a supported namespace, or `internal` as appropriate. This includes types in the following namespaces:* Microsoft.AspNetCore.Mvc.Formatters.Xml.Internal* Microsoft.AspNetCore.Mvc.Cors.Internal* Microsoft.AspNetCore.Mvc.ViewFeatures.Internal* Microsoft.AspNetCore.Mvc.Formatters.Json.Internal* Microsoft.AspNetCore.Mvc.RazorPages.Internal* Microsoft.AspNetCore.Mvc.DataAnnotations.Internal* Microsoft.AspNetCore.Mvc.TagHelpers.Internal* Microsoft.AspNetCore.Mvc.Internal* Microsoft.AspNetCore.Mvc.Razor.Internal* Microsoft.AspNetCore.Mvc.Formatters.Internal* Microsoft.AspNetCore.Mvc.Core.Internal* Microsoft.AspNetCore.Mvc.ModelBinding.InternalIf there are specific types in these namespaces that are critical to your applications, please file an issue in https://github.com/aspnet/Mvc and we will consider making the requested types public.
5262	area-mvc	Consider a restructure of the Spa middleware	In my opinion, the structure of the various bits of Spa middleware is not very flexible.For example the UseAngularCliServer and UseProxyToSpaDevelopmentServer is not available on IApplicationBuilder, as it is tied to the ISpaBuilder. This means that the use the SpaProxy we must write this:```// I think there is no reason to UseSpaStaticFiles in dev mode as all requests should be handled by the dev server onlyif (!env.IsDevelopment()) { 	frontendApp.UseSpaStaticFiles();}app.UseSpa(spa => {	spa.Options.SourcePath = "ClientApp";	if (env.IsDevelopment()) {		//spa.UseAngularCliServer(npmScript: "start");		spa.UseProxyToSpaDevelopmentServer(baseUri: "http://localhost:8080");	}});```UseSpaStaticFiles is just a wrapper around UseStaticFiles to allow 2 sets of static files to be served, one from 'wwwroot' and another from 'ClientApp/dist'.https://github.com/aspnet/JavaScriptServices/blob/release/2.1/src/Microsoft.AspNetCore.SpaServices.Extensions/StaticFiles/SpaStaticFilesExtensions.csThe UseSpa extension method just adds the SpaDefaultPageMiddleware middleware which unconditionally rewrites the context.Request.Path to the value of spa.Options.DefaultPage (/index.html). It then just passes the request down to the UseSpaStaticFilesInternal middleware that has some strange option "allowFallbackOnServingWebRootFiles" which is set to true. The 'allowFallbackOnServingWebRootFiles' can only come into play if AddSpaStaticFiles has not been added to ConfigureServices. I am not sure what the use case for falling back on serving Spa files from wwwroot would be. This behaviour is not in the docs as far as i can tell.https://github.com/aspnet/JavaScriptServices/blob/release/2.1/src/Microsoft.AspNetCore.SpaServices.Extensions/SpaApplicationBuilderExtensions.cshttps://github.com/aspnet/JavaScriptServices/blob/release/2.1/src/Microsoft.AspNetCore.SpaServices.Extensions/SpaDefaultPageMiddleware.csAnother quirk of the UseSpa method is that any configuration inside of the block is added to the middleware pipeline before the middleware that is added by the UseSpa extension method itself. That is why UseProxyToSpaDevelopmentServer actually works, because when it is enabled in dev mode, it is inserted before the request rewrite and StaticFiles middleware added by UseSpaStaticFilesInternal. That behaviour seems counter intuitive, for example when compared to app.Map.These are the issues with the current structure as i see it:1. In the Spa template code, effectively the UseSpaStaticFiles extension method is used twice, once directly and again via UseSpa (after a Request.Path rewrite) which uses an internal method which allows falling back to serving from wwwroot if there is no FileProvider, ie. if AddSpaStaticFiles has not been used. This behaviour is only apparent after studying the source code. The Spa template code does not really describe the behaviour nor do the official docs.2. UseSpaStaticFiles should be wrapped in if (!env.IsDevelopment()) to prevent previously built Spa files from being used in preference to files served by the Angular dev server.  This will then match the experience when using the Spa dev tools directly.3. spa.Options.SourcePath is only used by spa.UseAngularCliServer, would it not make more sense to make that option part of the UseAngularCliServer configuration?4. The SpaDefaultPageMiddleware should be used directly in the template rather than being an internal class hidden behind the UseSpa extension method. This would make the behaviour more easily discoverable.5. Currently the SpaDefaultPageMiddleware rewrites all requests to /index.html. It should only be rewriting requests for **"paths"** to /index.html. Requests for **"files"** should be left untouched. This is the behaviour of the webpack-dev-server and the Spa template should really provide the same experience as when using the Spa dev tools directly.6. There should be an option on SpaDefaultPageMiddleware to only rewrite requests for '/' or '' which can be used if we don't need to use HTML5 pushstate `options.RewriteRootOnly = false;`Those issues are described in more detail here: https://github.com/aspnet/JavaScriptServices/issues/1781Based on the above, i think that UseSpa should be removed in favour of SpaDefaultPageMiddleware used directly, with the spa.Options.DefaultPage made part of its configuration.Ideally i would like to be able to do this:```if (env.IsDevelopment()) {	// In dev mode all we need to do is send the request the Angular dev server        // use the helper which launches the dev server for us	app.UseAngularCliServer(sourcePath: "ClientApp", npmScript: "start");        // or launch it ourselves and use this	//app.UseProxyToSpaDevelopmentServer(baseUri: "http://localhost:4200");} else {	// rewrite any requests that are not file requests to the default page to support HTML5 pushstate	// (requests that do not contain a dot in the last path segment)	app.UseSpaDefaultPage(options => {		options.DefaultPage = "/index.html"; // the default is '/index.html'                options.RewriteRootOnly = false; // enable this if we are not using pushstate	});	// Serve the built/bundles Spa files	app.UseSpaStaticFiles();}```Which in my opinion is more meaningful and understandable than the current Spa template.I suppose it could be argued that UseProxyToSpaDevelopmentServer could be just UseWebSocketsEnabledProxy because that what it really is.Of course custom classes could be made to achieve the above or any other desired structure but i think it would be good for the Spa template if that's how it worked out of the box.Sorry for the ramble, i know this stuff is relatively new, but i understand that the change over to using SpaProxy was to bring the dev experience inline with the recommended or more popular community usage of Spa frameworks which seems to be the various CLI's. This way users do not have to tie their Spa app into their .NET Core app too tightly.Currently there is no example of running a Spa app off the root such as from /app/ or /frontend/ so that the root of the site can serve an MVC or razor page. My trip down the rabbit hole which resulted in the issues i have logged here were triggered by a desire to get that working nicely in both dev (with hmr enabled and working) and production modes. I have now achieved this but required some additional code as i have detailed in issue 1518.It seems that others have a desire to do this as well:https://github.com/aspnet/JavaScriptServices/issues/1518https://github.com/aspnet/JavaScriptServices/issues/1752The multi Spa post 1752 is interesting, it could be made possible by adding the ability to add names to multiple instances of AddSpaStaticFiles and then specify which one to use when adding UseSpaStaticFiles.
4697	area-servers	Kestrel gRPC support: provide more efficient APIs for reading request and response bodies	One of the possible ways how to integrate with gRPC is to write a generic handler that reads http request's body (`httpContext.Request.Body`) and parses them into grpc request messages  and writes grpc response messages into `httpContext.Response.Body`.  This works pretty well (see prototype in https://github.com/jtattermusch/grpc-aspnetcore-experiments), but both request body and response body are instances of `System.IO.Stream`, which works but isn't particularly efficient (e.g. copying of the data is required, it's hard to use with memory pooling etc.) and will probably become a performance bottleneck in the future.Is there a way to access request and response bodies e.g. in terms of the new System.IO.Pipelines API?Context: https://github.com/grpc/grpc/issues/15139
5627	area-mvc	Unable to link with System.IdentityModel.Tokens.Jwt	I added the ```System.IdentityModel.Tokens.Jwt``` package to my Blazor-project to handle JWT on the client. When building, I got the usual error about not being able to link because of dependencies, such as "Semaphore".```cmd3>TestApp.Client -> S:\Downloads\TestApp\src\TestApp.Client\bin\Debug\netstandard2.0\TestApp.Client.dll3>Cannot find declaration of exported type 'System.Threading.Semaphore' from the assembly 'System.Threading, Version=4.0.12.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'3>Fatal error in IL Linker3>Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'System.Private.DataContractSerialization, Version=4.1.2.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'3>   at Mono.Linker.DirectoryAssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)3>   at Mono.Linker.AssemblyResolver.Resolve(AssemblyNameReference name, ReaderParameters parameters)3>   at Mono.Linker.DirectoryAssemblyResolver.Resolve(AssemblyNameReference name)3>   at Mono.Cecil.MetadataResolver.Resolve(TypeReference type)3>   at Mono.Linker.Steps.ResolveFromAssemblyStep.ProcessLibrary(LinkContext context, AssemblyDefinition assembly, RootVisibility rootVisibility)3>   at Mono.Linker.Steps.ResolveFromAssemblyStep.ProcessLibrary(AssemblyDefinition assembly)3>   at Mono.Linker.Steps.ResolveFromAssemblyStep.Process()3>   at Mono.Linker.Steps.BaseStep.Process(LinkContext context)3>   at Mono.Linker.Pipeline.ProcessStep(LinkContext context, IStep step)3>   at Mono.Linker.Pipeline.Process(LinkContext context)3>   at Mono.Linker.Driver.Run(ILogger customLogger)3>   at Mono.Linker.Driver.Execute(String[] args, ILogger customLogger)```Is there a way to get around this? What is preventing me from using the package?
5375	area-signalr	whether connect to server?	Execute the following code:```javaHubConnection hubConnection = createHubConnection("https://example.com", new MockTransport(true), true, new TestHttpClient());        hubConnection.start().timeout(1, TimeUnit.SECONDS).blockingAwait();        hubConnection.on("Send", (name, message) -> {            System.out.println("*******************************" + name + ": " + message);        }, String.class, String.class);        hubConnection.onClosed((ex) -> {            System.out.println("*********************hubconnection Closed callback ran.");        });        hubConnection.stop();```only show  the following log：11-05 16:58:30.865 30150-30150/com.mango.demo I/System.out: *********************hubconnection Closed callback ran.who can tell me whether connected to server?
5374	area-signalr	What method attributes specified hubname call?	What method attributes specified hubname call in java?
5626	area-mvc	Suggestion: 401 Redirect Helper	With the way the HttpClient is working on client side Blazor it's actually super hard to intecept the HTTP errors (even with try/catch).It would be great on the HttpClient DI Singleton if we could specify a route associated with common HTTP codes that it returns.e.g. on a 401 it might redirect to a login route or token refresh route etc.eg. on a 500 it might show an error page etc.These might be specified in the Startup (i.e. when the dependency is injected).As a temp workaround I might try wrapping the current singleton - but it seems to be acting strangely (more debugging required by me).
4215	area-mvc	Static files and matching	I updated [a sample](https://github.com/aspnet/AuthSamples/pull/65) to use static files + endpoints + authz. To achieve the desired result I had to write a DIY static file endpoint matcher and it got me thinking.# RANDOM THOUGHT 1We could add configurable static file matching to `UseEndpointRouting`. It would be useful when you want to run the file through APIs that use endpoints, e.g. `AuthorizationMiddleware`. There could be a couple of modes for matching:* The static files all live as endpoints provided by an endpoint datasource. High memory, long startup time, high perf* Or the endpoint for a static file is created on demand. Low memory, short startup time, low perf. This is what the [authz sample](https://github.com/aspnet/AuthSamples/pull/65) is doing.```csapp.UseEndpointRouting(routes =>{    routes.MapApplication();    routes.MapStaticFiles();});```# RANDOM THOUGHT 2`UseStaticFiles` today is terminal if there is a matching file. If static files have endpoints then it could disappear from 3.0 templates and the static file could be returned at the end of the request pipeline.Would there be performance considerations from doing this? It would mean static files experience the entire request pipeline, e.g. if authentication is enabled then static file requests would be authenticated.Alternatively `UseStaticFiles` could remain present in templates, and if the request was matched to a static file endpoint in `UseEndpointRouting` then `UseStaticFiles` would do nothing more than invoke the endpoint and exit.
5261	area-mvc	Issue with Angular Spa template	Following on from: https://github.com/aspnet/JavaScriptServices/issues/1781I wanted to check the behaviour of the default Angular Spa template. I have a repo here: https://github.com/chrisckc/DotNetCoreAngularSpabut there seems to be a temporary issue with github not accepting my push and returning a 404 for that particular repo intermittently.Run the repo in Production mode as per the instructions in the Readme.md, but instead of building Angular with the package script: `npm run build -- --prod`Build using ng directly: `ng build --env=prod` which builds without the --extractCss option, which should be a valid and working choice?Now run the dotnet app in production mode and visit: https://localhost:5001, scroll back through the dotnet console output and notice this:> info: DotNetCoreAngularSpa.Startup[0] ... app context.Request.Path: /bootstrap.min.css.map> dbug: Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware[5]      The request path /bootstrap.min.css.map does not match an existing fileCorrect as the file bootstrap.min.css.map does not exist in the bundled app in 'ClientApp/dist' dir> info: Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware[2]      Sending file. Request path: '/index.html'. Physical path: '/xxxxxxxx/ClientApp/dist/index.html'> info: DotNetCoreAngularSpa.Startup[0] inside app.UseSpa context.Response.StatusCode: 200 Url: /index.htmlNotice that the Request reached the UseSpa middleware, which unconditionally rewrites the Request.Path to /index.html before passing it to UseSpaStaticFilesInternal which then serves the contents of index.html from the 'ClientApp/dist' dir.As a result of the unconditional rewrite, if the Angular app requests a file which does not exist it always get the contents of index.html with a 200 OK status code, masking the real issue. A request for any file which does not exist will always result in the index.html being served from the 'ClientApp/dist' dir.The Chrome console log shows the following:> DevTools failed to parse SourceMap: https://localhost:5001/bootstrap.min.css.mapChrome DevTools thinks it got the file it asked for and tried to parse it, which fails because it's actually not the file it asked for and contains unexpected content.Commenting out the app.UseSpa block and then visiting the site using https://localhost:5001/index.html shows that the console warnings are no longer there because the Chrome DevTools correctly receives a 404 and presumably just ignores the missing map file.There are 3 issues here:1. There is an issue with the Angular App inside provided in the Angular Spa template out of the box by 'dotnet new angular' when running without extractCss option on both dev and prod modes. In dev mode the DevTools error is not seen because the request for /bootstrap.min.css.map is proxied to the dev server which returns a 404 not found.2. The behaviour of the Angular Spa template seems to be suboptimal, i can't see why the  UseSpa (uses SpaDefaultPageMiddleware under the hood) middleware has been designed to unconditionally rewrite the Request Path.  It could cause headaches when trying to debug issues with the built/bundled app etc unless you are aware of the unconditional rewrite behaviour. I think that the Request rewrite should only occur when the request path is '/' so that the index.html file can be served.  _**EDIT: I noticed that the Angular app is using HTML5 pushstate so that real url's can be used rather than hash based url fragments off root such as /#/somepage. Because of this it would need to also rewrite non-root requests.**_Serving the index file for any non-matching file does not make sense. **_EDIT: to support HTML5 pushstate, maybe only rewriting requests that do not contain a dot, ie. ones that do not look requests for files would be better?_** . As it stands at the moment, to make this behave sensibly will require a custom UseSpa extension class and custom SpaDefaultPageMiddleware class to be added to the project which is coded to only rewrite requests to '/' or '' **_EDIT: and also requests that do not contain a dot if we want to use pushstate_**3. The Spa template should have UseSpaStaticFiles wrapped in ` if (!env.IsDevelopment()) {` so that it does not serve files from ClientApp/dist in preference to the Angular Dev server when in dev mode. To see the issues this can cause, perform an angular build using `npm run build -- --prod` then rename the dist dir to dist-copy prevent it from being deleted. replace `UseAngularCliServer` with `UseProxyToSpaDevelopmentServer(baseUri: "http://localhost:4200")` then run `npm start`. Once started rename the dist-copy dir back to dist. Run the dotnet app in Dev mode and notice that the bundles are now served from the dist dir instead of the proxy.> info: Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware[2]      Sending file. Request path: '/main.bundle.js.map'. Physical path: 'xxxxxxxx/ClientApp/dist/main.bundle.js.map'Luckily the build scripts inside the Angular CLI delete the dist dir when `npm start` is ran, but it is not unreasonable to expect that devs may run into that issue when ejecting from the CLI or changing build options etc.
5260	area-mvc	Behaviour of Spa Middleware seems odd, please confirm	I have been attempting to get a Spa app running nicely from a sub-path of the root of an MVC app in both development and production modes. While getting it working I decided to take a step back and gain a deeper understanding how the various bits of Spa middleware actually worked under the hood.The Docs don't say much about how it works: https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/angular?view=aspnetcore-2.1&tabs=visual-studio During my analysis I found a number of things that seem a bit odd so i thought i would post about them here to get some help gain an understanding why it's doing what it does, here is what i did:I used 'dotnet new angular' to create a project and then deleted all the contents of the ClientApp dir.I then added 2 test files, index.html and test.html to an empty 'ClientApp/dist' dir.I also commented out app.UseStaticFiles() which serves files from wwwroot as i am only concerned with how the Spa related code behaves.I added some logging to the middleware pipeline so i can see what's going on. The repo is available here: https://github.com/chrisckc/DotNetCoreSpaTemplateAnalysisI then ran the project and made some requests from the browser as follows:Running in Development mode:```These requests are handled by the UseProxyToSpaDevelopmentServer middleware:https://localhost:5001 > forwarded to: https://localhost:8080/https://localhost:5001/page.html > forwarded to: https://localhost:8080/page.htmlhttps://localhost:5001/some/arbitary/path > forwarded to: https://localhost:8080/some/arbitary/pathhttps://localhost:5001//some/arbitary/path > Generates an exception: SocketException: Device not configuredhttps://localhost:5001//example.com > forwarded to: http://example.comThese requests are handled by the UseSpaStaticFiles middleware:https://localhost:5001/index.html > Serves contents of file: ClientApp/dist/index.htmlhttps://localhost:5001/test.html > Serves contents of file: ClientApp/dist/test.htmlhttps://localhost:5001//test.html > Serves contents of file: ClientApp/dist/test.html```Running in Production mode:```These requests are handled by the UseSpa middleware: (which rewrites all requests to /index.html)https://localhost:5001 > Serves contents of file: ClientApp/dist/index.htmlhttps://localhost:5001/page.html > Serves contents of file: ClientApp/dist/index.htmlhttps://localhost:5001/some/arbitary/path > Serves contents of file: ClientApp/dist/index.htmlhttps://localhost:5001//some/arbitary/path > Serves contents of file: ClientApp/dist/index.htmlhttps://localhost:5001//example.com > Serves contents of file: ClientApp/dist/index.htmlThese requests are handled by the UseSpaStaticFiles middleware:https://localhost:5001/index.html > Serves contents of file: ClientApp/dist/index.htmlhttps://localhost:5001/test.html > Serves contents of file: ClientApp/dist/test.htmlhttps://localhost:5001//test.html > Serves contents of file: ClientApp/dist/test.html```As can be seen from the above its possible to get the SpaProxy to proxy requests to any other host which should not be allowed. Refer to this issue: https://github.com/aspnet/JavaScriptServices/issues/1779In development mode, matching file as still served from the ClientApp/dist dir, this could cause headaches, such as finding that changes to files are not being reflected in the browser because a production build has been left behind in the ClientApp/dist dir.Luckily the file bundle created during the production build using the default config uses hashes in the filenames so there should not be any clashes. Requests for / are not handled by the UseSpaStaticFiles as it does not match a filename, so the Request then hits the UseSpa middleware which unconditionally rewrites the request path to /index.html.So due to the above, again as luck would have it, when you hit https://localhost:5001 you will get the latest index.html from the Angular dev server which references the latest files. However if you hit https://localhost:5001/index.html you will get the index.html from the ClientApp/dist dir and a copy of the previous production build.There are 3 issues here as i see it:1. In the generated Angular Spa template project, the UseSpaStaticFiles middleware should be wrapped in an if !env.Development() statement, i can't see any reason for it to be enabled in Development mode with the workflow designed as it is.2. In production mode there seems to be no need for the UseSpa (internally just uses SpaDefaultPageMiddleware) middleware to unconditionally rewrite every request path that hits it to /index.html. It only needs to rewrite requests to the root '/'. _**EDIT: I noticed that the Angular app is using HTML5 pushstate so that real url's can be used rather than hash based url fragments off root such as /#/somepage. (I have been using Aurelia which uses hash based url fragments by default). Because of this it would need to also rewrite non-root requests.**_ In fact it would be better not to have UseSpa enabled in production mode and instead but some middleware before the UseSpaStaticFiles middleware which just rewrites requests to '/' to index.html. **_EDIT: or rewrite requests that do not contain a dot in the path, ie. ones that don't look like requests for files._** So rather than wrapping just the call to the proxy middleware in the if statement, wrap the whole UseSpa block in it and instead use a custom rewrite middleware before UseSpaStaticFiles.3. I think the structure of the Spa middleware needs to be reviewed to make it more configurable and flexible for different scenario's such as hosting to the Spa off the root path, for example at '/app' or '/frontend'As a side note, If you run the Node Http server against the dist dir, as described in the readme in my repo, you will notice that it only rewrties requests to '/' to index.html. My guess is that the Spa middleware has been designed to work like the Angular dev server which does seem to rewrite any requests that don't match a file to the index.html. This is only dev behaviour but it seems like the Spa middleware has been designed to behave like this in production mode as well. I don't agree with that behaviour in either mode, it should still only be rewriting '/' in my opinion. **_EDIT: or rewriting requests that do not contain a dot in the path, ie. ones that don't look like requests for files._**Here is the relevant code:https://github.com/aspnet/JavaScriptServices/blob/ea3a7bc8974271d6e9eeb9e890f23f953b8b40e2/src/Microsoft.AspNetCore.SpaServices.Extensions/SpaDefaultPageMiddleware.cs#L23-L28
6032	area-identity	Alternative SignedOut callback url	Is there a good way to use Areas/Controllers/AccountController.cs, but have alternative routes for pages like SignedOut.cshtml.  What I'm after is for the signed out user to be redirected to the home page rather than the current https://localhost:44383/AzureADB2C/Account/SignedOutIs it the intention that the code under https://github.com/aspnet/AADIntegration/tree/master/src/Microsoft.AspNetCore.Authentication.AzureADB2C.UI/Areas/AzureADB2C is just to demo how code should be structured and a real implementation would be code in the project?Thanks, John
5373	area-signalr	[Question] Versioning strategy on SignalR	Hi there, I would want to get some recommendation in regards to versioning strategy on signalr.My use case will contain a single hubs that has 3 methods. It provides independant result with accepting models in params that is similar to REST. The reason i'm doing this is that to execute the 3 operation using one websocket. However, i may need to evolve it at a point on without having to break client integrations.What's a better way to achieve it ? I have two options in my mind which is:1) Method versioning2) Param versioningAppreciate for a recommendation and please do share if there are any other better ways to achieve this.
5833	area-identity	Discussion for API authentication and Identity Server	Some of you may have noticed that the [Identity Server](https://identityserver.io/) integration is now in the [master branch](https://github.com/aspnet/Identity/tree/master/src/ApiAuth.IS) along with a [sample](https://github.com/aspnet/Identity/tree/master/samples/ApiAuthSample) on how it all hangs together.This issue is meant to centralize feedback as much as possible, so let's first discuss what this feature is aimed at and its limits- The feature will appear as an authorization option for API and SPA templates where you require Individual Authentication with a local database.- This will _not_ appear as an option for MVC or Razor Pages applications, those will continue as is for now.- It is meant as a _simple_ starting point, supporting APIs and first party clients. - It uses conventions to register the clients and apis without the need for configuring Identity Server beyond the helper methods in ConfigureServices()```            services.AddDbContext<ApplicationDbContext>(options =>                options.UseSqlite(Configuration.GetConnectionString("DefaultConnection")));            services.AddDefaultIdentity<ApplicationUser>()                .AddEntityFrameworkStores<ApplicationDbContext>();            services.AddIdentityServer()                .AddApiAuthorization<ApplicationUser, ApplicationDbContext>();            services.AddAuthentication()                .AddIdentityServerJwt();```- It still uses ASPNET Identity for the user database, and thus requires EF.- It will not support any advanced usage of Identity Server, like federation, WS-Fed, client certificates etc. although nothing will stop you migrating to those should you require them, you just have to abandon the helper functions and go full throttle with Identity Server's configuration system.- We'll be examining service to service authentication at some point.So, have at it.
5372	area-signalr	Is there build.gradle complete sample for Java project?	Is there build.gradle complete sample for Java project?```implementation 'com.microsoft.signalr:signalr:1.0.0-preview3-35501'implementation 'io.reactivex.rxjava2:rxjava:2.2.2'```
5371	area-signalr	How do I debug ClientSample by breakpoints？	I rebuild all projects of SignalR. I run SignalRSample and it shows the message as below:```Hosting environment: ProductionContent root path: C:\tmp\SignalRJava\SignalR-release-2.2\samples\SignalRSamples\bin\Debug\net461Now listening on: http://localhost:5000Now listening on: http://0.0.0.0:9001Application started. Press Ctrl+C to shut down.```I run the ClientSample with debug mode and set the breakpoint at program.cs's Main function. But the code does not stop. So, How do I set the breakpoints and debug the code inside ClientSample?Another problem is that the SignalRSample and ClientSample is the couple for SignalR Server and Signal Client? How do I run them correctly? Should I use the administrator privilege to run them as previous (.net framework) SignalR Server if it is a windows application?
5624	area-mvc	Make it easier to enable client-side SignalR logging when using server-side Blazor	We should provide a simple way to [enable client-side SignalR logging](https://github.com/aspnet/SignalR/wiki/Diagnostics-Guide#javascript-client-logging) when using server-side Blazor.
3855	area-servers	React to SDK/shared runtime custom install location changes	We would need to consume location information that is set by SDK installer to a registry key.https://github.com/dotnet/cli/issues/10100
4931	area-mvc	ViewEnginePath doesn't handle blackslashes	This line https://github.com/aspnet/Mvc/blob/release/2.2/src/Microsoft.AspNetCore.Mvc.Core/Internal/ViewEnginePath.cs#L32will fail if the second part starts with a backslash. Though they are expected as we can see in the `PathSeparator` field.
5446	area-mvc	Update React templates to use TypeScript	[CRA](https://github.com/facebook/create-react-app) now has [support for TypeScript](https://github.com/facebook/create-react-app/pull/4837). We should update the templates to use it.
4930	area-mvc	Create an Analyzer to prevent usage of reserved keywords in code	People are hitting these type of issues more and more: https://github.com/aspnet/Mvc/issues/7876The idea is to have an Analyzer which will be aware of all the reserved words we have in different places and will warn users about their name choices.@rynowak what are your thoughts about this?
5370	area-signalr	Ensure AzDO CI builds in release/2.1	We want to fully transition from Jenkins to Azure DevOps (AzDO), but AzDO isn't currently building `release/2.1`. I don't think it's going to be hard to port it, but we need to do the work:* [ ] Backport the YAML config file to the `release/2.1` branch* [ ] Change the triggers in AzDO to trigger PR and commit verification builds* [ ] Verify that the builds are triggering properly and succeed.For the indivdiual project build (i.e. no signing, release process goop, etc.), I think that this is fairly straightforward.
3775	area-mvc	Update MusicStore tests to run against the shared framework	The music store tests are still configured for ASP.NET Core 2.0 and the runtime store. The behavior of the shared framework is the same, so it should just be a matter of swapping the names of the environment variables used to enable the tests.
5623	area-mvc	Server side Blazor + Paste large amount of text into text area with binding = Disconnection of client	I have a server side execution Blazor app that is displaying a text area with a simple 'bind="@backingProperty"'. If I paste moderate amounts of text into the text area everything functions as it should. However, if I paste a large amount of text (it happens to be a base64 representation of an image in some html) then the connection is closed with the following error appearing:```Error: Connection disconnected with error 'Error: Server returned an error on close: Connection closed with an error.'. blazor.server.js:16:6839	I</e.prototype.log https://localhost:44379/_framework/blazor.server.js:16:6839	P</e.prototype.stopConnection/</< https://localhost:44379/_framework/blazor.server.js:16:27531	a/</< https://localhost:44379/_framework/blazor.server.js:16:1652	a/< https://localhost:44379/_framework/blazor.server.js:16:970	s/< https://localhost:44379/_framework/blazor.server.js:16:697	s https://localhost:44379/_framework/blazor.server.js:16:474	P</e.prototype.stopConnection https://localhost:44379/_framework/blazor.server.js:16:27424	P</e.prototype.startInternal/</</this.transport.onclose https://localhost:44379/_framework/blazor.server.js:16:23753	U</e.prototype.connect/</</</i.onclose https://localhost:44379/_framework/blazor.server.js:16:20576Blazor 0.6.0Firefox 63.0Window 10 Pro x64IIS Express hosted server side Blazor
5259	area-mvc	Behaviour of UseProxyToSpaDevelopmentServer when attempting to proxy to host/path	I am not sure if SpaProxy was designed to allow proxying to a sub path such as "http://localhost:8080/app" as the documentation does not really say anything about it's behaviour, just that the parameter is the 'target base URI'.In testing i found some odd results. To check the proxied request i just started up the node http server pointing to the 'dist' dir like this: `http-server dist --cors` and observed the console outputFirst, without a sub path everything is as expected:```app.UseSpa(spa => {		spa.UseProxyToSpaDevelopmentServer(baseUri: "http://localhost:8080");	}});Request to https://localhost:5001 goes to http://localhost:8080/Request to https://localhost:5001/ goes to http://localhost:8080/Request to https://localhost:5001/test goes to http://localhost:8080/testRequest to https://localhost:5001/test/ goes to http://localhost:8080/test/```When a sub path is used it is clear that the /app subpath is ignored:```// The behaviour is the same for "http://localhost:8080/app" and "http://localhost:8080/app/"app.UseSpa(spa => {		spa.UseProxyToSpaDevelopmentServer(baseUri: "http://localhost:8080/app");	}});Request to https://localhost:5001 goes to http://localhost:8080/Request to https://localhost:5001/ goes to http://localhost:8080/Request to https://localhost:5001/test goes to http://localhost:8080/testRequest to https://localhost:5001/test/ goes to http://localhost:8080/test/```Looking at the source code:https://github.com/aspnet/JavaScriptServices/blob/9c6a1b577f04d845152532c66252811260b3f36a/src/Microsoft.AspNetCore.SpaServices.Extensions/Proxying/SpaProxy.cs#L61-L63It is clear why this is the case, i don't think that method is the best choice for SpaProxy as it does not handle various scenarios very well. The `Uri(baseUri, relativeUri)` constructor method seems to treat the baseUri parameter as only "http(s)://host:port" ignoring any paths, well at least it does at first glance.However, looking at the docs for Uri, the intended behaviour is rather odd:https://docs.microsoft.com/en-us/dotnet/api/system.uri.-ctor?view=netcore-2.1> If the baseUri has relative parts (like /api), then the relative part must be terminated with a slash, (like /api/), if the relative part of baseUri is to be preserved in the constructed Uri.> Additionally, if the relativeUri begins with a slash, then it will replace any relative part of the baseUriThat behaviour does not suit the SpaProxy very well, i think it is reasonable to assume that the proxy should forward any paths passed to it to the proxy baseUri and retain any subpaths in the baseUri regardless of whether the path begins with a slash or not. The use case for the SpaProxy in the Angular Spa template means that it will always receive paths that start with a trailing slash. There is also a side effect, if SpaProxy is used inside app.Map("/app",  ...) , a request for "/app" will be sent to the proxy as empty string path as app.Map removes the matched path segment. (observed in testing) So in this instance the SpaProxy baseUri sub-path will be retained because the path passed to SpaProxy is an empty string, however if the request is for "/app/test" then the baseUri sub-path is removed because the request has been changed to "/test" which starts with a slash.Here are the results of testing using `new Uri(baseUri, relativeUri)` with a combination of different baseUri and relativeUri paths:```// Tests with trailing slash on baseUrivar targetUri = new Uri(new Uri("http://localhost:8080/app/"), "/");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://localhost:8080/" // as per the docs but does not feel rightvar targetUri = new Uri(new Uri("http://localhost:8080/app/"), "/test");logger.LogInformation($"targetUri: {targetUri}");"http://localhost:8080/test" // matches the docs but does not feel rightvar targetUri = new Uri(new Uri("http://localhost:8080/app/"), "test");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://localhost:8080/app/test"  // matches the docs var targetUri = new Uri(new Uri("http://localhost:8080/app/"), "");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://localhost:8080/app/" // matches the docs?var targetUri = new Uri(new Uri("http://localhost:8080/app/"), "http://example.com/test");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://example.com/test" // matches the docs but does not feel rightvar targetUri = new Uri(new Uri("http://localhost:8080/app/"), "//example.com/test"); logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://example.com/test" // wow! what the heck! is this in the docs?// Tests without trailing slash on baseUrivar targetUri = new Uri(new Uri("http://localhost:8080/app"), "/");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://localhost:8080/" // matches the docs but does not feel rightvar targetUri = new Uri(new Uri("http://localhost:8080/app"), "/test");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://localhost:8080/test" // matches the docs but does not feel rightvar targetUri = new Uri(new Uri("http://localhost:8080/app"), "test");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://localhost:8080/test" // matches the docs but does not feel rightvar targetUri = new Uri(new Uri("http://localhost:8080/app"), "");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://localhost:8080/app" // matches the docs?var targetUri = new Uri(new Uri("http://localhost:8080/app"), "http://example.com/test");logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://example.com/test" // matches the docs but does not feel rightvar targetUri = new Uri(new Uri("http://localhost:8080/app"), "//example.com/test"); logger.LogInformation($"targetUri: {targetUri}");"targetUri: http://example.com/test" // wow! what the heck! is this in the docs?```I find that case of the relativeUri being an absolute path "http://example.com/test" disturbing because it means that SpaProxy will try to forward the request to that host ignoring the baseUri or any security implications in dev mode. How would such a request get through to the middleware in the first place, see the example in the tests above, passing "//example.com/test" as the path is one possible way. Also refer to same issue here: https://github.com/aspnet/JavaScriptServices/issues/1763Please fix the potential security issue and consider changing the behaviour of SpaProxy to enable proxying to subpaths in the Angular Spa template, or update the docs to say that this is not possible.
5832	area-identity	Question: Migrating from the old pre-core ASP.NET Identity to ASP.NET Identity Core	What are the changes needed to the database schema for one to move an application from the old ASP.NET Identity? Are these documented anywhere?
5831	area-identity	Revisit how identity behaves without accepting privacy policy	Related to https://github.com/aspnet/Identity/issues/2034
3762	area-servers	Behaviour difference between app.map and app.mapWhen	According to the docs:https://docs.microsoft.com/en-us/aspnet/core/fundamentals/middleware/?view=aspnetcore-2.1#use-run-and-map> When Map is used, the matched path segment(s) are removed from HttpRequest.Path and appended to HttpRequest.PathBase for each request.The section about mapWhen does not say anything about what it does with HttpRequest.Path**observation**From my own testing i have found that 'mapWhen' does not do this, which is good because for my use case as i need the HttpRequest.Path to be left untouched, however in production mode i need it to be removed as it is when using 'map'.That little statement about map in the docs is easy to miss, a sensible assumption when discovering those methods would be that both methods behave the same way and don't modify the path.To keep the code clean and more meaningful i would rather not wrap the 2 different methods inside an if statement for env.IsDevelopment() and factor out the common code etc.**suggestion**It would be great if both map and mapWhen could be extended with an option for removing the matched path segment eg. `bool removeMatchedPathSegment` keeping the defaults to match the current behaviour to avoid breaking changes to existing apps etc.**workaround**To achieve this in my app i will probably go down the route of creating my own configurable mapWhen middleware based on this:https://github.com/aspnet/HttpAbstractions/blob/master/src/Microsoft.AspNetCore.Http.Abstractions/Extensions/MapWhenMiddleware.csand then borrowing the code from MapMiddleware.cs to optionally remove the path segment.I would rather not have to replicate framework code to achieve what i want to do so it would be great if this feature could be added for a future version. It would also make the behaviour more explicit to avoid any confusion.
5102	area-mvc	Razor Sdk 3.0 migration docs	Things to note in the migration docs* [ ] What do you replace Razor.Design with (ties in to #2676)? 
4929	area-mvc	InferParameterBindingInfoConvention sets BindingSource = Body when BinderType is specified but not a source	Consider: `BindingInfo.BinderType = typeof(SomeBinder); BindingInfo.BindingSource = null;``InferParameterBindingInfoConvention` ignores the `BinderType` and will infer the `BindingSource` based on the parameter type \ presence in route dictionary.
5622	area-mvc	CLI for creating components	
5369	area-signalr	[question] using SignalR with Azure traffic manager	I've multiple instances of the same signalr hub running under traffic manager.since i look at #2515 it seems not possible to use signalr in such scenario.But if i use [signalr coupled with Redis](https://docs.microsoft.com/en-us/aspnet/signalr/overview/performance/scaleout-with-redis) i suppose is then possible to use it under traffic manger.Am i right?
5368	area-signalr	Support for server sent events in java library?	When it will be available?
6028	area-identity	Issuer validation problem	Hello!Azure AD B2C produces JWT with issuer "https://sts.windows.net/{TENANT_ID}/', however JwtBearerHandler takes issuer from Open ID metadata endpoint (https://login.microsoftonline.com/{TENANT_ID}/v2.0/.well-known/openid-configuration), as I see, which is "https://login.microsoftonline.com/{TENANT_ID}/v2.0".Is there a way to override thsi behavior? Add some custom issuer validatior or add "sts.windows.net" to the list of valid issuers?I see that inside AzureADB2CAuthenticationBuilderExtensions.AddAzureADB2CBearer JwtBearerOptionsConfiguration is used. Is it possible to add some injection point or extend AzureADB2COptions to add valid issuers to the list?Thank you!
5621	area-mvc	[Server-side] Adding 'namespace' will prevent the debug session from continuing.	When debugging from time-to-time (especially when debugging components) The following error pops-up:> Adding 'namespace' will prevent the debug session from continuing.Although I haven't changed anything to the codebase, only stepping into and over functions.The component itself is a GenericComponent introduced in Blazor 0.6.0.Restarting Visual Studio, seems to solve the problem but from time-to-time the issue rises again.Edit:Removed component code, doesn't help at all.
4698	area-servers	Kestrel not returning response on time	I have a web application built against `.NET Core 2.1.403` running on Linux with Apache as a proxy. It works fine except for some long running requests. If the processing of the request takes longer than ~10s the request doesn't return response for much longer. Both my application logging and `RequestDurationMiddleware` (see below) says the request is done but I'm staring at a loading circle in my browser (Waiting for first byte). These requests are less than 100KB so bandwidth is not an issue. Here is the Invoke method of `RequestDurationMiddleware`:        public async Task Invoke(HttpContext context)        {            var watch = Stopwatch.StartNew();            await _next.Invoke(context);            watch.Stop();            var ms = watch.ElapsedMilliseconds;            if (ms > 500)                log.Info("SLOW: " + context.Request.Path + context.Request.QueryString.ToString() + $" for {context.User?.Identity?.Name}: {ms}ms");        }This would output "SLOW: .... 13000ms" but client is waiting for results for a full minute.The slow action just awaits a slow internal method.Any pointers what should I look into?
3755	area-platform	Assemblies being removed from Microsoft.AspNetCore.App 3.0	:bulb: _Working draft: this list will may fluctuate as we continue to work on ASP.NET Core 3.0._In ASP.NET Core 3.0, we plan to remove the following assemblies from Microsoft.AspNetCore.App. These APIs will still be available as NuGet packages.To upgrade your project from ASP.NET Core 2.1 to 3.0, you may need to add several `<PackageReference>` items for the following* Microsoft.AspNetCore.Authentication.Facebook* Microsoft.AspNetCore.Authentication.Google* Microsoft.AspNetCore.Authentication.JwtBearer* Microsoft.AspNetCore.Authentication.MicrosoftAccount* Microsoft.AspNetCore.Authentication.OpenIdConnect* Microsoft.AspNetCore.Authentication.Twitter* Microsoft.AspNetCore.Authentication.WsFederation* Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore* Microsoft.AspNetCore.Identity.EntityFrameworkCore* Microsoft.AspNetCore.Identity.UI* Microsoft.AspNetCore.JsonPatch* Microsoft.AspNetCore.MiddlewareAnalysis* Microsoft.AspNetCore.Mvc.Razor.Extensions* Microsoft.AspNetCore.NodeServices* Microsoft.AspNetCore.Owin* Microsoft.AspNetCore.Razor.Design* Microsoft.AspNetCore.Razor.Language* Microsoft.AspNetCore.Server.Kestrel.Https (cref #4228 )* Microsoft.AspNetCore.SpaServices* Microsoft.AspNetCore.SpaServices.Extensions* Microsoft.CodeAnalysis.Razor* Microsoft.EntityFrameworkCore* Microsoft.EntityFrameworkCore.Abstractions* Microsoft.EntityFrameworkCore.Analyzers* Microsoft.EntityFrameworkCore.Design* Microsoft.EntityFrameworkCore.InMemory* Microsoft.EntityFrameworkCore.Relational* Microsoft.EntityFrameworkCore.SqlServer* Microsoft.EntityFrameworkCore.Tools* Microsoft.Extensions.Caching.SqlServer* Microsoft.Extensions.DiagnosticAdapter
5620	area-mvc	Support canceling of navigation	There is an event `OnLocationChanged` on `IUriHelper`, it would be great to have support for canceling or more particularly confirming unintentional navigation.The use case is a simple form that users can change, but to don't lose any changes unintentionally, if the user tries to navigate away and the form has changed, we would like to ask him to confirm or cancel navigation.
3752	area-platform	Enable source-build for the ASP.NET Core shared framework	See also https://github.com/dotnet/source-build/issues/375.The Microsoft.AspNetCore.App shared framework and many of dependencies are not currently supported in source-build. To enable source-build on this shared runtime, we expect the following changes will need to be made:* Add a build flag to enable building only source-buildable assets. Not everything in the repo will support source-build* Enabling compiling without any remote assets.* Change our build scripts skip steps which require unavailable tools, such as NuGetPackageVerifier, xunit analyzers, etc.## RequirementsThe following must be available via source-build:* everything in the Microsoft.AspNetCore.App shared framework for Linux (currently excluding Windows, which requires Visual Studio to build)* all assemblies in the Microsoft.AspNetCore.App  targeting packWhat's not in source-build yet:* test projects* internal tools* KoreBuild* anything not in Microsoft.AspNetCore.App 
5367	area-signalr	Java Testing improvements	* [ ] Automated Functional Tests against the a real server* [ ] Test expected log messages
5366	area-signalr	Support Endpoint Routing	In ASP.NET Core 3.0 we should support endpoint routing. As part of this, we should look at a bit of a routing overhaul in SignalR, including support for attribute routing.
3745	area-mvc	Url.Action doesn't respect constraints from  IApplicationModelConvention	### Describe the bugI implemented localized routes using a ```ApplicationModelConvention```.This works fine as long as I type the urls directly in the browser.So, for example, german routes are only allowed in german culture. and routes from other languages are returning a 404. Exactly as expected.But when I use `Url.Action` it doesn't respect the constraints. so for example if i'm on the english domain i get russian links (depending on the order they are inserted)What am I doing wrong?[Startup Code:](https://github.com/cypressious/asp-net-core-localized-routes-issue/blob/master/FrontendCoreTest/Startup.cs)     services.AddMvc(o =>                {                    o.Conventions.Insert(0, new LocalizedRouteConvention());                })[Convention](https://github.com/cypressious/asp-net-core-localized-routes-issue/blob/master/FrontendCoreTest/LocalizedRouteConvention.cs)        public class LocalizedRouteConvention : IApplicationModelConvention    {        public void Apply(ApplicationModel application)        {            foreach (var controller in application.Controllers)            {                foreach (var action in controller.Actions)                {                    var attributes = action.Attributes.OfType<RouteAttribute>().ToArray();                    if (!attributes.Any()) return;                        foreach (var attribute in attributes)                    {                        SelectorModel defaultSelector = action.Selectors.First();                            foreach (var localizedVersion in GetLocalized(attribute.Template))                        {                            if (!action.Selectors.Any(s => s.AttributeRouteModel.Template == localizedVersion.Template))                            {                                action.Selectors.Insert(0, new SelectorModel(defaultSelector)                                {                                    AttributeRouteModel = localizedVersion,                                    ActionConstraints =                                    {                                        new CultureActionConstraint { Culture = ((LocalizedRouteAttribute) localizedVersion.Attribute).Culture }                                    }                                });                            }                        }                    }                }            }        }    }And here the constraint```    public class CultureActionConstraint : IActionConstraint    {        public string Culture { get; set; }        public int Order => 0;        public bool Accept(ActionConstraintContext context)        {            return CultureInfo.CurrentCulture.TwoLetterISOLanguageName == Culture;        }    }```### Expected behaviorUrl.Action should also only use the routes that are allowed.
5364	area-signalr	when invoking a server method from client and passing objects when the model binding in SignalR fails it thrown an exception, why it doesn't work like a controller Action model binding so it doesn't thrown an exception and fill a special object ModelState to be used by developer	### If you believe you have an issue that affects the security of the platform please do NOT create an issue and instead email your issue details to secure@microsoft.com. Your report may be eligible for our [bug bounty](https://technet.microsoft.com/en-us/mt764065.aspx).### Please consider the following before filing an issue* If you are using NuGet Packages that start with `Microsoft.AspNet.SignalR`, use the issue tracker at https://github.com/SignalR/SignalR to report the issue. This repository is for packages that start with `Microsoft.AspNetCore.SignalR` (and NPM packages that start with `@aspnet/signalr`)### Please include as much of the following as you can in your bug report* Versions of Server-Side NuGet Packages:* Versions of Client-Side NuGet/NPM Packages:* Are you using the C# client or the JavaScript client:* The Server you are using (Kestrel/HttpSysServer/IIS/IIS Express/Azure Web App/etc.): * The Operating System on the Server (Windows/Linux/macOS):* The Operating System on the Client (Windows/Linux/macOS):* The Browser on the client, if using the JavaScript client (IE/Chrome/Edge/Firefox/etc.):* Please use the Diagnostics Guide at https://github.com/aspnet/SignalR/wiki/Diagnostics-Guide to collect server-side and client-side logs and network traces if possible. Please **do not** put the traces and logs in the Issue text as they are quite large. The Diagnostics Guide describes how to attach them to the issue.When in doubt, feel free to file the issue, we're happy to help answer questions. We also suggest using the `asp.net-core-signalr` tag on StackOverflow to ask questions.
3737	area-servers	ParsingHelpers.GetHeaderSplit - Check if values is empty before parsing	Not calling `GetHeaderSplitImplementation` will skip the allocation of a yield-state-machine:https://github.com/aspnet/HttpAbstractions/blob/ec176b2e40699c24cc1c0e3bde8a828e93fe67c7/src/Microsoft.AspNetCore.Http.Abstractions/Internal/ParsingHelpers.cs#L19-L23
5363	area-signalr	Remove Duplication in Clients while Sending Message	I am having an issue with SignalR here, a client in my application can belong to more than 1 groups. When the client connects I add him in specific groups. Within Group there is no duplication. Now the issue is when the same message is broadcasted among different groups having same client and same connection ID.This is my code. notificationService is HubContext  await this.notificationService.SendNotificationToGroups(entity.Roles, NotificationConstants.Announcement, NotificationConstants.AnnouncementMessage);I am using core 2.1. Thanks alot
5619	area-mvc	TypedArray fail to serialize	Hello folks!While I was implementing [Blazor.Extensions.WebUSB](https://github.com/BlazorExtensions/WebUSB), I had to send/receive buffers to the USB device connected. In C#, I was sending `byte[]` down to JS and it was working perfectly fine. However, when I was sending a buffer back from JS to C#, it fail without any errors since it was unable to deserialize the `Uint8Array` into a `byte[]`. It just hang on the `resolve(array)` call.After a day trying to figure out what is going on, I noticed that if I convert it to a regular array it works perfectly with `Array.prototype.slice.call(new Uint8Array(out.data.buffer))`. That is very inefficient... The reason for that (looks like) is because we don't have support to deserialize [`TypedArray`s](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray) on SimpleJson...The same problem happens on [Blazor.Extensions.SignalR](https://github.com/BlazorExtensions/SignalR) when we have a callback that expects a `byte[]`.Look at the examples [here](https://github.com/BlazorExtensions/WebUSB/blob/master/src/Blazor.Extensions.WebUSB.JS/src/USBManager.ts#L184) and [here](https://github.com/BlazorExtensions/SignalR/blob/master/src/Blazor.Extensions.SignalR.JS/src/HubConnectionManager.ts#L100).Do we have a less hacky/slow alternative to this?Thanks!
5101	area-mvc	Add a test verifying 3.0 SDK is compatible with 2.2 targeting project	As part of https://github.com/aspnet/Razor/pull/2672/files, we added a test verifying 3.0 Razor Sdk's compatibility with 2.1 application. Once 2.2 ships and we can restore packages from NuGet.org, we should add a test to verify 2.2 compat.
5100	area-mvc	Figure out how RCLs in 3.0 work	* Project TFM* What does it compile against?* How does it specify language version \ Razor Configuration?* How does it use the compiler in the SDK (currently behind the `_EnableAllInclusiveRazorSdk` property)
5099	area-mvc	Determine what binaries need to ship in SDK	The SDK currently ships versions of Microsoft.CodeAnalysis and Newtonsoft.Json that the razor compiler independently ships. We could take advantage of the existing binaries instead of shipping them in the Razor Sdk
5362	area-signalr	Remove Jenkins builds	Two tasks (can be completed independently):* [x] Remove Jenkins builds* [ ] Consider adding a Spanish-language AzDO agent build
5361	area-signalr	Consider removing Moq dependency from tests	We've had some issues with it and I don't think we really need it since we use mocks (rather than moqs :trollface:) in most places already.
3724	area-servers	InvalidDataException: Line length limit 100 exceeded	_From @thomasd3 on October 25, 2018 20:11_When uploading data files with RestSharp to a .Net Core 2.1 REST interface, I get this error on some files:```System.IO.InvalidDataException: Line length limit 100 exceeded.   at Microsoft.AspNetCore.WebUtilities.BufferedReadStream.ReadLineAsync(Int32 lengthLimit, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.MultipartReaderStream.ReadAsync(Byte[] buffer, Int32 offset, Int32 count, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.StreamHelperExtensions.DrainAsync(Stream stream, ArrayPool`1 bytePool, Nullable`1 limit, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.MultipartReader.ReadNextSectionAsync(CancellationToken cancellationToken)```When I do the same operation with Insomnia, I do *not* get any error, only with RestSharp.I have read here https://stackoverflow.com/questions/44642701/microsoft-aspnetcore-webutilities-line-length-limit-100-exceeded that there is a problem with the line ending formats, but this is the only article about it.The controller signature is very simple:```[HttpPost, DisableRequestSizeLimit]public async Task<IActionResult> AddPictureAsync(	IFormFile Picture,	IFormFile Thumbnail,	string Title){```and the code to send is:```var Request = new RestRequest("picture", Method.POST) { AlwaysMultipartFormData = true };Request.AddHeader("SessionId", SessionId);Request.AddFile("Picture", PhotoData.ToArray(), Photo.PhotoUrl);Request.AddFile("Thumbnail", ThumbnailData, Photo.PhotoUrl.Replace(".jpg", "-t.jpg"));Request.AddParameter("Title", Photo.Title ?? string.Empty, ParameterType.GetOrPost);```If I understand the error, it means that the data lines are longer than they should. But is there a way to inspect what is coming in? My controller doesn't even  get executed, the error happens before_Copied from original issue: aspnet/KestrelHttpServer#3057_
3853	area-servers	Publish to azure initial request returns "The service is unavailable"	**Repro:**1. Publish site to azure using inprocess2. Initial request is sent to site automatically3. Check responseExpected: Response is the home page of the siteActual: ~50% of the time, it returns "The service is unavailable". Refreshing the page will return the home page. **Cause:**When ANCM detects app offline, it call IHttpServer::RecycleProcess. This event tells IIS to start shutting down the current worker process. However, requests can still be sent to the worker process before a new worker process is created. If app offline is dropped and removed, sending an HttpRequest to the server immediately may return a 500 for the process shutting down.We prototyped a fix to avoid calling shutdown until we receive a global notification from IIS, but that didn't seem to help.
5943	area-hosting	FriendlyName Property for Setting Human Readable Application Name	I'm creating this issue to more formally track at a least a passing mentionhttps://github.com/aspnet/Hosting/pull/1180#issuecomment-323616208https://github.com/aspnet/Hosting/pull/1180#issuecomment-323617999that this might be provided in the V3 roadmap.I was trying to set the application name to be picked up by Dynatrace application monitoring.https://github.com/aspnet/Hosting/issues/1572But soon discovered that the documentationhttps://docs.microsoft.com/en-us/aspnet/core/fundamentals/host/web-host?view=aspnetcore-2.1#application-key-name(at that time) did not accurately reflect that the property specifies the application entry point assembly file name.My Java/Spring application name via the spring.application.name application property, are named like "MyProduct-TheService" but without setting the application name, the dot net service shows up as "Org.MyProduct.TheService.dll".   The result is that my dotnet micro-services are not grouped with my other product micro-services.Essentially the proposal is to provide a meta data property that has no behavior.
4642	area-security	WS-Federation OnRemoteFailure - is this the best way to challenge for authentication again	ASP.NET Core 2.1My app has remote authentication configured with WS-Fed. I don't want any part of the app to be accessible to an unauthenticated user.```services    .AddAuthentication(o =>    {        o.DefaultScheme = CookieAuthenticationDefaults.AuthenticationScheme;        o.DefaultSignInScheme = CookieAuthenticationDefaults.AuthenticationScheme;        o.DefaultChallengeScheme = WsFederationDefaults.AuthenticationScheme;    })    .AddWsFederation(o =>    {        o.Wtrealm = "urn:sp.ProspectPortal";        o.MetadataAddress = "https://localhost:44311/metadata.xml";        o.Events.OnRedirectToIdentityProvider = ctx =>        {            ctx.ProtocolMessage.Wct = DateTimeOffset.UtcNow.ToString();            return Task.CompletedTask;        };    })    .AddCookie();```If the user cancels the authentication, then the remote authenticator redirects to the default WsFederationOptions.CallbackPath, which is /signin-wsfed. It displays the following exception ```System.Exception: An error was encountered while handling the remote login. ---> System.Exception: No message.   --- End of inner exception stack trace ---   at Microsoft.AspNetCore.Authentication.RemoteAuthenticationHandler`1.HandleRequestAsync()   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```I know an issue with my IdP is causing this exception. For now, in order to automatically challenge the user for authentication again and to not show the exception, I added this to the ws-fed configuration.```o.Events.OnRemoteFailure = ctx =>{    ctx.Response.Redirect("/Index");  //requires authentication    ctx.HandleResponse();    return Task.CompletedTask;};```Is this the best way to redirect on failure? Is this the best way to challenge authentication again? See any issues with this?
3850	area-servers	Consider committing binaries to avoid pulling from myget feed for backwards compat tests	Pulling from myget isn't a long term solution; preview builds may get purged eventually and the Microsoft.AspNetCore.AspNetCoreModule package isn't on nuget. We should either commit binaries or create a long term feed to keep a stable version of the package.cc @natemcmaster 
5360	area-signalr	Document Guidance for Scaling out with Redis as a Backplane	I am currently exploring the proper way to deploy redis as the backplane for several asp.net core based SignalR applications. High Availability is a requirement, but it is unclear what is supported from the redis side.Things I have tried:1. Use a Redis cluster, configure SignalR connection string to be aware of all nodes1.1. When monitoring pub/sub for each node, messages are spread around  nodes within the cluster (it was asymmetric, that is, every 8th message would consistently go to one node while many more would go to another) 1.1. When killing a node in the cluster using `DEBUG SEGFAULT`, traffic did seem to route to the remaining nodes2. Use Redis in a Master-Slave Configuration with 3 sentinels for HA2.1. When monitoring pub/sub for each node, messages seem to be sent to all nodes whether they are the master or a slave2.2. When killing a node with `DEBUG SEGFAULT`, some messages are missed but eventually things seem to stabilize after sentinel elects a new master2.3. When simulating bad responsiveness with `DEBUG SLEEP 60`, sentinel will elect a new master but the connected SignalR applications will just hang until the sleep period finishesBecause we are only interested in redis for pub/sub, a full-blown cluster seems like overkill so I'd prefer to go with a Master/Slave approach. The Asp.Net version of SignalR did not support clustering at all, but I cannot find documentation on whether the Core version does.To sum up, what is the guidance to achieve High Availability while using redis as the backplane? Is Redis clustering supported? What are the pros-cons of clustering vs. Master-Slave with Sentinel for high availability?
4699	area-servers	Unable to start Kestrel. System.Net.Sockets.SocketException (13): Permission denied while running alpine as non root user	_From @endejoli on Monday, 22 October 2018 19:03:34_## Steps to reproduce the issue1.Use the below Dockerfile to build image```dockerfileFROM microsoft/dotnet:2.1-aspnetcore-runtime-alpine3.7EXPOSE 5000WORKDIR /appCOPY ./app/* /app/RUN adduser -D buildadminRUN chown buildadmin:buildadmin /app /app/* USER buildadminENTRYPOINT ["dotnet", "Template.Sample.dll"]```2. Building and running the image gives below error```18:10:59 INF] Starting web host[18:10:59 INF] User profile is available. Using '/home/buildadmin/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.[18:10:59 INF] Creating key {c07b8334-0237-48ed-817e-9dcb73382d0e} with creation date 2018-10-22 18:10:59Z, activation date 2018-10-22 18:10:59Z, and expiration date 2019-01-20 18:10:59Z.[18:10:59 WRN] No XML encryptor configured. Key {c07b8334-0237-48ed-817e-9dcb73382d0e} may be persisted to storage in unencrypted form.[18:10:59 INF] Writing data to file '/home/buildadmin/.aspnet/DataProtection-Keys/key-c07b8334-0237-48ed-817e-9dcb73382d0e.xml'.[18:10:59 FTL] Unable to start Kestrel.System.Net.Sockets.SocketException (13): Permission denied   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)   at System.Net.Sockets.Socket.Bind(EndPoint localEP)   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass22_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.AnyIPListenOptions.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)[18:10:59 FTL] Host terminated unexpectedlySystem.Net.Sockets.SocketException (13): Permission denied   at System.Net.Sockets.Socket.UpdateStatusAfterSocketErrorAndThrowException(SocketError error, String callerName)   at System.Net.Sockets.Socket.DoBind(EndPoint endPointSnapshot, SocketAddress socketAddress)   at System.Net.Sockets.Socket.Bind(EndPoint localEP)   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.SocketTransport.BindAsync()   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.<>c__DisplayClass22_0`1.<<StartAsync>g__OnBind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindEndpointAsync(ListenOptions endpoint, AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.ListenOptions.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.AnyIPListenOptions.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.AddressesStrategy.BindAsync(AddressBindContext context)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.AddressBinder.BindAsync(IServerAddressesFeature addresses, KestrelServerOptions serverOptions, ILogger logger, Func`2 createBinding)   at Microsoft.AspNetCore.Server.Kestrel.Core.KestrelServer.StartAsync[TContext](IHttpApplication`1 application, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Hosting.Internal.WebHost.StartAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token, String shutdownMessage)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.RunAsync(IWebHost host, CancellationToken token)   at Microsoft.AspNetCore.Hosting.WebHostExtensions.Run(IWebHost host)   at Template.Sample.Program.Main(String[] args) in /repo/src/production/Template.Sample/Program.cs:line 20Application is shutting down...```## Expected behaviorIt should start the webserver successuflly## Actual behavior## Additional information (e.g. issue happens only occasionally)When i run dotnet as root user, everything works as expected ## Output of `docker version````docker infoContainers: 20 Running: 0 Paused: 0 Stopped: 20Images: 37Server Version: 18.06.1-ceStorage Driver: overlay2 Backing Filesystem: extfs Supports d_type: true Native Overlay Diff: falseLogging Driver: json-fileCgroup Driver: cgroupfsPlugins: Volume: local Network: bridge host macvlan null overlay Log: awslogs fluentd gcplogs gelf journald json-file logentries splunk syslogSwarm: inactiveRuntimes: runcDefault Runtime: runcInit Binary: docker-initcontainerd version: 468a545b9edcd5932818eb9de8e72413e616e86erunc version: 69663f0bd4b60df09991c08812a60108003fa340init version: fec3683Security Options: apparmor seccomp  Profile: defaultKernel Version: 4.15.0-1023-azureOperating System: Ubuntu 16.04.5 LTSOSType: linuxArchitecture: x86_64CPUs: 2Total Memory: 6.807GiBName: actaz-prod-lbf3ID: 2SKW:7Y6P:KJBW:RAON:HGZ4:TDLT:2M5J:NWAF:EMSL:ZYHW:TZAO:L736Docker Root Dir: /var/lib/dockerDebug Mode (client): falseDebug Mode (server): falseRegistry: https://index.docker.io/v1/Labels:Experimental: falseInsecure Registries: 127.0.0.0/8Live Restore Enabled: false```_Copied from original issue: dotnet/dotnet-docker#765_
5618	area-mvc	"Unknown edit type: 0" when calling StateHasChanged	When calling `StateHasChanged` in response to a component's callback event, I get the above error in Chrome's Javascript console.  On version 0.6 of Blazor.  The repro steps are pretty straightforward.  This is a contrived minimal example, but the idea is to respond to `CTRL-Enter` in a textbox (to save the changes, for example). First create a component named `TestComponent.cshtml`:```<input type="text" bind="@Text" onkeydown="@OnKeyDown" />@functions {    private string text;    [Parameter]    private string Text    {        get => text;        set        {            text = value;            TextChanged?.Invoke(text);        }    }    [Parameter]    private Action<string> TextChanged { get; set; }    [Parameter]    private Action Committed { get; set; }    private void OnKeyDown(UIKeyboardEventArgs e)    {        if (e.Key == "Enter" && e.CtrlKey)        {            Committed?.Invoke();        }    }}```Then use this component in a different file:```@if (flag){    <TestComponent bind-Text="@text" Committed="@OnCommitted" />}else{    @text}@functions {    private bool flag = true;    private string text;    private void OnCommitted()    {        flag = false;        StateHasChanged();    }}```Now type at least one character in the textbox, then hit `CTRL-Enter`.  The view doesn't re-render (i'd expect the textbox to go away and be replaced with the value of `text`) and I see the following errors in the console:```blazor.webassembly.js:1 Uncaught (in promise) Error: Microsoft.JSInterop.JSException: Unknown edit type: 0Error: Unknown edit type: 0    at e.applyEdits (blazor.webassembly.js:1)    at e.updateComponent (blazor.webassembly.js:1)    ...```and```blazor.webassembly.js:1 Uncaught (in promise) Error: Microsoft.JSInterop.JSException: Cannot read property 'parentNode' of undefinedTypeError: Cannot read property 'parentNode' of undefined    at Object.e [as removeLogicalChild] (blazor.webassembly.js:1)    at e.applyEdits (blazor.webassembly.js:1)   ...```
4643	area-security	AuthorizationPolicyBuilder.RequireUserName requires Name - not UserName in Google authentication type	https://github.com/aspnet/Security/blob/beaa2b443d46ef8adaf5c2a89eb475e1893037c2/src/Microsoft.AspNetCore.Authorization/AuthorizationPolicyBuilder.cs#L192See that we require on the user name, but a NameAutorizationRequired requirement is added.NameAutorizationRequired checks Identity.NameWhen using tokens from Google, the name is the real name (e.g. "Eva T"), and not the user name - and real names can have duplicates.(Debug info for claims returned from Google below)**Name Value Type** **Identities** Count = 1 System.Collections.Generic.IEnumerable<System.Security.Claims.ClaimsIdentity> {System.Collections.Generic.List<System.Security.Claims.ClaimsIdentity>}   [0] {System.Security.Claims.ClaimsIdentity} System.Security.Claims.ClaimsIdentity    **Actor** null System.Security.Claims.ClaimsIdentity   **AuthenticationType** "Google" string   **Claims** Count = 6 System.Collections.Generic.IEnumerable<System.Security.Claims.Claim> {System.Collections.Generic.List<System.Security.Claims.Claim>}   [0] {http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 1234567} System.Security.Claims.Claim  [1] {http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Eva T} System.Security.Claims.Claim   [2] {http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname: Eva} System.Security.Claims.Claim  [3] {http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname: T} System.Security.Claims.Claim   [4] {urn:google:profile: https://profiles.google.com/123456} System.Security.Claims.Claim   [5] {http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: evat@gmail.com} System.Security.Claims.Claim   **CustomSerializationData** null byte[]   **IsAuthenticated** true bool   **Label** null string   **Name** "Eva T" string   **NameClaimType** "http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name" string   **RoleClaimType** "http://schemas.microsoft.com/ws/2008/06/identity/claims/role"
5359	area-signalr	Question about changing the signalr hub protocol 	Hi,I want to use/change the signalr hub protocol in the following way: - clients pass the type of message (instead of method name) together with the message itself (ie. CreateUserCommand or GetAllUsersQuery)- the hub dispatcher calls Handle method on the Hub - the Hub Handle method will dispatch the message to the correct command/query handler. What's the best way to do this in Signalr Core? In previous versions of Singalr I could use PersistentConnection to do it. Can I override the DefaultHubDispatcher ? by creating a custom one and register it in the IoC?Thanks,Stefan
5445	area-mvc	Template does not include ProducesResponseType	The Web API template does not have actions that are decorated using the `ProducesResponseType` attribute.The `ProducesResponseType` attribute which should be considered to be added since it would improve integration with software such as [Swashbuckle](https://github.com/domaindrivendev/Swashbuckle.AspNetCore) (Swagger).
5258	area-mvc	InvokeAsync getting cancelled after roughly 110 seconds	`await nodeServices.InvokeAsync<string>` is getting canclled after 110 seconds. getting `System.Threading.Tasks.TaskCanceledException: 'A task was canceled.'` StackTrace   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Net.Http.HttpClient.<FinishSendAsyncBuffered>d__58.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.NodeServices.HostingModels.HttpNodeInstance.<InvokeExportAsync>d__7`1.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.NodeServices.HostingModels.OutOfProcessNodeInstance.<InvokeExportAsync>d__13`1.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.<InvokeExportWithPossibleRetryAsync>d__10`1.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()   at AIRWAYS.Renderer.Processor.Utility.NodeUtility.<GenerateImage>d__0.MoveNext() in  
5617	area-mvc	Apply default memory limit in Mono env	Recommendation from @kumpera is to set it at 128MB initially, allowing the developer to change that setting for their app if they want.If we don't do this, and the app exceeds the amount of memory the browser wishes to give, then it fails with an obscure error instead of an OutOfMemoryException.Note to self: to set env vars for the Mono wasm runtime, call something like the following from JS before the runtime starts.    MONO.mono_wasm_setenv ("MONO_LOG_MASK", "all");
5358	area-signalr	Where does SignalR store UserId for each conenction?	Hi all,If SignalR supports functionality for sending message to specyfic user, it means that SignalR somewhere stores data about each ConnectionId + UserIdThank you in advance
3704	area-servers	Buffering needs to be configurable	I got this exception because my request was 300MB and I was running in an Azure Cloud Service. Azure Cloud services cannot write to temp storage they need to configure a disk space and write to a specific directory. It was very difficult to find that I had to set a environment variable (ASPNETCORE_TEMP) to configure this.  https://github.com/aspnet/HttpAbstractions/blob/07d115400e4f8c7a66ba239f230805f03a14ee3d/src/Microsoft.AspNetCore.Http/Internal/BufferingHelper.cs#L25-L26Expected: This should be a first class config and documented.```System.IO.IOException: There is not enough space on the disk.   at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)   at System.IO.FileStream.BeginWriteCore(Byte[] bytes, Int32 offset, Int32 numBytes, AsyncCallback userCallback, Object stateObject)   at System.IO.FileStream.FlushWrite(Boolean calledFromFinalizer)   at System.IO.FileStream.BeginWriteAsync(Byte[] array, Int32 offset, Int32 numBytes, AsyncCallback userCallback, Object stateObject)   at System.IO.FileStream.WriteAsync(Byte[] buffer, Int32 offset, Int32 count, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.FileBufferingReadStream.<ReadAsync>d__35.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.WebUtilities.StreamHelperExtensions.<DrainAsync>d__3.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Formatters.JsonInputFormatter.<ReadRequestBodyAsync>d__17.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder.<BindModelAsync>d__7.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder.<BindModelAsync>d__11.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__13.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeFilterPipelineAsync>d__18.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeAsync>d__16.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Builder.RouterMiddleware.<Invoke>d__4.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)```
4928	area-mvc	ValidationSummaryTagHelper for prefix only	#### Is this a Bug or Feature request?:Feature Request#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):1 - Sometimes you have two forms on the page, each one submitted to a different action. e.g. a LoginRegister page split into two with a form for Login and another form for Register.2 - Each action would be model-binded to a separate form model. e.g. LoginFormModel and RegisterFormModel3 - Each form would have a Validation Summary#### Description of the problem:1 - If the form being submitted is invalid, the Validation Summary of both forms would include the validation error messages.2 - There is no way of setting the Validation Summary to display messages for only the fields in its form or to display error messages only for model keys with a specific prefix (e.g. "Login" or "LoginFormInput" )#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:Microsoft.AspNetCore.App version is v2.1.1<!--                                    --- NOTE ---1.  Try enabling logging (in the most verbose level) and see if the details help you in fixing    the issue you are seeing. Share the logs too if it helps in diagnosing the issue faster.    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging2.  If you are seeing an exception, include the full exceptions details (message and stack trace).    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/error-handling3.  If you believe you have an issue that affects the security of the platform please do    not create an issue, instead email your issue to 'secure@microsoft.com'. Your report may    be eligible for our bug bounty. More info: https://technet.microsoft.com/en-us/mt764065.aspx-->
6027	area-identity	query graph api	HiI'm using the Microsoft.AspNetCore.Authentication.AzureAD.UI lib in order to authenticate users against my Azure AD. Now I need to restrict some actions to particular groups, but it's not always that the groups are being loaded in the jwt token. I was able to get the groups using REST and Graph API, but now I need to way to couple it to [Authorize (Roles = "admin")] for example. Is there any example about to achieve that without manually launch http requests to the graph api?
3854	area-servers	ANCM diagnostics strings review	We have a bunch of diagnostics error strings in ANCM. We need to do a spelling and grammar review for all these messages
5616	area-mvc	Markup blocks don't run tryApplySpecialProperty logic	In the Blazor.Browser.JS code, after it inserts a markup block, should run the same logic that it would if it had constructed the DOM attribute-by-attribute. But it doesn't, which means that things like:```<select value=@someValue>    <option value="a">Item 1</option>    <option value="b">Item 2</option></select>```... don't pre-populate the dropdown with the correct initial selection if (for example) `someValue` equals `"a"`.To fix this, we need to run a pass through the inserted subtree to apply the captured values.
5830	area-identity	Null SecurityStamp results in in always invalid token.	If a user has a SecurityStamp of null and SupportsUserSecurityStamp is true.  The token is created with "" as the stamp.     [L82](https://github.com/aspnet/Identity/blob/c7276ce2f76312ddd7fccad6e399da96b9f6fae1/src/Identity/DataProtectionTokenProvider.cs#L82)However when it is validated Its compared against null resulting in always false validation  [L135](https://github.com/aspnet/Identity/blob/c7276ce2f76312ddd7fccad6e399da96b9f6fae1/src/Identity/DataProtectionTokenProvider.cs#L135)**Sugestions**Either the create token should create a stamp for the user if SupportsUserSecurityStamp is true and the stamp is null.    Or the compare in the validation should check for null and set it to space if it is.**pull request**I have a fix for this that I can submit as soon as GitHub is stable.  (tomorrow)
5357	area-signalr	Implement support for IAsyncEnumerable on the Server	C# 8 is adding support for IAsyncEnumerable so we should support it natively for client->server and server->client streaming. Depends on https://github.com/dotnet/corefx/issues/32640.
4700	area-servers	Implement IThreadPoolWorkItem on IOQueue	We'll be able to cut the allocations on UnsafeQueueUserWorkItem calls on the IOQueue. Depends on https://github.com/dotnet/corefx/issues/32485 
4702	area-servers	Alow bin\Web.config to override Web.config	One major issue I continually have with ASP.NET is the inability to perform XDT transformations on my Web.config file when I debug.  I want to hit F5 and get an XDT transformation that inserts config values appropriate for my debugging setup.  It seems to me that a good way to do this would be for the web server to first search for bin\Web.config, which could be the output location for the base Web.config with XDT transformations applied (from a base `Web.Debug.config` file).  If it finds that file, it uses it, otherwise it falls back to the base Web.config.  Could this be implemented?  Then we could press F5, VS does the XDT transformation for our Web.Debug.config, writes it to the bin directory, and the web server uses that when we're debugging.
4703	area-servers	Wait for client FIN during server-initiated socket close	Sometimes clients in the LargeUpload tests observe empty responses (#3022). I believe this happens because Kestrel behaves badly when it initiates the FIN which happens for "Connection: close" or HTTP/1.0 requests. Kestrel should send a FIN, *wait for a client FIN with some timeout*, and then dispose the socket. Today, we skip the second step in both the Socket and libuv transport which could be the cause of clients not observing all the buffered response data.I've opened #3036 to test this theory. If the lLargeUpload tests stabilize after this change, that will serve as evidence we should change this behavior.
5829	area-identity	field ID type text	_From @terrainkognito2017 on Friday, 19 October 2018 13:26:35_Hello, dear titans develop such a beautiful project. Please explain why the data type of the Id field in the AspNetUsers table is text. Why not uuid? What you guided this decision?_Copied from original issue: aspnet/AspNetCore#3675_
5356	area-signalr	"Resolve" deadlock with `InvokeAsync` in `On` handler	There's a deadlock that can happen if you call `InvokeAsync` in the `On` handler. Because `On` handlers block the event loop while they run, and `InvokeAsync` doesn't release until the completion message arrives you can end up dead-locked. There are a few solutions and we should look at implementing one of them:* Throw if `InvokeAsync` is called directly within the context of `On` to alert users that they need to dispatch that call* Don't block the event loop on calling `On` handlers
5355	area-signalr	Add extra parameter in SignalR method without breaking changes	I want to pass additional parameter via Signalr without any breaking changes.SignalR hub web api side signalr nuget package being used is "Microsoft.AspNetCore.SignalR" Version="1.0.3".Client side nuget package being used is "Microsoft.AspNetCore.SignalR.Client" Version="1.0.3" />Initial code at signalr hub web api side is given below-    public async Task<bool> SendResponse(string uniqueId, string param1, string param2, string param3, string param4, string param5, string param6)    {    	await HubContext.Clients.Group(uniqueId).SendAsync("SendResponse", param1, param2, param3, param4, param5,param6);    	return true;    }Initial code at client side-    Connection.On<string, string, string, string, string, string>("SendResponse",    async (param1, param2, param3, param4, param5, param6) =>    {    	//code here.    });This client side code is shared with everyone via a nuget package and its on application owner when he want to update the nuget package.Till now everything is working fine a changed requirement (pass a new parameter with response) arise.To fulfill this requirement I have made below given code changes in signalr hub side-    public async Task<bool> SendResponse(string uniqueId, string param1, string param2, string param3, string param4, string param5, string param6, string param7)    {    	//send 6 parameters in old method so that client code can continue his work without updating client side code changes.    	await HubContext.Clients.Group(uniqueId).SendAsync("SendResponse", param1, param2, param3, param4, param5, param6);    	//Send 7 parameters in new method.    	await HubContext.Clients.Group(uniqueId).SendAsync("SendResponse2", param1, param2, param3, param4, param5, param6, param7);	    	return true;    }SignalR is hub web api service updated with these code changes and issue start arise after that.Client applications who has old SignalR client code start receiving errors-    Exception thrown: 'System.IO.InvalidDataException' in Microsoft.AspNetCore.SignalR.Protocols.Json.dll    Invocation provides 7 argument(s) but target expects 0.Changes at client side for SendResponse2 method-    Connection.On<string, string, string, string, string, string, string>("SendResponse2",        async (param1, param2, param3, param4, param5, param6, param7) =>        {        	//code here.        });Please let me know how can I fix this issue.The main important thing for me is that my end user should work fine if they have updated the client side code or not.
5098	area-mvc	Make RazorLanguageVersion.Experimental round-trippable	When serializing RazorLanguageVersion we serialize the `ToString()` output of it. However, when reading it back-in via deserialization that the `RazorLanguageVersion.Parse` doesn't understand the version (`1337.1337`).
4704	area-servers	Response Headers are blocked by flow control	They get written into the buffer, but they wait for the first data frame to flush. If the data frames are blocked due to the flow control window then the headers do not get sent until the next window update is received.
5828	area-identity	ConfigureApplicationCookie does not work with AddDefaultIdentity	Using ConfigureApplicationCookie to change the LoginPath only works with AddIdentity but not with AddDefaultIdentity, even after adding the configuration **after** AddDefaultIdentity as per #1414 .```            services.AddDefaultIdentity<IdentityUser>(); //Redirects to Account/Login            //services.AddIdentity<IdentityUser, IdentityRole>(); //Redirects to Account/LoginRegister            services.Configure<IdentityOptions>(options =>            {                // Password settings.                options.Password.RequireDigit = false;                options.Password.RequireLowercase = false;                                .....                // User settings.                options.User.AllowedUserNameCharacters =                "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789-._@+";                options.User.RequireUniqueEmail = false;            });            services.ConfigureApplicationCookie(options =>            {                options.LoginPath = $"/Identity/Account/LoginRegister";            });```
5615	area-mvc	Use Server-side Blazor, but be able to offload some work to the client, using Client-side Blazor too.	Is it a scenario that:1. is possible at the moment?1. you think has any merit?1. you have given any thought to or plan to implement?I'd like to build a Pokah site ("Pokah" is a Greek variation of Poker) using the Server-side flavor of Blazor. At some point, I'd like to give the users the ability to see an estimate of their chance to win the round (Monte Carlo algorithm), based on their cards and the community ones.Since this can be taxing for the server, I was thinking that if a user wants to know their odds to win, let their browser calculate that.I hope the scenario makes sense, I guess using Client-side Blazor+WebAPI is one way to go, but I really like to go the Server-side route.
3667	area-servers	ContentDispositionHeaderValue does not sanitize newlines	### Describe the bugOn some systems (not Windows, but Linux), filenames may contain newline characters. Thus, it should be theoretically valid to have a Content-disposition header filename contain such a newline character, or else at least clear them out when sanitizing.However, [ContentDispositionHeaderValue.Sanitize](https://github.com/aspnet/HttpAbstractions/blob/8e4f7365adf304e9704b1db43e3095a267583513/src/Microsoft.Net.Http.Headers/ContentDispositionHeaderValue.cs#L437) only replaces characters outside the ASCII range, not characters that are otherwise invalid in headers.### To ReproduceSteps to reproduce the behavior:1. Using this version of ASP.NET Core: tested on 2.0, though I expect 2.1 still exhibits the problem.2. Run this code '....'```public class MyController : Controller{  [HttpGet("/test")]  public IActionResult Test()  {    var content = Encoding.UTF8.GetBytes("Hello");    return File(content, "text/plain", "File\nName.txt");  }}```3. With these arguments '....'4. See errorThis eventually throws an exception, complaining that "\n" is not valid in HTTP headers.### Expected behaviorI expected the newline in the filename to either be correctly encoded so that it is preserved (and possibly let the browser deal with it in some system-specific way), or else be removed or substituted in the header.
5354	area-signalr	Handling Clients who become un-authorized whilst connected to a hub	Hi,I have a scenario (raised during a discussion at work about how we use SignalR) about how to manage Clients who are connected to a Hub (using WebSockets), with Cookie based Auth, who become un-authorized during the connection.**The critical scenario of interest is**:- We have User accounts where users can login to our website with a username/password and obtain cookies which are valid for a time period (using AspNetCore Identity).- A Client (C1) connects to an Authorized hub with valid cookies (obtained by logging in to the site).- Another malicious Client (C2) obtains their password, logs into their account, obtains valid cookies and then creates a connection with the hub with the same account).- Client C1, realises, changes their password, so existing cookies obtained with previous password are now invalid- Client C2 however remains connected, and even after the password reset event, continues to receive data they should no longer have access to.**Question**:Is there anything which can be done to kick off a specific connected client when an event occurs which causes their cookie becomes invalid during a connection?(Assuming that the we cannot trust the Client to honour any specific hand-rolled disconnect message or similar)(I have observed that putting the Authorise attribute at method-level causes Auth to be evaluate for all Client invocations of those methods, but I have not seen a way to re-auth any pushes from the server back to connected Clients).Apologies where I have not understood the docs correctly, I hope this is not a completely idiotic question!Many thanks in advance for your advice.Ps. Been using SignalR for a few months now, really excellent product, thanks for all here who work on it, made life a lot easier!
5444	area-mvc	Add template parameter for cookie consent UI to Web Application project template	The cookie consent UI in the web application template should be an option in the web application template. I'd make it off by default at the cmd line, and on by default in VS. The option should be visualized in VS with a checkbox. Disabling the option should remove:- `_CookieConsentPartial.cshtml`- The `app.UseCookiePolicy()` line in `Startup.cs` (and associated `using`)- The `services.Configure<CookiePolicyOptions>` call in `Startup.cs` (and associated `using`)- The `<partial name="_CookieConsentPartial" />` line in `_Layout.cshtml`@danroth27 
5614	area-mvc	Visual Studio - Remove compilation errors in .g.cs files 	When a component fails to compile, the error list shows the {componentname}.g.cs files, which are not clickable in VS. Is it possible to hide these files?
3656	area-infrastructure	Add "don't touch this" doc to all pubternal types in all packages	_From @Eilon on Wednesday, January 10, 2018 10:52:11 AM_We need to add docs to all our pubternal types (i.e. `public` types in a `.Internal` namespace) to indicate that they are not supported.I suggest writing a tool that uses Roslyn to insert a comment for all applicable types:```c#///   <summary>///       This API supports infrastructure and is not intended to be used directly///       from your code. This API may change or be removed in future releases.///   </summary>```This will also make it easier in the future to enable the "doc comments required" C# compiler error because we *would* have docs for all accessible types.For example, here's what EF Core does: https://github.com/aspnet/EntityFrameworkCore/blob/dev/src/EFCore/Internal/Graph.cs#L9-L24```c#///   <summary>///       This API supports the Entity Framework Core infrastructure and is not intended to be used///       directly from your code. This API may change or be removed in future releases.///   </summary>```- Ⓜ️🌊🔨_Copied from original issue: aspnet/Universe#767_
3654	area-infrastructure	Consider removing all Obsolete APIs when we start working on 3.0.0	_From @Eilon on Thursday, January 11, 2018 11:54:54 AM_In theory, when we start working on 3.0.0, we should delete all APIs that have been marked as `[Obsolete]`. There could be exceptions to that, but we should at least look._Copied from original issue: aspnet/Universe#776_
3651	area-infrastructure	Run Universe external dependency check on every PR in each repo	_From @Eilon on Friday, April 13, 2018 2:48:28 PM_This will find errors such as mismatched dependencies, including 3rd party packages.Can also automate checking if OSS approval is registered via some magical script that @anurse knows about._Copied from original issue: aspnet/Universe#1071_
3649	area-infrastructure	Remove un-needed instances of MicrosoftNETCoreApp21PackageVersion etc	_From @ryanbrandenburg on Monday, May 7, 2018 1:20:43 PM_When moving to netcoreapp2.2 we started out trying to remove any instances of `MicrosoftNETCoreApp21PackageVersion` and `MicrosoftNETCoreApp20PackageVersion` that weren't needed anymore, but doing the logic for that across 50 repos was bogging down the rest of the work, and they weren't hurting anything, so we stopped trying to enforce that.This item tracks the work of going back and removing that kind of unused thing, including `DotNetCoreRuntime` , `RuntimeFrameworkVersion` and more._Copied from original issue: aspnet/Universe#1153_
3647	area-infrastructure	Add tooling to validate the correctness of package versions in servicing updates	_From @natemcmaster on Thursday, July 12, 2018 9:38:05 PM_Follow-up to https://github.com/aspnet/Universe/pull/1257. In this PR, I manually did a lot of work to figure out what were the versions to use as the pinned baseline. We should add:* More tests to verify this work is correct* Add tests which will invalidate the build in future servicing updates when something is updated* Add tests to assert any changes to nuspec dependencies are expected_Copied from original issue: aspnet/Universe#1258_
3646	area-infrastructure	Implement stable 'channels' for the aspnet runtime and dotnet-install.ps1	_From @natemcmaster on Friday, July 27, 2018 8:57:55 AM_Now that 2.1 is RTM, we should implement channels to match the .NET Core runtime and SDK for dotnet-install.ps1/sh. For example, it's reasonable to expect this to work:```dotnet-install -Channel 2.1 -Architecture "x64" -Runtime aspnetcore -NoPath -Verbose```**Requirements**Create a blob here: dotnetcli.blob.core.windows.net/dotnet/aspnetcore/Runtime/2.1/latest.version. This should be a simple text file which contains full version information for the latest stable RTM version of the runtime. Example:```2cd777f06183bf5639578ff3a4162cd3f576e9892.1.2```This file should be updated for each servicing release of 2.1_Copied from original issue: aspnet/Universe#1283_
3645	area-infrastructure	Consider enabling strict roslyn setting	_From @pakrym on Sunday, July 29, 2018 7:59:29 PM_See: https://github.com/dotnet/corefx/pull/31457cc @natemcmaster @davidfowl @Eilon _Copied from original issue: aspnet/Universe#1285_
3644	area-infrastructure	Produce osx symbols for the shared runtime	_From @natemcmaster on Monday, August 20, 2018 10:48:52 AM_It looks like the build currently disables building symbols for osx-x64. There are osx symbols for Microsoft.NETCore.App. We should look into produce symbols for the aspnetcore shared runtime as well._Copied from original issue: aspnet/Universe#1330_
5942	area-hosting	Request.Host not set by Microsoft.AspNetCore.TestHost.WebSocketClient	I am using a `Microsoft.AspNetCore.TestHost.TestServer` to test my application.Whenever I use `TestServer.CreateClient()` then `HttpClient.PostAsync()`, I can see that my controller correctly has the `Request.Host` property matching `TestServer.BaseAddress`.However, when I use `TestServer.CreateWebSocketClient()` then `WebSocketClient.ConnectAsync()`, I find that the controller's `Request.Host` is always `null`. This is a problem for me as I try to generate a new url relative to the requested url in the controller using `new Uri(Request.GetEncodedUrl())`. The call to `Request.GetEncodedUrl()` returns a url with no host (e,g, "http:///path/here") and `new Uri()` throws a `UriFormatException` because there's no _hostname_.
5257	area-mvc	Recommendations for injecting appsettings.json configuration into Angular	Hi all, I'm looking for the best practice in sharing configuration with the Angular client app - for example database connection strings and auth keys. I've seen some blogs around using a Controller API and then fetching these from within the Angular app. I've also seen an article suggesting you can inject from the Home controller into the razor page, which then adds fields to the app-root tag, however in the latest template there is no home controller.In Angular you have the environment.ts files, would be interested to hear if there's some good practice around how to share/structure this configuration properly between server and clientThanks in advance
6013	area-middleware	Have url_rewrite middleware resolve server variables from IIS when running ANCM in-proc	
4214	area-mvc	Redesign LinkGenerationTemplate	
4705	area-servers	Remove test retries for flaky tests caused by https://github.com/dotnet/corefx/issues/30691 	We should revert https://github.com/aspnet/KestrelHttpServer/pull/3016 when the [corefx issue](https://github.com/dotnet/corefx/issues/30691) is resolved.
5097	area-mvc	using TModel = global::System.Object defined during design time results in weird editor completion	![image](https://user-images.githubusercontent.com/174281/47034461-461ef400-d12c-11e8-8682-a1935d12bfc2.png)In this case, the extension method is defined as `public static string Action(this IUrlHelper helper, string action, object values);` but the editor shows a `TModel` instance instead.I'm also able to write odd things `new TModel` which looks correct in the IDE, but doesn't compile at runtime.![image](https://user-images.githubusercontent.com/174281/47034629-c80f1d00-d12c-11e8-9414-5537fbe69472.png)
5613	area-mvc	SVG not rendering properly with Blazor	_Originally posted by @mdegroot71 in https://github.com/aspnet/Blazor/issue_comments#issuecomment-430270522_I am having the same issues.  I've taken all of the same CSS, Javascript and produced HTML from Blazor, popped it into a static HTML page and ran it.  The SVG scales as it should without any workarounds.  I'm using Chrome.  When I run it with Blazor, the SVG behaves in a weird way.  This isn't a CSS issue.  This is definitely a rendering issue b/c no matter how I inject the SVG, it still does not behave as if Blazor was not present.
4706	area-servers	Add support for PEM format SSL certificates	Presently, Kestrel configuration supports only the PKCS12 ( *.pfx ) format certificates. Whereas, PEM seems to be much more widely used format ( Public and Private keys are stored in two different files ) and most often one needs to convert the certificate format using OpenSSL before they can be used with Kestrel. Referring to : https://github.com/dotnet/corefx/issues/32367#issuecomment-423671246It looks like that the core already has api's to load public and private keys from two different files. Can we leverage them and add the support for the PEM certificate formats ?
5827	area-identity	Microsoft.AspNetCore.Identity.EntityFrameworkCore should not reference Microsoft.AspNetCore.Identity	![1](https://user-images.githubusercontent.com/775878/46988744-a7df5e00-d12c-11e8-9455-2dd6c629f0fb.png)![2](https://user-images.githubusercontent.com/775878/46988745-a9a92180-d12c-11e8-9a9a-6cafc20327c9.png)
4707	area-servers	BadHttpRequestException: Reading the request body timed out due to data arriving too slowly	We have an asp.net core 2.1 app running on .net 4.7 in azure web app service.Recently we started getting A LOT of the following error:> Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Reading the request body timed out due to data arriving too slowly. See MinRequestBodyDataRate.Our app is under pretty constant heavy load (from incoming webhooks mostly). During big spikes, we tend to see more of these.We used to run on asp.net core 2.0 / .net 4.6.1 for many months and we never saw that error before.It seems to have started happening following our recent upgrade to asp.net core 2.1 / .net 4.7.We'd like to get to the bottom of this issue, but we are not even sure where to start.Any thoughts?
3842	area-servers	Expose timing and connection information in in-proc	In Windows 19H1, the `HTTP_REQUEST_INFO` struct supports following new info types-- `HttpRequestInfoTypeRequestTiming`: Returns timestamps (KeQueryPerformanceCounter) for significant events in Request life time (e.g. connection start, SSL handshake timings, delivery timings etc.)- `HttpRequestInfoTypeTcpInfoV0`: Returns information about underlying TCP connection via `TCP_INFO_V0`.- `HttpRequestInfoTypeRequestSizing`: Returns information about different sizes from underlying components (e.g. HTTP header size, SSL handshake send/receive sizes etc.). In addition, it also returns more information about connection like if TCP fast open was used, TLS Session Resumption/False Start was used etc.We should expose this information via new features
5443	area-mvc	Updated react-scripts dependency for the React-CSharp template	@ryanbrandenburg, can you please validate the associated PR, per @SteveSandersonMS's comments before merging it in. This issue is actually for tracking that work.https://github.com/aspnet/Templating/pull/756
5353	area-signalr	Consider introducing a single "hub pipeline" abstraction for cross-cutting concerns	We had https://github.com/aspnet/SignalR/issues/871 and https://github.com/aspnet/SignalR/issues/924 tracking some of this, and resolved those by adding HubDispatcher as a user-overridable abstraction. However, there's still value in the simple abstraction Hub Pipeline modules provided in ASP.NET SignalR. We should consider bringing that abstraction back.
5352	area-signalr	Self host and error handling	I'm integrating a SignalR server inside a WPF application.My problem is that whenever an error occurs on a hub I can't handle it in a global way.See this line:https://github.com/aspnet/SignalR/blob/defbadb26b4224d5025549992fc5ae4e95e0d288/src/Microsoft.AspNetCore.SignalR.Core/HubConnectionHandler.cs#L113As you can see it's handled internally so I can't handle it myself.
5442	area-mvc	Test for console errors/warnings in templates	Multiple times now we've missed Errors and warnings that show up in the console of our templates in different circumstances. If we were to add the capacity to confirm no warnings or errors were logged to our functional tests it would likely catch a lot of future mistakes.
5351	area-signalr	Non-serialized hub invocations	I have tried to circumvent the missing stream invocations in the Java client by introducing for each streaming method on my Hub a sibling method that would `await` and return the next value that a ChannelReader would provide. The client would then have to immediately invoke the same method again after receiving a value to simulate continuous values. In my C# design validation client, I try to invoke two methods, run `Task.WhenAny` and then re-issue the finished invocation.However, the invocation serialization from 1957655653608fa17803308c98153586f6623597 means that any additional incoming message on the connection will only be dispatched when a running (async-blocking) invocation has finished. This includes any second invocation, a new streaming invocation and (which is where it's likely getting interesting) any form of graceful connection abort from the client. As far as I could see in the code for the latter case, all forms of `Abort` (which would trigger the cancellation token) originate from outside the dispatch loop, so only actually reading from the input pipe can close a connection which is blocked by the running invocation.So: Personally, I'd love to see lifting the restriction around non-streaming invocations...
3624	area-installers	 No SDKs were found after installing dotnet-hosting-2.1.5-win.exe	To address your issues more quickly, please open the issue in the most appropriate repository.If you're not sure exactly where to log the bug, please log the issue here and we will redirect it.ASP.NET Core: - General issues: https://github.com/aspnet/Home (this repo) - MVC and Razor Pages: https://github.com/aspnet/Mvc - SignalR: https://github.com/aspnet/SignalR - Kestrel HTTP Server: https://github.com/aspnet/KestrelHttpServer - Docker: https://github.com/aspnet/aspnet-docker - Documentation: https://github.com/aspnet/Docs - Microsoft.NET.Sdk.Web: https://github.com/aspnet/websdk - See a full list here: https://github.com/aspnet   - Note: Some repos do not have active issue trackers, so if you see such a warning, please log the issue hereASP.NET 4.x: - ASP.NET MVC/Web API (not Core): https://github.com/aspnet/AspNetWebStack - Katana: https://github.com/aspnet/AspNetKatanaEntity Framework: - Entity Framework Core: https://github.com/aspnet/EntityFrameworkCore - Entity Framework 6: https://github.com/aspnet/EntityFramework6Other common projects: - .NET Core CLI and SDK: https://github.com/dotnet/core - .NET Core runtime: https://github.com/dotnet/coreclr - .NET Core libraries: https://github.com/dotnet/corefx - NuGet: https://github.com/NuGet/home - Visual Studio: https://developercommunity.visualstudio.com - Visual Studio Code: https://github.com/microsoft/vscode - Omnisharp (C# support for VS Code): https://github.com/omnisharp/omnisharp-vscodeIf you believe you have an issue that affects the security of the platform please do NOT create an issue and instead email your issue details to secure@microsoft.com. Your report may be eligible for our [bug bounty](https://technet.microsoft.com/en-us/mt764065.aspx).---Tips for opening great bugs:1. Try enabling logging (in the most verbose level) and see if the details help you in fixing the issue you are seeing. Share the logs too if it helps in diagnosing the issue faster. More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging2. If you are seeing an exception, include the full exceptions details (message and stack trace). More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/error-handling3. Please try to include as much information as possible:   1. Description of the problem:   2. Steps to reproduce (preferrably a link to a GitHub repo with a repro project)   3. The version of `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`   4. The output of `dotnet --info`
5941	area-hosting	Setup unhandled exception handlers in hosting that log errors	Handle `TaskScheduler.UnobservedTaskException` and `AppDomain.CurrentDomain.UnhandledException` and log errors to the logger. Today application code needs to manually hook and add these. These are well know system events that our host should just route to the logger.
5256	area-mvc	Utilising Node Clustering to scale Server Side Rendering	We're running this package under heavy load in production and Node's Server Side Rendering cannot keep up to the number of requests coming in. We're experiencing "request pile-up" as React's RenderToString function blocks Node's event loop from handling more requests. Our server's response times are terrible when SSR is enabled.I found an article from AirBnB describing the exact same problem (and their solution):https://medium.com/airbnb-engineering/operationalizing-node-js-for-server-side-rendering-c5ba718acfc9I'm wonder if this package has some configuration (that I may have missed) to enable [Node Clustering](https://nodejs.org/api/cluster.html) and/or some type of load balancing
5612	area-mvc	Allow JSInvokable identifiers with the same value	[See this proposed solution](https://github.com/mrpmorris/JSInterop)[Pull request](https://github.com/dotnet/jsinterop/pull/6)When JavsScript is instructed to call back C# it should not throw an exception about duplicate identifiers when invoking an instance.```public class One{  [JSInvokable]  public void DoSomething() {}}public class Two{  [JSInvokable]  public void DoSomething() {}}```In JavaScript the following code will throw an exception because there is more than one JSInvoke with the identifier "DoSomething"```window.someLibrary = {  callBackDoSomething: function(callback) {    callback.invokeMethodAsync("DoSomething");  }}```This makes sense when invoking static methods on a static class, but when invoking on a DotNetObjectRef it makes sense to check for duplicate identifiers only on the class of the instance being passed.This will save from having to write `[JSInvokable("MyCompany.MyLibrary.One.DoSomething")]` and `[JSInvokable("MyCompany.MyLibrary.Two.DoSomething")]` to ensure unique callback identifiers across multiple libraries when calling methods on instances (the above string format would still be recommented for static methods though).In essence, the JSInvokableAttribute applied to a static method should be a globally unique identifier for the method, and on an instance method it should be treated as an alias for the method.I'd be happy to rewrite the relevant code and submit a pull request if you are in agreement? The implementation I have in mind would also address https://github.com/aspnet/Blazor/issues/1557.
5611	area-mvc	Cannot call back C# generics from JS	[See this proposed solution](https://github.com/mrpmorris/JSInterop)[Pull request](https://github.com/dotnet/jsinterop/pull/6)When trying to call back a DotNetObjectRef that is a reference to an instance of a generic class it is not possible to execute a method that has a parameter of the generic type. It results in the following exception`System.InvalidCastException: Invalid cast from 'System.String' to ''.`[Example project here](https://drive.google.com/open?id=1ifsIpdIDHQ9NOkiCSMqunfqpKf0fd7_d)To see the problem the following instructions will show how to call back a class with a pre-defined type of string, and a second that uses a generic type. The hard-coded string type works, but the generic type does not work even though it too is set to a string.In index.html```	<script>		window.stringPromise = {			execute: function (callback, name) {				console.log("JS: stringPromise.execute(" + name + ")");				callback.invokeMethodAsync("StringSuccess", "Callback value " + name);			}		};		window.genericPromise = {			execute: function (callback, name) {				console.log("JS: genericPromise.execute(" + name + ")");				callback.invokeMethodAsync("GenericSuccess", "Callback value " + name);			}		};	</script>```In C#```using System;using System.Collections.Generic;using System.Threading.Tasks;using Microsoft.JSInterop;namespace CannotCallbackGeneric.Promises{	public class GenericPromise<T>	{		private readonly TaskCompletionSource<T> TaskCompletionSource;		private GenericPromise(TaskCompletionSource<T> taskCompletionSource)		{			TaskCompletionSource = taskCompletionSource;		}		public static async Task<T> Execute(string identifier, params object[] args)		{			var taskCompletionSource = new TaskCompletionSource<T>();			var promise = new GenericPromise<T>(taskCompletionSource);			var argsToPass = new List<object>(args ?? Array.Empty<object>());			using (var promiseRef = new DotNetObjectRef(promise))			{				argsToPass.Insert(0, promiseRef);				args = argsToPass.ToArray();				await JSRuntime.Current.InvokeAsync<object>(identifier, args);				return await taskCompletionSource.Task;			}		}		[JSInvokable("GenericSuccess")]		public void Success(T result)		{			Console.WriteLine("C# success");			TaskCompletionSource.SetResult(result);		}	}	public class StringPromise	{		private readonly TaskCompletionSource<string> TaskCompletionSource;		private StringPromise(TaskCompletionSource<string> taskCompletionSource)		{			TaskCompletionSource = taskCompletionSource;		}		public static async Task<string> Execute(string identifier, params object[] args)		{			var taskCompletionSource = new TaskCompletionSource<string>();			var promise = new StringPromise(taskCompletionSource);			var argsToPass = new List<object>(args ?? Array.Empty<object>());			using (var promiseRef = new DotNetObjectRef(promise))			{				argsToPass.Insert(0, promiseRef);				args = argsToPass.ToArray();				await JSRuntime.Current.InvokeAsync<object>(identifier, args);				return await taskCompletionSource.Task;			}		}		[JSInvokable("StringSuccess")]		public void Success(string result)		{			Console.WriteLine("C# success");			TaskCompletionSource.SetResult(result);		}	}}```In Index.cshtml```@functions {	protected override async Task OnInitAsync()	{		string returnValue = await Promises.StringPromise.Execute("stringPromise.execute", "Hello");		Console.WriteLine("C# " + returnValue);		returnValue = await Promises.GenericPromise<string>.Execute("genericPromise.execute", "Hello");		Console.WriteLine("C# " + returnValue);	}}```
3839	area-servers	Add support for framework dependent exe dotnet location discovery	Reaction to https://github.com/dotnet/core-setup/issues/4330cc @shirhatti 
3840	area-servers	Add support for logging fatal errors reported by the host	Reaction to https://github.com/dotnet/core-setup/issues/4455cc @shirhatti 
4708	area-servers	Don't log ConnectionAbortedExceptions in HttpProtocol/Http2Connection as warning	ConnectionAbortedExceptions are already logged by the transport. If these are logged at all by the input processing loop, these shouldn't be logged as warning. Examples:```[0.002s] [TestLifetime] [Information] Starting test ResponseBodyWriteAsyncCanBeCancelled at 2018-10-12T17:51:42[0.009s] [Microsoft.AspNetCore.Hosting.Internal.WebHost] [Debug] Hosting starting[0.009s] [Microsoft.AspNetCore.Hosting.Internal.WebHost] [Debug] Hosting started[0.009s] [Microsoft.AspNetCore.Hosting.Internal.WebHost] [Debug] Loaded hosting startup assembly testhost[0.010s] [Microsoft.AspNetCore.Server.Kestrel] [Debug] Connection id "0HLHGDDCK10TF" started.[0.011s] [Microsoft.AspNetCore.Hosting.Internal.WebHost] [Information] Request starting HTTP/1.1 GET http:///  [0.025s] [Microsoft.AspNetCore.Server.Kestrel] [Debug] Connection id "0HLHGDDCK10TF" closing because: "The connection or stream was aborted because a write operation was aborted with a CancellationToken."[0.025s] [Microsoft.AspNetCore.Server.Kestrel] [Debug] Connection id "0HLHGDDCK10TF" disconnecting.[0.026s] [Microsoft.AspNetCore.Server.Kestrel] [Debug] Connection id "0HLHGDDCK10TF" completed keep alive response.[0.026s] [Microsoft.AspNetCore.Hosting.Internal.WebHost] [Information] Request finished in 14.8892ms 200 [0.028s] [Microsoft.AspNetCore.Hosting.Internal.WebHost] [Debug] Hosting shutdown[0.046s] [Microsoft.AspNetCore.Server.Kestrel] [Warning] Connection processing ended abnormally.Microsoft.AspNetCore.Connections.ConnectionAbortedException: The connection or stream was aborted because a write operation was aborted with a CancellationToken. ---> System.OperationCanceledException: The operation was canceled.   at System.Threading.CancellationToken.ThrowOperationCanceledException()   at System.IO.Pipelines.Pipe.GetFlushResult(FlushResult& result)   at System.IO.Pipelines.Pipe.GetFlushAsyncResult()   at System.IO.Pipelines.Pipe.DefaultPipeWriter.GetResult(Int16 token)   at System.Threading.Tasks.ValueTask`1.ValueTaskSourceAsTask.<>c.<.cctor>b__4_0(Object state)--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Infrastructure.TimingPipeFlusher.TimeFlushAsync(MinDataRate minRate, Int64 count, IHttpOutputAborter outputAborter, CancellationToken cancellationToken) in G:\dev\aspnet\KestrelHttpServer\src\Kestrel.Core\Internal\Infrastructure\TimingPipeFlusher.cs:line 82   --- End of inner exception stack trace ---   at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1Connection.BeginRead(ValueTask`1& awaitable) in G:\dev\aspnet\KestrelHttpServer\src\Kestrel.Core\Internal\Http\Http1Connection.cs:line 454   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application) in G:\dev\aspnet\KestrelHttpServer\src\Kestrel.Core\Internal\Http\HttpProtocol.cs:line 523   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequestsAsync[TContext](IHttpApplication`1 application) in G:\dev\aspnet\KestrelHttpServer\src\Kestrel.Core\Internal\Http\HttpProtocol.cs:line 472[0.048s] [Microsoft.AspNetCore.Server.Kestrel] [Debug] Connection id "0HLHGDDCK10TF" stopped.[0.055s] [TestLifetime] [Information] Finished test ResponseBodyWriteAsyncCanBeCancelled in 0.0533177s``````[0.002s] [TestLifetime] [Information] Starting test HEADERS_ReceivedWithoutAllCONTINUATIONs_WithinRequestHeadersTimeout_AbortsConnection at 2018-10-12T17:51:34[0.039s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" sending SETTINGS frame for stream ID 0 with length 18 and flags NONE[0.040s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" sending WINDOW_UPDATE frame for stream ID 0 with length 4 and flags 0x0[0.062s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" received SETTINGS frame for stream ID 0 with length 0 and flags NONE[0.062s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" sending SETTINGS frame for stream ID 0 with length 0 and flags ACK[0.067s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" received HEADERS frame for stream ID 1 with length 318 and flags NONE[0.071s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" received CONTINUATION frame for stream ID 1 with length 0 and flags NONE[0.079s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" received CONTINUATION frame for stream ID 1 with length 0 and flags NONE[0.081s] [Microsoft.AspNetCore.Server.Kestrel] [Information] Connection id "null" bad request data: "Reading the request headers timed out."Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Reading the request headers timed out.[0.083s] [Microsoft.AspNetCore.Server.Kestrel] [Verbose] Connection id "null" sending GOAWAY frame for stream ID 0 with length 8 and flags 0x0[0.083s] [Microsoft.AspNetCore.Server.Kestrel] [Debug] Connection id "null" is closed. The last processed stream ID was 1.[0.090s] [Microsoft.AspNetCore.Server.Kestrel] [Warning] Connection processing ended abnormally.Microsoft.AspNetCore.Connections.ConnectionAbortedException: Reading the request headers timed out.   at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()   at System.IO.Pipelines.PipeCompletion.IsCompletedOrThrow()   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)   at System.IO.Pipelines.Pipe.GetReadAsyncResult()   at System.IO.Pipelines.Pipe.DefaultPipeReader.GetResult(Int16 token)   at System.Threading.Tasks.ValueTask`1.get_Result()   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http2.Http2Connection.ProcessRequestsAsync[TContext](IHttpApplication`1 application) in G:\dev\aspnet\KestrelHttpServer\src\Kestrel.Core\Internal\Http2\Http2Connection.cs:line 209[0.093s] [TestLifetime] [Information] Finished test HEADERS_ReceivedWithoutAllCONTINUATIONs_WithinRequestHeadersTimeout_AbortsConnection in 0.0912812s```
5610	area-mvc	[Server-side] BindMethods.cs does not parse a number when using 'input type="number"'	Error occurs when using **Blazor Server Side**.If i use `type="number"` parameter I cannot use `double / float / decimal` in `bind`.**TestPage.cshtml**```@page "/testpage"@functions {    protected double sum { get; set; }}<input type="number" bind="@sum" />```When I enter `4.1` or` 4,1` into input, I get an error message.```Uncaught (in promise) Error: System.FormatException: Input string was not in a correct format.   at Microsoft.JSInterop.DotNetDispatcher.InvokeSynchronously(String assemblyName, String methodIdentifier, Object targetInstance, String argsJson)   at Microsoft.JSInterop.DotNetDispatcher.BeginInvoke(String callId, String assemblyName, String methodIdentifier, Int64 dotNetObjectId, String argsJson)   at Microsoft.JSInterop.DotNetDispatcher.InvokeSynchronously(String assemblyName, String methodIdentifier, Object targetInstance, String argsJson)   at Microsoft.JSInterop.DotNetDispatcher.BeginInvoke(String callId, String assemblyName, String methodIdentifier, Int64 dotNetObjectId, String argsJson)    at endInvokeDotNetFromJS (http://localhost:57231/_framework/blazor.server.js:23:48593)    at http://localhost:57231/_framework/blazor.server.js:23:48162    at new Promise (<anonymous>)    at e.beginInvokeJSFromDotNet (http://localhost:57231/_framework/blazor.server.js:23:48131)    at http://localhost:57231/_framework/blazor.server.js:16:11652    at Array.forEach (<anonymous>)    at e.invokeClientMethod (http://localhost:57231/_framework/blazor.server.js:16:11623)    at e.processIncomingData (http://localhost:57231/_framework/blazor.server.js:16:10229)    at e.connection.onreceive (http://localhost:57231/_framework/blazor.server.js:16:7298)    at WebSocket.i.onmessage (http://localhost:57231/_framework/blazor.server.js:16:20346)endInvokeDotNetFromJS @ blazor.server.js:23(anonymous) @ blazor.server.js:23beginInvokeJSFromDotNet @ blazor.server.js:23(anonymous) @ blazor.server.js:16e.invokeClientMethod @ blazor.server.js:16e.processIncomingData @ blazor.server.js:16connection.onreceive @ blazor.server.js:16i.onmessage @ blazor.server.js:16```**After this method, data is sent to the socket.**https://github.com/aspnet/Blazor/blob/master/src/Microsoft.AspNetCore.Blazor.Browser.JS/src/Rendering/EventDelegator.ts#L83```eventArgs = EventForDotNet {type: "change", data: {type: "change", value: "4.1"}}value: "4.1" <= The value is always with a dot.```**These data without preliminary processing get here.**https://github.com/aspnet/Blazor/blob/master/src/Microsoft.AspNetCore.Blazor/Components/BindMethods.cs#L117```cspublic static Action<UIEventArgs> SetValueHandler(Action<double> setter, double existingValue){   return _ =>      {         var val = (string)((UIChangeEventArgs)_).Value;  // res: 4.1  <= The value is always with a dot.         var sum = double.Parse(val);                     // System.FormatException         setter(sum);                                     // Not called      };}```
5609	area-mvc	Failed in resolving dependencies After adding msgpack-cli	msgpack-cli currently support mono build. https://github.com/msgpack/msgpack-cliBut I got errors MSB3037 while making build.![image](https://user-images.githubusercontent.com/40863525/46847071-b23be800-ce0c-11e8-88cf-b6eeda031b49.png)
5608	area-mvc	Cannot resolve @typeparam	I have Blazor 0.6.0 installed, using the VS template.  .NET Core SDK 2.1.402.  I see this, both with ReSharper enabled and disabled.  The app appears to still compile and run correctly, so perhaps this is an issue with Visual Studio?  I have VS 2017 15.8.6.![image](https://user-images.githubusercontent.com/14915247/46832614-1fe40780-cd6c-11e8-9cc5-c7ee4a70d848.png)
5607	area-mvc	Suggestion: Adding Directive	I'd love to see the ability of supporting also directives, same principle as Angular.<input MyDirective />Thanks!
5255	area-mvc	React + ASPNET Core + Prerendering: An attempt was made to access a socket in a way forbidden by its access permissions	(Also posted on [Stack Overflow](https://stackoverflow.com/questions/52745622/react-aspnet-core-prerendering-an-attempt-was-made-to-access-a-socket-in-a)) I have a .NET Core + React app using aspnet-prerendering. I created the app using [dotnet new reactredux](https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/react?view=aspnetcore-2.1&tabs=visual-studio). I published this to Azure, and routed to that app using AWS CloudFront. The app has worked in all environments (locally, CI, prestaging...) but when I deployed it to production, it worked for a few days and then I started getting a lot of `An attempt was made to access a socket in a way forbidden by its access permissions` errors. This is happening when a POST is made to `127.0.0.1:<randomPort>`. I do not make this POST in my code, and I've been told it has to do with how react is prerendered. These errors usually only start about 1-2 days after deploying. So when I first deploy, everything looks good, but then when the errors start, they continue until I re-deploy or restart the app in Azure. ----------Things I've tried:* Restarting the app fixes the problem for a little while.* I have heard that this is caused by react hot reloading, so I made sure to add an appsetting in Azure: `ASPNETCORE_ENVIRONMENT=Production`. This did not solve the problem.* I tried commenting out the hot reloading portion of Startup.cs entirely to check this hypothesis…but the errors still started again 2 days after deploying that code.----------A sample list of the ports that fail vs. succeed (seemingly random...?):    success	count_	data    FALSE	3493	http://127.0.0.1:53571    FALSE	1353	http://127.0.0.1:49988    FALSE	535	    http://127.0.0.1:55453    FALSE	484	    http://127.0.0.1:53144    FALSE	13	    http://127.0.0.1:52428    FALSE	7	    http://127.0.0.1:49583    TRUE	11247	http://127.0.0.1:56790    TRUE	10960	http://127.0.0.1:55806    TRUE	10920	http://127.0.0.1:55227    TRUE	9300	http://127.0.0.1:55453    TRUE	8472	http://127.0.0.1:51734    TRUE	5602	http://127.0.0.1:53571    TRUE	5429	http://127.0.0.1:56860----------*Code snippets:*Startup:    public void ConfigureServices(IServiceCollection services)        {    services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);            // In production, the React files will be served from this directory            services.AddSpaStaticFiles(configuration =>            {                configuration.RootPath = "ClientApp/build";            });            …        }    public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();                app.UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions                {                    HotModuleReplacement = true,                    ReactHotModuleReplacement = true,                    // This configuration suppresses the warnings that the server code doesn't match the client code, which happens on reload.                    HotModuleReplacementClientOptions = new Dictionary<string, string>()                    {                        { "warn", "false" }                    }                });            }            else            {            app.UseExceptionHandler("/Error");            app.UseHsts();            }            //app.UseHttpsRedirection();            app.UseStaticFiles();            …        }Index.cshtml    @using Microsoft.Extensions.Configuration    @inject Microsoft.AspNetCore.Hosting.IHostingEnvironment hostingEnv    @inject IConfiguration Configuration    <script>        window.data = @Html.Raw(Json.Serialize(@Model));    </script>    <div id="col-app"         asp-prerender-module="./wwwroot/cost-of-living-calculator/dist/main-server"         asp-prerender-webpack-config="webpack.config.server.js"         asp-prerender-data="@Model">Loading...</div>    @if (hostingEnv.EnvironmentName == "Production")    {        <script src="/cost-of-living-calculator/dist/main.min.js" asp-append-version="true"></script>    }    else    {        <script src="/cost-of-living-calculator/dist/main.js" asp-append-version="true"></script>    }Package.json    ...    "aspnet-prerendering": "3.0.1",    "aspnet-webpack": "3.0.0",    "aspnet-webpack-react": "3.0.0",    ...*NOTE: I have a boot-server and a boot-client, as well as a server webpack config and a client webpack config. This is due to differing needs for server/client compilation.*Boot-server.js    import React from 'react';    import { createServerRenderer } from 'aspnet-prerendering';    import { renderToString } from 'react-dom/server';    import App from './App';    export default createServerRenderer(      params =>        new Promise((resolve, reject) => {          const data = params.data;          const result = renderToString(React.createElement(App, data));          resolve({ html: result });        })    );Boot-client.js     import React from 'react';    import ReactDOM from 'react-dom';    import App from './App';    const element = document.getElementById('col-app');    ReactDOM.render(<App {...window.data} />, element);    // This is required to trigger the hot reloading functionality    if (module.hot) {      module.hot.accept('./App', () => {        const NewApp = require('./App').default;        ReactDOM.render(<NewApp {...window.data} />, element);      });    }Webpack.config.js    var path = require('path');    var webpack = require('webpack');     const UglifyJsPlugin = require("uglifyjs-webpack-plugin");    const MiniCssExtractPlugin = require("mini-css-extract-plugin");    const OptimizeCSSAssetsPlugin = require("optimize-css-assets-webpack-plugin");    const isDevelopment = process.env.ASPNETCORE_ENVIRONMENT === 'Development';    module.exports = () => {      return {        devtool: 'inline-source-map',        entry: {        'main': ['babel-polyfill', './ClientApp/boot-client.js', './ClientApp/index.scss'],    },    optimization: {      minimizer: [        new UglifyJsPlugin({          cache: true,          parallel: true,          sourceMap: true // set to true if you want JS source maps        }),        new OptimizeCSSAssetsPlugin({})      ]    },    output: {      path: path.join(__dirname, './wwwroot/cost-of-living-calculator/dist'),      publicPath: '/cost-of-living-calculator/dist/',      filename: isDevelopment ? "[name].js" : "[name].min.js"    },    plugins: [      new MiniCssExtractPlugin({        // Options similar to the same options in webpackOptions.output        // both options are optional        filename: "[name].css",        chunkFilename: "[id].css"      })    ],    module: {      rules: [        {          // JavaScript files, which will be transpiled          // based on .babelrc          test: /\.(js|jsx)$/,          exclude: [/node_modules/],          loader: ['babel-loader', 'source-map-loader']        },        {          test: /\.s?css$/,          use: isDevelopment ? [            'style-loader',            'css-loader',            'sass-loader',          ] : [            MiniCssExtractPlugin.loader,            'css-loader',            'sass-loader'          ]        }      ]    },    mode: isDevelopment ? 'development' : 'production'      }    };Webpack.config.server.js    var path = require('path');    const isDevelopment = process.env.ASPNETCORE_ENVIRONMENT === 'Development';    module.exports = () => {      return {        devtool: 'inline-source-map',        entry: {          'main-server': ['babel-polyfill', './ClientApp/boot-server.js']        },        output: {          path: path.join(__dirname, './wwwroot/cost-of-living-calculator/dist'),          publicPath: '/cost-of-living-calculator/dist/',          filename: "[name].js",          // commonjs is required for server-side compilation          libraryTarget: 'commonjs'        },        module: {          rules: [            {              test: /\.js$/,              exclude: [/node_modules/],              loader: ['babel-loader', 'source-map-loader']            }          ]        },        target: 'node',        mode: isDevelopment ? 'development' : 'production'      }    };My question is - Why is this happening? How do I prevent it?
3614	area-middleware	text/javascript is the "correct" Static Files MIME Type	I noticed this change when I got a warning while trying out [Sonar](https://github.com/sonarwhal/sonar/issues/568). Apparently the standards bodies have changed their minds:- https://github.com/whatwg/html/pull/3096- https://github.com/bmeck/I-D/issues/2This is a breaking change. I raised PR https://github.com/aspnet/StaticFiles/pull/220 but it was closed without a reason given for why.
3611	area-platform	Move all MSBuild logic from Microsoft.AspNetCore.App (the package) into an MSBuild SDK	### ProblemFollow-up to https://github.com/aspnet/AspNetCore/issues/3608. In 2.1 and 2.2, there are some MSBuild targets and tooling bundled in the NuGet packages pulled in by Microsoft.AspNetCore.App. As a part of making Microsoft.AspNetCore.App a shared framework in 2.1, we failed to realize that this would impact MSBuild targets and related tooling. The design of shared frameworks calls for the package version of Microsoft.AspNetCore.App to be pinned and not to update in packages. This makes it difficult to service the MSBuild targets and tooling without also impacting compilation references and runtime versions.In 3.0, this will impacts the following* Microsoft.AspNetCore.App* Microsoft.AspNetCore.Razor.Design* Microsoft.AspNetCore.Mvc.Razor.Extensions* Microsoft.Extensions.Configuration.UserSecrets* Microsoft.Extensions.FileProviders.Embedded### Proposed solutionAll packages that are part of Microsoft.AspNetCore.App should move MSBuild targets and tasks out of the package and into an MSBuild SDK.* Targets and tools for Razor compilation move into Microsoft.NET.Sdk.Razor.* Targets for Microsoft.AspNetCore.App move into Microsoft.NET.Sdk (the `<FrameworkReference>` feature)* Targets and tasks for Microsoft.Extensions.FileProviders.Embedded move into either:	* An in-box SDK like Microsoft.NET.Sdk	* A separate package named something like Microsoft.Extensions.FileProviders.Embedded.Sdk which provides build-time only assets* Targets for Microsoft.Extensions.Configuration.UserSecrets move into Microsoft.NET.Sdk
3610	area-platform	Produce reference assemblies for Microsoft.AspNetCore.App	In order to satisfy the requirements of making Microsoft.AspNetCore.App a ref-only package (https://github.com/aspnet/AspNetCore/issues/3608), we need to change our build system to produce reference assemblies for API in Microsoft.AspNetCore.App.### Requirements* Reference assemblies do not contain implementation. * API breaking changes to any assembly in Microsoft.AspNetCore.App are not allowed after 3.0.0* Reference assemblies must not change assembly version in patch updates. They remain constant at "Version=3.0.0.0" for the lifetime of netcoreapp3.0.* Assembly version bumps when the TFM changes. So when/if netcoreapp3.1 comes along, assemblies change to "Version=3.1.0.0"* Implementation binaries must satisfy the API surface of the reference assembly* When Microsoft.Extensions.* APIs are used in projects targeting .NET Framework, automatic binding redirect generation must continue to work correctly### Proposed solution1. Generate source for ref assembliesWe use build tools from https://github.com/dotnet/arcade to generate reference assemblies from implementation projects. This generated source lives in the repo next to the implementation. Most assemblies in the shared framework will have a folder layout like this:```.../Microsoft.AspNetCore.Mvc/	ref/		Microsoft.AspNetCore.Mvc.csproj		Microsoft.AspNetCore.Mvc.cs       (generated by tools, should not be hand edited)	src/		Microsoft.AspNetCore.Mvc.csproj		**/*.cs       (code for the implementation of Microsoft.AspNetCore.Mvc.dll)	test/ (optional - unit tests)		Microsoft.AspNetCore.Mvc.Tests.csproj		**/*.cs       (test code)```2. Implement tests to ensure implementation matches the ref APIWire up the build to use tools from https://github.com/dotnet/arcade which assert that the implementation binaries are binary compatible with their reference assemblies. This is essential to making sure patches don't break API.## Open questions* How to structure NuGet packages and set assembly versions without introducing downgrade errors or producing incorrect binding redirects?
4927	area-mvc	Improve filenames and class names in code generation	#### Is this a Bug or Feature request?Bug that's part of #7947#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):1. Create new console project2. Add reference to manually-built NSwag.MSBuild.CodeGeneration package (relying on the Microsoft.Extensions.ApiDescription.Design package)3. Add `<ServiceUriReference Include="https://docs.oracle.com/en/cloud/paas/content-cloud/rest-api-documents/swagger.json" ... />` to the .csproj file4. `dotnet build`##### ExpectedSuccessful build##### ActualLots of compilation errors in the generated Docs.oracle.com_en_cloud_paas_content-cloud_rest-api-documents_swaggerClient.cs file#### Description of the problemDefault filenames and class names may contain invalid characters. In this case, the chosen class name contains both dashes and periods (Docs.oracle.com_en_cloud_paas_content-cloud_rest-api-documents_swaggerClient).It's also possible for the package to generate invalid filenames from a URI containing, say, angle brackets or double-quotes.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the [features/client.code.generation](https://github.com/aspnet/Mvc/tree/feature/client.code.generation) branch. That work is intended for the 2.2 Preview 3 milestone.
5350	area-signalr	Improve error messaging for 404s	Usually a 404 occurs because sticky sessions are not enabled. We should provide a better error message here.
5826	area-identity	Show errors in the log from VerifyUserTokenAsync	I am getting a nice warning in my logs when the code is invalid  from [L1712](https://github.com/aspnet/Identity/blob/c7276ce2f76312ddd7fccad6e399da96b9f6fae1/src/Core/UserManager.cs#L1712)>warn: Microsoft.AspNetCore.Identity.UserManager[9]>     VerifyUserTokenAsync() failed with purpose: ResetPassword for user 21248592.However it does not tell me what the error is in the error message is.   I have had to add this in my own code.>dbug:IdentityServer.Controllers.Account.AccountController[2150]>     User invite failed for [User: 21248592] [error: Invalid token.]Which basically means i have two log entries for the same issue.  It would be nice to get a list of the errors from the result into the warning message.Can i suggest something like this?  I would be happy to submit a pull request if you like```if (!result)            {               var errors = string.Join(", ", result.Errors.Select(a => a.Description));                Logger.LogWarning(9, "VerifyUserTokenAsync() failed with purpose: {purpose} for user {userId}.  Errors {errors }", purpose, await GetUserIdAsync(user), errors );            }```
5349	area-signalr	Discussion: SignalR Java Client Package Name Change	This is a discussion item for https://github.com/aspnet/Announcements/issues/321. Please see the announcement for details.
5254	area-mvc	The NPM script 'start' exited without indicating that the Angular CLI	_From @addikhann on Tuesday, 09 October 2018 19:34:00_https://stackoverflow.com/questions/52724294/how-to-solve-the-npm-script-start-exited-without-indicating-that-the-angular-ci posted here today .. but no one reply my error.. please checkhttps://stackoverflow.com/questions/52714606/an-unhandled-exception-occurred-while-processing-the-request-in-netcorei am facing these error on my different machine.... i spend 9 hours in this issue but still pending both of these_Copied from original issue: aspnet/Home#3603_
5253	area-mvc	The NPM script 'start' exited without indicating that the Angular CLI	https://stackoverflow.com/questions/52724294/how-to-solve-the-npm-script-start-exited-without-indicating-that-the-angular-ci posted here today .. but no one reply my error.. please checkhttps://stackoverflow.com/questions/52714606/an-unhandled-exception-occurred-while-processing-the-request-in-netcorei am facing these error on my different machine.... i spend 9 hours in this issue but still pending both of these
5348	area-signalr	Poor documentation and error messages	I wanted to add SignalR to my existing ASP.NET Core project which was serving my Angular SPA. I started by reading this article https://blogs.msdn.microsoft.com/webdev/2018/02/27/asp-net-core-2-1-0-preview1-getting-started-with-signalr/where it clearly states that the SignalR route mapping should go at the END of the Configure method. Doing that gave me a 404 error because it was after my UseSpa method which swallows all the routes. However, I thought it might be a Cors issue, or a version mismatch. Moving those lines earlier just gave a "Could not initialize transports" error which sounded like it was happening too soon, so I moved it back. I noticed that putting an invalid hub name in the client made no difference, so I clearly wasn't getting through to the server.8 hours of hard slog later after reading hundreds of posts, I found one that mentioned the UseSpa swallowing the routes - if only the error had said "Hub not found".So then I set about fixing the "Could not initialize transports" error. I tried configuring long polling, switching the version of my client library. My server was running ASP.NET Core 2.1 so that should be fine. Nothing I did would resolve the error. 4 more hours of hard slog later, I noticed that although VS was saying I was running .NET Core 2.1, it was loading some funky preview. I'd only ever installed released code on my machine so I don't know where the preview came from. If only the error had said "Client/server version mismatch" - surely not rocket science. So I then updated all the NuGet packages to the latest 2.1 release, but I ran into the "Method was called with 2 arguments but was expecting 0" error, documented in another issue, but I was making progress, it was trying to call my code. Of course my methods had the correct number of arguments but the wrong names - if only it had said "Method not found".So after 12 hours of hard slog, I finally got it to work! If only the docs had been correct, if only the error messages had not just said Error negotiating: error.Please improve the error messages and docs, SignalR is awesome!Cheers,Paul
5347	area-signalr	Rename JavaScript client package name	With the release of the Azure SignalR service and it's server-less model, it's entirely possible for a SignalR application to have no ASP.NET Core in it at all. As a result, the name aspnet in the package seems odd. Let's rename from `@aspnet/signalr` to something else. We can't use `signalr` though because it's already in-use by ASP.NET SignalR.Ideas:* `@microsoft/signalr`?
5825	area-identity	License headers incorrect	While working on updating Identity to the newest jquery.validation.unobtrusive I noticed that the license headers [on some files](https://github.com/aspnet/Identity/search?l=C%23&q=%22Copyright+%28c%29+Microsoft%22) doesn't match, reporting that the license is held by Microsoft instead of the .NET Foundation.CC @Eilon for license issues, @javiercn since we already talked about this a bit.
4926	area-mvc	[Discussion] 3.0 - Removing Microsoft.AspNetCore.Mvc.WebApiCompatShim	The Microsoft.AspNetCore.Mvc.WebApiCompatShim (WebApiCompatShim) package provides partial compatibility in ASP.NET Core with ASP.NET Web API 2 to simplify migrating existing Web API implementations to ASP.NET Core. However, apps using the WebApiCompatShim do not benefit from the API related features shipping in recent ASP.NET Core releases, such as improved Open API Spec genertaion, standardized error handling, and client code generation. To better focus our API efforts in 3.0, we plan to remove WebApiCompatShim. We recommend that existing applications using the WebApiCompatShim migrate to the newer `[ApiController]` model.
5345	area-signalr	Fix skipped redis unit tests	Updating to 2.X.X of StackExchange,Redis broke the unit tests because we can't properly mock the `ISubscriber` class.This is for tracking https://github.com/StackExchange/StackExchange.Redis/issues/969 and fixing our unit tests once a fix has been made.
4709	area-servers	4077 ECONNRESET connection reset by peer	EXCEPTION OCCURRED:Microsoft.AspNetCore.Server.Kestrel.Transport.Abstractions.Internal.ConnectionResetException|Error -4077 ECONNRESET connection reset by peer|Void ThrowFailed()|   at Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.PipeCompletion.ThrowFailed()   at Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.Pipe.GetResult(ReadResult&amp; result)   at Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.Pipe.Microsoft.AspNetCore.Server.Kestrel.Internal.System.IO.Pipelines.IReadableBufferAwaiter.GetResult()   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.MessageBody.&lt;ReadAsync&gt;d__22.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.FrameRequestStream.&lt;ReadAsyncInternal&gt;d__21.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.WebUtilities.BufferedReadStream.&lt;EnsureBufferedAsync&gt;d__37.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.WebUtilities.MultipartReaderStream.&lt;ReadAsync&gt;d__36.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.WebUtilities.FileBufferingReadStream.&lt;ReadAsync&gt;d__35.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.WebUtilities.StreamHelperExtensions.&lt;DrainAsync&gt;d__3.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Http.Features.FormFeature.&lt;InnerReadFormAsync&gt;d__18.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.ModelBinding.FormValueProviderFactory.&lt;AddValueProviderAsync&gt;d__1.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.&lt;CreateAsync&gt;d__3.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.&lt;CreateAsync&gt;d__2.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.&lt;&gt;c__DisplayClass0_0.&lt;&lt;CreateBinderDelegate&gt;g__Bind|0&gt;d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.&lt;InvokeInnerFilterAsync&gt;d__14.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.&lt;InvokeNextExceptionFilterAsync&gt;d__23.MoveNext()Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvException|Error -4077 ECONNRESET connection reset by peer
5606	area-mvc	The error does not reported in console	I attempt to create simple Blazor JS interop for vibration API. During testing in Edge I encounter following problems:1. If proxy function could not be accessed via `window` then error silently eaten.2. Since I use `navigator.vibrate` which is not supported by Edge it produce error `SCRIPT438: Object doesn't support property or method 'vibrate'` which again silently eaten. In Chrome, 1. the first error is properly captured and displayed in the browser console. 2. I attempt to simulate second error in Chrome by calling `navigator.vibrate2`, it properly reported as `Error: Microsoft.JSInterop.JSException: navigator.vibrate2 is not a function`Initially I thought that this is due to https://github.com/dotnet/jsinterop/blob/master/src/Microsoft.JSInterop.JS/src/Microsoft.JSInterop.ts#L159 not bening wrapped in try/catch but this properly wrapped in the `_mono_wasm_invoke_js_marshalled` and in Edge this code is working. So seems to be any unhandled exception in the WASM is swallowed by the Edge. I have experience similar error when playing with different application.
5252	area-mvc	Add an option for specifying the port for npm	Currently `UseReactDevelopmentServer` and `UseAngularCliServer` randomly select a port for starting the npm script. However in a few cases (for example when caching the webpack configuration) it would be useful to be able to specify the port being used.Would it therefore make sense to add an optional port parameter to those two functions?
4924	area-mvc	Make it possible to change when client code generation runs	#### Is this a Bug or Feature request?Enhancement that's part of #7947#### Description of the problemCurrently, any project that references the Microsoft.Extensions.ApiDescription.Client will have the `ServiceFileReferenceGenerator` and related targets run unconditionally before the `BeforeCompile` target. Make this conditional so that users can configure the targets to run elsewhere in the build pipeline. For example, use `$(BuildDependsOn)`, `$(CoreBuildDependsOn)`, `$(CompileDependsOn)` or `$(CoreCompileDependsOn)` and make it conditional on a documented property.Not positive where hook should land but prepending it into `$(BuildDependsOn)` seems better than current spot because the code generation targets do not rely on other `Build` or `Compile` work.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the [features/client.code.generation](https://github.com/aspnet/Mvc/tree/feature/client.code.generation) branch. That work is intended for the 2.2 Preview 3 milestone.
4923	area-mvc	Clean up TODOs and duplicated code in client code generation	#### Is this a Bug or Feature request?Enhancement that's part of #7947#### Description of the problem- replace `Microsoft.DotNet.Cli.CommandLine` code with `Microsoft.Extensions.CommandLineUtils.Sources` package- replace custom lookup with `Internal.WebHostBuilderFactory.Sources` package- perhaps, replace console writing code with `Microsoft.Extensions.Logging`  - not positive because adding dependencies to the tool seems perilous#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the [features/client.code.generation](https://github.com/aspnet/Mvc/tree/feature/client.code.generation) branch. That work is intended for the 2.2 Preview 3 milestone.
5251	area-mvc	(SSR) Provider for both Server and Client	I created an ASP.NET Core Angular project using the VS 2017 template.I followed these [directions](https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/angular?view=aspnetcore-2.1&tabs=visual-studio#server-side-rendering) to get server-side rendering working. In the section called [Pass data from .NET code into TypeScript code](https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/angular?view=aspnetcore-2.1&tabs=visual-studio#pass-data-from-net-code-into-typescript-code), it says:"Your main.server.ts code receives this as params.data. For example, the preceding code sample passes a boolean value as params.data.isHttpsRequest into the createServerRenderer callback. You can pass this to other parts of your app in any way supported by Angular. For example, see how main.server.ts passes the BASE_URL value to any component whose constructor is declared to receive it."Ok, so that appears to say that you can use Angular dependency injection. However, if I have a piece of data that is passed from .NET code to TypeScript code (e.g. MyData), and add it as an "extraProvider" in main.server.ts so that it can be dependency injected, if I land on the site then navigate to a component that has that injected (important note: I'm navigating there so main.ts is in play, not main.server.ts), MyData will not be there because the regular "main.ts" has no knowledge of a provider for MyData.So my question is, if we pass data from .NET code into TypeScript using the method described in the article and then we try to dependency inject that data into components, how can we make that same data available on the browser via dependency injection?Thanks in advance.EDIT: I tried using "globals" as described in the section [Passing data from server-side to client-side code](https://github.com/aspnet/JavaScriptServices/tree/master/src/Microsoft.AspNetCore.SpaServices) but when I do that I get the error:"Globals is not supported when prerendering via UseSpaPrerendering"
5605	area-mvc	Compiler error with mixed content in onclick attribute	I have a line in Teachers.cshtml:`<button onclick="window.location.href = '/teacher/@(teacher.Id)/';">More info...</button>`After compilation I have the following line in Teachers.g.cs (/obj/Debug/netstandart2.0/Pages/):`builder.AddAttribute(24, "onclick", (Microsoft.AspNetCore.Blazor.Components.BindMethods.GetEventHandlerValue<Microsoft.AspNetCore.Blazor.UIMouseEventArgs>() + "window.location.href" + " =" + " \'/teacher/" + (teacher.Id) + "/\';" + ()));`And an error message:> CS1525	Invalid expression term ")"
5096	area-mvc	Update to Microsoft.CodeAnalysis 2.9.0 for Microsoft.CodeAnalysis.Razor	We need to update the version of Roslyn that we reference for 2.2 to pick up C# 7.3 - currently build-time compilation can use C# 7.3 but it won't be supported during runtime compilation.This is something we generally do each release near the end because we're usually aligning with a Roslyn release. In this case the relevant bits have been available publicly for a few months. 
5604	area-mvc	Setting up logging in Blazor	Hi all!! Hope you're all having fun, hacking on such an interesting bit of code 😄 I spent a few hours last night experimenting with Serilog in Blazor, both to the local browser console and piped through the server using middleware. The code is in: https://github.com/nblumhardt/serilog-blazor.There's a whole lot to explore in this space, but I thought I'd try to get in early with a bit of feedback on how it hangs together.Some developers, me among them, will go to great lengths to get logging set up before any other application code executes. This makes it easier to debug startup failures, which are usually critical issues. You can see I've done that in the Blazor client demo here: https://github.com/nblumhardt/serilog-blazor/blob/master/SerilogBlazorDemo.Client/Program.cs#L12Because the demo pipes client logs through the server, HTTP is needed; getting the base URI before the Blazor host is initialized took some hackiness: https://github.com/nblumhardt/serilog-blazor/blob/master/SerilogBlazorDemo.Client/Diagnostics/BrowserHttpSink.cs#L67 - it would be great if this could be properly supported by the Blazor API.This echoes some of the problems with logging in ASP.NET Core, particularly the decision to put configuration (and thus logging setup) into DI. This ends up greatly expanding the amount of code that runs before logging is available, and thus the scope of potential failures that can't be properly logged. It would be great to avoid this in Blazor, by providing non-DI access to critical system services (like HTTP, mentioned above). Less-ergonomics/jumping-through-hoops would be acceptable, if it enabled bootstrapping logging ahead of anything else.Hope this is at least food-for-thought, and good luck with it all! (Also, hope you have a chance to run the demo, it's quite compelling to see just how consistent the client/server experiences can be 😎 .)
5095	area-mvc	DocumentSnapshot system needs to understands imports better	tl;dr; Getting imports today isn't guaranteed to be correct in the DocumentSnapshot world.When you go through the process of adding documents to the project system you can get into an invalid state where documents you pull from the project system may generate invalid output. Basically, adding all .cshtml files => generating their output and then adding a _ViewImports.cshtml to the project system results in all of the previous files not seeing the _ViewImports.cshtml file.So we need to design some mechanism when every time an important import file enters the system the ProjectSnapshotManager needs to update all documents in the project to be aware.This isn't an issue in VS windows today because we don't rely on the DocumentSnapshot system for import updates./cc @rynowak @ajaybhargavb 
5940	area-hosting	Application shutdown on Ctrl-C (SIGTERM)	I have 2 hosted services running within my ASPNET Core application.```services.AddSingleton<IHostedService, ServiceHost1>();services.AddSingleton<IHostedService, ServiceHost2>();```Prior to 2.1.4 (2.1.402) a CTRL-C would cause the cancellationToken in each of the hostedservices to be set so that I could exist the tasks and the process would stop.  However, that is no longer the case.The CancellationToken does not get set and the hosted services DO NOT stop.  Which will not let the ASPNET main task stop either.  I get the message in the console "Application is shutting down", but nothing happens.This is running on the latest Raspbian image on a Pi 3 B+.Anyone else having this issue?
3586	area-servers	Poison the HttpContext after it's disposed by the HttpContextFactory	The default HttpContextFactory should poison the HttpContext so that it throws `ObjectDisposedException` if the feature collection is accessed after the request is over. We'd do this by setting a feature collection that just throws on GetFeatureRelated to #3581cc @Tratcher 
5250	area-mvc	Can't hit clientside breakpoints in projects generated from SPA Templates	Hi, Running Visual Studio 2017 15.8.6Created new ASP.NET Core, React project.Put a breakpoint in /ClientApp/src/components/Counter.js, incrementCounter method.  F5.Does not hit breakpoint on increment counter button click. Breakpoint says "The breakpoint will not currently be hit. No symbols have been loaded for this document. Location Counter.js, line 13, character 5"Incidentally, the angular spa and knockout spa project have the same issues.  I am really after a solution to knockout (with typescript), since this is what I am using, but built the other projects since knockout no longer seems supported.  I could not hit the breakpoints in VS Code either, but I could hit them in the browser debug tools.UPDATE - can hit breakpoint in IE and Edge. Still cannot in Chrome or FireFox.Thanks
4710	area-servers	Stop referencing user-replaceable features for internal logic	E.g. the use of RequestHeaders instead of HttpRequestHeaders in the following:https://github.com/aspnet/KestrelHttpServer/blob/35d35f22a36c9ba564889a355f09d95a8e5b78fe/src/Kestrel.Core/Internal/Http2/Http2MessageBody.cs#L19-L26
5344	area-signalr	[Java] Add Cookies configurability	In the .NET Client we expose a Cookies collection in HttpConnectionOptions that we will send with every request. We currently don't have this exposed in Java.
5249	area-mvc	Default SPA handler proxies arbitrary requests	The default SPA application created from template proxies arbitrary requests.For example, create a react based SPA application using `dotnet new react`Then do `curl http://localhost:5000//example.com` (note the double slash here; I disabled https redirection for simplicity)I get HTML code from `example.com`This seems to be caused by:https://github.com/aspnet/JavaScriptServices/blob/15884cbadb94d880c77111017e76e8d37d8d4a72/src/Microsoft.AspNetCore.SpaServices.Extensions/Proxying/SpaProxy.cs#L61-L63Where `new Uri(Uri, string)` has the strange behavior where it ignores the URI when the second parameter is absolute
5603	area-mvc	Support type constraints on @typeparam	This is in regards to the new @typeParam released in 0.6.0 version.I am not sure if Type Constraints can be defined on the generic type passed to @typeParam. If this is something which already existing, can you please direct me to some semantics help. And if it is not there; is there any  plan to support this.This feature will be very much helpful while developing abstract components which must take "T" of some base type for example.
5248	area-mvc	Angular template - Failed to authenticate HTTPS connection.	Angular template throws Authentication failed on startup```info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[0]      User profile is available. Using 'C:\Users\...\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.info: Microsoft.AspNetCore.SpaServices[0]      Starting @angular/cli on port 30387...Hosting environment: DevelopmentContent root path: C:\Users\...Now listening on: https://localhost:5001Now listening on: http://localhost:5000Application started. Press Ctrl+C to shut down.dbug: HttpsConnectionAdapter[1]      **Failed to authenticate HTTPS connection.**System.IO.IOException: **Authentication failed because the remote party has closed the transport stream.**   at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)   at System.Net.Security.SslState.PartialFrameCallback(AsyncProtocolRequest asyncRequest)--- End of stack trace from previous location where exception was thrown ---   at System.Net.Security.SslState.ThrowIfExceptional()   at System.Net.Security.SslState.InternalEndProcessAuthentication(LazyAsyncResult lazyResult)   at System.Net.Security.SslState.EndProcessAuthentication(IAsyncResult result)   at System.Net.Security.SslStream.EndAuthenticateAsServer(IAsyncResult asyncResult)   at System.Net.Security.SslStream.<>c.<AuthenticateAsServerAsync>b__51_1(IAsyncResult iar)   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionAdapter.InnerOnConnectionAsync(ConnectionAdapterContext context)dbug: HttpsConnectionAdapter[1]      Failed to authenticate HTTPS connection.System.IO.IOException: Authentication failed because the remote party has closed the transport stream.   at System.Net.Security.SslState.StartReadFrame(Byte[] buffer, Int32 readBytes, AsyncProtocolRequest asyncRequest)   at System.Net.Security.SslState.PartialFrameCallback(AsyncProtocolRequest asyncRequest)--- End of stack trace from previous location where exception was thrown ---   at System.Net.Security.SslState.ThrowIfExceptional()   at System.Net.Security.SslState.InternalEndProcessAuthentication(LazyAsyncResult lazyResult)   at System.Net.Security.SslState.EndProcessAuthentication(IAsyncResult result)   at System.Net.Security.SslStream.EndAuthenticateAsServer(IAsyncResult asyncResult)   at System.Net.Security.SslStream.<>c.<AuthenticateAsServerAsync>b__51_1(IAsyncResult iar)   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionAdapter.InnerOnConnectionAsync(ConnectionAdapterContext context)info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/info: Microsoft.AspNetCore.SpaServices[0]      > ...@0.0.0 start C:\Users\...\ClientApp> ng serve --extract-css "--port" "30387"** NG Live Development Server is listening on localhost:30387, open your browser on http://localhost:30387/ ** 34%: Microsoft.AspNetCore.SpaServices[0]ctive ..._modules\core-js\modules\_is-array.jsinfo      webpack: wait until bundle finished: /info: Microsoft.AspNetCore.SpaServices[0]      Date: 2018-10-03T16:29:16.575Zinfo: Microsoft.AspNetCore.SpaServices[0]      Hash: dd7f742a114ca490fbb8Time: 7870mschunk {inline} inline.bundle.js (inline) 3.85 kB [entry] [rendered]chunk {main} main.bundle.js (main) 50.7 kB [initial] [rendered]chunk {polyfills} polyfills.bundle.js (polyfills) 549 kB [initial] [rendered]chunk {styles} styles.bundle.css (styles) 119 kB [initial] [rendered]chunk {vendor} vendor.bundle.js (vendor) 9.5 MB [initial] [rendered]info: Microsoft.AspNetCore.SpaServices[0]      webpack: Compiled successfully.info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/vendor.bundle.jsinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/polyfills.bundle.jsinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 12805.5166ms 200 text/html; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/inline.bundle.jsinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/main.bundle.jsinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/styles.bundle.cssinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 449.7253ms 200 application/javascript; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 1274.9799ms 200 application/javascript; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 1335.4996ms 200 application/javascript; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 1353.4796ms 200 text/css; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 1542.2346ms 200 application/javascript; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/glyphicons-halflings-regular.448c34a56d699c29117a.woff2info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/sockjs-node/info?t=1538584159024info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 94.6434ms 200 font/woff2; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 97.568ms 200 application/json; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/sockjs-node/687/0tevmzba/websocketinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 POST https://localhost:5001/sockjs-node/687/otrrfttm/xhr_streaming?t=1538584160236  0info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/sockjs-node/687/aou3wjf3/htmlfile?c=_jp.al2yo2tinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/sockjs-node/iframe.htmlinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 41.7992ms 200 text/html; charset=UTF-8info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/__webpack_dev_server__/sockjs.bundle.jsinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 47.9794ms 200 application/javascriptinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET https://localhost:5001/sockjs-node/687/qqwpe4vk/htmlfile?c=_jp.aswx1jfinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 15555.8808ms 200 text/html; charset=UTF-8```
4922	area-mvc	TypeLoadException: The generic type 'System.Func`2' was used with an invalid instantiation in assembly 'System.Private.CoreLib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e'.	_From @RemarkLima on August 24, 2018 22:40_I have a webapp that works in Core 2.0 without issue.I've attempted to upgrade to 2.1 without success. Most of the application works, except for certain pages and only when posting data. The issue appears to be in the model-binder but I can't diagnose any further as there's no more info other than the stack trace.I've updated all version, I've uninstalled old SDK's and tried to put the latest `System.Private.CoreLib` in the bin directory however, the same error always happens when `POST`ing data back to a controller.I've cut out all references where possible, and cut down my project.json to the bare minimum. I've tried to remove packages but all has had the same result. Also, all the model binding is to a strongly typed model without any generics, so I'm a bit lost with the error.My project.json is:```xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp2.1</TargetFramework>    <UserSecretsId>xxx</UserSecretsId>  </PropertyGroup>  <ItemGroup>	<PackageReference Include="Microsoft.AspNetCore.App" />    <PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.1.1" PrivateAssets="All" />	<PackageReference Include="EPPlus.Core" Version="1.5.4" />	<PackageReference Include="LinqKit.Microsoft.EntityFrameworkCore" Version="1.1.15" />    <PackageReference Include="CsvHelper" Version="7.1.1" />      <PackageReference Include="NReco.PdfGenerator.LT" Version="1.1.15" />    <PackageReference Include="SixLabors.ImageSharp" Version="1.0.0-beta0005" />    <PackageReference Include="MailKit" Version="2.0.6" />    <PackageReference Include="MimeKit" Version="2.0.6" />    <PackageReference Include="SSH.NET" Version="2016.1.0" />    <PackageReference Include="System.Linq.Dynamic.Core" Version="1.0.8.16" />    <PackageReference Include="Z.EntityFramework.Plus.EFCore" Version="1.8.8" />    <PackageReference Include="AWSSDK.S3" Version="3.3.21" />  </ItemGroup></Project>```The full stack trace is below:```System.RuntimeType.MakeGenericType(Type[] instantiation)Microsoft.Extensions.Internal.PropertyHelper.MakeFastPropertyGetter(Type openGenericDelegateType, MethodInfo propertyGetMethod, MethodInfo openGenericWrapperMethod)Microsoft.AspNetCore.Mvc.ModelBinding.Metadata.DefaultModelMetadataProvider.CreateSinglePropertyDetails(ModelMetadataIdentity propertyKey, PropertyHelper propertyHelper)Microsoft.AspNetCore.Mvc.ModelBinding.Metadata.DefaultModelMetadataProvider.CreatePropertyDetails(ModelMetadataIdentity key)Microsoft.AspNetCore.Mvc.ModelBinding.Metadata.DefaultModelMetadataProvider.GetMetadataForProperties(Type modelType)Microsoft.AspNetCore.Mvc.ModelBinding.Metadata.DefaultModelMetadata.get_Properties()Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreCached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexTypeModelBinderProvider.GetBinder(ModelBinderProviderContext context)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinderCoreUncached(DefaultModelBinderProviderContext providerContext, object token)Microsoft.AspNetCore.Mvc.ModelBinding.ModelBinderFactory.CreateBinder(ModelBinderFactoryContext context)Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.GetParameterBindingInfo(IModelBinderFactory modelBinderFactory, IModelMetadataProvider modelMetadataProvider, ControllerActionDescriptor actionDescriptor, MvcOptions mvcOptions)Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.CreateBinderDelegate(ParameterBinder parameterBinder, IModelBinderFactory modelBinderFactory, IModelMetadataProvider modelMetadataProvider, ControllerActionDescriptor actionDescriptor, MvcOptions mvcOptions)Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvokerCache.GetCachedResult(ControllerContext controllerContext)Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvokerProvider.OnProvidersExecuting(ActionInvokerProviderContext context)Microsoft.AspNetCore.Mvc.Internal.ActionInvokerFactory.CreateInvoker(ActionContext actionContext)Microsoft.AspNetCore.Mvc.Internal.MvcRouteHandler+<>c__DisplayClass8_0.<RouteAsync>b__0(HttpContext c)Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.ResponseCompression.ResponseCompressionMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Diagnostics.StatusCodePagesMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```As support is short for 2.0 it is something that would be good to get resolved._Copied from original issue: aspnet/Home#3457_
4711	area-servers	Kestral is very slow when posting data	Please get the sample source from  https://github.com/cibinmathewjose/KestrelPostIssue.git run the code and post {"Name":"test","Price":1} to http://{machine}:5000/api/products, it will take ~6 seconds.if you post {"Price":1} to http://{machine}:5000/api/products it will work normally.The put request endpoint is always slow with machine name url, regardless of the data posted.Also if you use localhost instead of machine name in url, it will always works normal. this is the same issue as #2229 
5247	area-mvc	Ability to use yarn instad of npm with Microsoft.AspNetCore.SpaServices	Is it possible to use yarn instead of npm to install packages using Microsoft.AspNetCore.SpaServices?The Microsoft.AspNetCore.SpaServices installs client side packages internally with npm, but we want to use yarn so we can use the yarn.lock file for consistent package versions. I know npm has a similar lock file but we don't want to use that one. Could this be implemented? A lot of the JS community are using yarn instead of npm, for certain things that it does better and also because it's slightly faster.Thanks! 
5246	area-mvc	NpmScriptRunner.LaunchNodeProcess can't locate npm, but it exists	I have installed node and npm. When i executing project aspnetcore-spa project from command line or VS, it working normally. When executing published (dotnet publish -r win-x64) version on same machine, in browser i have error: Ensure that 'npm' is installed and can be found in one of the PATH directoriesPS C:\Program Files\nodejs> lsDirectory: C:\Program Files\nodejsMode                LastWriteTime         Length Name----                -------------         ------ ----d-----       07.05.2018     12:21                node_modules-a----       29.03.2018     23:06       22832792 node.exe-a----       11.02.2018      1:08            702 nodevars.bat-a----       11.02.2018      1:08           8997 node_etw_provider.man-a----       11.02.2018      0:08           4974 node_perfctr_provider.man-a----       11.02.2018      1:08            867 npm-a----       11.02.2018      0:08            483 npm.cmd-a----       29.03.2018     22:37            867 npx-a----       29.03.2018     22:37            483 npx.cmd`Error details:[1] Ensure that 'npm' is installed and can be found in one of the PATH directories.Current PATH enviroment variable is: C:\Program Files (x86)\Common Files\Intel\Shared Libraries\redist\intel64\compiler;c:\app\product\11.2.0\client_1\bin;C:\Program Files (x86)\Common Files\Oracle\Java\javapath;C:\Windows\system32;C:\Windows;C:\Windows\System32\Wbem;C:\Windows\System32\WindowsPowerShell\v1.0\;C:\Windows\System32\OpenSSH\;C:\Program Files\dotnet\;C:\Program Files\Microsoft SQL Server\130\Tools\Binn\;C:\Program Files\nodejs\ <-----------------------------C:\Program Files\Git\cmd;C:\Program Files\TortoiseSVN\bin;C:\Program Files\Microsoft SQL Server\Client SDK\ODBC\130\Tools\Binn\;C:\Program Files (x86)\Microsoft SQL Server\140\Tools\Binn\;C:\Program Files\Microsoft SQL Server\140\Tools\Binn\;C:\Program Files\Microsoft SQL Server\140\DTS\Binn\;C:\Program Files (x86)\Microsoft SQL Server\Client SDK\ODBC\130\Tools\Binn\;C:\Program Files (x86)\Microsoft SQL Server\140\DTS\Binn\;C:\Program Files (x86)\Microsoft SQL Server\140\Tools\Binn\ManagementStudio\;C:\Program Files\Microsoft VS Code\bin;C:\Users\user\AppData\Local\Microsoft\WindowsApps;C:\Users\user\AppData\Roaming\npm;C:\Program Files\Microsoft VS Code\bin;C:\Users\user\.dotnet\toolsMake sure the executable is in one of those directories, or update your PATH.Stack trace:Microsoft.AspNetCore.NodeServices.Npm.NpmScriptRunner.LaunchNodeProcess(ProcessStartInfo startInfo)Microsoft.AspNetCore.NodeServices.Npm.NpmScriptRunner..ctor(string workingDirectory, string scriptName, string arguments, IDictionary<string, string> envVars)Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.StartAngularCliServerAsync(string sourcePath, string npmScriptName, ILogger logger)dotnet info:dotnet --info.NET Core SDK (reflecting any global.json): Version:   2.1.402 Commit:    3599f217f4Runtime Environment: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.1.402\Host (useful for support):  Version: 2.1.4  Commit:  85255dde3e.NET Core SDKs installed:  2.1.104 [C:\Program Files\dotnet\sdk]  2.1.105 [C:\Program Files\dotnet\sdk]  2.1.201 [C:\Program Files\dotnet\sdk]  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.301 [C:\Program Files\dotnet\sdk]  2.1.302 [C:\Program Files\dotnet\sdk]  2.1.400-preview-009063 [C:\Program Files\dotnet\sdk]  2.1.400 [C:\Program Files\dotnet\sdk]  2.1.402 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.All 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.AspNetCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.0.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.7 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.1 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.4 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]npm info:node --versionv8.11.1
3574	area-servers	Add a Redirect overload that takes PathString, QueryString, etc..	https://github.com/aspnet/Mvc/issues/8518The redirect overloads that take a string do not do the encoding for you. Consider adding an overload that accepted the component parts and assembled and encoded them for you. This would likely delegate to the UriHelper.BuildRelative and BuildAbsolute APIs.
5824	area-identity	Table mappings not working with Core 2.1	I have a netcoreapp2.0 in which I mapped the Identity classes to custom table names.  I created the Identity migration and it works fine.  When I update to netcoreapp2.1, I get the following error, when I attempt to access Identity:`SqlException: Invalid object name 'AspNetRoles'. `I searched the solution.  CreateIdentitySchema.Designer.cs and ApplicationDbContextModelSnapshot.cs each contain an entry that maps to the correct table.  They also contain a second entry:```C#            modelBuilder.Entity("Microsoft.AspNetCore.Identity.IdentityRole", b =>                {                    b.HasBaseType("Microsoft.AspNetCore.Identity.IdentityRole<string>");                    b.HasIndex("NormalizedName")                        .IsUnique()                        .HasName("RoleNameIndex")                        .HasFilter("[NormalizedName] IS NOT NULL");                    b.ToTable("AspNetRoles");                    b.HasDiscriminator().HasValue("IdentityRole");                });```If I edit these entries to point to the correct table, I still get the above error.  If I rollback to netcoreapp2.0, everything works as expected.
4712	area-servers	Add support for LetsEncrypt certificate acquisition and rotation in Kestrel	Original issue: https://github.com/aspnet/Home/issues/1190cc @blowdart
3573	area-servers	Transfer-Encoding: Chunked - Inaccurate and sometimes incomplete using HttpRequestStreamReader	_From @VAchris on August 15, 2018 11:9_https://github.com/aspnet/HttpAbstractions/blob/bfa183747f6fb528087554c3d6ec58ef05f1c10a/src/Microsoft.AspNetCore.WebUtilities/HttpRequestStreamReader.cs#L322Ok, so lets set the stage. I have an ApiController that accepts a POST request. I will always expect the POST  to include the http headers **Transfer-Encoding: Chunked** and Content-Type: application/json. The POST body will typically contain a large JSON file that is sent from a central gateway (similar to a DMZ) that sits between the LAN and WAN.The central gateway doesn't store and forward; it just forwards using chunked transfer encoding to my receiving ApiController which writes the POST body to a file.**Issue:** How do I detect the true EOF when chunked transfer encoding is used?**What I've tried:** `var streamReader = new HttpRequestStreamReader(Request.Body, Encoding.UTF8);``if(streamReader.Peek() >= 0) { ... }`However there are times when `.Peek()` will return -1 even though only a small portion of the POST body transfer is complete.I've also tried a do while loop using `.Read()` however I get similar results to `.Peek()``var postBody = streamReader.ReadToEnd();`This works however I can't and shouldn't read the entire contents; I need to be able to stream the POST body and immediately write to a file, especially for large POSTs.**Interestingly:** .Peek() and .Read() consistently both return -1 after 8,192 bytes have been read from the stream. _Copied from original issue: aspnet/HttpAbstractions#1031_
3572	area-servers	204 result produces HttpContext response body stream flagged as writable. 	_From @mkArtakMSFT on July 30, 2018 16:37__From @mfolker-sage on July 30, 2018 9:20_#### BugThe HttpContext in middleware has response body stream flagged as writeable when a 204 response is returned. A 204 should not be writable has the status code denotes no content. When you try to write to the response body stream an error is thrown as expected.#### Steps to reproduce:1) Add a middleware class with the following code and an endpoint that returns a 204 status. ``` public async Task Invoke(HttpContext context) {     _logger.LogInformation("Invoking vanilla middleware middleware.");     await _next(context);      _logger.LogInformation ($"Status code {context.Response.StatusCode}");      if (context.Response.Body.CanWrite)      {           //Write something to the body.      } }```2) Write something to the body, for example,         public async Task Invoke(HttpContext context)        {            var bodyStream = context.Response.Body;            using (var responseBodyStream = new MemoryStream())            {                using (var reader = new StreamReader(responseBodyStream))                {                    context.Response.Body = responseBodyStream;                    await _next(context);                    responseBodyStream.Seek(0, SeekOrigin.Begin);                    var responseBodyText = reader.ReadToEnd();                    var messageObjToLog = new { responseBody = responseBodyText, statusCode = context.Response.StatusCode };                    _logger.LogInformation(JsonConvert.SerializeObject(messageObjToLog));                    if (context.Response.CanWrite)                    {                        responseBodyStream.Seek(0, SeekOrigin.Begin);                        await responseBodyStream.CopyToAsync(bodyStream);                       }                }            }        }3) When you return a 204 status code you will notice context.Response.CanWrite == true and therefore the lines copies back to it throws an error. #### Description of the problem:In  instances of 204 status codes the context.Response.CanWrite should be false.#### Microsoft.AspNetCore.All version 2.0.3_Copied from original issue: aspnet/Mvc#8171__Copied from original issue: aspnet/HttpAbstractions#1028_
4645	area-security	One rule from several rules in AuthorizationPolicyBuilder	Hello, allNow, If AuthorizationPolicyBuilder have several rules, all rules should be fulfilled.But in our project we have use case when need to resolve only one rule from several rules.As example: /* Adding policy */```options.AddPolicy("UserOrClient",                    policy => policy.AddRequirements(                        new UserAccessRequirement(),                        new ClientAccessRequirement()));```/* Handler */```public class UserOrClientAccessHandler : IAuthorizationHandler {Task HandleAsync(AuthorizationHandlerContext context) {            var requirements = context.PendingRequirements.ToList();            var userRequirement = requirements.FirstOrDefault(item => item is UserAccessRequirement);            var clientRequirement = requirements.FirstOrDefault(item => item is ClientAccessRequirement);           if (userRequirement.IsNull() && clientRequirement.IsNotNull())            {                IsOnlyClienCheck(context, clientRequirement);            }            else if (userRequirement.IsNotNull() && clientRequirement.IsNull())            {                await IsOnlyUserCheckAsync(context, userRequirement);            }            else if (userRequirement.IsNotNull() && clientRequirement.IsNotNull())            {                await IsUserOrClientAsync(context, userRequirement, clientRequirement);            }}}```And for situations like this needs to write CustomHandler and several requirements.When we will add more rules, handler will be "trash"Maybe you know, How I can this resolve?
4713	area-servers	Kestrel (or something I don't know) caches my API	I've created a bunch of services using ASP.NET Core. I've hosted them in IIS using AspNetCoreModule. Nowhere I've used caching. In fact, I'm not familiar with the concept of caching at all in ASP.NET Core.I've published this service to two different servers. Both have this environment:Windows Server 2012 R2 StandardIIS 8.5.9600.16384The problem is that one works just fine, the other caches my API requests. I've compared IIS configuration of two servers by comparing `Windows\System32\inetsrv\config` folders, and they are the same.Also `Web.config` files are the same on both machines. I'm stuck at this point on how to find and solve the problem. The problem should be environmental, since I've not configured anything related to caching in my codebase. In other words, codebase is the same across two machines. So that can't be the source of the caching problem.Is Kestrel the culprit here? How can I make sure that Kestrel is not caching my API responses without me knowing it?This is the response header on when it's not cached:```HTTP/1.1 200 OKContent-Type: application/json; charset=utf-8Vary: OriginServer: KestrelAccess-Control-Allow-Credentials: trueAccess-Control-Allow-Origin: http://admin.vas.taak.ioDate: Mon, 01 Oct 2018 11:37:44 GMTContent-Length: 8804```
5342	area-signalr	[JS Client] Url can't be changed for easy reconnect	Using a client-side cursor (e.g. `lastId` processed); for a reconnect this wants to be passed back to the server in the query string (as cors doesn't allow custom headers and cors is always applicable to websockets).However while `signalR.HubConnectionBuilder()` provides easy construction of the connection; the url cannot be changed after building.This means if the connection disconnects and you need to pass a cursor (e.g. id); the connection has to be rebuilt and all the events re-registered to the new connection.It would be easier if the url could be updated and only `.start` needed to be called again.
5602	area-mvc	NullReferenceException in resolve-dependencies	I get the following error when using Blazor.Server on an F# project:```EXEC : error : Object reference not set to an instance of an object. [C:\Users\loic.denuziere\my\miniblazor\tests\server\server.fsproj]     at Microsoft.AspNetCore.Blazor.Build.RuntimeDependenciesResolver.AssemblyResolutionContext.<ResolveAssemblies>g__GetAssemblyReferences|13_1(AssemblyEntry current) in /_/src/Microsoft.AspNetCore.Blazor.Build/Core/RuntimeDependenciesResolver.cs:line 103     at Microsoft.AspNetCore.Blazor.Build.RuntimeDependenciesResolver.AssemblyResolutionContext.<ResolveAssemblies>g__ResolveAssembliesCore|13_0(<>c__DisplayClass13_0& ) in /_/src/Microsoft.AspNetCore.Blazor.Build/Core/RuntimeDependenciesResolver.cs:line 91     at Microsoft.AspNetCore.Blazor.Build.RuntimeDependenciesResolver.AssemblyResolutionContext.ResolveAssemblies() in /_/src/Microsoft.AspNetCore.Blazor.Build/Core/RuntimeDependenciesResolver.cs:line 82     at Microsoft.AspNetCore.Blazor.Build.RuntimeDependenciesResolver.ResolveRuntimeDependenciesCore(String entryPoint, String[] applicationDependencies, String[] monoBclDirectories) in /_/src/Microsoft.AspNetCore.Blazor.Build/Core/RuntimeDependenciesResolver.cs:line 46     at Microsoft.AspNetCore.Blazor.Build.Cli.Commands.ResolveRuntimeDependenciesCommand.<>c__DisplayClass0_0.<Command>b__0() in /_/src/Microsoft.AspNetCore.Blazor.Build/Cli/Commands/ResolveRuntimeDependenciesCommand.cs:line 44C:\Users\loic.denuziere\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0-preview1-20180925.6\targets\Blazor.MonoRuntime.targets(538,5): error MSB3073: The command "dotnet "C:\Users\loic.denuziere\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0-preview1-20180925.6\targets\../tools/Microsoft.AspNetCore.Blazor.Build.dll" resolve-dependencies "C:\Users\loic.denuziere\my\miniblazor\tests\server\obj\Debug\netcoreapp2.0\server.dll" --references "C:\Users\loic.denuziere\my\miniblazor\tests\server\obj\Debug\netcoreapp2.0\blazor\resolve-dependencies.txt" --base-class-library "C:\Users\loic.denuziere\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0-preview1-20180925.6\targets\../tools/mono/bcl/" --base-class-library "C:\Users\loic.denuziere\.nuget\packages\microsoft.aspnetcore.blazor.build\0.7.0-preview1-20180925.6\targets\../tools/mono/bcl/Facades/" --output "C:\Users\loic.denuziere\my\miniblazor\tests\server\obj\Debug\netcoreapp2.0\blazor\resolved.assemblies.txt"" exited with code 1. [C:\Users\loic.denuziere\my\miniblazor\tests\server\server.fsproj]```I ran this with a locally built Razor with print debugging to find what was going on, and it seems that the problem is that it can't find `System.Buffers.dll`; it's not copied locally, and it's not in mono's stdlib either. And indeed, the issue disappears if I add this to my project:```xml  <ItemGroup>    <ReferenceCopyLocalPaths Include="$(NuGetPackageRoot)system.buffers/4.5.0/lib/netstandard2.0/System.Buffers.dll" />  </ItemGroup>```
4646	area-security	Documentation issue: clarify JwtBearerOptions.Audience's behaviour in its <summary>	The current XML documentation for `JwtBearerOptions.Audience` does not explain why this property exists when `JwtBearerOptions.TokenValidationParameters.ValidAudience` is also an Audience property.I had to look into the source code to find `JwtBearerPostConfigureOptions` and I see that it simply copies `JwtBearerOptions.Audience` into `JwtBearerOptions.TokenValidationParameters.ValidAudience` - but only if `JwtBearerOptions.TokenValidationParameters.ValidAudience` is empty. This behavior is not documented.I'd suggest changing the comment on `JwtBearerOptions.Audience` from this:> Gets or sets the audience for any received OpenIdConnect token.... to something like:> Gets or sets a single valid audience value for any received OpenIdConnect token. This value is passed into `TokenValidationParameters.ValidAudience` if that property is empty.
5823	area-identity	Default Values for IdentityUser	I've realized that the configuration for the default entity `IdentityUser` https://github.com/aspnet/Identity/blob/master/src/EF/IdentityUserContext.cs#L134 doesn't have any configuration for the `PhoneNumber` and other values.I faced a few performance lacking using varchar(max) sizing.Reference : https://sqlperformance.com/2017/06/sql-plan/performance-myths-oversizing-stringsI think it'd be a good idea use some standard as default to avoid users that don't care or don't know about it have to deal with those kind of throughput issues and every once can configure like they prefer (as it is possible now) but IMO is a quite dangerous letting this as default![image](https://user-images.githubusercontent.com/8322252/46265030-2dda9280-c4f9-11e8-9649-881dec444d3b.png)Acording this with `For full international support, you'd need a VARCHAR of 15 digits.`https://en.wikipedia.org/wiki/E.164 Thanks.
5245	area-mvc	Webpack: allow dynamic timeout	I require a higher timeout than the [default 100 seconds](https://github.com/aspnet/JavaScriptServices/blob/0050b505ec42d32dae42a4925c6cc03e01ee7dd0/src/Microsoft.AspNetCore.SpaServices/Webpack/WebpackDevMiddleware.cs#L115). I propose to make the timeout configurable. This would become an property on `WebpackDevMiddlewareOptions`.Please let me know if you are open for this, and like a pull request.
4221	area-mvc	Plan to migrate IRouter based implementations onto Endpoint Routing	# SummaryI'm developing a plan to make it possible for folks implementing `IRouter` based functionality to migrate endpoint routing. This is our future direction for MVC and the stack in general, and we don't want to leave users/frameworks behind.I'm also lumping in this category custom `IActionSelector` implementations. `IActionSelector` is not used in endpoint routing so it's just as relevant/obsolete for new apps. Over time we're going to evolve in the direction of endpoint routing being the primary experience for the whole stack. I don't expect that we'd ever be able to delete `IRouter` or remove `IRouter` support from MVC. We can offer users more options to migrate and try to make it as enticing as possible, but some portion will be left behind; either by our choice not to add a feature they want, or their choice not to adopt new features and concepts.## AnalysisBased on analysis, I've found 3 major types of usages:1. I want to rewrite the route values (usually localization) - [example](https://github.com/aspnet/Routing/issues/823)2. My route values are in a database (usually a CMS, SimpleCommerce) - [example](https://github.com/simplcommerce/SimplCommerce/blob/master/src/Modules/SimplCommerce.Module.Core/Extensions/UrlSlugRoute.cs)3. I am implementing a framework (OData) - [example](https://github.com/OData/WebApi/blob/d02bc61ea7b31ada1e54abbeebbecb3c5df0e3ac/src/Microsoft.AspNetCore.OData/Routing/ODataActionSelector.cs#L33)Note that these are roughly in ascending order of 'off-road-ness' - reusing less of our implementation gradually.  Most genuine challenges in framework design related to application authors writing extensibility that *uses* and is *used by* the framework.Let's go case by case and look at these...## I want to rewrite the route valuesUsually the case for this is that you want to have one set of actions that you 'multiply' (cross-product) across different localized strings that you want to appear in the URL. There's a major pivot here regarding whether you want to localize the 'route values' or just localize the URL template. In general all of these things 'just work' with application model today. Some users *choose* to implement this with `IRouter` because they have done that in the past or it's what seems most obvious to them, but there's no real problem with using application model for this. ## My route values in the databaseGenerally this kind of system works by defining a `slug` route in the route table that matches all URLs, and then looking up a set of route values in a database using the URL path or part of it as a key.Example:```var urlSlug = ... do database query...;RouteData.Values["controller"] = urlSlug.EntityType.RoutingController;RouteData.Values["action"] = urlSlug.EntityType.RoutingAction;RouteData.Values["id"] = urlSlug.EntityId;```This requires a slightly more involved solution, because the route templates can't be defined statically, and because we don't provide a simple way to 'run code' to select an MVC action. My assumption here is that this user doesn't want to access the DB once on startup to create the route table, they want to make configuration changes while the app is running. The key here is that this user is reusing MVC's action selector by rewriting the route values.---- Here's a proposal:1. Make it so that an `IEndpointSelectorPolicy` can be filter where it applies by candidate set. This is for isolation.2. Register a single endpoint that with a metadata that identifies it as a 'slug' endpoint3. Write an endpoint selector policy that selects the real/action/endpoint and returns it when it finds the 'slug' endpointThis has a few drawbacks:- There is no path to support link generation, but I have yet to see an example of this pattern that includes link generation.- This does not allow you to reuse HTTP method filtering or other policies. The custom implementation is responsible for handling these concerns.Another approach would be to rewrite the URL. That might be more straightforward.## I am implementing a frameworkUpon further analysis, this case is very similar to the above. The framework registers a route that matches a 'slug', and has a custom implementation that produces an action.This case has fewer drawbacks because they are not using MVC's action selection.## Next steps> Make it so that an `IEndpointSelectorPolicy` can be filter where it applies by candidate set. This is for isolation.We need to do this. This is a nice perf enhancement to `IEndpointSelectorPolicy` and can unblock a framework like OData migrate. We need to do this in 2.2 so it's not a breaking change. We should consider further whether URL rewriting is a better solution for most of these scenarios. I think the timeframe for any other choices we'd consider is 3.0
4920	area-mvc	Bad exception message when @inject-ing unregistered types in razor views	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):1. Clone: https://github.com/InDieTasten/BadRazorInjectionExample2. Debug application3. Index page throws exception described below#### Description of the problem:When doing the steps above, the index view will throw the following exception:```InvalidOperationException: No service for type 'Microsoft.AspNetCore.Identity.UserManager`1[Microsoft.AspNetCore.Identity.IdentityUser]' has been registered.Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)Microsoft.AspNetCore.Mvc.Razor.Internal.RazorPagePropertyActivator+<>c__DisplayClass8_0.<CreateActivateInfo>b__1(ViewContext context)Microsoft.Extensions.Internal.PropertyActivator<TContext>.Activate(object instance, TContext context)Microsoft.AspNetCore.Mvc.Razor.Internal.RazorPagePropertyActivator.Activate(object page, ViewContext context)Microsoft.AspNetCore.Mvc.Razor.RazorPageActivator.Activate(IRazorPage page, ViewContext context)Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageCoreAsync(IRazorPage page, ViewContext context)Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderPageAsync(IRazorPage page, ViewContext context, bool invokeViewStarts)Microsoft.AspNetCore.Mvc.Razor.RazorView.RenderAsync(ViewContext context)Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ViewContext viewContext, string contentType, Nullable<int> statusCode)Microsoft.AspNetCore.Mvc.ViewFeatures.ViewExecutor.ExecuteAsync(ActionContext actionContext, IView view, ViewDataDictionary viewData, ITempDataDictionary tempData, string contentType, Nullable<int> statusCode)Microsoft.AspNetCore.Mvc.ViewFeatures.ViewResultExecutor.ExecuteAsync(ActionContext context, ViewResult result)Microsoft.AspNetCore.Mvc.ViewResult.ExecuteResultAsync(ActionContext context)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultAsync(IActionResult result)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResultFilterAsync<TFilter, TFilterAsync>()Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResultExecutedContext context)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.ResultNext<TFilter, TFilterAsync>(ref State next, ref Scope scope, ref object state, ref bool isCompleted)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeResultFilters()Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(ref State next, ref Scope scope, ref object state, ref bool isCompleted)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```Which doesn't include any hint of where the injection was actually attempted. If the generated view code for injecting would catch and rethrow with information about which view actually attempted the injection, debugging issues of injecting wrong types would be much easier.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:Microsoft.AspNetCore.App: 2.1.1Microsoft.NETCore.App 2.1
4919	area-mvc	Redirect should encode URLs if it needs to	All these issues are result of people trying to redirect to a URL that is not all ASCII. Resolution seems to be "you should have encoded your URL".https://github.com/aspnet/Home/issues/2678https://github.com/aspnet/Mvc/issues/7701https://github.com/aspnet/KestrelHttpServer/issues/2508https://github.com/aspnet/KestrelHttpServer/issues/2296https://github.com/aspnet/Security/issues/1646https://github.com/aspnet/HttpAbstractions/issues/971https://github.com/aspnet/Routing/issues/513https://github.com/aspnet/Mvc/issues/7529https://github.com/aspnet/HttpAbstractions/issues/907https://github.com/aspnet/Mvc/issues/6609https://github.com/aspnet/Home/issues/2106https://github.com/madskristensen/Miniblog.Core/issues/87However, the fact that the RedirectResult puts the URL into a HTTP header (which is the ultimate source of the issue) is an implementation detail that the caller cannot magically assume. It is therefore responsibility of e.g. RedirectResultExecutor to meet the requirements and ensure the URL is properly formatted in case it decides to use HTTP headers for redirection.
5939	area-hosting	WebHost needs an error flag	When the setting CaptureStartupErrors is set to True and you do Db initialization after building the WebHost there is no way to tell if an exception has occured during configuration. In my case I am getting a service from WebHost.Services which throws an exception because it doesn't exist. The end result is not seeing the configuration exception
4647	area-security	Microsoft Security Advisory:  iOS12 breaks social, WSFed and OIDC logins	# Microsoft Security Advisory:  iOS12 breaks social, WSFed and OIDC logins## <a name="executive-summary"></a>Executive summaryMicrosoft is releasing this security advisory to provide information about an incompatibly between iOS12 and some types of authentication. This advisory also provides guidance on what developers can do to remove current security restrictions added by ASP.NET to their applications to become compatible with iOS12.## AnnouncementThe original announcement for this issue can be found at https://github.com/aspnet/Announcements/issues/318## DiscussionDiscussion for this issue can be found at https://github.com/aspnet/Identity/issues/1984 for ASP.NET Core Identity## <a name="advisory-faq"></a>Advisory FAQ### <a name="how-affected"></a>What has changedThe recent iOS12 update has changed Safari's handling of [SameSite](https://tools.ietf.org/html/rfc6265) cookies. The SameSite attribute allows a developer to control when cookies are sent to a web site, enabling the flow to only occur when requests are from the same site. This standard was introduced to reduce exposure to Cross Site Request Forgery (CSRF) attacks. By default ASP.NET Core 2.0 and later protects its authentication cookies using the SameSite property. The change on Apple's part is not limited to ASP.NET Core applications, it is affecting multiple frameworks and authentication software which relay on HTTP forms in a browser, for example authenticating to a third party via Facebook, Twitter or browser based Open ID Connect (OIDC) mechanism.Apple have stated they believe [their change is correct behavior](https://bugs.webkit.org/show_bug.cgi?id=188165), and that the fault lies in every other browser's implementation.While we take no stance on the correctness of browser behavior we feel that removing the SameSite protections would expose our customers, and their customers to a wider risk, as it would remove the protection provided everywhere, for all users, in any browser.### <a name="how-affected"></a>How do I know if I am affected?If your users can no longer login to your web application on iOS12 using Safari then you are affected.### <a name="how-fix"></a>How do I fix this?Developers can allow iOS12 Safari users to log into their applications by turn off SameSite protection in `ConfigureServices()`.If you are using ASP.NET Core Identity you disable the protection by configuring cookies with the following code```c#services.ConfigureExternalCookie(options =>{    // Other options    options.Cookie.SameSite = SameSiteMode.None;});services.ConfigureApplicationCookie(options =>{    // Other options    options.Cookie.SameSite = SameSiteMode.None;});```If you are using cookie authentication without ASP.NET Core identity you can turn off the protection with the following code```c#services.AddCookie(CookieAuthenticationDefaults.AuthenticationScheme, options =>{    // Other options    options.Cookie.SameSite = Microsoft.AspNetCore.Http.SameSiteMode.None;})```If you are using external OIDC providers you may be able to avoid the issue by changing the response mode your provider uses from a POST to a GET request, using the following code. Not all providers may support this.```c#.AddOpenIdConnect("myOIDProvider", options => {    // Other options    options.ResponseType = "code";    options.ResponseMode = "query";};```_Note that in making these changes protection is removed for all users and all browsers. You should ensure that all your actions that make state changes are protected with [CSRF anti-forgery mechanisms](https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery) built into ASP.NET Core.#### Rebuilding your applicationAfter making these configuration changes you rebuild your application, test, and redeploy.## Other Information### Reporting Security IssuesIf you have found a potential security issue in .NET Core, please email details to secure@microsoft.com. Reports may qualify for the .NET Core Bug Bounty. Details of the .NET Core Bug Bounty including terms and conditions are at [https://aka.ms/corebounty](https://aka.ms/corebounty).### SupportYou can ask questions about this issue on GitHub in the .NET Core or ASP.NET Core organizations. These are located at https://github.com/dotnet/ and https://github.com/aspnet/. The Announcements repo for each product (https://github.com/dotnet/Announcements and https://github.com/aspnet/Announcements) will contain this bulletin as an issue and will include a link to a discussion issue. You can ask questions in the discussion issue.### DisclaimerThe information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.### External Links[Bug 188165 - iOS 12 Safari breaks ASP.NET Core 2.1 OIDC authentication](https://bugs.webkit.org/show_bug.cgi?id=188165)### RevisionsV1.0 (September 28, 2018): Advisory published.
5822	area-identity	Microsoft Security Advisory: iOS12 breaks social, WSFed and OIDC logins	# Microsoft Security Advisory:  iOS12 breaks social, WSFed and OIDC logins## <a name="executive-summary"></a>Executive summaryMicrosoft is releasing this security advisory to provide information about an incompatibly between iOS12 and some types of authentication. This advisory also provides guidance on what developers can do to remove current security restrictions added by ASP.NET to their applications to become compatible with iOS12.## AnnouncementThe original announcement for this issue can be found at https://github.com/aspnet/Announcements/issues/318## DiscussionDiscussion for this issue can be found at https://github.com/aspnet/Security/issues/1864 for ASP.NET Core Cookie Authentication## <a name="advisory-faq"></a>Advisory FAQ### <a name="how-affected"></a>What has changedThe recent iOS12 update has changed Safari's handling of [SameSite](https://tools.ietf.org/html/rfc6265) cookies. The SameSite attribute allows a developer to control when cookies are sent to a web site, enabling the flow to only occur when requests are from the same site. This standard was introduced to reduce exposure to Cross Site Request Forgery (CSRF) attacks. By default ASP.NET Core 2.0 and later protects its authentication cookies using the SameSite property. The change on Apple's part is not limited to ASP.NET Core applications, it is affecting multiple frameworks and authentication software which relay on HTTP forms in a browser, for example authenticating to a third party via Facebook, Twitter or browser based Open ID Connect (OIDC) mechanism.Apple have stated they believe [their change is correct behavior](https://bugs.webkit.org/show_bug.cgi?id=188165), and that the fault lies in every other browser's implementation.While we take no stance on the correctness of browser behavior we feel that removing the SameSite protections would expose our customers, and their customers to a wider risk, as it would remove the protection provided everywhere, for all users, in any browser.### <a name="how-affected"></a>How do I know if I am affected?If your users can no longer login to your web application on iOS12 using Safari then you are affected.### <a name="how-fix"></a>How do I fix this?Developers can allow iOS12 Safari users to log into their applications by turn off SameSite protection in `ConfigureServices()`.If you are using ASP.NET Core Identity you disable the protection by configuring cookies with the following code```c#services.ConfigureExternalCookie(options =>{    // Other options    options.Cookie.SameSite = SameSiteMode.None;});services.ConfigureApplicationCookie(options =>{    // Other options    options.Cookie.SameSite = SameSiteMode.None;});```If you are using cookie authentication without ASP.NET Core identity you can turn off the protection with the following code```c#services.AddCookie(CookieAuthenticationDefaults.AuthenticationScheme, options =>{    // Other options    options.Cookie.SameSite = Microsoft.AspNetCore.Http.SameSiteMode.None;})```If you are using external OIDC providers you may be able to avoid the issue by changing the response mode your provider uses from a POST to a GET request, using the following code. Not all providers may support this.```c#.AddOpenIdConnect("myOIDProvider", options => {    // Other options    options.ResponseType = "code";    options.ResponseMode = "query";};```_Note that in making these changes protection is removed for all users and all browsers. You should ensure that all your actions that make state changes are protected with [CSRF anti-forgery mechanisms](https://docs.microsoft.com/en-us/aspnet/core/security/anti-request-forgery) built into ASP.NET Core.#### Rebuilding your applicationAfter making these configuration changes you rebuild your application, test, and redeploy.## Other Information### Reporting Security IssuesIf you have found a potential security issue in .NET Core, please email details to secure@microsoft.com. Reports may qualify for the .NET Core Bug Bounty. Details of the .NET Core Bug Bounty including terms and conditions are at [https://aka.ms/corebounty](https://aka.ms/corebounty).### SupportYou can ask questions about this issue on GitHub in the .NET Core or ASP.NET Core organizations. These are located at https://github.com/dotnet/ and https://github.com/aspnet/. The Announcements repo for each product (https://github.com/dotnet/Announcements and https://github.com/aspnet/Announcements) will contain this bulletin as an issue and will include a link to a discussion issue. You can ask questions in the discussion issue.### DisclaimerThe information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.### External Links[Bug 188165 - iOS 12 Safari breaks ASP.NET Core 2.1 OIDC authentication](https://bugs.webkit.org/show_bug.cgi?id=188165)### RevisionsV1.0 (September 28, 2018): Advisory published.
4918	area-mvc	Support CRUD with strongly typed sorting, filtering and pagination (paging) out of the box	#### Feature request:Support sorting, filtering and pagination out of the box.Pretty much all API's need this, unless you're doing a simple demo. So instead of every developer having to invent and implement these standard feature I think it would be greatly beneficial if this came with the framework.You already have some work you can draw on. https://github.com/OData/WebApi already give you access to sorting, filtering and pagination via the `[EnableQuery]` attribute. But OData might not be suitable for everyone.The current documented way of doing the above is relying on `switch`ing on strings. > ```csharp> public async Task<IActionResult> Index(>     string sortOrder,>     string currentFilter,>     string searchString,>     int? page)> {>     ViewData["CurrentSort"] = sortOrder;>     ViewData["NameSortParm"] = String.IsNullOrEmpty(sortOrder) ? "name_desc" : "";>     ViewData["DateSortParm"] = sortOrder == "Date" ? "date_desc" : "Date";> >     if (searchString != null)>     {>         page = 1;>     }>     else>     {>         searchString = currentFilter;>     }> >     ViewData["CurrentFilter"] = searchString;> >     var students = from s in _context.Students>                    select s;>     if (!String.IsNullOrEmpty(searchString))>     {>         students = students.Where(s => s.LastName.Contains(searchString)>                                || s.FirstMidName.Contains(searchString));>     }>     switch (sortOrder)>     {>         case "name_desc":>             students = students.OrderByDescending(s => s.LastName);>             break;>         case "Date":>             students = students.OrderBy(s => s.EnrollmentDate);>             break;>         case "date_desc":>             students = students.OrderByDescending(s => s.EnrollmentDate);>             break;>         default:>             students = students.OrderBy(s => s.LastName);>             break;>     }> >     int pageSize = 3;>     return View(await PaginatedList<Student>.CreateAsync(students.AsNoTracking(), page ?? 1, pageSize));> }> ```> source: https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/sort-filter-page?view=aspnetcore-2.0While versatile it's rather cumbersome/annoying to write and maintain. Just imagine an entity where you'd want to sort and filter on 10 properties and not just do it on single properties but do stuff like (pseudo example) `/resource?filter=PropA=foo & sort=PropB,desc & sort=PropC`. That's a nightmare to write.Why can't we have something like this:```csharppublic PagedResult<Foo> Get(QueryParams<Foo> params){    var filteredSortedPagedFoos = _db.Foos.ApplyQuery(params);    return Ok(filteredSortedPagedFoos);}```While this might be a bit over simplified it should demonstrate the "out of box" feeling I'm looking for :)I basically want something similar to what Spring Boot has "out of the box". ```java@RepositoryRestResourcepublic interface FooRepository extends JpaRepository<Foo, Long> {}```This code snippet gives me a fully functional CRUD controller with paging and sorting. Not filtering though. While I don't advocate Spring Boot because it's absolutely terrible compared to ASP.NET Core that particulier feature is pretty cool. Though it's rather limited and has all sorts of problems - as does everything with Spring Boot... Anyway...Last but not least. The implementation should take DTO usage into account.I know there are some packages that try to solve this "problem". I haven't found one that fully solves it. Since it's something every API or MVC site needs I think it would be handy with a default way to implement it.
4714	area-servers	Seperate TimeoutControl into distinct types	The new times would be for read timeout, write timeout, and generic timeout. The methods already appear to be distinct and grouped, the biggest overheard looks like it would be passing three types around.
5093	area-mvc	[Tracking] Parser improvements feedback	I'm putting all the miscellaneous improvements we want to do after we get the end-to-end working in the list below,- [ ] Cleanup attribute value (First step: Get rid of `GenericBlock`)- [ ] Cleanup how CSharpParser.ParseBlock()` works- [ ] Cleanup MarkupElementRewriter (Original comment: https://github.com/aspnet/Razor/pull/2624#pullrequestreview-160520343)- [ ] Should we generate classified spans for a tag helper end tag?- [ ] In cases like `<p class= >`, the attribute value should contain a marker. Currently it is null.- [ ] Add TagHelperPrefix to generated baselines- [x] Razor directive descriptors and directive token descriptors should be first class properties on the directive nodes- [ ] Need to rethink what goes inside `RazorDirectiveBody` (https://github.com/aspnet/Razor/pull/2621#discussion_r230513198)- [ ] Should we create a new type for significant whitespace? (https://github.com/aspnet/Razor/pull/2621#discussion_r230513846)- [ ] `@: ` shouldn't be represented as `CSharpTemplateBlock` (https://github.com/aspnet/Razor/pull/2708#discussion_r232419788)- [ ] Why does `WhitespaceRewriter` exist separately?- [ ] Generate TagHelperSpans with more information on attributes- [ ] Trailing extensible directive whitespace is considered markup at design time (https://github.com/aspnet/AspNetCore-Internal/issues/1464)
5341	area-signalr	Expose CookieJar implementation to users	We should expose the CookieJar implementation in Java so that users can provide things like persistent cookie storage if they want to.This would require wrapping the `CookieJar` and `Cookie` classes in OkHttp.
5340	area-signalr	ASP.NET Core SignalR Authentication on .net WPF returns -  401 (Unauthorized)	I am trying to connecting the server using JWT authentication. I downloaded your sample Docs/aspnetcore/signalr/authn-and-authz/sample and works fine. However when connecting on .net client, it throws after the .StartAsync():**Response status code does not indicate success: 401 (Unauthorized).**I did this. options.AccessTokenProvider = async () =>                          {                                httpResponse = await new HttpClient().PostAsync("host with token", null);                                httpResponse.EnsureSuccessStatusCode();                                return await httpResponse.Content.ReadAsStringAsync();                          };the server validates the user and password. and passes ok on JwtSecurityTokenHandler.but on hubs/chat/negotiate it returns the 401 (Unauthorized).what i found out is it does not enter on the options.TokenValidationParameters part on jwtbearer.i followed  #2431 that was recently closed but no success.
4277	area-mvc	Update the ExceptionHandlerMiddleware to support getting the path to redirect to via LinkGenerator	Today, the web app project templates have a block like this:``` c#if (env.IsDevelopment()){    app.UseDeveloperExceptionPage();}else{    app.UseExceptionHandler("/Error");    app.UseHsts();}```Note the string literal parameter in the call to `app.UseExceptionHandler`. That string (in this case) is the path to a Razor Page (*~/Pages/Error.cshtml*), but as it's a string literal, if the page's route changes (e.g. because its name changes or another route for it is configured) this string path will now be wrong.It would be great if the middleware allowed the user to specify the path using a `LinkGenerator` (expression?) such that strongly-typed paths to MVC endpoints in 2.2 (and in 3.0 any endpoint) could be done.@rynowak @JamesNK 
3836	area-infrastructure	Create VSTS build definition to upload symbols to VS automatically.	
4192	area-middleware	Fetch ISession data from client code without refreshing the session	I need to check whether a session is not expired in my client code. But by polling each few minutes HTTP GET and checking session status I'm extending the actual session. Which means unless the user closes the browser tab session will never be expired. Is there any way to specify which GET requests should not extend the session? "Microsoft.AspNetCore.App" Version="2.1.4" installed
5339	area-signalr	Add ability to send pre-serialized data for efficiency	There's a pattern where you're sending data that's already serialized from another system (like a message bus) to the clients without first de-serializing and re-serializing. Here's an example:https://github.com/gcsuk/Achievements/blob/f54479ca595bcf62fa17177b0ec101a7b918d8a5/src/Achievements/Achievements/EventListener.cs#L66-L76The above code gets a utf8 JSON encoded message from the queue, turns it into a string, then turns that string into a `UserAchievement<string>` object. Then it calls IHubContext.User(...).SendAsync which turns that object back into a utf8 byte[] payload to send on the wire.We should introduce a new type that encodes this information that IHubProtocols have native support for. Some considerations:- If connected clients are various protocols, what do we do? Do we store type information so that we can de-serialize in the original format and re-serialize in the correct format?
4917	area-mvc	XML Model State Validation	#### Feature Request#### Description of the problem:On JSON content-negotiation formatting, all exception are wrapped into a ModelState validation which provides flexibility for each controllers to decide the handling on the bad input models. #### Steps to reproduce1) Configure XML Formatters for content-negotiation on .NET Core Web API```builder.AddMvcOptions(options =>{       options.InputFormatters.Add(new XmlSerializerInputFormatter(options));       options.OutputFormatters.Add(new XmlSerializerOutputFormatter());});```2) Submit an invalid XML input(e.g. invalid XML root)**C# Model**```[DataContract(Namespace = "")][XmlRoot("Request")]public class Request{        [Required]        [DataMember]        public string Attribute{ get; set; }}```**Client Input(take note on XML root)**```<Request1> <Attribute>attribute1</Attribute>	<Request1>```3) XML formatter will throw **InvalidOperationException** which does not propagate down to filters/controllers and Exception Middlewares will catch the exceptions with a message - _There is an error in XML document_#### Question:Are there any plans in roadmap to have the similar handling for ModelState wrapping on XML Serialization?
3829	area-servers	Event log whether websockets, auth, etc. is enabled or not.	
3831	area-servers	Verify IISCertificateMappingAuthenticationModule support in inproc/outofproc	
4715	area-servers	Implement HPack dynamic compression	Today Kestrel does not use any of the HPack compression features when serializing response headers. Dynamic compression is an advanced option we could look into.Likely candidates:- Server: Kestrel- Content-Encoding: gzip- Content-Encoding: brotli - Content-Type (and a dozen common values)- strict-transport-securityNote the client gets more benefits from dynamic compression, especially browsers, they send a lot of repetitive headers. HttpClient would get some benefit for things like :authority, :method, :scheme, accept-encoding, Related work:- Static compression #2950- Huffman encoding #2683
4716	area-servers	Implement HPack static compression	Today Kestrel does not use any of the HPack compression features when serializing response headers. Static compression looks like the easiest place to start.Design notes:- The static table is here: https://tools.ietf.org/html/rfc7541#appendix-A- Make an enum that maps to the static header names. Associate this with the known headers in the response header collection.- Rather than passing in an enumeration of `<string, string>` to the encoder, come up with another structure that allows passing in either the enum values or the strings.- Stretch: the :status pseudo header has 7 static entries that include common values. All of the other static header values are request headers (though shared code with HttpClient would want to take advantage of those).Related work:- Dynamic compression #2951- Huffman encoding https://github.com/aspnet/KestrelHttpServer/issues/2683
5600	area-mvc	Support for an element extension mechanism	One use-case for having an extension mechanism on existing elements is already given here: https://github.com/aspnet/Blazor/issues/404#issuecomment-413037767, which can be used for form validation and the like. I didn't get any response on that so I will provide a little more extensive description this time to see if there is some interest. This time will be about providing a typed manner for Bootstrap concepts. Let say we want to write:```html <ul Type="ListGroup">    <li Active>First item</li>    <li>Second item</li>    <li>Third item</li> </ul>```instead of:```html <ul class="list-group">    <li class="list-group-item active">First item</li>    <li class="list-group-item">Second item</li>    <li class="list-group-item">Third item</li> </ul>```and this:```html<nav Type="Navbar" Expand="S" Color.Background="Dark" NavbarDark>   <a Brand href="#">Logo</a>   <ul>      <li><a href="#">Link 1</a></li>      <li><a href="#">Link 2</a></li>      <li><a href="#">Link 3</a></li>   </ul></nav>```instead of:```html<nav class="navbar navbar-expand-sm bg-dark navbar-dark">  <a class="navbar-brand" href="#">Logo</a>  <ul class="navbar-nav">    <li class="nav-item">      <a class="nav-link" href="#">Link 1</a>    </li>    <li class="nav-item">      <a class="nav-link" href="#">Link 2</a>    </li>    <li class="nav-item">      <a class="nav-link" href="#">Link 3</a>    </li>  </ul></nav>```and get those extended attributes, Type, Expand, Color, etc. in a typed manner!To describe how that can be accomplished I am getting into muddy waters… so take it with a grain of salt… but I am imagining a way to specify those extensions similar to this```cs[ElementExtension(AttributeName = "Type", TargetElements = "ul, div")]public class ListType : ISingleValueProperty{   [Parameter]   [StringLiteralConversion]    ListGroupValue Value { get; set; }   void OnContentBegin(builder, renderSettings);  // Extends class attribute during render}[ElementExtension(AttributeName = "Colors", ExcludeType = ElementType.VoidElement)]public class Colors : IMultipleValueProperty{   [Parameter]   [StringLiteralConversion]    ContextualTextColor Text { get; set; }   [Parameter]   [StringLiteralConversion]    ContextualBackgroundColor Background { get; set; }   void OnContentBegin(builder, renderSettings);  // Extends class attribute during render}  //...```1) Render extension hooks:Now we get into even muddier waters to talk about hooks into the render-builder… but see it as something to spur your thinking. I think it will be easiest to have a combination of run-time-calls and design-time-services, like having the calls```csAction<Builder, ExtensionRenderSettings> OnAddArgument;Action<Builder, ExtensionRenderSettings> OnContentBegin;Action<Builder, ExtensionRenderSettings> OnContentEnd;```which are present in the cases when a design-time service returns them```csbool TryGetOnAddArgument(parsed-argument-nodes??,     out Action<Builder, ExtensionRenderSettings> onAddArgument,     out ExtensionRenderSettings renderSettings)```But I am open to any suggestions. In addition, I expect there will be a need to resolve parameters at design-time also, thus the conversion attributes and in this case from string literals to replace their typed counterpart in the generated c# file.2) Parameter tags:Somewhat semi-related is that I think it would make sense to allow these extended attributes to be set as tags also. Especially when it comes to multi-value settings of columns in a grid, etc., but I haven’t explored that. It relates somewhat also to this comment https://github.com/aspnet/Blazor/pull/1404#issuecomment-420968030.3) Parameter tag constructs:Having same construct of tags referring to a mix of types and parameters can get it even more convoluted then. Do you think it will make sense do introduce an attribute at module level to configure it, so that one can try different styles before it is settled?```[PropertyPrefix(PrefixType: ParentComponentName)]   // As in <MyPage.Header />[PropertyPrefix("@Parent.", PrefixType: Fixed)]     // As in <@Parent.Header />[PropertyPrefix("_.", PrefixType: Fixed)]           // As in <_.Header />, fixed placeholder for parent.```@SteveSandersonMS I mentioned point 2 and 3 here just so you can reflect on it with respect to this idea also. I think this mechanism would be very powerful, although I must admit I am new to both Blazor and Bootstrap. I have a third use-case that could use this extension mechanism for another time.Is this of any interest? Any thoughts?
5599	area-mvc	On create project with template Blazor ASP.Net core hosted on run show this error	Серьезность	Код	Описание	Проект	Файл	Строка	Состояние подавленияОшибка	MSB3073	выход из команды "dotnet "C:\Users\Zver\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\../tools/illink/illink.dll" -l none -c link -u link -b true -t --verbose  -d "C:\Users\Zver\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\../tools/mono/bcl/" -d "C:\Users\Zver\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\../tools/mono/bcl/Facades/" -o "C:\Users\Zver\Projects\wasm\CRUD\CRUD.Client\obj\Debug\netstandard2.0\blazor/linker/" -x "C:\Users\Zver\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\BuiltInBclLinkerDescriptor.xml" -x "C:\Users\Zver\Projects\wasm\CRUD\CRUD.Client\obj\Debug\netstandard2.0\blazor\linker.descriptor.xml" -a "C:\Users\Zver\.nuget\packages\microsoft.aspnetcore.blazor\0.5.1\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.dll" -a "C:\Users\Zver\.nuget\packages\microsoft.aspnetcore.blazor.browser\0.5.1\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.Browser.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.csharp\4.5.0\lib\netstandard2.0\Microsoft.CSharp.dll" -a "C:\Users\Zver\.nuget\packages\microsoft.entityframeworkcore\2.1.2\lib\netstandard2.0\Microsoft.EntityFrameworkCore.dll" -a "C:\Users\Zver\.nuget\packages\microsoft.entityframeworkcore.abstractions\2.1.2\lib\netstandard2.0\Microsoft.EntityFrameworkCore.Abstractions.dll" -a "C:\Users\Zver\.nuget\packages\microsoft.entityframeworkcore.relational\2.1.2\lib\netstandard2.0\Microsoft.EntityFrameworkCore.Relational.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.caching.abstractions\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Caching.Abstractions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.caching.memory\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Caching.Memory.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.configuration\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Configuration.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.configuration.abstractions\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Configuration.Abstractions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.configuration.binder\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Configuration.Binder.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.dependencyinjection\2.1.1\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.dependencyinjection.abstractions\2.1.1\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.Abstractions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.logging\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Logging.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.logging.abstractions\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Logging.Abstractions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.options\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Options.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.primitives\2.1.1\lib\netstandard2.0\Microsoft.Extensions.Primitives.dll" -a "C:\Users\Zver\.nuget\packages\microsoft.jsinterop\0.5.1\lib\netstandard2.0\Microsoft.JSInterop.dll" -a "C:\Users\Zver\.nuget\packages\mono.webassembly.interop\0.5.1\lib\netstandard2.0\Mono.WebAssembly.Interop.dll" -a "C:\Users\Zver\.nuget\packages\mysqlconnector\0.44.1\lib\netstandard2.0\MySqlConnector.dll" -a "C:\Users\Zver\.nuget\packages\newtonsoft.json\11.0.2\lib\netstandard2.0\Newtonsoft.Json.dll" -a "C:\Users\Zver\.nuget\packages\pomelo.entityframeworkcore.mysql\2.1.2\lib\netstandard2.0\Pomelo.EntityFrameworkCore.MySql.dll" -a "C:\Users\Zver\.nuget\packages\pomelo.jsonobject\2.0.0\lib\netstandard2.0\Pomelo.JsonObject.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\remotion.linq\2.2.0\lib\netstandard1.0\Remotion.Linq.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.buffers\4.4.0\lib\netstandard2.0\System.Buffers.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.collections.immutable\1.5.0\lib\netstandard2.0\System.Collections.Immutable.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.componentmodel.annotations\4.5.0\lib\netstandard2.0\System.ComponentModel.Annotations.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.diagnostics.diagnosticsource\4.5.0\lib\netstandard1.3\System.Diagnostics.DiagnosticSource.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.interactive.async\3.1.1\lib\netstandard1.3\System.Interactive.Async.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.linq\4.1.0\lib\netstandard1.6\System.Linq.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.linq.expressions\4.1.0\lib\netstandard1.6\System.Linq.Expressions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.linq.queryable\4.0.1\lib\netstandard1.3\System.Linq.Queryable.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.memory\4.5.1\lib\netstandard2.0\System.Memory.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.numerics.vectors\4.4.0\lib\netstandard2.0\System.Numerics.Vectors.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.objectmodel\4.0.12\lib\netstandard1.3\System.ObjectModel.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit\4.0.1\lib\netstandard1.3\System.Reflection.Emit.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit.ilgeneration\4.0.1\lib\netstandard1.3\System.Reflection.Emit.ILGeneration.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit.lightweight\4.0.1\lib\netstandard1.3\System.Reflection.Emit.Lightweight.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.typeextensions\4.1.0\lib\netstandard1.5\System.Reflection.TypeExtensions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.runtime.compilerservices.unsafe\4.5.1\lib\netstandard2.0\System.Runtime.CompilerServices.Unsafe.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.threading\4.0.11\lib\netstandard1.3\System.Threading.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.threading.tasks.extensions\4.3.0\lib\netstandard1.0\System.Threading.Tasks.Extensions.dll" -a "C:\Users\Zver\Projects\wasm\CRUD\CRUD.Shared\bin\Debug\netstandard2.0\CRUD.Shared.dll" -a "C:\Users\Zver\Projects\wasm\CRUD\CRUD.Client\obj\Debug\netstandard2.0\CRUD.Client.dll"" с кодом 1.	CRUD.Client	C:\Users\Zver\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\Blazor.MonoRuntime.targets	441	
5244	area-mvc	Window is not defined with .net core and Angular Template	It works fine when i run with node Express server (I use @ng-toolkit/universal) But with aspnet core node engine throwing NodeInvocation Exception Reference Error: Window is not defined in a third party modules like ngx-bootstrap and angular-jwt.
4717	area-servers	Allow setting InitialWindowSize lower than the protocol default	This is a spinoff of https://github.com/aspnet/KestrelHttpServer/issues/2814. Setting the initial window size to any value larger than the protocol default is easy and was implemented in the first PR. However small servers may want lower values to save memory. Setting the window size to a value lower than the default requires some additional juggling that we weren't prepared for yet. The root of the problem is that the client is allowed to send frames immediately after opening the connection using the default limits. They don't have to wait for the server's settings frame that may lower the limits. This means the server can't enforce a limit lower than the protocol default until it gets a settings ack.Proposal:- Implement the settings ack timeout #2901 to make sure we can eventually enforce the limits.- Use the protocol default values for the pipe and stream window size initially. See the note about connection windows below.- Lowering the window size for the connection is trickier. The settings frame only applies to streams, there's no way to send a negative connection window update to the client. We have to start with the default value and then lower it by skipping/shrinking normal window updates that would have restored the window to the original size. At least this isn't dependent on the settings ack.- When we get the settings ack we can lower the window size for streams accordingly. This may temporarily make them go negative, but that's OK so long as the client doesn't send any more data in the meantime.- Pipes don't have a way to lower their limits [yet](https://github.com/dotnet/corefx/issues/30689), but that's not required here, it's only a safety mechanism. The flow control window should prevent too much data from being written to the pipe. There's an Assert if we ever hit back pressure from the stream pipes.Note InitialWindowSize was split into InitialConnectionWindowSize and InitialStreamWindowSize 
5243	area-mvc	Targeting .NET Core 2.1 - Startup error for new Aurelia WebApp - JsonReaderException: Unexpected character encountered while parsing value: <. Path '', line 0, position 0	Problem can be seen in dotnet/core#1726, dotnet/corefx#30962,My point is to make config option in WebpackDevMiddlewareOptions, which to allow HttpClient to use  WinHttpHandler or SocketsHttpHandler on a call-by-call basis.**Sockets Performance and SocketsHttpHandler**https://blogs.msdn.microsoft.com/dotnet/2018/04/11/announcing-net-core-2-1-preview-2/I'am under corporate proxy when I switch off it all working fine PS:I get copy of source code and where HttpClient is created I put```C#            HttpClientHandler handler = new HttpClientHandler()            {                UseProxy = false            }            _client = new HttpClient(handler);```now all working finescreenshot from debug ![image](https://user-images.githubusercontent.com/383517/45871787-f8b29f80-bd96-11e8-83ba-e980d6ac085a.png)
4718	area-servers	Route arguments are weirdly decoded	Hi,So currently Kestrel seems to have made an odd choice to weirdly decode route arguments.An ASP.NET Core web application doesn't get to see the real route arguments which a client has sent, but equally doesn't get presented with properly URL decoded arguments either. It doesn't follow any standard decoding algorithm and sort of returns an unexpected result.For example, a route argument would decode `%3A`, but wouldn't decode `%2F`. This is extremely annoying, because code which works with route arguments doesn't really know what is going on. Is the string already decoded or not? There is also no function in the standard library which would help to correctly decode the remaining encoded parts of a route argument. If the string value would be passed into `WebUtility.UrlDecode` then it would create bugs, because the `+` sign would get decoded twice.I would like to propose that Kestrel, the web server, shouldn't take the decision to decode any route arguments and leave that responsibility up to the actual framework on top of it (MVC, NancyFx, Giraffe, etc.). As a framework author it would make more sense to give this control to the web framework which might want to see the original URL which a client has actually called.
5821	area-identity	Improve UserManager accessibility	I was trying to override the `CreateAsync` method [here ](https://github.com/aspnet/Identity/blob/ed28df1236db01d75463f40bcf58d9e960a206a9/src/Core/UserManager.cs#L466-L483) but I lose access to `UpdateSecurityStampInternal(TUser user)` and `GetUserLockoutStore()`. It would be helpful to make the stores as well as the updating of the security stamp accessible on derived classes.
5242	area-mvc	ConditionalProxyMiddleware attempts to proxy incoming WebSocket upgrade requests	Moved from https://github.com/aspnet/SignalR/issues/2990It looks like the ConditionalProxyMiddleware just tries to forward any incoming HTTP request to it's target, but because it doesn't check the `Connection` header, it causes errors if a WebSocket request arrives. The middleware attempts to send a matching request using HttpClient, but that means it sets the `Connection` header and the `Upgrade` header and things seem to blow up.The ConditionalProxyMiddleware should just let the request pass through if the `Connection` header is set to `Upgrade` since `HttpClient` does not support sending Upgrade requests.
5598	area-mvc	Consider splitting up AddAttribute functionality for elements/components	Based on: https://github.com/aspnet/Blazor/pull/1453#discussion_r219171895We have a bunch of overloads of `AddAttribute` but we could potentially reduce runtime complexity by making more decisions at compile time based on whether we're operating on a component or an element.
3542	area-servers	FlushAsync doesn't actually write data to the client?	_From @drauch on Tuesday, 11 September 2018 10:39:35_I have a Razor view which (as a minimal repro sample) looks like this:    @{ var longStr = new string('x', 100 * 1024); /* more than 64KB */ }    ...    @functions { string Throw () { throw new Exception(); } }    ...    <p>@longStr</p>    @await FlushAsync()    <p>@Throw()</p>I expected to see many x on the client, instead I see a proper error page. How is this possible if `FlushAsync` already sent `longStr` to the client? Is the data still buffered somewhere on the server?_Copied from original issue: aspnet/KestrelHttpServer#2912_
4916	area-mvc	Remove need for users to special-case second and later clients	#### Is this a Bug or Feature request?Enhancement that's part of #7947#### Steps to reproduce (preferably a link to a GitHub repo with a repro project)See https://github.com/dougbu/CodeGeneration repo and its [`ClientConsole` project](https://github.com/dougbu/CodeGeneration/blob/fbc0e82aa186f4d8de2ba7ece21f87d550be1817/ClientConsole/ClientConsole.csproj). Lines of particular interest are https://github.com/dougbu/CodeGeneration/blob/fbc0e82aa186f4d8de2ba7ece21f87d550be1817/ClientConsole/ClientConsole.csproj#L23-L26#### Description of the problemNSwag code generation creates `Exception` classes by default. Unfortunately, these classes are not nested and do not have unique names. So, when multiple generated clients are included in a project, compilation errors ensue.This is not mandatory for the Preview3 milestone because multiple generated clients per project is a grow-up scenario and users _can_ provide the necessary `%(NSwagCSharpCodeGeneratorOptions)` metadata to avoid problems.Most likely fix is to update the [`GetProjectReferenceMetadata`](https://github.com/aspnet/Mvc/blob/792d5b49a27f5d4d99b3238019deaed5ba9eca0f/src/Microsoft.Extensions.ApiDescription.Client/GetFileReferenceMetadata.cs) task to add `FirstForGenerator` metadata to the relevant items.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the features/client.code.generation branch branch. That work is intended for the 2.2 Preview 3 milestone.
4915	area-mvc	Address problems loading `System.Threading` in dotnet-getdocument inside man	#### Is this a Bug or Feature request?Bug that's part of #7947#### Steps to reproduce (preferably a link to a GitHub repo with a repro project)1. download https://github.com/dougbu/CodeGeneration repo2. install relevant tools and packages locally3. `dotnet build` in repo's ClientConsole folder##### ExpectedSmooth build##### Actual```Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'System.Threading, Version=4.1.1.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040)     at System.Console.get_IsOutputRedirected()     at Microsoft.Extensions.ApiDescription.Client.Program.Main(String[] args)```#### Description of the problemSince builds from the root of the project work much better, it appears something goes awry when the ClientConsole project builds the p2p references. Need to see if, for example, the build from root builds the web site projects differently.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the features/client.code.generation branch branch. That work is intended for the 2.2 Preview 3 milestone.
5338	area-signalr	HubCallerContext as an injectable	Are there any plans to make HubCallerContext an injectable? This would be nice as IHubContext<> doesn't contain any information about the current user making the request.I can manually pass around a user context to my services, but it would be better to inject this.
4211	area-mvc	Inbound route parameter transformer	As discussed at EndpointCon 2018
4719	area-servers	[Discussion] Kestrel Connection Adapter Logging Namespace Changes	The logging namespaces for Kestrel's HttpsConnectionAdapter and LoggingConnectionAdapter are changing in 2.2.0.1. The `HttpsConnectionAdapter` logging namespace is now `Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionAdapter`.2. The `LoggingConnectionAdapter` logging namespace is now `Microsoft.AspNetCore.Server.Kestrel.Core.Adapter.Internal.LoggingConnectionAdapter`.Here's an example HttpsConnectionAdapter log prior to the change:```dbug: HttpsConnectionAdapter[2]      Authentication of the HTTPS connection timed out.```And after:```dbug: Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionAdapter[2]      Authentication of the HTTPS connection timed out.```
5938	area-hosting	TestServer.CreateClient :  the HttpClient created didn't support well the cancellation.	Hello,I just found a nasty bug on HttpClient created from TestServer.When I call a request which took 2 seconds if I cancel it after one second.The client created by test server didn't throw an OperationCancelledException.Here the code with real httpClient :```var httpClient = new HttpClient();using (var cts = new CancellationTokenSource(TimeSpan.FromSeconds(1))){    var request = new HttpRequestMessage    {        Method = HttpMethod.Get,        RequestUri = new Uri("http://localhost:4242/TimeoutTest/Action2Secs")     };     await httpClient.SendAsync(request, HttpCompletionOption.ResponseContentRead, cts.Token);}```The same code with client created by the class TestServer. ```var httpClient = new testServer.CreateClient();using (var cts = new CancellationTokenSource(TimeSpan.FromSeconds(1))){    var request = new HttpRequestMessage    {        Method = HttpMethod.Get,        RequestUri = new Uri("http://localhost:4242/TimeoutTest/Action2Secs")     };     await httpClient.SendAsync(request, HttpCompletionOption.ResponseContentRead, cts.Token);}```
5597	area-mvc	Intellisense or language service error	1. have `<td></td>`2. Put caret between `<td>|</td>`3. Press Enter4. Type `@if (` fast. After typing `(` the additional `if` appears.![image](https://user-images.githubusercontent.com/4257079/45607604-5c735a80-ba6f-11e8-9e8e-81bb72d43589.png) 
5596	area-mvc	Add Blazor templates for ASP.NET Core 2.2	Visual Studio doesn't show "Blazor" project template:![IMG1](https://jy6aig.am.files.1drv.com/y4mauLwTx069pbd96LhWvNZx5BPsgsnmIdSAlWlzLbNhPHf2iI3eNqBe_0_vvl5Px4w7YynXwGSQ4eQtsYVPMuabrqf816F1kQiewqcDOiT5FIPT8M0VhGbdkLf30ZMqCfCpW3BZ2tGOqTlJ9F-Wnt4SmRxHiH82YcE7uUcUg1nRXmPmIlEoqIIEOeYDEcr_Xq7LjFgVIFaSXq5xrW3l2WGIA?width=786&height=553&cropmode=none)Blazor Language Services extension is installed:![IMG2](https://jy41lw.am.files.1drv.com/y4m7S5LiH6O4ORVvwP67fxjaMpHLPUXjeh8oRIGzEWFkZE4yeLrh9qq-yLQlrNDkTAkrzZC7TE-HuIsZu7nUMAGi4EiRQBvcJF_0efDpcePYwiFKR8rILP2EJs06QiVgbycHx9uiNbjZH7JEesLwHi8drGbyEBNw9CPkEck5RGclG_jINk-PD4ZKHdTAog1gPPi-fJkRmmMVnjzOoa-jmxE9w?width=941&height=653&cropmode=none)**Configuration**:- VS 2017 15.9.0 Preview 2- .NET Core 2.2.100-preview2-009404- SDK: 2.2.100-preview2-009404- OS: Windows 10 Home x64
5337	area-signalr	What is default Javascript SignalR Client AuthenticationScheme?	HelloI have two clients for my SignalR app: Javascript client for web browsers and Android client ([Gurgen/SignalR-.net-core-android-client][1]) that use JWT Bearer Authentication.I added this attribute to my SignalR Hub:    [Authorize(AuthenticationSchemes = JwtBearerDefaults.AuthenticationScheme + "," + CookieAuthenticationDefaults.AuthenticationScheme)]    public class MyHub : HubAnd my _Startup.cs_ file:            public void ConfigureServices(IServiceCollection services)            {            //…            services.AddAuthentication()                .AddCookie(cfg => cfg.SlidingExpiration = true)                .AddJwtBearer(options =>                {                    options.RequireHttpsMetadata = false;                    options.SaveToken = true;                    options.TokenValidationParameters = new TokenValidationParameters()                    {                        ValidIssuer = Configuration["Tokens:Issuer"],                        ValidAudience = Configuration["Tokens:Issuer"],                        IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(Configuration["Tokens:Key"]))                    };                });            services.AddSignalR();            //…Android client login successfully with header authentication bearer token. **But** web client comes failed connecting to the hub (401 Unauthorized).When I remove [Authorize] attribute the javascript client works!What is default Javascript SignalR Client AuthenticationScheme? Or what is the issue I made?I use Microsoft.AspNetCore.SignalR and my IDE is Visual Studio for Mac on Mac OS.  [1]: https://github.com/Gurgen/SignalR-.net-core-android-client
4720	area-servers	Remove the unsafe code from Kestrel	This is more of an aspirational goal instead of something we would immediately do but we should have enough primitives in the BCL now that this is viable. Of course there might be a tiny performance hit but it might be worth it if we can remove all of the unsafe code.cc @DamianEdwards @blowdart @halter73 @KrzysztofCwalina @benaadams 
5241	area-mvc	Angular 6 multi project SPA 	Hi, I have a solution with two Angular 6 "projects", one for the desktop app, one for the mobile app.In dev it works fine with : ```c#app.MapWhen((context) =>{    return context.Request.Path.StartsWithSegments("/mobile");}, (mobileApp) =>{      mobileApp.UseSpa((spa) =>      {               spa.Options.SourcePath = "ClientApp";               if (env.IsDevelopment())               {                  spa.UseAngularCliServer("start:mobile");               }        });           }); app.UseSpa(desktop => {       desktop.Options.SourcePath = "ClientApp";       if (env.IsDevelopment())       {             desktop.UseAngularCliServer(npmScript: "start");       }});```But in production they are deployed in wwwroot : * wwwroot/desktop* wwwroot/mobileAnd I am able to access only one of these application because of the```c# services.AddSpaStaticFiles(configuration =>            {                configuration.RootPath = "wwwroot/desktop";             });```To solve this I am thinking of :* Putting the mobile directory inside the desktop one* Wrinting a custom SpaStaticFileProvider (dont known if it is possible)Any recommandation would be very nice.thx
5092	area-mvc	C# 8 Readiness	We need to evaluate and update Razor for C# 8. This will align with 3.0https://github.com/dotnet/csharplang/milestone/8https://channel9.msdn.com/Events/dotnetConf/2018/S103
5336	area-signalr	Allow signalr-protocol-msgpack to be use with UMD	Could you pls export this module as namespace as well ?(same treatment given to the signalr npm package https://github.com/aspnet/SignalR/issues/951 )![image](https://user-images.githubusercontent.com/1522516/45550546-6573ea00-b82b-11e8-909a-df94a2fb3390.png)Thanks
5595	area-mvc	[Suggestion] Self closing tags	This is not really an issue, just that it would be good to have. Right now the intellisense cannot detect components that should not have closing tags(or does not need them) e.g. `<div></div>`, but instead they would have a "_self-close_" tag e.g. `<input />` or `<img />`.Possible use case would be for components that does not have `ChildContent`. For example I have an Icon component and I define the icon name through the `Name `parameter so `ChildContent `is not needed. But every time I use it, the VS intellisense will generate closing tag.**Current behavior:**`<Icon Name="user"></Icon>`**Wanted:**`<Icon Name="user" />`Maybe this is not connected to the Blazor team but to the VS team instead, please ignore in that case.
5594	area-mvc	Server side blazor does not trigger @bind update for auto filled input fields	I have a test app with a login form with a username and password input, both bound to string properties on the model. It works correctly if I manually enter values in these fields (the string properties get updated from the @bind directive).If the browser has a cached username / password combination and I select auto fill for these fields, the fields do get filled (visually on the page) but the bound password property does not get updated (the username does). The password field does get filled correctly on the browser, if I make any change to the field (add a space for example), the string password property does get updated.It looks like whatever event is used to trigger the update does not get processed correctly or does not fire for the auto filled password. I have not tested with other auto filled form fields.This was tested on Safari & Edge. When exactly the same code is used compiled for client side Blazor it works 100%. 
6026	area-identity	Microsoft.AspNetCore.Authentication.AzureAD.UI is not support v2.0 endpoint?	I want to use 'AddAzureADBearer' method with v2.0 endpoint (from Application Registration Portal), but it seems to be not supported. Do I have to use this sample? https://github.com/Azure-Samples/active-directory-dotnet-native-aspnetcore-v2/blob/master/TodoListService/Extensions/AzureAdAuthenticationBuilderExtensions.cs
4721	area-servers	Memory consumption by Idle HTTPS/TLS Connections	[Reposting from an e-mail thread]When I was doing IoT for example, we measured that an idle HTTPS/TLS connection can suck as much as 128 KB of memory.  For Gateway scenarios, where connections can be mostly idle, but they need to be there this is very expensive.  If I remember correctly the problem was SSL libraries requiring a couple of 32KB or 64KB buffers no matter what.Ideally, you want 'idle' connections to truly cost 0 Bytes of memory or very close to it.  And this is relatively simple to test, create a HTTPS server with 100,000 TLS connections doing nothing, take note of the Commit Bytes, divide by 100,000.Do you know in .NET Core what is the cost?A lot of that overhead is cached request structures and pipe buffers designed to make active connections faster. We could consider discarding some of those cached objects if the connection is idle for a certain period of time. What if we only held it via a weak reference when the connection was idle?
5593	area-mvc	Please add Blazor sample with ML.NET	Blazor allows us to use .NET Core features. Now that the .NET Core supports machine learning, it would be very helpful to learn how we can use ML.NET features with Blazor on the client side.If this works, we could perform machine learning on the client side or server side using our web apps.
5091	area-mvc	Parser computes the wrong length for C# code with an escaped transition	The parser parses the following code into the correct C# but gets the length wrong - it includes `@@` when computing the length. ```@{ @@Da }```I'm not aware of the impact of this issue. This is somewhat unlikely to occur, and would only happen when someone needs to use a verbatim identifier in C# from Razor. This could cause a variety of incorrect editor behaviors including issues with completion or crashes.Found while investigating #2266
5090	area-mvc	Parser treats the whitespace between a directive and its first token as C#	The parser incorrectly maps the whitespace text that appears below into C# (syntax tree). Since this token isn't significant in any way, it gets thrown away harmlessly instead of mapped into the C# editor buffer. ```@page "foo"```So what I'm saying is that the 'space' character above is treated as C# by the buffer instead of metacode/none. Unfortunately the fix for this breaks completion for partial parsing. So it looks like we cut a corner or two when implementing this to make it easier to support completion.  Found while implementing #2266
4722	area-servers	Allow the encoder to split headers across frames	The HPackEncoder has a potential infinite loop today.https://github.com/aspnet/KestrelHttpServer/blob/55e5e564226e7b27742c91f46ea71841071e4ac3/src/Kestrel.Core/Internal/Http2/HPack/HPackEncoder.cs#L35-L42EncodeHeader returns false if it does not have enough space to encode the value. If this header was larger than max frame size then no data will be available for the frame at all and length will be 0. The server will be stuck in an infinite loop sending zero length continuation frames.https://github.com/aspnet/KestrelHttpServer/pull/2893 added an exception to break the infinate loop, but it did so by throwing and very ungracefully aborting the socket.Proposal: The spec allows splitting encoded headers across frames. This would allow the encoder to pack frames more densely and always make progress.Priority: Not urgent, the response header would need to be larger than the max frame size (16kb). The client and server can also raise that frame size.  Implementing real response header compression would allow even larger values before hitting the frame size limit.
4155	area-hosting	IHostingEnvironment/appsettings configuration file dichotomy	`IHostingEnvironment` has an extension method `IsEnvironment(string environment)` and other similar [methods like `IsProduction()` that are case-insensitive](https://github.com/aspnet/Hosting/blob/master/src/Microsoft.AspNetCore.Hosting.Abstractions/HostingEnvironmentExtensions.cs#L77).The default/automatic configuration-loading looks for [`$"appsettings.{env.EnvironmentName}.json"`](https://github.com/aspnet/MetaPackages/blob/master/src/Microsoft.AspNetCore/WebHost.cs#L170)This creates a strange dichotomy in which the resolution of the environment is case-insensitive while the resolution of that environment's configuration is not.In the increasingly cross-platform world of .NET Core development (e.g., developing on Windows OS and then using an Alpine Linux container) that dichotomy becomes painful.My anecdote for witnessing this was trying to troubleshoot a production problem by running code locally. We use lowercase environment names, but I was aware of ASP.NET Core's default environment of "Production" (and its case-insensitivity while determining env.), so I left out the specification of the environment. I was getting wildly different results even though any environment-dependent code paths were correct - because the configuration was wrong while the code path was not.I'd like the team to consider doing something like this:```c#config  .AddJsonFile("appsettings.json", optional: true, reloadOnChange: true)  .AddJsonFile($"appsettings.{env.EnvironmentName.ToUpperInvariant()}.json", optional: true, reloadOnChange: true)  .AddJsonFile($"appsettings.{env.EnvironmentName.ToLowerInvariant()}.json", optional: true, reloadOnChange: true)  .AddJsonFile($"appsettings.{env.EnvironmentName}.json", optional: true, reloadOnChange: true);```It doesn't completely get rid of the dichotomy, but at least it solves for [debatably] the 2 most common letter-case variants.
5592	area-mvc	Unpredictable No element is currently associated with component {ComponentId} 	**Edited to remove the false-positives**Reproducable : https://github.com/aspnet/Blazor/issues/1412#issuecomment-439267547Using Blazor Server SideFrom time to time Blazor throws the following error:`No element is currently associated with component {ComponentId}`The error is always thrown on the first load after a `StateHasChanged`, if you hard refresh the page the error doesn't happen anymore.- Is there a way to see which component has which id?- Is this a known issue?For me this is quite vague and it happends for no certain reason, only from time to time.
5089	area-mvc	Make the debugging experience of the new syntax tree better	Right now the debugging experience for the new tree is very painful. Need to add the necessary `DebuggerDisplay()`s to the syntax nodes to make it easier to understand. This might involve updating the Syntax generator to support it.
5820	area-identity	Does this package have a hard dependency on Microsoft.EntityFrameworkCore 2.1.1?	[reproduce.instructions.pdf](https://github.com/aspnet/Identity/files/2385719/reproduce.instructions.pdf)[Error Message.txt](https://github.com/aspnet/Identity/files/2385720/Error.Message.txt)[qs.site.zip](https://github.com/aspnet/Identity/files/2385721/qs.site.zip)Have upgraded entire project to 2.1.3. or 2.1.2 where necessary.  I've got some typescript-generating T4 template code (a forked version of TypeLite https://www.nuget.org/packages/TypeLite/1.8.4, but the original would suffice) that when run is saying (even though I have everything upgraded to 2.1.3, or 2.1.2 where that's the latest) that it can't load Microsoft.EntityFrameworkCore 2.1.1, even though I have Microsoft.EntityFrameworkCore 2.1.3 installed. The whole project works unchanged with 2.1.2 (or previous versions). Updating to 2.1.3 jacks it up.  Will try and post a bare-bones sample project shortly.[Upgrade Error Info.0.txt](https://github.com/aspnet/Identity/files/2373282/Upgrade.Error.Info.0.txt)I've updated with files and instructions to reproduce. 
4723	area-servers	Microsoft Security Advisory CVE-2018-8409: ASP.NET Core Denial Of Service Vulnerability	# Microsoft Security Advisory CVE-2018-8409: ASP.NET Core Denial Of Service Vulnerability## <a name="executive-summary"></a>Executive summaryMicrosoft is releasing this security advisory to provide information about a vulnerability in ASP.NET Core 2.1. This advisory also provides guidance on what developers can do to update their applications to remove this vulnerability.Microsoft is aware of a denial of service vulnerability when ASP.NET Core improperly handles web requests. An attacker who successfully exploited this vulnerability could cause a denial of service against an ASP.NET Core web application. The vulnerability can be exploited remotely, without authentication. A remote unauthenticated attacker could exploit this vulnerability by providing a specially crafted web requests to the ASP.NET Core application.The update addresses the vulnerability by correcting how ASP.NET Core handles parsing web requests.The underlying problem exists in the `System.IO.Pipelines` package. If you have other software which uses this package please follow the instructions in the [.NET Core bulletin](https://github.com/dotnet/announcements/issues/83).## Original AnnouncementThe original announcement for this issue can be found at https://github.com/aspnet/Announcements/issues/316### <a name="mitigation-factors"></a>Mitigation factorsThere are no mitigating factors for this vulnerability.## <a name="affected-software"></a>Affected softwareAny ASP.NET Core based application that uses either of the packages with a vulnerable version listed below.Package name | Vulnerable versions | Secure versions------------ | ------------------- | -------------------------Microsoft.AspNetCore.All | 2.1.0, 2.1.1, 2.1.2, 2.1.3 | 2.1.4Microsoft.AspNetCore.App | 2.1.0, 2.1.1, 2.1.2, 2.1.3 | 2.1.4System.IO.Pipelines | 4.5.0 | 4.5.1## <a name="advisory-faq"></a>Advisory FAQ### <a name="how-affected"></a>How do I know if I am affected?#### Applications which use Microsoft.AspNetCore.App or Microsoft.AspNetCore.AllASP.NET Core 2.1 is distributed as part of the .NET Core runtime. To check the current installed runtimes open a command prompt and run the `dotnet --info` command. If you have a 2.1 or greater runtime installed you will see output like the following;```.NET Core SDK (reflecting any global.json): Version:   2.1.401 Commit:    91b1c13032Runtime Environment: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.1.401\Host (useful for support):  Version: 2.1.3  Commit:  124038c13e.NET Core SDKs installed:  2.1.4 [C:\Program Files\dotnet\sdk]  2.1.401 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.1.3 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]To install additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download```If the highest .NET Core SDK version is less that 2.1.402 or the highest `Microsoft.AspNetCore.App` runtime version is less that 2.1.4 you are vulnerable to this issue. You may not see any SDK versions if you have only installed the runtime.To update ASP.NET Core 2.1 you should [download](https://www.microsoft.com/net/download) and install the .NET Core SDK 2.1.402 on your development machines and build servers, and the .NET Core Runtime 2.1.4 on your deployment servers. Your application will roll forward to these versions on an application restart.#### Applications not using Microsoft.AspNetCore.App or Microsoft.AspNetCore.AllSystem.IO.Pipelines is distributed both in ASP.NET Core 2.1 and separately as a NuGet package. If you are not using Microsoft.AspNetCore.App or .All, you may still be affected if you are referencing the System.IO.Pipelines package.##### Direct dependenciesDirect dependencies are discoverable by examining your `csproj` file. They can be fixed by [editing the project file](#fixing-direct-dependencies) or using NuGet to update the dependency.##### Transitive dependenciesTransitive dependencies occur when you add a package to your project that in turn relies on another package. For example, if Contoso publishes a package `Contoso.Utility` which, in turn, depends on `Contoso.Internals` and you add the `Contoso.Utility` package to your project now your project has a direct dependency on `Contoso.Utility` and, because `Contoso.Utility` depends 'Contoso.Internals', your application gains a transitive dependency on the `Contoso.Internals` package.Transitive dependencies are reviewable in two ways:* In the Visual Studio Solution Explorer window, which supports searching.* By examining the `project.assets.json` file contained in the obj directory of your project for `csproj` based projectsThe `project.assets.json` files are the authoritative list of all packages used by your project, containing both direct and transitive dependencies.There are two ways to view transitive dependencies. You can either [use Visual Studio’s Solution Explorer](#vs-solution-explorer), or you can review [the `project.assets.json` file](#project-assets-json)).##### <a name="vs-solution-explorer"></a>Using Visual Studio Solution ExplorerTo use Solution Explorer, open the project in Visual Studio, and then press Ctrl+; to activate the search in Solution Explorer. Search for the [vulnerable package](#affected-software) and make a note of the version numbers of any results you find.For example, searching for `Microsoft.AspNetCore.Mvc.Core` in an example project that contains a package that takes a dependency on `Microsoft.AspNetCore.Mvc` shows the following results in Visual Studio 2017:![Screenshot of search results in Visual Studio 2017](https://cloud.githubusercontent.com/assets/796298/25858816/8ecdc2b4-3491-11e7-9363-746804bb9832.png)The search results appear as a tree. In the previous results, you can see that a reference to `Microsoft.AspNetCore.Mvc.Core` version 1.1.2 is discovered.Under the Dependencies node is a NuGet node. Under the NuGet node is the list of packages you have directly taken a dependency on and their versions.In screenshot, the application takes a direct dependency on `Microsoft.AspNetCore.Mvc`. `Microsoft.AspNetCore.Mvc` in turn has leaf nodes that list its dependencies and their versions.The `Microsoft.AspNetCore.Mvc` package takes a dependency on a version of `Microsoft.AspNetCore.Mvc.ApiExplorer`, that in turn takes a dependency on a version of `Microsoft.AspNetCore.Mvc.Core`.##### <a name="project-assets-json"></a> Manually reviewing project.assets.jsonOpen the *project.assets.json* file from your project’s obj directory in your editor. We suggest you use an editor that understands JSON and allows you to collapse and expand nodes to review this file.Visual Studio and Visual Studio Code provide JSON friendly editing.Search the *project.assets.json* file for the [vulnerable package](#affected-software), using the format `packagename/` for each of the package names from the preceding table. If you find the assembly name in your search:* Examine the line on which they are found, the version number is after the `/`.* Compare to the [vulnerable versions table](#affected-software).For example, a search result that shows `System.IO.Pipelines/4.5.0` is a reference to version 4.5.0 of `System.IO.Pipelines`.If your *project.assets.json* file includes references to the [vulnerable package](#affected-software), then you need to fix the transitive dependencies.If you have not found any reference to any vulnerable packages, this means either* None of your direct dependencies depend on any vulnerable packages, or* You have already fixed the problem by updating the direct dependencies.### <a name="how-fix"></a>How do I fix the issue?#### <a name="fixing-direct-dependencies"></a>Fixing direct dependenciesOpen *projectname.csproj* in your editor. If you're using Visual Studio, right-click the project and choose **Edit projectname.csproj** from the context menu, where projectname is the name of your project. Look for `PackageReference` elements. The following shows an example project file:```xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp2.1</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="System.IO.Pipelines" Version="4.5.0" />  </ItemGroup></Project>```The preceding example has a reference to the [vulnerable package](#affected-software), as seen by the single `PackageReference` element. The name of the package is in the `Include` attribute.The package version number is in the `Version` attribute. The previous example shows a single direct dependency on `System.IO.Pipelines` version 4.5.0To update the version to the secure package, change the version number to the updated package version as listed on the table [previously](#affected-software).In this example, update `System.IO.Pipelines` to the appropriate [fixed package number](#affected-software) for your major version. Save the *csproj* file. The example *csproj* now looks as follows:```xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp2.1</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="System.IO.Pipelines" Version="4.5.1" />  </ItemGroup></Project>```If you're using Visual Studio and you save your updated *csproj* file, Visual Studio will restore the new package version.You can see the restore results by opening the **Output** window (Ctrl+Alt+O) and changing the **Show output from** drop-down list to **Package Manager**.If you're not using Visual Studio, open a command line and change to your project directory. Execute the `dotnet restore` command to restore the updated dependencies.Now recompile your application. If after recompilation you see a *Dependency conflict warning*, you must update your other direct dependencies to versions that take a dependency on the updated package.#### <a name="transitive-dependencies"></a>Fixing transitive dependenciesIf your transitive dependency review found references to the [vulnerable package](#affected-software), you must add a direct dependency to the updated package to your *csproj* file to override the transitive dependency.Open *projectname.csproj* in your editor. If you're using Visual Studio, right-click the project and choose **Edit projectname.csproj** from the context menu, where projectname is the name of your project.Look for `PackageReference` nodes, for example:```xml<Project Sdk="Microsoft.NET.Sdk.">  <PropertyGroup>    <TargetFramework>net461</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="ThirdParty.NotUpdatedYet" Version="2.0.0" />  </ItemGroup></Project>```You must add a direct dependency to the updated version of the [vulnerable package](#affected-software) by adding it to the *csproj* file.You do this by adding a new line to the dependencies section, referencing the fixed version.For example, if your search showed a transitive reference to a vulnerable `System.ServiceModel.Http` version, you'd add a reference to the [fixed package number](#affected-software).```xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>net461</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="System.IO.Pipelines" Version="4.5.1" />    <PackageReference Include="ThirdParty.NotUpdatedYet" Version="2.0.0" />  </ItemGroup></Project>```After you've added the direct dependency reference, save your *csproj* file.If you're using Visual Studio, save your updated *csproj* file and Visual Studio will restore the new package versions.You can see the restore results by opening the **Output** window (Ctrl+Alt+O) and changing the **Show output from** drop-down list to **Package Manager**.If you're not using Visual Studio, open a command line and change to your project directory. Execute the `dotnet restore` command to restore the new dependencies.#### Rebuilding your applicationFinally you must rebuild your application, test, and redeploy.## Other Information### Reporting Security IssuesIf you have found a potential security issue in .NET Core, please email details to secure@microsoft.com. Reports may qualify for the .NET Core Bug Bounty. Details of the .NET Core Bug Bounty including terms and conditions are at [https://aka.ms/corebounty](https://aka.ms/corebounty).### SupportYou can ask questions about this issue on GitHub in the .NET Core or ASP.NET Core organizations. These are located at https://github.com/dotnet/ and https://github.com/aspnet/. The Announcements repo for each product (https://github.com/dotnet/Announcements and https://github.com/aspnet/Announcements) will contain this bulletin as an issue and will include a link to a discussion issue. You can ask questions in the discussion issue.### DisclaimerThe information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.### External Links[CVE-2018-8409](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-CVE-2018-8409)### RevisionsV1.0 (September 11, 2018): Advisory published._Version 1.0__Last Updated 2018-09-11_
3529	area-servers	EnableRewind for HttpResponse similar to HttpRequest	   1. Description of the problem: EnableRewind for HttpResponse similar to HttpRequestThis is more of a feature request than anything. I have need to log the response body but this requires the need for a rewindable response stream. HttpRequest has the extension method defined: BufferingHelper.EnableRewind for HttpRequest. The ask is for a similar extension method for HttpResponse so we don't have to swap out the streams manually ourselves.   2. The version of `Microsoft.AspNetCore.All`: 2.1.2   3. The output of `dotnet --info`.NET Core SDK (reflecting any global.json): Version:   2.1.302 Commit:    9048955601Runtime Environment: OS Name:     Windows OS Version:  10.0.17134 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Program Files\dotnet\sdk\2.1.302\Host (useful for support):  Version: 2.1.2  Commit:  811c3ce6c0.NET Core SDKs installed:  2.0.2 [C:\Program Files\dotnet\sdk]  2.0.3 [C:\Program Files\dotnet\sdk]  2.1.4 [C:\Program Files\dotnet\sdk]  2.1.104 [C:\Program Files\dotnet\sdk]  2.1.201 [C:\Program Files\dotnet\sdk]  2.1.202 [C:\Program Files\dotnet\sdk]  2.1.302 [C:\Program Files\dotnet\sdk].NET Core runtimes installed:  Microsoft.AspNetCore.All 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.All]  Microsoft.AspNetCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.AspNetCore.App]  Microsoft.NETCore.App 2.0.0 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.3 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.5 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.6 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.7 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.0.9 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]  Microsoft.NETCore.App 2.1.2 [C:\Program Files\dotnet\shared\Microsoft.NETCore.App]To install additional .NET Core runtimes or SDKs:  https://aka.ms/dotnet-download
5088	area-mvc	Add unit tests for the new syntax infrastructure	
5087	area-mvc	Improve HTML syntax structure	- Can do this only after #2580 - Define the structure for all other nodes (like separate start tag and end tag) and generate them- Rewrite the parser to incorporate these new nodes in the tree
3825	area-servers	Implement IHttpMaxRequestBodySizeFeature for in-proc	How would this interact with IIS's normal limit? Could it override it? Could users disable the IIS limit and use this more flexible implementation instead?
5441	area-mvc	Generate package names in scripts	Right now have the version of generated packages in our "run templates" scripts. This keeps going out of date and requiring us to update it by hand when it break. Lets instead get the Custom-Hive.ps1 functions to intelligently use the value from version.props.
3826	area-servers	IIS failed to pre-load .Net Runtime	_From @pmtolk on Thursday, 30 August 2018 16:40:18_IIS 10 on a windows server 2016 "The worker process failed to pre-load .Net Runtime version No Managed Code."The windows event viewer shows the following errors### "The worker process failed to pre-load .Net Runtime version No Managed Code."### "The worker process failed to initialize correctly and therefore could not be started. The data is the error."cross posted here https://stackoverflow.com/questions/52086610/asp-net-core-http-error-503-the-service-is-unavailableI am able to run dotnet website.dll from the command line and view it in the web browser but for some reason IIS does not run the asp.net core website.I have installed the windows hosting dotnet core from here as well as the sdkhttps://github.com/dotnet/core/blob/master/release-notes/download-archives/I have set the .net clr version to No Managed CodeI changed the identity to administrator to eliminate potential permission issues```Enable-WindowsOptionalFeature -Online -FeatureName IIS-WebServerRoleEnable-WindowsOptionalFeature -Online -FeatureName IIS-WebServerEnable-WindowsOptionalFeature -Online -FeatureName IIS-CommonHttpFeaturesEnable-WindowsOptionalFeature -Online -FeatureName IIS-HttpErrorsEnable-WindowsOptionalFeature -Online -FeatureName IIS-HttpRedirectEnable-WindowsOptionalFeature -Online -FeatureName IIS-ApplicationDevelopmentEnable-WindowsOptionalFeature -Online -FeatureName NetFx4Extended-ASPNET45Enable-WindowsOptionalFeature -Online -FeatureName IIS-HealthAndDiagnosticsEnable-WindowsOptionalFeature -Online -FeatureName IIS-HttpLoggingEnable-WindowsOptionalFeature -Online -FeatureName IIS-LoggingLibrariesEnable-WindowsOptionalFeature -Online -FeatureName IIS-RequestMonitorEnable-WindowsOptionalFeature -Online -FeatureName IIS-HttpTracingEnable-WindowsOptionalFeature -Online -FeatureName IIS-SecurityEnable-WindowsOptionalFeature -Online -FeatureName IIS-RequestFilteringEnable-WindowsOptionalFeature -Online -FeatureName IIS-PerformanceEnable-WindowsOptionalFeature -Online -FeatureName IIS-WebServerManagementToolsEnable-WindowsOptionalFeature -Online -FeatureName IIS-IIS6ManagementCompatibilityEnable-WindowsOptionalFeature -Online -FeatureName IIS-MetabaseEnable-WindowsOptionalFeature -Online -FeatureName IIS-ManagementConsoleEnable-WindowsOptionalFeature -Online -FeatureName IIS-BasicAuthenticationEnable-WindowsOptionalFeature -Online -FeatureName IIS-WindowsAuthenticationEnable-WindowsOptionalFeature -Online -FeatureName IIS-StaticContentEnable-WindowsOptionalFeature -Online -FeatureName IIS-DefaultDocumentEnable-WindowsOptionalFeature -Online -FeatureName IIS-WebSocketsEnable-WindowsOptionalFeature -Online -FeatureName IIS-ApplicationInitEnable-WindowsOptionalFeature -Online -FeatureName IIS-NetFxExtensibility45Enable-WindowsOptionalFeature -Online -FeatureName IIS-ASPNET45Enable-WindowsOptionalFeature -Online -FeatureName IIS-ISAPIExtensionsEnable-WindowsOptionalFeature -Online -FeatureName IIS-ISAPIFilterEnable-WindowsOptionalFeature -Online -FeatureName IIS-HttpCompressionStatic```Also, I had to change the .csproj to the following to get around conflicting asp.net core versions```  <PropertyGroup>    <TargetFramework>netcoreapp2.0</TargetFramework>    <PublishWithAspNetCoreTargetManifest>false</PublishWithAspNetCoreTargetManifest>  </PropertyGroup>```_Copied from original issue: dotnet/core#1907_
5240	area-mvc	.netCore web application throws exception at UseWebpackDevMiddleware in startup.cs after including custom nuget.	_From @tusharsantoki on Saturday, 11 August 2018 13:40:17_**Application detail =>**.NetCore Version : 2.0File name : Startup.csline number :41 UseWebpackDevMiddleware()Package Reference :  <PackageReference Include="Microsoft.ApplicationInsights.AspNetCore" Version="2.1.1" />    <PackageReference Include="Microsoft.AspNetCore.All" Version="2.0.6" />    <PackageReference Include="Microsoft.PowerBI.Api" Version="2.0.12" />    <PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.0.3" />**Stack trace:**  System.TypeLoadException  HResult=0x80131522  Message=Could not load type 'System.Runtime.Serialization.SerializationBinder' from assembly 'netstandard, Version=2.0.0.0, Culture=neutral, PublicKeyToken=cc7b13ffcd2ddd51'.  Source=Newtonsoft.Json  StackTrace:   at Newtonsoft.Json.JsonSerializer..ctor()   at Newtonsoft.Json.JsonSerializer.Create(JsonSerializerSettings settings)   at Microsoft.AspNetCore.Builder.WebpackDevMiddleware.UseWebpackDevMiddleware(IApplicationBuilder appBuilder, WebpackDevMiddlewareOptions options)   at WebUI.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in    F:\code\UI\WebUI\Startup.cs:line 41**Custom nuget Project details =>**Application Framework : .net Framework 4.6.1Package information :<?xml version="1.0" encoding="utf-8"?><packages>  <package id="Microsoft.ApplicationInsights" version="2.6.4" targetFramework="net461" />  <package id="Microsoft.Azure.KeyVault" version="3.0.0" targetFramework="net461" />  <package id="Microsoft.Azure.KeyVault.Core" version="1.0.0" targetFramework="net461" />  <package id="Microsoft.Azure.KeyVault.WebKey" version="3.0.0" targetFramework="net461" />  <package id="Microsoft.Azure.ServiceBus.EventProcessorHost" version="2.2.10" targetFramework="net461" />  <package id="Microsoft.Azure.Services.AppAuthentication" version="1.1.0-preview" targetFramework="net461" />  <package id="Microsoft.Azure.WebJobs" version="2.2.0" targetFramework="net461" />  <package id="Microsoft.Azure.WebJobs.Core" version="2.2.0" targetFramework="net461" />  <package id="Microsoft.Azure.WebJobs.ServiceBus" version="2.2.0" targetFramework="net461" />  <package id="Microsoft.Data.Edm" version="5.6.4" targetFramework="net461" />  <package id="Microsoft.Data.OData" version="5.6.4" targetFramework="net461" />  <package id="Microsoft.Data.Services.Client" version="5.6.4" targetFramework="net461" />  <package id="Microsoft.Extensions.Logging.Abstractions" version="1.1.1" targetFramework="net461" />  <package id="Microsoft.IdentityModel.Clients.ActiveDirectory" version="3.19.8" targetFramework="net461" />  <package id="Microsoft.IdentityModel.Logging" version="5.2.2" targetFramework="net461" />  <package id="Microsoft.IdentityModel.Protocols" version="5.2.2" targetFramework="net461" />  <package id="Microsoft.IdentityModel.Protocols.OpenIdConnect" version="5.2.2" targetFramework="net461" />  <package id="Microsoft.IdentityModel.Tokens" version="5.2.2" targetFramework="net461" />  <package id="Microsoft.NETCore.Platforms" version="1.1.0" targetFramework="net461" />  <package id="Microsoft.Rest.ClientRuntime" version="2.3.11" targetFramework="net461" />  <package id="Microsoft.Rest.ClientRuntime.Azure" version="3.3.12" targetFramework="net461" />  <package id="Microsoft.Win32.Primitives" version="4.3.0" targetFramework="net461" />  <package id="NETStandard.Library" version="1.6.1" targetFramework="net461" />  <package id="Newtonsoft.Json" version="10.0.1" targetFramework="net461" />  <package id="StackExchange.Redis" version="1.2.6" targetFramework="net461" />  <package id="StyleCop.MSBuild" version="4.7.49.1" targetFramework="net461" developmentDependency="true" />  <package id="System.AppContext" version="4.3.0" targetFramework="net461" />  <package id="System.Collections" version="4.3.0" targetFramework="net461" />  <package id="System.Collections.Concurrent" version="4.3.0" targetFramework="net461" />  <package id="System.Console" version="4.3.0" targetFramework="net461" />  <package id="System.Diagnostics.Debug" version="4.3.0" targetFramework="net461" />  <package id="System.Diagnostics.DiagnosticSource" version="4.4.0" targetFramework="net461" />  <package id="System.Diagnostics.Tools" version="4.3.0" targetFramework="net461" />  <package id="System.Diagnostics.Tracing" version="4.3.0" targetFramework="net461" />  <package id="System.Globalization" version="4.3.0" targetFramework="net461" />  <package id="System.Globalization.Calendars" version="4.3.0" targetFramework="net461" />  <package id="System.IdentityModel.Tokens.Jwt" version="5.2.2" targetFramework="net461" />  <package id="System.IO" version="4.3.0" targetFramework="net461" />  <package id="System.IO.Compression" version="4.3.0" targetFramework="net461" />  <package id="System.IO.Compression.ZipFile" version="4.3.0" targetFramework="net461" />  <package id="System.IO.FileSystem" version="4.3.0" targetFramework="net461" />  <package id="System.IO.FileSystem.Primitives" version="4.3.0" targetFramework="net461" />  <package id="System.Linq" version="4.3.0" targetFramework="net461" />  <package id="System.Linq.Expressions" version="4.3.0" targetFramework="net461" />  <package id="System.Net.Http" version="4.3.0" targetFramework="net461" />  <package id="System.Net.Primitives" version="4.3.0" targetFramework="net461" />  <package id="System.Net.Sockets" version="4.3.0" targetFramework="net461" />  <package id="System.ObjectModel" version="4.3.0" targetFramework="net461" />  <package id="System.Reflection" version="4.3.0" targetFramework="net461" />  <package id="System.Reflection.Extensions" version="4.3.0" targetFramework="net461" />  <package id="System.Reflection.Primitives" version="4.3.0" targetFramework="net461" />  <package id="System.Resources.ResourceManager" version="4.3.0" targetFramework="net461" />  <package id="System.Runtime" version="4.3.0" targetFramework="net461" />  <package id="System.Runtime.Extensions" version="4.3.0" targetFramework="net461" />  <package id="System.Runtime.Handles" version="4.3.0" targetFramework="net461" />  <package id="System.Runtime.InteropServices" version="4.3.0" targetFramework="net461" />  <package id="System.Runtime.InteropServices.RuntimeInformation" version="4.3.0" targetFramework="net461" />  <package id="System.Runtime.Numerics" version="4.3.0" targetFramework="net461" />  <package id="System.Security.Cryptography.Algorithms" version="4.3.0" targetFramework="net461" />  <package id="System.Security.Cryptography.Encoding" version="4.3.0" targetFramework="net461" />  <package id="System.Security.Cryptography.Primitives" version="4.3.0" targetFramework="net461" />  <package id="System.Security.Cryptography.X509Certificates" version="4.3.2" targetFramework="net461" />  <package id="System.Spatial" version="5.6.4" targetFramework="net461" />  <package id="System.Text.Encoding" version="4.3.0" targetFramework="net461" />  <package id="System.Text.Encoding.Extensions" version="4.3.0" targetFramework="net461" />  <package id="System.Text.RegularExpressions" version="4.3.0" targetFramework="net461" />  <package id="System.Threading" version="4.3.0" targetFramework="net461" />  <package id="System.Threading.Tasks" version="4.3.0" targetFramework="net461" />  <package id="System.Threading.Timer" version="4.3.0" targetFramework="net461" />  <package id="System.Xml.ReaderWriter" version="4.3.0" targetFramework="net461" />  <package id="System.Xml.XDocument" version="4.3.0" targetFramework="net461" />  <package id="WindowsAzure.ServiceBus" version="3.4.5" targetFramework="net461" />  <package id="WindowsAzure.Storage" version="7.2.1" targetFramework="net461" /></packages>_Copied from original issue: dotnet/core#1852_
5239	area-mvc	NpmScriptRunner leaves NodeJs running (after test session)	When running the functional tests of my dotnet core / angular app I noticed that the NodeJS processes are not stopped after my tests finishes. After 5 minutes after my tests completed, they are still there... ![image](https://user-images.githubusercontent.com/467692/45259872-531a2c00-b3a5-11e8-8dd7-03556b826fff.png)My NUnit `OneTimeTearDown` also seems to be hanging when that happens. I'm guessing that's because I'm trying to dispose the web server in there![image](https://user-images.githubusercontent.com/467692/45259914-54982400-b3a6-11e8-93c0-c89b4aace3eb.png)I'm creating the server with `_server = new WebApplicationFactory<Startup>()` and calling both `_server.Server?.Dispose();` and `_server?.Dispose();` in the tests' teardown, just in case.The culprit section in `Startup` is:```if (env.IsDevelopment()) {   spa.UseAngularCliServer(npmScript: "start");}```I went through the source a bit and in the [`NpmScriptRunner`](https://github.com/aspnet/JavaScriptServices/blob/7a0413434577274666ff72ee790b53cc71b22970/src/Microsoft.AspNetCore.SpaServices.Extensions/Npm/NpmScriptRunner.cs#L67), there's an external npm process created that never seems to be killed and no reference to the `process` is maintained. Where is this process terminated? Could that be it?More findings:* When running a single test by itself, the NodeJS processes are terminated, albeit after my test finishes* I tried reproducing on a newly created angular template project, no luck. It seems to only happen when multiple tests are ran...Related (closed) issues: * https://github.com/aspnet/JavaScriptServices/issues/1699
5440	area-mvc	Change ASP.NET Core templates to use async main	We should look at doing this in 3.0
4914	area-mvc	Add tests of client code generation components	#### Is this a Bug or Feature request?Enhancement that's part of #7947#### Description of the problemHave previously been manually testing the client code generation feature. Need to automate this, including tests of the tasks, the generic document tool, and the MSBuild targets.Tasks should be relatively simple to unit test. But, the remainder will likely need functional tests that (unfortunately) write to disk. Will have a look at aspnet/DotNetTools, aspnet/EntityFrameworkCore, and aspnet/websdk to see how those repos test tools and MSBuild targets. May also discuss potential MSBuild and tool testing approaches with @pranavkm and @ryanbrandenburg.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the [features/client.code.generation branch](https://github.com/aspnet/Mvc/tree/feature/client.code.generation) branch. That work is intended for the 2.2 Preview 3 milestone.
5591	area-mvc	StateHasChanged has no effect when called from JavaScript interop	I've uploaded a sample app here https://drive.google.com/open?id=1HnrxLNiRAbfTn3Mgwkk-pvgZeqrb7Rjb1. Run the app2. Note that the Counter is 03. Click the button (repeatedly)4. Note it remains 0Edit index.cshtmlComment out the call to StateHasChanged in OnPageLoaded1. Run the app2. Note that the Counter is 03. Click the button (once)4. Note it changes to 2Conclusion: A call from JavaScript into Blazor does not automatically update view state, but adding in StateHasChanged causes all view state to stop working from thereon in.SOURCE=====>     public static class BrowserInterop>     {>         private const string NotifyPageLoadedCallbackId = "PeterMorris.BrowserInterop.NotifyPageLoaded";> >         public static event EventHandler PageLoaded;> >         public static RenderFragment Initialize()>         {>             return (RenderTreeBuilder renderer) =>>             {>                 renderer.OpenElement(1, "script");>                 renderer.AddContent(1, GetPageLoadedScript());>                 renderer.CloseElement();>             };>         }> >         [JSInvokable(NotifyPageLoadedCallbackId)]>         public static void NotifyPageLoaded()>         {>             Console.WriteLine("PageLoaded!!!");>             PageLoaded?.Invoke(null, null);>         }> >         private static string GetPageLoadedScript()>         {>             string assemblyName = typeof(BrowserInterop).Assembly.GetName().Name;> >             return >             #region JavaScript> $@"> 	(function() {{ > 		DotNet.invokeMethodAsync('{assemblyName}', '{NotifyPageLoadedCallbackId}');> 	}})();> ";>             #endregion>         }>     }> MainLayout.cshtml============At the bottom of the file add > @BrowserInterop.Initialize()Index.cshtml========```@page "/"Counter value is @Count<button class="btn btn-primary" onclick="@ButtonClick">Click me</button>@functions{    int Count = 0;    protected override void OnInit()    {        base.OnInit();        BrowserInterop.PageLoaded += OnPageLoaded;    }    private void OnPageLoaded(object sender, EventArgs args)    {        BrowserInterop.PageLoaded -= OnPageLoaded;        Count++;        StateHasChanged();        Console.WriteLine($"Counter is now {Count}");    }    private void ButtonClick()    {        Count++;        StateHasChanged();    }}```
4913	area-mvc	GetDocumentInsider code should not overwrite up-to-date API descriptions	#### Is this a Bug or Feature request?Enhancement that's part of #7947#### Steps to reproduce (preferably a link to a GitHub repo with a repro project)1. Create a test project with a `<ServiceProjectReference/>` to an (experimental) web site providing an `IDocumentProvider` service2. Build the project3. Notice build creates the expected API description file (aka Swagger or OpenAPI document)4. Without deleting the above file, build the project again5. Notice the timestamp of the description file changes and the client code is generated again#### Description of the problemThe timestamp change is a problem because it extends the build time unnecessarily.Problem does not occur when the document generation tool relies on `%(Uri)` metadata. That is, the download option works well already.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the [features/client.code.generation branch](https://github.com/aspnet/Mvc/tree/feature/client.code.generation) branch. That work is intended for the 2.2 Preview 3 milestone.
4912	area-mvc	Flesh out the `GetProjectReferenceMetadata` task	#### Is this a Bug or Feature request?Enhancement that's part of #7947#### Description of the problemThe current `GetProjectReferenceMetadata` task is basically a stub. It needs to get the requisite metadata and add it to the `Inputs` items i.e. behave like `GetFileReferenceMetadata` and `GetUriReferenceMetadata` but with `ServiceProjectReference` items. See expected metadata in the `<ItemDefinitionGroup/>` at https://github.com/aspnet/Mvc/blob/364b3a7720cb6f925b0eea39ef8e7e8df47af57d/src/Microsoft.Extensions.ApiDescription.Client/build/Microsoft.Extensions.ApiDescription.Client.props#L59-L104Of course, also need to use this task in [Microsoft.Extensions.ApiDescription.Client.targets](https://github.com/aspnet/Mvc/blob/364b3a7720cb6f925b0eea39ef8e7e8df47af57d/src/Microsoft.Extensions.ApiDescription.Client/build/Microsoft.Extensions.ApiDescription.Client.targets) and thereby simplify the `ServiceProjectReferenceGenerator` target.This issue will _not_ remove the need for the GetDocumentInsider to retrieve information from the web site project prior to doing its work. Most metadata the inside man needs e.g. a default `%(Uri)` is not generic enough to be of interest in other document generators.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`See the [features/client.code.generation branch](https://github.com/aspnet/Mvc/tree/feature/client.code.generation) branch. That work is intended for the 2.2 Preview 3 milestone.
5439	area-mvc	Verify generated content with a linter or similar	Right now this is only our site.min.css files. We should (as part of our tests) verify that the contents are at least valid css.
4724	area-servers	Kestrel does not listen for https when run as a service on Ubuntu	I am trying to host an ASP.Net Core MVC application (https redirection is enabled) on Ubuntu server, using Nginx as a reverse proxy. I have created and installed a local SSL certificate using OpenSSL. When i run my application using dotnet CLI it listens on both http://localhost:5000 & https://localhost:5001, and i am able to access it on web using https (http requests are being redirect to https by Nginx).The problem is when i try to run the as a service, it only listens on http://localhost:5000.Here's the *.service file :```[Unit]Description=Test ASP.Net core web application service.[Service]WorkingDirectory=/home/ubuntu/MyAppFolderExecStart=/usr/bin/dotnet/home/ubuntu/MyAppFolder/MyApplication.dllRestart=always# Restart service after 10 seconds if the dotnet service crashes:RestartSec=10SyslogIdentifier=MyApplicationUser=www-dataEnvironment=ASPNETCORE_ENVIRONMENT=DevelopmentEnvironment=DOTNET_PRINT_TELEMETRY_MESSAGE=falseEnvironment=ASPNETCORE_HTTPS_PORT=5001Environment=ASPNETCORE_URLS=http://localhost:5000;https://localhost:5001[Install]WantedBy=multi-user.target```Environment details : ASP.Net Core 2.1.1, ASP.Net Core SDK 2.1.3, Nginx 1.14, Ubuntu 16.04
4725	area-servers	Add timeout for settings ack	Meta issue: #2627See settings ack
5590	area-mvc	Sidebar auto-collapses any collapsable children on wide media - fix included	Figured this out while trying to create an accordion on the sidebar. I found that the standard bootstrap collapse on child elements worked fine on small screens where the sidebar collapses to the top, but on large screens the accordion menu(s) would just keep re-collapsing (again, only only large screens, collapseable elements functioned normally in mobile view).### The Problem:The problem is with the default template, specifically this in NavMenu.cshtml:![image](https://user-images.githubusercontent.com/18584301/45224021-cc842280-b2b0-11e8-9047-a30114adcc75.png)and this in site.css:![image](https://user-images.githubusercontent.com/18584301/45224090-048b6580-b2b1-11e8-9422-4b0a6cbc1327.png)This means that the collapse prevention is inherited by all child elements on wide screens, which makes a hamburger/accordion-style menu impossible.### The Fix:Add an arbitrary class to the HTML - I called mine navInner:![image](https://user-images.githubusercontent.com/18584301/45224401-c93d6680-b2b1-11e8-99a1-80f31b6efb68.png)Then modify the CSS so it targets only the sidebar specifically and not its children. I did this by replacing the  ".collapse" with a combo-selector ".navInner.collapse" :![image](https://user-images.githubusercontent.com/18584301/45224515-0dc90200-b2b2-11e8-95b2-e1b79293da91.png)### The Result:![image](https://user-images.githubusercontent.com/18584301/45230184-014ba600-b2c0-11e8-903d-d8693b762d89.png)![image](https://user-images.githubusercontent.com/18584301/45230231-24765580-b2c0-11e8-8efc-2f9138c5a060.png)Hey hey, it works!
3821	area-servers	Add hosting bundle installer tests	
5589	area-mvc	Avoid publishing _bin/asmjs/wasm directories for server-side only apps	Currently the build/publishing process doesn't differentiate between WebAssembly and server-side Blazor apps, and hence it outputs `mono.wasm`/`mono.asm.js` and the `_bin` directory (containing client-downloadable .NET assemblies) in both cases.You *do* want to publish those files for WebAssembly apps, but you *don't* for server-side only ones (partly because it's pointless extra stuff to publish, and partly because you might actively not want clients to be able to download the Blazor app assemblies, since you only intend to use them on the server).**Proposal**1. In the Blazor client project, add an MSBuild property like `<OutputWebAssemblyFiles>true</OutputWebAssemblyFiles>`. This will be present by default in our WebAssembly project templates, but not the server-side one. Then we change the build process so that, if this flag is not present, it does not emit the `_bin`/`asmjs`/`wasm` directories.    * Obviously this is a breaking change, but it's pretty easy for people to add this to their existing apps.    * I think it should be opt-in like this, not opt-out, because it gives people a better chance of recognizing that they even have a choice.    * Having this flag also slightly simplifies the server-side template, because it no longer has to explicitly opt out from running the linker. The linker wouldn't be run anyway if we weren't outputting the WebAssembly files.2. We can also use the `OutputWebAssemblyFiles` flag to know whether to include a list of .NET assemblies in `_framework/blazor.boot.json`, hence also solving #1233.@danroth27 / @rynowak - thoughts on this design? Any other way you'd prefer it to be configured?The main way people could still get this wrong is by adding a new Blazor client project to an existing solution to use it as a server-executed app, but forgetting to remove the `<OutputWebAssemblyFiles>` flag. Not sure how big of an issue to consider that.
5438	area-mvc	Template tests should baseline SPA templates	Add- angular- react- reactreduxto the baseline tests.
5819	area-identity	Usage of IdentityRole	I know claims are the best practice here but there are some cases where Roles are needed. And I have checked out issues, yet couldn't find any answer. It might be my mistake though.Although Identity namespace has IdentityRole class, 1. `Microsoft.AspNetCore.Authorization.AuthorizationPolicyBuilder` does only have `RequireRole(IEnumerable<string> roles)` and `RequireRole(params string[] roles)`, which obviously accepts string as parameter.2. `System.Security.Claims.ClaimsPrincipal` does only have `IsInRole(string role)`, which also accepts string as parameter.I have added my own IdentityRole class where some audit properties like CreatedAt, CreatedBy etc. and had to inherit those two classess implementing my own IdentityRole. But at some points it had lead me to reimplement whole Identity assembly, which is a totally bad idea.While there is IdentityRole class, why we use string as roles?
4726	area-servers	Kestrel returns 400 before reaching any of my code	Our web app started returning seemingly random 400s since the last two weeks. It is a ASP.NET Core 2.0 mvc web site running under IIS and Windows Server 2016. First thing we did was, of course, look at our logs. However, there was nothing. None of those 400s were there. We then enabled Failed Request Tracing and found this: https://pastebin.com/NVR2pzbJ (as you may know, Failed Request Traces from IIS are quite gigantic, thus I'm using pastebin). Anyway, the **TLDR** is this:```xml<EventData>  <Data Name="ContextId">{80002F02-0002-EE00-B63F-84710C7967BB}</Data>  <Data Name="ModuleName">AspNetCoreModule</Data>  <Data Name="Notification">128</Data>  <Data Name="HttpStatus">400</Data>ç  <Data Name="HttpReason">Bad Request</Data>  <Data Name="HttpSubStatus">0</Data>  <Data Name="ErrorCode">0</Data>  <Data Name="ConfigExceptionInfo"></Data> </EventData> <RenderingInfo Culture="en-US">  <Opcode>MODULE_SET_RESPONSE_ERROR_STATUS</Opcode>  <Keywords>   <Keyword>RequestNotifications</Keyword>  </Keywords>  <freb:Description Data="Notification">EXECUTE_REQUEST_HANDLER</freb:Description>  <freb:Description Data="ErrorCode">The operation completed successfully. (0x0)</freb:Description> </RenderingInfo> <ExtendedTracingInfo xmlns="http://schemas.microsoft.com/win/2004/08/events/trace">  <EventGuid>{002E91E3-E7AE-44AB-8E07-99230FFA6ADE}</EventGuid> </ExtendedTracingInfo></Event><Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"> <System>  <Provider Name="WWW Server" Guid="{3A2A4E84-4C21-4981-AE10-3FDA0D9B0F83}"/>  <EventID>0</EventID>  <Version>1</Version>  <Level>4</Level>  <Opcode>56</Opcode>  <Keywords>0x0</Keywords>  <TimeCreated SystemTime="2018-09-06T13:58:08.103Z"/>  <Correlation ActivityID="{80002F02-0002-EE00-B63F-84710C7967BB}"/>  <Execution ProcessID="3828" ThreadID="14428"/>  <Computer>siip</Computer> </System> <EventData>  <Data Name="ContextId">{80002F02-0002-EE00-B63F-84710C7967BB}</Data>  <Data Name="HeaderName">Content-Length</Data>  <Data Name="HeaderValue">0</Data>  <Data Name="Replace">true</Data> </EventData> <RenderingInfo Culture="en-US">  <Opcode>GENERAL_SET_RESPONSE_HEADER</Opcode> </RenderingInfo> <ExtendedTracingInfo xmlns="http://schemas.microsoft.com/win/2004/08/events/trace">  <EventGuid>{D42CF7EF-DE92-473E-8B6C-621EA663113A}</EventGuid> </ExtendedTracingInfo></Event><Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"> <System>  <Provider Name="WWW Server" Guid="{3A2A4E84-4C21-4981-AE10-3FDA0D9B0F83}"/>  <EventID>0</EventID>  <Version>1</Version>  <Level>4</Level>  <Opcode>56</Opcode>  <Keywords>0x0</Keywords>  <TimeCreated SystemTime="2018-09-06T13:58:08.103Z"/>  <Correlation ActivityID="{80002F02-0002-EE00-B63F-84710C7967BB}"/>  <Execution ProcessID="3828" ThreadID="14428"/>  <Computer>siip</Computer> </System> <EventData>  <Data Name="ContextId">{80002F02-0002-EE00-B63F-84710C7967BB}</Data>  <Data Name="HeaderName">Server</Data>  <Data Name="HeaderValue">Kestrel</Data>  <Data Name="Replace">true</Data> </EventData> <RenderingInfo Culture="en-US">  <Opcode>GENERAL_SET_RESPONSE_HEADER</Opcode> </RenderingInfo> <ExtendedTracingInfo xmlns="http://schemas.microsoft.com/win/2004/08/events/trace">  <EventGuid>{D42CF7EF-DE92-473E-8B6C-621EA663113A}</EventGuid> </ExtendedTracingInfo></Event><Event xmlns="http://schemas.microsoft.com/win/2004/08/events/event"> <System>  <Provider Name="WWW Server" Guid="{3A2A4E84-4C21-4981-AE10-3FDA0D9B0F83}"/>  <EventID>0</EventID>  <Version>1</Version>  <Level>5</Level>  <Opcode>3</Opcode>  <Keywords>0x100</Keywords>  <TimeCreated SystemTime="2018-09-06T13:58:08.103Z"/>  <Correlation ActivityID="{80002F02-0002-EE00-B63F-84710C7967BB}"/>  <Execution ProcessID="3828" ThreadID="14428"/>  <Computer>siip</Computer> </System> <EventData>  <Data Name="ContextId">{80002F02-0002-EE00-B63F-84710C7967BB}</Data>  <Data Name="ModuleName">AspNetCoreModule</Data>  <Data Name="Notification">128</Data>  <Data Name="fIsPostNotificationEvent">false</Data>  <Data Name="CompletionBytes">0</Data>  <Data Name="ErrorCode">0</Data> </EventData> <RenderingInfo Culture="en-US">  <Opcode>NOTIFY_MODULE_COMPLETION</Opcode>  <Keywords>   <Keyword>RequestNotifications</Keyword>  </Keywords>  <freb:Description Data="Notification">EXECUTE_REQUEST_HANDLER</freb:Description>  <freb:Description Data="ErrorCode">The operation completed successfully. (0x0)</freb:Description> </RenderingInfo> <ExtendedTracingInfo xmlns="http://schemas.microsoft.com/win/2004/08/events/trace">  <EventGuid>{002E91E3-E7AE-44AB-8E07-99230FFA6ADE}</EventGuid> </ExtendedTracingInfo></Event>```Now, I'm not an IIS expert by any means, but if I understand this correctly, Asp.Net Core has run and has decided to return 400 bad request. The problem is: _our code never ran_. This is our `Startup.Configure()`:```csharppublic void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            // This middleware, as you can see, is the first thing ever to run and it simply logs           // everything that enters and leaves. Do note that other "normal" 400 errors are logged by this            app.UseMiddleware<SerilogMiddleware>();            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();                app.UseBrowserLink();            }            else            {                app.UseExceptionHandler("/Home/Error/500");            }            // other middleware ...            // This turns 400s, 404s and 500s into some pretty pages.            // And this middleware is also not being run when this problem occurs,            // further evidencing that Kestrel is returning 400 _before_ any of my code runs.            app.UseStatusCodePagesWithReExecute("/Home/Error/{0}");            app.UseMvc(routes =>            {                routes                .MapRoute(                    name: "default",                    template: "{controller=Home}/{action=Index}/{id?}");            });        }```We thought that maybe the request got corrupted and somehow it was so invalid that kestrel didn't even bother to send it to the rest of the pipeline. However, we've repated the same request on fiddler and they return success codes. This is the request if you don't want to navigate through those 4k lines of log:```httpCache-Control: max-age=0Connection: keep-aliveContent-Length: 2410Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8Accept-Encoding: gzip, deflateAccept-Language: pt-BR,pt;q=0.9,en-US;q=0.8,en;q=0.7Cookie: .AspNetCore.Antiforgery.yRvNsY19ltY=CfDJ8DgfkYSRB59EqqhuWGHNsd9RwNppJLY8SuEzNMhyyszJv8tPzAJPfuZ4uwMX8RPtO28x3qVO1FtSXHGrb4pjZLkETcbVr4zDiH4VEuoFYbNqBe6hUKHZrN4Vg_5LIGCfY6vVLtnX1Dl7QCy3arKjRVY; .AspNetCore.Cookies=CfDJ8DgfkYSRB59EqqhuWGHNsd_qCE-_zqZcbhiSe47BlGFvLNyIFQ2CyUTMFARZScdH8o0E-LhqGzGgbMPnn5G9-T0KpL7sV0K4uQ1yYA59vo25d42-rtr8WMz2jgEVlYCwiUoZwy0AHBhJstwdilM3_D3FxkJTzebye8BHOrjobdeOqTWk4D774_V4M-O2-pltX3On_U0vKheQGc2-YrGwP4RFlR0x9XSrszgtKyRv_mJE67g9ueRD1aRRp9-BGoymJujrxjDnuPD7ZIN1RWlstiV5RyQpsjnurMISgNsl6ET5wRH0-Bu2p-RNnjAiFHAlCjom4RKb7pKDXMipaQoEGkwesn4T02kV5R4NhwrUOzbyUFZ1aWltOFuDp6Ce3pMAnPNtx2SsUN0ru7T3Yjc1pUIEZW3_quxcHQnrb601NGRHZpmoIqVOJSIFOhuX-rgYhGWfBUHtqckv2Cb-WiS1sIrR0Za7E692mQkVvbN5uT1n1fFbhNLRmixT0empfGtI8ZrKbHDjmVhdOuTvgNRZ3Z0uQx05pjmtITHenYkqCtPja0j-sCqEIhMsfXc2XFj4dNNvTMWEBGHXzTpvqD2CUgpBt2fHxC2fm8tRXZPWgojqVrM4JRMS03sl5nf92RIbtubVc8gsRNYIZPftLdl193PmosGSAYhpiU6XyRwh7d4KILEgsXJPZXiwY5UTmBCqW84aHRv9X9ZZ1P-e9jvBHm_31gR8IbiFeiZqGTRF8_cPDYuBd43fuA0z_L1G8LpcNaQrbDm-CrVuaWLpr8aQy-VzrQJMiCJWUxo9sQRZGCaK_Jl_ukRKn-YHelY9nNAAcWitiPLdqQYal194oLYPYo4t7K9ftGQuib4NJa7I8TwXeKK1Qy6TVupTQgUNIjO_yvRiZyrnvq5oaOP9V9SYT4_nppOhryaqVQ-jJRY4XKxqnP5shwDbPtOVFg-67ozWebX_a7EHSzULIvSoBUsR7utlhZCmmBJGgBZZhJfr2-6GWwcdcJ23Sz0x5JyW-O4Liw4ErXnbEdSvZTomjS2pjqleG_TsBJS6xCEIStSRRiyxZduG9ihmQB1fCGC8DhTmckU0-M_quPsHGjBahr7f1MNx6yXxF5ms4CHSvG-i7Lhh-WDDRLg21dBvtFrvT65bYsoRPHsukfi-6dT3oS49KdriqCNKTa5o4nWX98563be0znJTj8T_1eXOrYcjRfYThZnkB8OpJjz1Eihaj7bgQ-N6zuK3NWJSU3j4EA2s15qgrnVzCEXcd37HpQxRzTtCJ0eS-EY062xf3RW441WRY1-bhqjsAgajW6JCgkh7Ukb4W-_accuiUjW0U2jSepyUysdTva64JwF8hKF7ap1StomK1U7Dxg10hLJ3vMfqW1G5Tbo-ahQCVhBxhgKjsCFUFALdQUlWgnfsXMyr-6wbT273lQ7xsYW2HzhkSLYyWbkZLXEP5QJjm4hgb8EEEJYrLLkwqAyu5uO7CLqbLbKlytAH5rAcvnWq6J2yZfC_diNoRW35gaw96RV51OTI2CQTOPzYzqZTfUYmkhuNeGkNIZqgPOKJivZu5aSNMBBrzqXPcDAPmHEOKTlNODtiN1f3sE1XzPUz2CWRf-GMTO6NwdrRYgx2Y6aTf_XCElC5z6Rk1dK04yhR9xBKq_l35YjyuZNPg9ArO46jhfBM1WbaB_tmBPob9dSEuW5kXNnfBZ-CbWJZEioequiVC-_Z2PGtbOeRkFtCfPgk07t9kVskNjYHtFRSmEB7kmC-DYDFz29SXicjsgTko05tmviT_XxTDaAtdQfoYap5QF8BTgSW9L2uvDPB3XS5QUhiKSbXtU-UUoQp4uJ_zGwg3H-2bsTiieG2ZfGZ7uRKGQ1we-WWp1Jb-4ADv28ZQrQuYaNfRtelIxixDmUWoOoygIvGV_K-Ini27CPeZ8ys5oG3LiW-sQND_eVIluCGwY3RkorPhgmggAKOsHIvqRyzD3Y0PtdUkqN2J5cODm4sADZl9J_0uFhe4q-dnCyeqQhDbKfIr3nCiHehKfsBKKa_49aOF0ZhH9z5quZvymtWo3mAJp3VUNTdJcAqYnvWWydS3gLhlGz2AJxkpnzVd0XDaTy4y3yDoS_h15efbjZjI6hrByCAg48phLByXJ0aJYKeh-7Qf-lsvVpixkQKOWie5weN8LWKbE5z8HdKVW0gL_2me7fh1k8PdI3wyX6dvG1K6Ez0GN2nWl0wNUQknyj9xCAr2IOzmNXXJkDHzLBxtvIJvUqRQTN5MRwmz-Mp-CUjdiexokVSa8s87Dts-YLkY9d9dy2SWSPuhfowr9XnBjuRBkv62kQMAFQzvxMiz0vdj-cLRTclH8xWYg4damLkJ_ugUXMUPEixKPMurLOlYL9GxlFaiIjvytj9g2Y53C2LrQWtrJakNuweHXSQsSSUiUl99mDBQzYC2Wg3QmGILCz7_bT4XH_FLYcMQt7QVTASmS_4ikFjIVe4QhWOMWXUFnY9TCYmUkqSYXPtDyd23rbnRU8xZosTH7FLWXH0PnbIs2AsfTmPq52WtIR2tLn1hcgsOR7YqXn_MWE7HLLh_FQdt-x6jSNKpxkFMeR3ZsQXHQzoRqdeb3S17Fe7XD58HhpSPBXcyDgqZK3uu84CLsR-CjY9h3xnKSTSepU9Nqa_KdGIa8Q9bpKAVpu2arnlW6Fxdh7_j9_cPpFS6Jk6mGMH0xh5JE_ZxhICXMlWYCIblD_YBV3HTE7FDGj1gbg-TT6inBnq8PbDXXEOfPa3K1OuqdDgHXvFLwqq0y1PXg3r0c2eYcMIUdS0DBjiIsu6sLqNwPJvdwI-B_aucHCha6ZHNUrSEbLJVqw3HWlZ-CgSSLa_G8JYjzp2k4Lw2HaZd2cYP2H25ZIfDac-mBtgutJN9pIzxvF-qrPatjXjRA8LyPj2H92cy2mKu7WXpvrvvs7JppiSNPVKJFzvR0RmMbvvONUnyQlnrXizwPgwKSOEFLzyl9kvsafzTXVdhUhb3Mo3WYFEng; .AspNetCore.Session=CfDJ8DgfkYSRB59EqqhuWGHNsd8Rf5SAzNzUXxufiopkJheFoufaoaYs2XFLN%2FpaOO9pUyxt3J9noimn8wgCl3vxbuAPNJ0tsqR%2FBiEn0YU2SOFLrPVhGgZ6kd0rn3tmhPHyrZTSVGP%2Ftvow8CPdWg8USxbMhwtKrcwaKq56tmhqcjUmHost: [redacted-url]Referer: http://[redacted-url]/Inspecao/CadastrarUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.106 Safari/537.36Origin: http://[redacted-url]Upgrade-Insecure-Requests: 1DataAlteracao=&DataInclusao=&Municipio=São+Vicente&Data=13/08/2018&Hora=09:31&```There were other parameters in the body, but I've removed them for brevity. You can find all of them on the provided log. Also, note that in the log, the body was url-encoded. We tested both replaying them url-encoded and decoded, both result in _our code being run_, which is what is really important here.**Edit** Some more info: We have this same application deployed to two different physical servers. Only one of them is having these issues, however. These are the differences I managed to gather between the two (italic being the one presenting these issues):_Windows Server 2016_ vs Windows Server 2008_Azure VM_ vs Physical Server_Multiple (20+) IIS Websites, all runing ASP.NET Core 2 and 3 running WebForms under .NET 4.5_ vs 2 IIS Websites running ASP.NET Core 2_16 GB RAM_ vs 8GB
5937	area-hosting	Feature request: something similar to app_offline.htm	_From @lonix1 on September 6, 2018 16:14_In regular ASP.NET I can dump an `app_offline.htm` file on the server, and that would signal IIS to take down the app. Then I can do some maintenance, and delete the file to restart the app.Kestrel doesn't have such a feature (I think?). I realise there are other (perhaps better?) ways to do this, but most devs and companies are used to this because it is so easy, quick and intuitive.Please consider it._Copied from original issue: aspnet/KestrelHttpServer#2890_
3851	area-servers	DotNetCoreWindowsHosting install corrupt after sysprep	_From @elangelo on September 6, 2018 14:44_As part of our offering on Azure we have an API service that is running in dotnetcore 2.0 We use packer to create a custom image and install the dotnetcore windows hosting module.The version we install is DotNetCore.2.0.0-WindowsHosting.exeAt the end of the packer process a sysprep gets run: 				"& $env:SystemRoot\\System32\\Sysprep\\Sysprep.exe /oobe /generalize /quiet /quit",When i spin up a machine from this image and install our dotnet core service on it we always get 500s externally. browsing localhost we get: ![image](https://user-images.githubusercontent.com/1935881/45164852-c4b27880-b1f3-11e8-965a-3ac743103d67.png)The only way to fix this is to go to the control panel and find the dotnetcore hosting program and click on repair:![image](https://user-images.githubusercontent.com/1935881/45164947-f9becb00-b1f3-11e8-9149-0a556fc81967.png)I have no idea why this even helps or why the installation wouldn't survive a sysprep in the first place. I would like to know 1. why does the installation not survive a sysprep2. how can i figure out what the repair actually fixes and what is actually broken (so i can perhaps fix it manually with some powershell script instead of just having to manually run the 'repair' step._Copied from original issue: aspnet/Home#3508_
4727	area-servers	Allow non-ASCII characters in response header values	Following up for https://github.com/aspnet/KestrelHttpServer/issues/1144. We may want to allow UTF-8 characters in response header values now to parallel our acceptance of UTF-8 characters in request header values. Note that the app has some degree of control over the response headers and their values.
3498	area-mvc	JsonPatch: test operations fail when contract resolver is used to serialize data	### Functional impactWhen controlling data serialization using a contract resolver (and the contract resolver is not registered for the JsonConvert's default settings), test operations in patch requests fail.### Minimal repro stepsIssue noticed in `Microsoft.AspNetCore.JsonPatch 2.1.1`.Example code:```class Person{    public string FirstName { get; set; }    public string MiddleName { get; set; }    public string LastName { get; set; }}class NoMiddleNameContractResolver : DefaultContractResolver {    protected override JsonProperty CreateProperty(MemberInfo member, MemberSerialization memberSerialization)    {        JsonProperty property = base.CreateProperty(member, memberSerialization);        if (property.DeclaringType == typeof(Person) && property.PropertyName == nameof(Person.MiddleName))            property.ShouldSerialize = obj => false;        return property;    }}class Program{    static void Main(string[] args)    {        var contractResolver = new NoMiddleNameContractResolver();        var serializerSettings = new JsonSerializerSettings { ContractResolver = contractResolver };        var person = new Person { FirstName = "John", MiddleName = "Alexander", LastName = "Doe" };        var serializedValue = JsonConvert.SerializeObject(person, serializerSettings);        var jsonTestValue = $"[{{ op: \"test\", path: \"/0\", value: {serializedValue} }}]";        var operations = JsonConvert.DeserializeObject<Operation<List<Person>>[]>(jsonTestValue, serializerSettings).ToList();        var patchDoc = new JsonPatchDocument<List<Person>>(operations, contractResolver);        var people = new List<Person> { person };        try        {            patchDoc.ApplyTo(people);            Console.WriteLine("patch test passed");        }        catch (Exception ex)        {            Console.WriteLine($"patch test failed: {ex}");        }    }}```### Expected resultApplyTo method does not throw an error, test operation was successful.### Actual resultApplyTo method throw an error, due to failed test operation.### Further technical detailsEach implementation of the `IAdapter` interface uses the static JsonConvert class with the default serializer settings. The provided ContractResolver is not being used when serializing values being compared.[DictionaryAdapterOfU](https://github.com/aspnet/JsonPatch/blob/release/2.2/src/Microsoft.AspNetCore.JsonPatch/Internal/DictionaryAdapterOfTU.cs#L168)[DynamicObjectAdapter](https://github.com/aspnet/JsonPatch/blob/release/2.2/src/Microsoft.AspNetCore.JsonPatch/Internal/DynamicObjectAdapter.cs#L126)[ListAdapter](https://github.com/aspnet/JsonPatch/blob/release/2.2/src/Microsoft.AspNetCore.JsonPatch/Internal/ListAdapter.cs#L180)[PocoAdapter](https://github.com/aspnet/JsonPatch/blob/release/2.2/src/Microsoft.AspNetCore.JsonPatch/Internal/PocoAdapter.cs#L164)
5588	area-mvc	Component not rendering after StateHasChanged call	I have created simple `NavElement` component that changes a bit standard `NavLink` behaviour. According to log all logic works but somehow component is not re-rendered after `StateHasChanged` call. Relevant code looks like this:        private void OnLocationChanged(object sender, string newUriAbsolute)        {            Console.WriteLine("OnLocationChanged");            var shouldBeActiveNow = ShouldMatch(newUriAbsolute);            if (shouldBeActiveNow != IsActive)            {                IsActive = shouldBeActiveNow;                Console.WriteLine("Calling StateHasChanged");                StateHasChanged();            }        }        protected override bool ShouldRender() => true;        protected override void BuildRenderTree(RenderTreeBuilder builder)        {            Console.WriteLine("BuildRenderTree");            builder.OpenElement(0, "li");            // Set class attribute            builder.AddAttribute(0, "class", CombineWithSpace(Class, IsActive ? ActiveClass : null));            builder.AddContent(1, ChildContent);            builder.CloseElement();        }Component renders initialy. Later on when I click on some link logic works like expected and I get `Calling StateHasChanged` in browser console for two nav elements (old active and new active). But after that I can't see in logs `BuildRenderTree`. But when I refresh web page changes are applied.
4728	area-servers	Add an exception for responses that are prematurely cut off due to their size.	This is a "feature" that has plagued me for months, until I realized there was a very easy fix - https://stackoverflow.com/questions/16436533/how-to-modify-the-default-allowed-response-size-settings-for-a-web-api-applicati .Unless configured, there seems to be a (configurable) upper limit on the response size for JSON strings and responses in general - instead of throwing returning 500 and an exception that tells us the response is too large for the server to handle, it trims the response to the limit and sends it, leading to malformed JSON strings and 〈capslock〉developer frustration〈/capslock〉. I feel that an  exception (maybe can be toggled on/off) should be implemented here that at least tells us the server encountered an error instead of sending half of a response that inevitably breaks the client.🐊
5586	area-mvc	BrowserHttpMessageHandler reads body content to end	Inside "Blazor/src/Microsoft.AspNetCore.Blazor.Browser.JS/src/Services/Http.ts", the response data is handled via " responseData = await response.arrayBuffer();", which reads the entire response stream to the end, and then returns the data, however this is the incorrect behaviour.HttpMessageHandler's should not buffer the response as this is handled within the HttpClient.This means that method such as "_httpClient.SendAsync(request, HttpCompletionOption.ResponseHeadersRead, CancellationToken.None);", are not handled correctly as the ResponseHeadersRead flag is not respected, due to the content body being read to the end.We would need to wrap the ReadableStream from the JS side to the c# side as the HttpContent in the ReceiveResponse in BrowserHttpMessageHandler.Is there any chance of getting this fixed? As I've managed to get the c# signalr client working with long polling, but can't get the "ServerSentEventsTransport" to work until this is fixed, as otherwise the client timeouts trying to read the content body to the end, when it shouldn't as the ResponseHeadersRead is passed.
3486	area-servers	RequestHeaders - favor empty collection over null values	When working with the different request headers, we have to do null-checks for now.Please consider following the [best practises for working with collections](https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/guidelines-for-collections), that clearly states:**X DO NOT return null values from collection properties or from methods returning collections. Return an empty collection or an empty array instead.**Thanks.
5936	area-hosting	Cancellation Token parameter in BackgroundService.StartAsync is not respected	I have a suspicion that this is by design but wanted to check. I was planning to unit test an implementation of the background service I had written. To stop it looping forever in the case of a bug in my code I was looking to cancel the service after a certain amount of time. I thought that by passing in a cancellation token into the `StartAsync` and then cancelling it after 1 second, that this would work but it seems that this cancellation token is ignored.The relevant code is [found here](https://github.com/aspnet/Hosting/blob/712c992ca827576c05923e6a134ca0bec87af4df/src/Microsoft.Extensions.Hosting.Abstractions/BackgroundService.cs#L26-L43), and I've pasted it below for convenience.```csharp/// <summary>/// Triggered when the application host is ready to start the service./// </summary>/// <param name="cancellationToken">Indicates that the start process has been aborted.</param>public virtual Task StartAsync(CancellationToken cancellationToken){    // Store the task we're executing    _executingTask = ExecuteAsync(_stoppingCts.Token);    // If the task is completed then return it, this will bubble cancellation and failure to the caller    if (_executingTask.IsCompleted)    {        return _executingTask;    }    // Otherwise it's running    return Task.CompletedTask;}```The `cancellationToken` parameter is not used and it instead passes in a different cancellation token that is private to `BackgroundService`. I think it might be useful to combine the parameter cancellation token with `_stoppingCts`. I understand that I can call `Dispose` or `StopAsync` to cancel `_stoppingCts`, but that doesn't let me call `CancelAfter` for the behaviour I was looking for and doesn't change that the cancellation token is ignored.
5818	area-identity	Compiler error CS0433 caused by duplicate types: IdentityServiceCollectionExtensions	We have two types in the different assemblies with the same name. This can lead to unresolvable compiler errors when referencing Microsoft.Extensions.DependencyInjection.IdentityServiceCollectionExtensions> error CS0433: The type 'IdentityServiceCollectionExtensions' exists in both 'Microsoft.AspNetCore.Identity, Version=2.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60' and 'Microsoft.Extensions.Identity.Core, Version=2.1.2.0, Culture=neutral, PublicKeyToken=adb9793829ddae60'https://github.com/aspnet/Identity/blob/release/2.1/src/Identity/IdentityServiceCollectionExtensions.cshttps://github.com/aspnet/Identity/blob/release/2.1/src/Core/IdentityServiceCollectionExtensions.cs
5086	area-mvc	Problem with referencing a COM object from ASP.NET Core 2.1 Targeting  .NET 461.	Hi, I've found that just adding a reference to a COM object causes the build to fail with this single error:> …\.nuget\packages\microsoft.aspnetcore.razor.design\2.1.2\build\netstandard2.0\Microsoft.AspNetCore.Razor.Design.CodeGeneration.targets(69,5): error : The assembly path obj\Debug\net461\win7-x86\Interop.MyComLib.dll is invalid. Assembly paths must be rooted.As a quick work-around I disabled the error in **RazorTagHelper.cs**, rebuilt and replaced my current 2.1.2\tasks\netstandard2.0\Microsoft.AspNetCore.Razor.Tasks.dllIt’s unclear to me where the path of the referenced COM import library is stored let alone created. Maybe the “rooted assembly path” check should verify it’s not a COM object first?```   // My work-around is:       protected override bool ValidateParameters()        {           ...            for (var i = 0; i < Assemblies.Length; i++)            {                if (!Path.IsPathRooted(Assemblies[i]))                {                    // my COM object doesn't seem to have a rooted path and this fails - so lets make it a warning instead                    //Log.LogError("The assembly path {0} is invalid. Assembly paths must be rooted.", Assemblies[i]);                    //return false;                    Log.LogWarning("The assembly path {0} is invalid. Assembly paths must be rooted.", Assemblies[i]);                }            }```
4911	area-mvc	Allow validation attributes on `PageModel` itself	#### Is this a Bug or Feature request?: Feature request#### Steps to reproduce (preferably a link to a GitHub repo with a repro project): https://github.com/Yaevh/RootModelValidationDemo#### Description of the problem:As of 2.1.0, validation attributes are allowed on controller parameters, bound controller parameters, page model properties and handler method parameters. They are however not allowed on page models themselves, which makes it impossible to implement complex, multi-property validation in Razor Pages declaratively. Right now one must either invoke such validation manually, or encapsulate all properties in a custom viewmodel and decorate that viewmodel with a validation attribute, which is rather awkward considering that `PageModel` is the actual viewmodel for the page.Are there any plans to allow validation of whole `PageModel`s in Razor Pages?#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`: 2.1.0<!--                                    --- NOTE ---1.  Try enabling logging (in the most verbose level) and see if the details help you in fixing    the issue you are seeing. Share the logs too if it helps in diagnosing the issue faster.    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging2.  If you are seeing an exception, include the full exceptions details (message and stack trace).    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/error-handling3.  If you believe you have an issue that affects the security of the platform please do    not create an issue, instead email your issue to 'secure@microsoft.com'. Your report may    be eligible for our bug bounty. More info: https://technet.microsoft.com/en-us/mt764065.aspx-->
5335	area-signalr	How to create Hub and new route at run-time using Roslyn scripting?	In my ASP.NET Core 2.1 application, users can create new classes and types at run-time using Roslyn scripting. With that in mind, I'm trying to create a new Hub with a method that can handle this new type (input and output). I can't use generics since they are a compile-time construct. I believe the "new" hub will also need to be instantiated via Roslyn scripting. The reason for this is I want a strongly typed Hub and Client for performance reasons. (The strongly-typed C# client can be instantiated via Roslyn.)However, hubs and their routes need to be declared in Startup.cs which is essentially compile-time. One other consideration is using a hub that uses the "dynamic" type. But this is slower than using a strongly-typed type, and could require boxing/unboxing of value types.Any pointers would be appreciated since I have searched the web and docs to no avail. Thanks!
5436	area-mvc	Consider moving SPA template packages to number post-fix naming scheme	The "Regular" project templates have a 2.2 post-fix, but SPA packages do not. Let's see what the costs and benefits of making these two the same are.
6025	area-identity	AzureADB2CBearer support for dynamic validation of issuers and audiences 	When implementing WebApi, we have often requirement to dynamically validate issuers and/or audiences. With JwtBearer we could do it as shown below:      ```      services.AddAuthentication().AddJwtBearer(o => {            (o => {                Configuration.Bind("AzureAd", o);                o.Authority = $"{xyz}/common";                o.TokenValidationParameters = new                 Microsoft.IdentityModel.Tokens.TokenValidationParameters()                {                    ValidateAudience = true,                    ValidateIssuer = true,                    AudienceValidator = (audiences, securityToken, validationParameters) =>                    {                            return true/false;                    },                    IssuerValidator = (issuer, token, tvp) =>                    {                         . . .                        return issuer;                    },                };                o.Events = new JwtBearerEvents()                {                    OnAuthenticationFailed = ctx =>                    {                        throw ctx.Exception;                    }                };            });```The question is, how to do the same with **AzureADB2CBearer** ? Looking for handlers like IssuerValidator and AudienceValidator. My API does not really care about AAD v2 or v2. It just needs a token as it is. I have tried with the more or less same code provided above, but it fails on validation of the signature, because v1 and v2 seems to use different signing mechanism.Currently supported using of *B2C*works well, but it is very static. This is the code, which I usually use when working with B2C in a WebApi:``` services.AddAuthentication(AzureADB2CDefaults.BearerAuthenticationScheme)            .AddAzureADB2CBearer(options => Configuration.Bind("AzureAd", options));```Thanks
5585	area-mvc	Preload Dlls and mono.wasm on build	The way things are currently loaded is mono.wasm first, then after it is processed the dlls get loaded and processed. After all of this is done the application will finally render in the browser. As a result the initial load is quite slow (for me its been around 4s on a fast computer with a good internet connection). The initial page load performance can be greatly improved simply by adding a preload link in the HTML for each dll. E.G. ```<link rel="preload" as="fetch" type="application/octet-stream" href="_framework/_bin/mscorlib.dll" /> <link rel="preload" as="fetch" type="application/octet-stream" href="_framework/_bin/System.Core.dll" />...```You could also use a script like:```(function () {    function preload(href) {        var link = document.createElement('link');        link.rel = 'preload';        link.as = 'fetch';        link.type = 'application/octet-stream';        link.href = '_framework/_bin/' + href;        document.head.appendChild(link);    }    [        'mscorlib.dll',        'System.Core.dll',        'Microsoft.CSharp.dll',        'System.dll',        'Microsoft.AspNetCore.Blazor.dll',    ].forEach(preload);}());```The downside of using a script is browsers can be pushed link preloads by the server, and using the script loses the server push ability.What would be nice is a build script that detects the generated dlls and injects the link preload into the html file head. When you preload the dlls they are generally done being retrieved before mono.wasm is even ready to look for them. This has reduced my render times down to 1s from the 4s I mentioned above, a notable improvement. Alternatively a service worker that prefetches the dlls would work just as well.
5817	area-identity	User signed out after requesting /Identity/Account/Manage/TwoFactorAuthentication	ASP.NET Core 2.1.1I've configured an asp.net core mvc project with Identity. I'm using the default UI but have scaffolded it because had to translate it to Dutch. When I navigate to the Manage pages everything works well until /Identity/Account/Manage/TwoFactorAuthentication is requested. The page is shown but the user has been signed out. After navigating away the user is redirected to the login page. The issue is triggered by https://github.com/aspnet/Identity/blob/fcc02103aa10dcdd8759e0463cac2717114f3c1e/src/UI/Areas/Identity/Pages/V3/Account/Manage/TwoFactorAuthentication.cshtml.cs#L58```Startup.cs...services.AddDbContext<ApplicationDbContext>(options =>        options          .UseSqlServer(Configuration.GetConnectionString("DefaultConnection")));services    .AddIdentity<ApplicationUser, IdentityRole>(options =>    {        options.Password.RequiredLength = 10;        options.Password.RequireDigit = false;        options.Password.RequiredUniqueChars = 0;        options.Password.RequireLowercase = false;        options.Password.RequireNonAlphanumeric = false;        options.Password.RequireUppercase = false;    })    .AddDefaultUI()    .AddEntityFrameworkStores<ApplicationDbContext>()    .AddDefaultTokenProviders();services.ConfigureApplicationCookie(options =>{    options.ExpireTimeSpan = TimeSpan.FromMinutes(60);    options.SlidingExpiration = true;});services.AddAuthentication(CookieAuthenticationDefaults.AuthenticationScheme);...``````Debug output...Microsoft.AspNetCore.Hosting.Internal.WebHost:Information: Request starting HTTP/1.1 GET http://localhost:44308/Identity/Account/Manage/TwoFactorAuthentication  Microsoft.AspNetCore.Mvc.RazorPages.Internal.PageActionInvoker:Information: Route matched with {page = "/Account/Manage/TwoFactorAuthentication", area = "Identity", action = "", controller = ""}. Executing action /Account/Manage/TwoFactorAuthenticationMicrosoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.Microsoft.AspNetCore.Authorization.DefaultAuthorizationService:Information: Authorization was successful.Microsoft.AspNetCore.Mvc.RazorPages.Internal.PageActionInvoker:Information: Executing handler method OnGet with arguments ((null)) - ModelState is ValidMicrosoft.EntityFrameworkCore.Infrastructure:Information: Entity Framework Core 2.1.1-rtm-30846 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: NoneMicrosoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[FirstName], [e].[FullName], [e].[InviteSecret], [e].[IsInvited], [e].[LastLogin], [e].[LastName], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]FROM [AspNetUsers] AS [e]WHERE [e].[Id] = @__get_Item_0Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (Size = 450), @__get_Item_1='?' (Size = 450), @__get_Item_2='?' (Size = 450)], CommandType='Text', CommandTimeout='30']SELECT TOP(1) [e].[UserId], [e].[LoginProvider], [e].[Name], [e].[Value]FROM [AspNetUserTokens] AS [e]WHERE (([e].[UserId] = @__get_Item_0) AND ([e].[LoginProvider] = @__get_Item_1)) AND ([e].[Name] = @__get_Item_2)Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (Size = 450)], CommandType='Text', CommandTimeout='30']SELECT TOP(1) [e].[Id], [e].[AccessFailedCount], [e].[ConcurrencyStamp], [e].[Email], [e].[EmailConfirmed], [e].[FirstName], [e].[FullName], [e].[InviteSecret], [e].[IsInvited], [e].[LastLogin], [e].[LastName], [e].[LockoutEnabled], [e].[LockoutEnd], [e].[NormalizedEmail], [e].[NormalizedUserName], [e].[PasswordHash], [e].[PhoneNumber], [e].[PhoneNumberConfirmed], [e].[SecurityStamp], [e].[TwoFactorEnabled], [e].[UserName]FROM [AspNetUsers] AS [e]WHERE [e].[Id] = @__get_Item_0**Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: Identity.Application signed out.Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: Identity.External signed out.Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: AuthenticationScheme: Identity.TwoFactorUserId signed out.Microsoft.AspNetCore.Authentication.Cookies.CookieAuthenticationHandler:Information: Identity.TwoFactorRememberMe was not authenticated. Failure message: No principal.**Microsoft.EntityFrameworkCore.Database.Command:Information: Executed DbCommand (1ms) [Parameters=[@__get_Item_0='?' (Size = 450), @__get_Item_1='?' (Size = 450), @__get_Item_2='?' (Size = 450)], CommandType='Text', CommandTimeout='30']SELECT TOP(1) [e].[UserId], [e].[LoginProvider], [e].[Name], [e].[Value]FROM [AspNetUserTokens] AS [e]WHERE (([e].[UserId] = @__get_Item_0) AND ([e].[LoginProvider] = @__get_Item_1)) AND ([e].[Name] = @__get_Item_2)Microsoft.AspNetCore.Mvc.RazorPages.Internal.PageActionInvoker:Information: Executed action /Account/Manage/TwoFactorAuthentication in 17174.327msMicrosoft.AspNetCore.Hosting.Internal.WebHost:Information: Request finished in 17189.4446ms 200 text/html; charset=utf-8...``````.csproj...<ItemGroup>    <PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.1.1" />    <PackageReference Include="Microsoft.AspNetCore.App" Version="2.1.1" />    <PackageReference Include="Microsoft.AspNetCore.DataProtection.AzureStorage" Version="2.1.1" />    <PackageReference Include="Microsoft.EntityFrameworkCore" Version="2.1.1" />    <PackageReference Include="Microsoft.EntityFrameworkCore.Proxies" Version="2.1.1" />    <PackageReference Include="Microsoft.EntityFrameworkCore.Design" Version="2.1.1" /></ItemGroup>...```
3479	area-middleware	DistrubutedSession error: A severe error occurred on the current command. The results, if any, should be discarded. Operation cancelled by user. 	I'm getting an error in DistributedSession. The source of the error seems to come from Cancellation tokens. There was discussion on quieting some of the noisy logs coming from cancellation tokens here in [Session Issue 189](https://github.com/aspnet/Session/issues/189)I'm wondering if the same can be done for this error? Or, if not, how can I handle this error myself?I'll keep trying, but so far, I'm unable to reproduce.**Exception Message:** A severe error occurred on the current command. The results, if any, should be discarded. Operation cancelled by user. **Stack trace:** ```System.Data.SqlClient.SqlException (0x80131904): A severe error occurred on the current command.  The results, if any, should be discarded. Operation cancelled by user.   at System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)   at System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)   at System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)   at System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)   at System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()   at System.Data.SqlClient.SqlDataReader.get_MetaData()   at System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption)   at System.Data.SqlClient.SqlCommand.CompleteAsyncExecuteReader(Boolean isInternal, Boolean forDescribeParameterEncryption)   at System.Data.SqlClient.SqlCommand.InternalEndExecuteReader(IAsyncResult asyncResult, String endMethod, Boolean isInternal)   at System.Data.SqlClient.SqlCommand.EndExecuteReaderInternal(IAsyncResult asyncResult)   at System.Data.SqlClient.SqlCommand.EndExecuteReaderAsync(IAsyncResult asyncResult)   at System.Threading.Tasks.TaskFactory`1.FromAsyncCoreLogic(IAsyncResult iar, Func`2 endFunction, Action`1 endAction, Task`1 promise, Boolean requiresSynchronization)--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.Extensions.Caching.SqlServer.DatabaseOperations.d__28.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.Extensions.Caching.SqlServer.DatabaseOperations.d__21.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.Extensions.Caching.SqlServer.SqlServerCache.d__10.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Session.DistributedSession.d__32.MoveNext()```The IIS logs also show this message in addition to stack trace: _Session cache read exception_I found [a test that tests for this message](https://github.com/aspnet/Session/blob/1869bd09fabb7ba2b9cdf457fbd5f7eaf6592bea/test/Microsoft.AspNetCore.Session.Tests/SessionTests.cs#L595), if that helps.asp.net core 2.1MVC site with DistributedSqlServerCache. Session is backed by SqlServer.
3476	area-servers	HttpClient does not work with Request.EnableRewind	_From @cnblogs-dudu on August 21, 2018 9:39_Perhaps it is `HttpConnection.WriteAsync` does not work with `FileBufferingReadStream`.Website A with the following code is listening 5000.```cspublic class HomeController : Controller{    public async Task<IActionResult> Index()    {        Request.EnableRewind();        var streamContent = new StreamContent(Request.Body);        var httpClient = new HttpClient();        var response = await httpClient.PostAsync("http://localhost:5002", streamContent);        return Ok(await response.Content.ReadAsStringAsync());    }}```Website B with the following code is listening 5002.```cspublic class HomeController : Controller{    public async Task<IActionResult> Index()    {        using (var ms = new MemoryStream())        {            await Request.Body.CopyToAsync(ms);            return Ok(ms.Length);        }    }}```Use the following curl command to send a request.```shellcurl -s -d 'test' localhost:5000/```The actual output is 0. The expected output is 4.If remove `Request.EnableRewind()`, it works.If put the following code between `Request.EnableRewind()` and `HttpClient` , it works.```csusing (var ms = new MemoryStream()){    await Request.Body.CopyToAsync(ms);}Request.Body.Seek(0, 0);```_Copied from original issue: dotnet/corefx#31866_
5435	area-mvc	Centralize content	We have some repeated content in our templates (site.css is one example) that we basically have to copy between each project which makes this very error prone. Let's centralize these items and run a pre-build preparation task which copies any needed files to be built into the templates. 
5085	area-mvc	Razor Language Service does not appear to work with cshtml files in fsproj project	I have noticed for a while now that when attempting to use Giraffe.Razor to make views for a Giraffe web application, the cshtml files themselves have no intellisense or formatting outside of basic html.  After playing around a bit with adding ProjectCapability elements directly to the fsproj, I noticed if I add CSharp as a project capability and reopening the project in Visual Studio (as adding this capability tends to crash Visual Studio the moment a cshtml file is open, or immediately if one is already open), the cshtml file now gets basic razor formatting in addition to the html formatting, but no csharp intellisense, and all fs files only get basic fsharp formatting with no intellisense.I would like to request that somehow Razor Language Service could somehow be made to work for this situation.  Having the design time editor treat the files as simply html files with no knowledge of how the razor or csharp bits work makes the use of Razor templates nearly worthless to me.
5935	area-hosting	Using custom ILoggerProvider and IServiceFactoryProvider breaks logging scopes of WebHost	_From @schuettecarsten on Wednesday, 08 August 2018 05:19:33_Create a sample AspNetCore application. Add a custom logging Framework that implements ILoggerProvider. Observe the behaviour of logging scopes, for each request you get several scopes that contain details about the connection and the request.Now add a custom DI container framework that implements IServiceFactoryProvider and a observe again. The logging scopes are lost.You can see that your LoggerProvider implementation is initialized twice. One time immediately after the start of the application, when the WebHost is initialized. After that, the custom DI container is registered and the logger is initialized again. Also, a new IExternalScopeProvider is registered at the LoggerProvider.The problem seems to be that the WebHost still uses the old, orphaned scope provider._Copied from original issue: aspnet/Home#3395_
5084	area-mvc	Directive usage errors need to appear in runtime too	There are cases like https://github.com/aspnet/Razor/issues/2539#issuecomment-416384015 when using directives as variables in cshtml results in a weird csharp error at runtime. Instead we should provide a Razor error like it does during design time.cc @dougbu @NTaylorMullen 
3471	area-middleware	Static files localization in RCL	RCL with static files with "localizable" names (like `messages.en.js`) throws 500 error.What happens: in RCL static files are included as embedded resources. And compiler includes localized files in separate dlls. And when you try to get them, you get an error:```info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/2.0 GET http://localhost/Test/js/messages.en.jsfail: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[1]      An unhandled exception has occurred while executing the request.System.NullReferenceException: Object reference not set to an instance of an object.   at Microsoft.Extensions.FileProviders.Embedded.Manifest.ManifestFileInfo.EnsureLength()   at Microsoft.Extensions.FileProviders.Embedded.Manifest.ManifestFileInfo.get_Length()   at Microsoft.AspNetCore.StaticFiles.StaticFileContext.LookupFileInfo()   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```Sample project with tests: https://github.com/meancrazy/LocalizationInRCL/
5334	area-signalr	Cannot connect from a non-browser Javascript client to Asp.Net Core SignalR	Hi, I am trying to write a non-browser javascript client to connect to my Asp.Net Core SignalR and I am having the following error message:> Debug: Starting HubConnection.> Debug: Starting connection with transfer format 'Text'.> Debug: Sending negotiation request: https://localhost:44339/chatHub/negotiate> Error: Failed to complete negotiation with the server: Error: callback argument missing> Error: Failed to start the connection: Error: callback argument missing**My Javascript non-browser javascript client code is as follows(this client powered with Node.Js):**global.XMLHttpRequest = require('xhr');var signalR = require('@aspnet/signalr');var connection = new signalR.HubConnectionBuilder()       .withUrl("https://localhost:44339/chatHub")       .configureLogging(signalR.LogLevel.Trace)      .build();connection.on("receivemessage", function(user, message) {    var msg = message.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;");    var encodedmsg = user + " says " + msg;    console.log(encodedmsg);});connection.start().catch(function(err) {    //return console.error(err.tostring());});**My Asp.Net Core SignalR is that exact implementation from this tutorial:** [click here](https://docs.microsoft.com/en-us/aspnet/core/signalr/javascript-client?view=aspnetcore-2.1)**One the Server-side, I am using:**- Microsoft.AspNetCore.SignalR version 1.0.3- Microsoft IIS Express (Visual Studio 2017 version 15.8.1)- C# - Operating System: Windows 10 version 1803**On the client side:**- Node.js version 9.11.1- Visual Studio Code version 1.26.1- ASP.NET Core SignalR JavaScript Client version 1.0.3- Module xhr, version 2.5.0
5584	area-mvc	Could not publish with --no-build	1. Have setup Two projects. First is API, second is Client Blazor app which is referenced by API.2. I do build of solution using dotnet build3. then I run `dotnet publish API --no-build`Resulting the generated output does not contains .blazor.configwhen I run `dotnet publish` without specifying `--no-build` produced package contains valid `blazor.config` file. This make whole published package unusable.
5934	area-hosting	host.RunAsService() throws PlatformNotSupportedException on Windows	Hello!I'm facing a very strange issue. Currently I'm porting our .Net Framework windows service to ASP.NET Core. For the windows service part, i have been following this tutorial: https://docs.microsoft.com/en-us/aspnet/core/host-and-deploy/windows-service?view=aspnetcore-2.1However the `host.RunAsService()` throws a `PlatformNotSupportedException `on my windows dev machine (i didn't had the time to test it somewhere else).```c#System.PlatformNotSupportedException: ServiceController enables manipulating and accessing Windows services and it is not applicable for other operating systems.   at System.ServiceProcess.ServiceBase..ctor()   at Microsoft.AspNetCore.Hosting.WindowsServices.WebHostService..ctor(IWebHost host)   at Project.TerminalServer.Program.Main(String[] args) in C:\Users\user\source\repos\Project\src\Project.Server\Program.cs:line 63```The code isn't very spectacular:```c#IsService = args.Contains(RUN_AS_SERVICE);ContentRoot = IsService ? Path.GetDirectoryName(Process.GetCurrentProcess().MainModule.FileName) : Directory.GetCurrentDirectory();Logger = NLogBuilder.ConfigureNLog(Path.Combine(ContentRoot, NLOG_CONFIG)).GetCurrentClassLogger();var host = CreateWebHostBuilder(args.Where(x => x != RUN_AS_SERVICE).ToArray()).Build();                if (IsService){    Logger.Info("Starting as a service.");    host.RunAsService();}else{    Logger.Info("Starting in console mode.");    host.Run();}```Info:```ASP.NET Core 2.1.2 with Microsoft.AspNetCore.Hosting.WindowsServices 2.1.1.Windows 10.0.17134 C:\Users\user>dotnet --version2.1.400```
5083	area-mvc	Generate Page classes as sealed	None of the virtual/overriden properties or methods on a Page are inlinable (as they are virtual); if the generated Page was `sealed` they would be.The non-inlinablity causes crazy call counts for moderate sized pages e.g.For 9k requests of a Razor Page![image](https://user-images.githubusercontent.com/1142958/44684663-8f629980-aa41-11e8-9bb7-5ee0387ed2b2.png)![image](https://user-images.githubusercontent.com/1142958/44684807-eec0a980-aa41-11e8-8dce-36dbd956aa1a.png)/cc @rynowak @davidfowl 
5583	area-mvc	Button's onclick triggered upon right mouse click	When you have onclick event e.g.```<button onclick="@HandleClick">Click me</button>```it's triggered upon both left and right button click. I think it's a bug, as you can read in living HTML [standard](https://w3c.github.io/uievents/#event-type-click):>The click event type MUST be dispatched on the topmost event target indicated by the pointer, when the user presses down and releases the **primary** pointer button, or otherwise activates the pointer in a manner that simulates such an action.
3465	area-servers	Improve documentation for RequestHeaders.Get(String) Method	This issue was created by @StevenLiekens from https://github.com/MicrosoftDocs/feedback/issues/626. I couldn't find the comment section for this article so consider this a comment.Link to article:https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.http.headers.requestheaders.get?view=aspnetcore-2.1#Microsoft_AspNetCore_Http_Headers_RequestHeaders_Get__1_System_String_Problem:There is no good documentation for `RequestHeaders.Get<T>(string): T`. I tried using it and thought I could substitute T with anything I want, like string. That turned out not to work.```c#var myHeader = requestHeaders.Get<string>("X-My-Header");```I found out the hard way that there is an implicit constraint on T: it needs to be a type with a static TryParse method.```System.NotSupportedException: 'The given type 'T' does not have a TryParse method with the required signature 'public static bool TryParse(string, out T).'```That should be documented.
5933	area-hosting	Add factory overload for `UseServiceProviderFactory`	Hello,I am trying to configure the generic `HostBuilder` to use Autofac, and I am running into an issue that I think could be solved by adding the following overload to `IHostBuilder`:```csharpIHostBuilder UseServiceProviderFactory<TContainerBuilder>(Func<HostBuilderContext, IServiceProviderFactory<TContainerBuilder>> configureDelegate);```The usage of this api would allow for the following startup:```csharp.UseServiceProviderFactory(hostBuilderContext => new AutofacServiceProviderFactory(containerBuilder => containerBuilder.Properties.Add(nameof(HostBuilderContext), hostBuilderContext)));```This change would allow all of my Autofac modules to gain access to the `HostBuilderContext`.```csharppublic abstract class AutofacModule : Autofac.Module{    protected sealed override void Load(ContainerBuilder builder)    {        base.Load(builder);        var hostBuilderContext = builder.Properties[nameof(HostBuilderContext)] as HostBuilderContext;        this.Load(builder, hostBuilderContext);    }    protected abstract void Load(ContainerBuilder builder, HostBuilderContext hostBuilderContext);}```
5333	area-signalr	How to disconnect specified client from outside hub	I have a web Api for disconnectting specified client ,how to disconnect specified client from outside hub.I do not find a method about disconnect client from IHubContext<T>;
4729	area-servers	Respect client's header table size settings	Follow-up to https://github.com/aspnet/KestrelHttpServer/issues/2816. Currently our encoder does not do any header compression. If we decide to do response header compression, we will need to take into account the client's settings for header table size.
5238	area-mvc	IIS deployment is not working	Hi,I created new application in .Net core and Angular JS. I did on click publish to IIS server, it is not working.I am getting the below mentioned error.**project structure**![image](https://user-images.githubusercontent.com/39718742/44590587-1a8d2680-a7d9-11e8-9b67-c45a67eb2c4b.png)**My deployment folder**![image](https://user-images.githubusercontent.com/39718742/44590635-3bee1280-a7d9-11e8-8c1f-dd20e38c2d06.png)**Raw error detail:**System.AggregateException: One or more errors occurred. (One or more errors occurred. (The NPM script 'start' exited without indicating that the Angular CLI was listening for requests. The error output was: npm ERR! Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'npm ERR!  { [Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'])) ---> System.AggregateException: One or more errors occurred. (The NPM script 'start' exited without indicating that the Angular CLI was listening for requests. The error output was: npm ERR! Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'npm ERR!  { [Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json']) ---> System.InvalidOperationException: The NPM script 'start' exited without indicating that the Angular CLI was listening for requests. The error output was: npm ERR! Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'npm ERR!  { [Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'] ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.StartAngularCliServerAsync(String sourcePath, String npmScriptName, ILogger logger)   --- End of inner exception stack trace ---   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.StartAngularCliServerAsync(String sourcePath, String npmScriptName, ILogger logger)   --- End of inner exception stack trace ---   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.<>c.<Attach>b__2_0(Task`1 task)   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)--- End of stack trace from previous location where exception was thrown ---   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)   --- End of inner exception stack trace ---   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)   at Microsoft.AspNetCore.SpaServices.Extensions.Util.TaskTimeoutExtensions.WithTimeout[T](Task`1 task, TimeSpan timeoutDelay, String message)   at Microsoft.AspNetCore.SpaServices.Extensions.Proxy.SpaProxy.PerformProxyRequest(HttpContext context, HttpClient httpClient, Task`1 baseUriTask, CancellationToken applicationStoppingToken, Boolean proxy404s)   at Microsoft.AspNetCore.Builder.SpaProxyingExtensions.<>c__DisplayClass2_0.<<UseProxyToSpaDevelopmentServer>b__0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Flex.EQ.UI.Startup.<>c__DisplayClass5_0.<<Configure>b__0>d.MoveNext() in C:\TFSCorp\MPDM Tracker\Dev\Client\Flex.EQ.UI\Startup.cs:line 91--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Session.SessionMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)---> (Inner Exception #0) System.AggregateException: One or more errors occurred. (The NPM script 'start' exited without indicating that the Angular CLI was listening for requests. The error output was: npm ERR! Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'npm ERR!  { [Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json']) ---> System.InvalidOperationException: The NPM script 'start' exited without indicating that the Angular CLI was listening for requests. The error output was: npm ERR! Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'npm ERR!  { [Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'] ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.StartAngularCliServerAsync(String sourcePath, String npmScriptName, ILogger logger)   --- End of inner exception stack trace ---   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.StartAngularCliServerAsync(String sourcePath, String npmScriptName, ILogger logger)   --- End of inner exception stack trace ---   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.<>c.<Attach>b__2_0(Task`1 task)   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)--- End of stack trace from previous location where exception was thrown ---   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot)---> (Inner Exception #0) System.InvalidOperationException: The NPM script 'start' exited without indicating that the Angular CLI was listening for requests. The error output was: npm ERR! Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'npm ERR!  { [Error: ENOENT, open 'D:\EQ\UI\node_modules\start\package.json'] ---> System.IO.EndOfStreamException: Attempted to read past the end of the stream.   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.StartAngularCliServerAsync(String sourcePath, String npmScriptName, ILogger logger)   --- End of inner exception stack trace ---   at Microsoft.AspNetCore.SpaServices.AngularCli.AngularCliMiddleware.StartAngularCliServerAsync(String sourcePath, String npmScriptName, ILogger logger)<---<---
5237	area-mvc	Running with webpack publicPath="/path" locally with IISExpress causes HMR endpoint to be hosted under "/path/path/__webpack_hmr"	Running my ASP.NET Core 2.1 app through Visual Studio using IIS Express. launchsettings.json:``` json{  "iisSettings": {    "windowsAuthentication": true,    "anonymousAuthentication": false,    "iisExpress": {      "applicationUrl": "http://localhost:54163/AppName",      "sslPort": 0    }  },  "profiles": {    "IIS Express": {      "commandName": "IISExpress",      "launchBrowser": true,      "environmentVariables": {        "ASPNETCORE_ENVIRONMENT": "Development"      }    }  }}```In my webpack config, I have `output.publicPath = "/AppName/"`In my Startup.cs, I have``` cs                    app.UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions                    {                        HotModuleReplacement = true,                    });```With this configuration, all requests that should be getting proxied through webpack-hot-middleware are being proxied under `/AppName/AppName` instead of just `/AppName`. For example, the `__webpack_hmr` endpoint is being hosted at `/AppName/AppName/__webpack_hmr`, even though attempts to request it in the browser are going after `/AppName/__webpack_hmr`. The same goes for all my static files & for the hot-update js/json files. No amount of tweaking `WebpackDevMiddlewareOptions.HotModuleReplacementEndpoint` was able to fix this, because this value is always added in additionally to the path - there's no way to remove one of the repeated bits of base path.I was able to work around this in the interim by adding the following rewrite rule in my Startup.cs just before I call `UseWebpackDevMiddleware`:``` csapp.UseRewriter(new RewriteOptions()    .AddRewrite("^__hmr__(.*)", "AppName/__hmr__$1", true));```and then changing my webpack `publicPath` to `/AppName/__hmr__/` (the reason I changed the public path was to ensure that all HMR requests had a unique bit of path to them so I could distinguish them from other requests.I believe this is because `WebpackDevMiddleware.UseProxyToLocalWebpackDevMiddleware` does not accommodate for the fact that my ASP.NET Core application already has a root URL configured via `IISSetupFilter`: https://github.com/aspnet/Home/issues/2302#issuecomment-350801537Could checks be added to `ConditionalProxyMiddleware` that would accommodate for `context.Request.PathBase` somehow?
4730	area-servers	An InvalidOperationException instead of an OperationCanceledException can sometimes be thrown for request body timeouts	See the following test failure from aspnet/KestrelHttpServer#2845```17:14:07   [xUnit.net 00:00:53.16]     ConnectionClosedWhenBothRequestAndResponseExperienceBackPressure [FAIL]17:14:07   Failed   ConnectionClosedWhenBothRequestAndResponseExperienceBackPressure17:14:07   Error Message:17:14:07    Assert.Throws() Failure17:14:07   Expected: typeof(System.OperationCanceledException)17:14:07   Actual:   typeof(System.InvalidOperationException): Advancing examined to the end would cause pipe to deadlock because FlushAsync is waiting.17:14:07   Stack Trace:17:14:07      at System.IO.Pipelines.ThrowHelper.ThrowInvalidOperationException_BackpressureDeadlock()17:14:07      at System.IO.Pipelines.Pipe.AdvanceReader(BufferSegment consumedSegment, Int32 consumedIndex, BufferSegment examinedSegment, Int32 examinedIndex)17:14:07      at System.IO.Pipelines.Pipe.DefaultPipeReader.AdvanceTo(SequencePosition consumed, SequencePosition examined)17:14:07      at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1MessageBody.PumpAsync()17:14:07      at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()17:14:07      at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)17:14:07      at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)17:14:07      at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)17:14:07      at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.MessageBody.CopyToAsync(Stream destination, CancellationToken cancellationToken) in /_/src/Kestrel.Core/Internal/Http/MessageBody.cs:line 8617:14:07      at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.CopyToAsyncInternal(Stream destination, CancellationToken cancellationToken) in /_/src/Kestrel.Core/Internal/Http/HttpRequestStream.cs:line 15717:14:07      at Microsoft.AspNetCore.Server.Kestrel.FunctionalTests.ResponseTests.<>c__DisplayClass11_0.<<ConnectionClosedWhenBothRequestAndResponseExperienceBackPressure>g__App|4>d.MoveNext() in /_/test/Kestrel.Transport.FunctionalTests/ResponseTests.cs:line 67917:14:07   --- End of stack trace from previous location where exception was thrown ---17:14:07   Standard Output Messages:17:14:07    | [0.001s] TestLifetime Information: Starting test ConnectionClosedWhenBothRequestAndResponseExperienceBackPressure at 2018-08-24T00:13:5617:14:07    | [0.010s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Hosting starting17:14:07    | [0.010s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Hosting started17:14:07    | [0.011s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Loaded hosting startup assembly Sockets.FunctionalTests, Version=2.2.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae6017:14:07    | [0.011s] Microsoft.AspNetCore.Server.Kestrel Debug: TestServer is listening on port 5931217:14:07    | [0.011s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLG9APF4IM52" started.17:14:07    | [0.011s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request starting HTTP/1.1 POST http:///  655360017:14:07    | [0.023s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLG9APF4IM52", Request id "0HLG9APF4IM52:00000001": started reading request body.17:14:07    | [1.598s] Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets Debug: Connection id "0HLG9APF4IM52" paused.17:14:07    | [3.025s] Microsoft.AspNetCore.Server.Kestrel Information: Connection id "0HLG9APF4IM52", Request id "0HLG9APF4IM52:00000001": the connection was closed because the response was not read by the client at the specified minimum data rate.17:14:07    | [3.025s] Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets Debug: Connection id "0HLG9APF4IM52" aborted.17:14:07    | [3.025s] Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets Debug: Connection id "0HLG9APF4IM52" sending FIN.17:14:07    | [3.025s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLG9APF4IM52" disconnecting.17:14:07    | [3.026s] Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets Debug: Connection id "0HLG9APF4IM52" resumed.17:14:07    | [3.028s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLG9APF4IM52", Request id "0HLG9APF4IM52:00000001": done reading request body.17:14:07    | [3.030s] Microsoft.AspNetCore.Server.Kestrel Error: Connection id "0HLG9APF4IM52", Request id "0HLG9APF4IM52:00000001": An unhandled exception was thrown by the application.17:14:07    | System.InvalidOperationException: Advancing examined to the end would cause pipe to deadlock because FlushAsync is waiting.17:14:07    |    at System.IO.Pipelines.ThrowHelper.ThrowInvalidOperationException_BackpressureDeadlock()17:14:07    |    at System.IO.Pipelines.Pipe.AdvanceReader(BufferSegment consumedSegment, Int32 consumedIndex, BufferSegment examinedSegment, Int32 examinedIndex)17:14:07    |    at System.IO.Pipelines.Pipe.DefaultPipeReader.AdvanceTo(SequencePosition consumed, SequencePosition examined)17:14:07    |    at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1MessageBody.PumpAsync()17:14:07    |    at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()17:14:07    |    at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)17:14:07    |    at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)17:14:07    |    at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)17:14:07    |    at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.MessageBody.CopyToAsync(Stream destination, CancellationToken cancellationToken) in /_/src/Kestrel.Core/Internal/Http/MessageBody.cs:line 8617:14:07    |    at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.CopyToAsyncInternal(Stream destination, CancellationToken cancellationToken) in /_/src/Kestrel.Core/Internal/Http/HttpRequestStream.cs:line 15717:14:07    |    at Microsoft.AspNetCore.Server.Kestrel.FunctionalTests.ResponseTests.<>c__DisplayClass11_0.<<ConnectionClosedWhenBothRequestAndResponseExperienceBackPressure>g__App|4>d.MoveNext() in /_/test/Kestrel.Transport.FunctionalTests/ResponseTests.cs:line 67917:14:07    | --- End of stack trace from previous location where exception was thrown ---17:14:07    |    at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpProtocol.ProcessRequests[TContext](IHttpApplication`1 application) in /_/src/Kestrel.Core/Internal/Http/HttpProtocol.cs:line 54217:14:07    | [3.031s] Microsoft.AspNetCore.Hosting.Internal.WebHost Information: Request finished in 3019.943ms 200 17:14:07    | [3.032s] Microsoft.AspNetCore.Server.Kestrel Debug: Connection id "0HLG9APF4IM52" stopped.17:14:07    | [3.038s] Microsoft.AspNetCore.Hosting.Internal.WebHost Debug: Hosting shutdown17:14:07    | [3.039s] TestLifetime Information: Finished test ConnectionClosedWhenBothRequestAndResponseExperienceBackPressure in 3.038697s```https://ci3.dot.net/job/aspnet_KestrelHttpServer/job/release_2.2/job/osx-Configuration_Release_prtest/161/
5932	area-hosting	SIGTERM handling	Hi,I'm seeing issues with handling sigterm on a linux system, seeing similar behaviour to [516](https://github.com/aspnet/Hosting/issues/870#issuecomment-257433617) but on linuxEnvironment infoOS: **ubuntu 16.04** 64bitdotnet --version is **2.1.300**As the docs indicate WaitForShutdown should handle sigterm, sigint and ctrl-cCan see it handling sigint and ctrl-c as expected, but sigterm is not behaving as documented for meSince sigterm is what docker will send to a container being stopped this is pretty important for graceful shutdowns with log entriesI create a standard webapi project with ```dotnet new webapi``` and altered the Program.cs as follows```using System;using System.Linq;using Microsoft.AspNetCore;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Hosting.Server.Features;namespace shutdown{    public class Program    {        public static void Main(string[] args)        {            try            {                Console.WriteLine("About to build web host");                using (var host = BuildWebHost(args))                {                    Console.WriteLine("About to start host");                    host.Start();                    var serverAddressFeature = host.ServerFeatures.Get<IServerAddressesFeature>();                    Console.WriteLine($"Waiting for shutdown, listening on {String.Join(", ", serverAddressFeature.Addresses.ToArray())}");                    host.WaitForShutdown();                    Console.WriteLine("Shutting down");                }            }            catch (Exception exception)            {                Console.WriteLine($"Exception encountered, about to die {exception}");                throw;            }            finally            {                Console.WriteLine("Exiting finally");            }        }        public static IWebHost BuildWebHost(string[] args) =>            WebHost.CreateDefaultBuilder(args)                .UseStartup<Startup>()                .Build();    }}```So ```ctlr-c``` and ```kill -INT pid``` are working as expected and the exiting log lines appearBut ```kill pid``` is just resulting in the process terminating with no exiting log lines, this I did not expect and is an issue with docker where I need it to handle a sigtermThanks in advancePat
3452	area-mvc	CORS redesign in 3.0	Our CORS implementation leaves some room for improvement. We keep getting issues from customers about it.We should take 3.0 as an opportunity to revisit the scenarios customers need to support and to update our implementation to be cleaner and more straightforward as we keep getting issues from customers that are hard to fix or make our CORS implementation too complicated and confusing
3450	area-servers	QueryCollection Is Not Case Sensitive	According to [RFC3986](https://tools.ietf.org/html/rfc3986#section-6.2.2.1), everything in a URI except the host and scheme should be case-sensitive. However the current implementation [is case insensitive](https://github.com/aspnet/HttpAbstractions/blob/8b3c308c/src/Microsoft.AspNetCore.WebUtilities/KeyValueAccumulator.cs#L19), except [when there is no query string](https://github.com/aspnet/HttpAbstractions/blob/e854d3a/src/Microsoft.AspNetCore.WebUtilities/QueryHelpers.cs#L116). Personally I think the best choice is to make it configurable, defaulting to the current behavior as not to break anyone.
5582	area-mvc	Framework location path should be configurable	I am experimenting with different hosting scenarios for a Blzaor App and thought about packaging it into a Chrome Extension / App. however, Chrome Extension do not support _ at the begining of a path because it is reserved for system use.  Blazor make extensive use of _ in the path, at least for _framework and _bin. These paths should be configurable so that scenarios like Chrome Extension can be supported / tested.
4910	area-mvc	[Discussion]: 3.0: Deprecating MvcPrecompilation tool	In ASP.NET Core 1.1, we introduced the `Microsoft.AspNetCore.Mvc.Razor.ViewCompilation` (MVC precompilation tool) package that added support for publish time compilation of Razor files (.cshtml files). Starting in ASP.NET Core 2.1, we introduced the [Razor SDK](https://docs.microsoft.com/en-us/aspnet/core/razor-pages/sdk?view=aspnetcore-2.1) that expanded on the features of the precompilation tool by adding support for build and publish time of Razor files. The SDK allows for verifying the correctness of cshtml files at build time while also improving on startup time for applications. The Razor SDK is on by default and no gesture is required to start using it.In 3.0, we plan to remove the earlier MVC precompilation tool. Earlier versions of the package will continue receiving important bug and security fixes as part of our patch release. For users of ASP.NET Core 2.1 or later, we recommend migrating to the Razor SDK if you haven't already. If you're currently using the precompilation tool and are unable to migrate to the Razor SDK due to bugs or missing features, please file an issue at https://github.com/aspnet/Razor/issues.
5434	area-mvc	Remove SPA templates from the SDK and ship as NuGet packages only	We want to be able to update the SPA templates as fast as the client libraries update.
5581	area-mvc	Adding / Removing element via cshtml prevents click event from firing	If you have an if statement that updates a variable that is used to determine if an element should be rendered or not, and you update this variable in an onblur handler then the onclick handler of a button will not fire if the focus is on the element that has the onblur handler when you click the button.For example, if you create a new Blazor project and put the code in the attached file in the Counter.cshtml file you can see the issue. Just click in the input, then click the submit button. The onblur event of the input fires, but the onclick event of the button does not.If you remove the lines that render / prevents rendering (called out in the attached file) from the code, then both events fire as expected:[CodeToReplicateEventIssue.txt](https://github.com/aspnet/Blazor/files/2311808/CodeToReplicateEventIssue.txt) 
4731	area-servers	Kestrel dies because of Out of Memory exception	One of our MVC projects keeps growing memory, and it seems that Garbage collector dose not do anything with it.The process keeps growing until it is killed by the OS.`dmesg` outputs this log:```[961030.365411] Out of memory: Kill process 3673 (dotnet) score 913 or sacrifice child[961030.365725] Killed process 3673 (dotnet) total-vm:29592364kB, anon-rss:3565416kB, file-rss:256kB, shmem-rss:0kB```**What makes me think that it is related to, GC not working as expected is that, i have periodically called `GC.Collect() ` and memory immediately drops down significantly but still keeps growing in a much slower pace.**Also GC is running under Server mode.**Environment Info** ```Runtime: .Net Core 2.1ASP.NET Core 2.1Web server: Kestrel (directly exposed)OS: Centos 74 Core processor4GB Memory```Also not sure if it any how related, i thought maybe GC dose not recognize memory limits, so here is the output of `ulimit` command:```core file size          (blocks, -c) 0data seg size           (kbytes, -d) unlimitedscheduling priority             (-e) 0file size               (blocks, -f) unlimitedpending signals                 (-i) 15062max locked memory       (kbytes, -l) 64max memory size         (kbytes, -m) unlimitedopen files                      (-n) 1024pipe size            (512 bytes, -p) 8POSIX message queues     (bytes, -q) 819200real-time priority              (-r) 0stack size              (kbytes, -s) 8192cpu time               (seconds, -t) unlimitedmax user processes              (-u) 15062virtual memory          (kbytes, -v) unlimitedfile locks                      (-x) unlimited```**Notes*** the apps works as expected on Windows server 2016.* this may or may not be a duplicate of #1976 but all the issues in there are being tracked separately.**Update**Adding entire `dmesg` log [here ](https://gist.github.com/HassanHashemi/d1aa177a9cf552ef0cc8572f84e2dce3)as gist to keep things clear.
5236	area-mvc	Why not publish the nuget for 2.1.1 or more	https://www.nuget.org/packages/Microsoft.AspNetCore.SpaTemplates/Version | Downloads | Last updated-- | -- | --  | 2.1.0-preview1-final | 824 | 6 months ago  | 2.0.7 | 12,383 | 4 months ago  | 2.0.6 | 4,180 | 5 months ago  | 2.0.5 | 9,034 | 7 months ago  | 2.0.3 | 8,529 | 9 months ago
5816	area-identity	The total size of an index or primary key cannot exceed 900 bytes.	The default length of `UserId` and `RoleId` should not be 450, it's a `Guid` by default, so the size should match the default value as well.Once if I need UserId as a foreign key and if it's part of multiple primary keys, MS SQL throws this error:> The total size of an index or primary key cannot exceed 900 bytes.For example, table Customer, 2 primary keys:1.     UserId(nvarchar(450)),   --PK, FK. it does not work even if changing length to 100!2.     CustomerTypeId(int),   --PK, FK. CustomerType is another table3.     it will be worse if I had more PKs and FKsI don't want to customize anything about Identity Framework tables, I want keep using default setup.
5433	area-mvc	Assert that links work in Functional tests	To avoid issues like [this](https://github.com/aspnet/Templating/issues/692) we should Assert that our links are correct (or at least valid) in our functional tests.
5332	area-signalr	Check if connection state for a particular hub.	I have a situation where I have to keep a dictionary of connections which are connected via web socket.how can we get a list of connects which are started? 
5331	area-signalr	Feature Request - Python client for aspnet core SignalR.	
5432	area-mvc	Update to React 17	Unknown release date: https://github.com/facebook/react/milestone/40
5431	area-mvc	Update to Angular 7	It looks like Angular 7 is scheduled to be released in Sept/Oct of this year: https://angular.io/guide/releases#release-schedule
5082	area-mvc	Datatemplating	In XAML it is quite easy to use datatemplate on items. In Razor, it does not seem possible to do it without including an external view/component.It is quite often that I get several `foreach` on a page, with the same kind of items, and using razor, I have to repeat the same template several times, it is not very handy.I would see something similar to functions:```csharp@templates {     EventItemTemplate(string name, DateTime time, string place) {         <div class="event">              <div class="event-name">@name</div>              <div class="event-time">@time.ToString("g")</div>              <div class="event-place">@place</div>         <div>     }}<div class="events">    <div class="events-title">Coming events and in progress</div>    @foreach(var e in events.Where(e2=>e2.EndTime > DateTime.UtcNow))     {        @EventItemTemplate(e.Name, e.Start, e.Place)    }</div><div class="events">    <div class="events-title">Past events</div>    @foreach(var e in events.Where(e2=>e2.EndTime < DateTime.UtcNow))     {        @EventItemTemplate(e.Name, e.Start, e.Place)    }</div>```It would highly simplify the display of a structure like this:building.cs ```csharppublic class Building{    public string Address {get;set;}    public List<Floor> Floors {get;set;}}public class Floor{    public string Number {get;set;}    public List<Premise> Premises {get;set;}}public class Premise{    public string Door {get;set;}    public string Owner {get;set;}    public List<string> Residents {get;set;}}```building.cshtml```csharp@templates {     BuildingTemplate(Building b) {         <div class="building">              <div class="building-name">@b.Name</div>              <div class="building-floors">               @foreach(var f in p.Floors)               {                  @FloorTemplate(f)               }              </div>         <div>     }     FloorTemplate(Floor f) {         <div class="floor">              <div class="floor-number">@f.Number</div>              <div class="floor-premises">               @foreach(var p in f.Premises)               {                  @PremiseTemplate(p)               }              </div>         <div>     }     PremiseTemplate(Premise p) {         <div class="premise">              <div class="premise-door">@p.Door</div>              <div class="premise-owner">@p.Owner</div>              <div class="premise-residents">               @foreach(var r in p.Resident)               {                     <span class="premise-resident">@r</span>               }              </div>         <div>     }}<div class="buildings left-side">    @foreach(var b in Model.BuildingsLeft)     {        @BuildingTemplate(b)    }</div><div class="buildings right-side">    @foreach(var b in Model.BuildingsRight)     {        @BuildingTemplate(b)    }</div>```It may allow recursive templates```csharp@templates {     CommentItemTemplate(CommentViewModel comment) {         <div class="comment">              <div class="comment-name">By: @name</div>              <div class="comment-time">@time.ToString("g")</div>              @if(comment.Comments?.Count>0)              {                  <div class="comment-subcomments">                  @foreach(var c in comment.Comments)                  {                          @CommentItemTemplate(c)                  }                  </div>              }         <div>     }}<div class="comments">    <div class="comments-title">Comments</div>    @foreach(var c in Model.Comments)     {        @CommentItemTemplate(c)    }</div>```In that specific case, component may be a better choice of implementation, but that is just an example.Globally defined c# variables may be available or not, depending on language constraints. If not available, they can still be passed as parameters anyway.It seems quite clean to me, does it conflict the current language in any way?
4909	area-mvc	Route Localizer ( Area, Controller and Action Names )	#### Is this a Bug or Feature request?:Feature request#### Description of the problem:As ASP Net Core already implements StringLocalizer and ViewLocalizer, it would be great if it implemented "RouteLocalizer" so that an application could be fully localizable.Example:**[ControllerNameLocalizer(**"Resource.Key"**)]****[ActionNameLocalizer(**"Resource.Key"**)]**```csharppublic class HomeController : Controller    {        [ActionNameLocalizer("About")]        public IActionResult About()        {            return View();        }    }```localhost:5000/Home/**About** ( en-US )localhost:5000/Home/**Sobre** ( pt-BR )
5931	area-hosting	Implement IServerAddressesFeature for TestServer	Using a fairly-generic 2.1 web site with `app.UseHttpsRedirection();` in its `Startup.Configure(...)` method, the following code (after discovering the site's `CreateWebHostBuilder` method) does _not_ prevent the `Failed to determine the https port for redirect.` warning from the middleware:``` c#var builder = (IWebHostBuilder)methodInfo.Invoke(obj: null, parameters: args);// Enable HTTPS in case HttpsRedirectionMiddleware is in use.builder.PreferHostingUrls(preferHostingUrls: true);builder.UseUrls("https://localhost", "http://localhost");using (var server = new TestServer(builder)){    var httpClient = server.CreateClient();    // send a request to HTTP port e.g. client's default base address}```Oddly, the warning goes away and redirection occurs if I remove the `builder.PreferHostingUrls(preferHostingUrls: true);` statement. But, it's not clear why that breaks anything.This feels like a bug in `TestServer` per @jkotalik. Also per @jkotalik, this is likely a separate issue from #1523.
5430	area-mvc	Add a CSS Grid Layout template for new projects	_From @josejmoran on August 17, 2018 11:40_It will be great to have a template for creating new projects where the Razor pages make use of CSS Grid Layout and CSS only without the use of javascript libraries: No bootstrap, No jquery, just core technologies._Copied from original issue: aspnet/Razor#2543_
5235	area-mvc	Improve interaction with DotNet.Watcher.Tools	I'm not sure it is possible to improve it, but the experience while using angular SpaServices while also using DotNet.Watcher.Tools is pretty bad when making changes to the server. Any time a change is made a new background 'npm start' is run. For large projects webpack is notoriously slow during the first build. It would be amazing if SpaServices could maintain the instance of 'npm start' across DotNet.Watcher.Tools restarts.
4732	area-servers	Add IIPEndPointConnectionFeature	Right now the only way to get IP information is to go through the IHttpConnectionFeature which is a bit unfortunate:```C#public interface IIPEndPointConnectionFeature{    IPEndPoint RemoteEndPoint { get; set; }    IPEndPoint LocalEndPoint { get; set; }}```
5234	area-mvc	Error is vague when supplying empty string to AddSpaStaticFiles	### Functional impactThis one's pretty minor, but annoying.When one's static files start at the root of a project, one's first instinct is to set the RootPath configuration variable to an empty string, much like one would with the `app.UseStaticFiles("")` method call.Unfortunately, setting the RootPath to an empty string in the service collection call `services.AddSpaStaticFiles(config => config.RootPath = "")` results in an `InvalidOperationException` claiming that "No RootPath was set on the SpaStaticFilesOptions." This is both incorrect and confusing.![image](https://user-images.githubusercontent.com/5761601/44305251-f9dc5100-a340-11e8-9d51-25853f4e71f2.png)Based on the [source](https://github.com/aspnet/JavaScriptServices/blob/436cdb0e967ab5b3e3903bb876bbd3edef844172/src/Microsoft.AspNetCore.SpaServices.Extensions/StaticFiles/SpaStaticFilesExtensions.cs#L37), this error should say something to the tune of "RootPath may not be null or empty." I know the exception handling was designed to be generic, but seeing as RootPath is currently the only configurable variable, this shouldn't be a problem.### Minimal repro steps1. Create a dotnet web project targeting `netcoreapp2.1`.2. Add `services.AddSpaStaticFiles(config => config.RootPath = "")` to the `Startup.ConfigureServices` method.3. Add `app.UseSpaStaticFiles();` to the `Startup.Configure` method.4. Build and run.### Expected resultA clearer exception that didn't require me digging into the source to find out why I was getting it, or allowing the user to choose the root of the project for his/her ClientApp.### Actual resultAn unclear exception and a failure to load the SPA.
5429	area-mvc	Dockerfile support in webapi template?	Adding sample docker file the can be used to deploy the app (based on one of the [official samples](https://github.com/dotnet/dotnet-docker/tree/master/samples/aspnetapp)) could make it a lot easier for people who start with .NET and want to run their code on Docker.  I find myself many times just copy an existing dockerfile from another project, or from the official samples.If that makes sense, I would be happy to open a pull request.
4276	area-mvc	WIP - Activities and distributed tracing	Figure out how to log deep links to diagnostics providers by default. cc @mkArtakMSFT \ @glennc \ @shirhatti 
3795	area-servers	Out of process handler should be able to unload after last application is stopped	Currently, it runs code after `IAPPLICATION.Stop` causing DLL unload to AV.
4908	area-mvc	Consider adding a feature to link generation to add metadata that indicates that the link is broken	Related to https://github.com/aspnet/Routing/issues/728With 2.1 routing, link generation has two modes of behavior when a route cannot be resolved:* Conventional routes will produce a url (which will 404) e.g. `<a asp-controller="DoesNotExist" asp-action="Index">` -> `<a href="DoesNotExist/Index">`* Attribute routes will produce empty urls e.g. `<a asp-controller="DoesNotExist" asp-action="Index">` -> `<a href="">`With 2.2 (endpoint) routing, empty urls are always produced regardless of the style of routing.Neither of these experiences are very good and there isn't a good way for a developer to identify if urls are invalid. Endpoint routing's link generation has a feature that indicates when a link could not be generated. We could take advantage of this to generate some additional markup (`data-` attributes, `css` classes etc) as part of html generation in **developer** mode. At minimum, we could inject a script in development that prints logs these to the console. Once the data is available, more involved visualizations (a developer console for instance) could be implemented.
3819	area-servers	Expose ITlsHandshakeFeature for in-proc	https://github.com/aspnet/HttpAbstractions/pull/1019
5330	area-signalr	Add support to SignalR for Session	
5579	area-mvc	Bind does not yet handle radio buttons	I have the the following in my cshtml````    <td>        <input type="radio" name="vacation" bind="@northwestVacation" /> Northwest @northwestVacation<br>        <input type="radio" name="vacation" bind="@sinaiVacation" /> Sinai @sinaiVacation    </td>````with corresponding properties `northwestVacation` and `sinaiVacation` in my code. During a debug session I see the `get` called numerous times for each but even with a `true` value the corresponding radio button is not in the selected state. And, as I select either button I never see the `set` called on either property.
4907	area-mvc	Test failure: CacheTagHelper_VaryByCultureComposesWithOtherVaryByOptions	This test [fails](http://aspnetci/viewLog.html?buildId=532556&buildTypeId=Releases_22xPublic_OsxUniverse) occasionally with the following error:```Assert.Equal() Failure           ↓ (pos 1)Expected: 10Actual:   14           ↑ (pos 1)   at Microsoft.AspNetCore.Mvc.FunctionalTests.HtmlGenerationWithCultureTest.CacheTagHelper_VaryByCultureComposesWithOtherVaryByOptions() in /_/test/Microsoft.AspNetCore.Mvc.FunctionalTests/HtmlGenerationWithCultureTest.cs:line 152--- End of stack trace from previous location where exception was thrown ---```Other tests within that build may have failed with a similar message, but they are not listed here. Check the link above for more info.This test failed on 2.2.CC @mkArtakMSFTThis issue was made automatically. If there is a problem contact ryanbrandenburg.
5233	area-mvc	Sourcemaps not working	I have no clue what is causing this. I don't even know where to start. I have updated my nuget and node packages to the lastest. That means I'm on webpack 4 too. The source file structure looks different. The files aren't showing the source either, just the compiled versions.This is the unmodified site structure:![image](https://user-images.githubusercontent.com/114971/44179757-685dac80-a0be-11e8-9bd3-d6c72306895a.png)This is the structure after doing the upgrades:![image](https://user-images.githubusercontent.com/114971/44179839-d4401500-a0be-11e8-8c97-c0cb94b3c794.png)What determines this structure? Is this webpack, aspnet-webpack, JS node services, something else?webpack.config.vendor.js```jsconst path = require("path");const webpack = require("webpack");const ExtractTextPlugin = require("extract-text-webpack-plugin");const merge = require("webpack-merge");const UglifyJsPlugin = require("uglifyjs-webpack-plugin");module.exports = (env) => {	const isDevBuild = !(env && env.prod);	const extractCSS = new ExtractTextPlugin("vendor.css");	const sharedConfig = {		mode: isDevBuild ? "development" : "production",		stats: { modules: false },		resolve: { extensions: [".js"] },		module: {			rules: [				{ test: /\.(png|woff|woff2|eot|ttf|svg)(\?|$)/, use: "url-loader?limit=100000" }			]		},		entry: {			vendor: [				"@fortawesome/fontawesome-svg-core",				"@fortawesome/free-brands-svg-icons",				"@fortawesome/free-solid-svg-icons",				"@fortawesome/react-fontawesome",				"babel-polyfill",				"classnames",				"domain-task",				"event-source-polyfill",				"history",				"react",				"react-dom",				"react-redux",				"redux",				"redux-logger",				"react-router-dom",				"react-router-redux",				"redux-thunk"			],		},		output: {			publicPath: "dist/",			filename: "[name].js",			library: "[name]_[hash]",		},		plugins: [			//new webpack.ProvidePlugin({ $: "jquery", jQuery: "jquery" }), // Maps these identifiers to the jQuery package (because Bootstrap expects it to be a global variable)			new webpack.NormalModuleReplacementPlugin(/\/iconv-loader$/, require.resolve("node-noop")), // Workaround for https://github.com/andris9/encoding/issues/16			new webpack.DefinePlugin({				"process.env.NODE_ENV": isDevBuild ? '"development"' : '"production"'			})		]	};	const clientBundleConfig = merge(sharedConfig, {		output: { path: path.join(__dirname, "wwwroot", "dist") },		module: {			rules: [				{ test: /\.css(\?|$)/, use: extractCSS.extract({ use: isDevBuild ? "css-loader" : "css-loader?minimize" }) }			]		},		plugins: [			extractCSS,			new webpack.DllPlugin({				path: path.join(__dirname, "wwwroot", "dist", "[name]-manifest.json"),				name: "[name]_[hash]"			})		].concat(isDevBuild ? [] : [			new UglifyJsPlugin()		])	});	const serverBundleConfig = merge(sharedConfig, {		target: "node",		resolve: { mainFields: ["main"] },		output: {			path: path.join(__dirname, "ClientApp", "dist"),			libraryTarget: "commonjs2",		},		module: {			rules: [{ test: /\.css(\?|$)/, use: isDevBuild ? "css-loader" : "css-loader?minimize" }]		},		entry: { vendor: ["aspnet-prerendering", "react-dom/server"] },		plugins: [			new webpack.DllPlugin({				path: path.join(__dirname, "ClientApp", "dist", "[name]-manifest.json"),				name: "[name]_[hash]"			})		]	});	return [clientBundleConfig, serverBundleConfig];};```webpack.config.js```jsconst path = require("path");const webpack = require("webpack");const ExtractTextPlugin = require("extract-text-webpack-plugin");const merge = require("webpack-merge");const UglifyJsPlugin = require("uglifyjs-webpack-plugin");module.exports = (env) => {	const isDevBuild = !(env && env.prod);	// Configuration in common to both client-side and server-side bundles	const sharedConfig = () => ({		mode: isDevBuild ? "development" : "production",		stats: { modules: false },		resolve: { extensions: [".js", ".jsx"] },		output: {			filename: "[name].js",			publicPath: "dist/" // Webpack dev middleware, if enabled, handles requests for this URL prefix		},		externals: {			google: "google"		},		module: {			rules: [{				test: /\.jsx?$/,				include: /ClientApp/,				use: {					loader: "babel-loader",					options: {						presets: ["env", "stage-2", "react"]					}				}			}, {				test: /\.(png|jpg|jpeg|gif|svg)$/,				use: "url-loader?limit=25000"			}]		}	});	// Configuration for client-side bundle suitable for running in browsers	const clientBundleOutputDir = "./wwwroot/dist";	const clientBundleConfig = merge(sharedConfig(), {		entry: { "client": "./ClientApp/client.js" },		module: {			rules: [{				test: /\.s[ca]ss$/,				use: ExtractTextPlugin.extract({					use: [						isDevBuild ? "css-loader" : "css-loader?minimize",						"sass-loader"					]				})			}, {				test: /\.(png|jpg|jpeg|gif|svg)$/,				use: "url-loader?limit=25000"			}]		},		output: { path: path.join(__dirname, clientBundleOutputDir) },		plugins: [			new ExtractTextPlugin("site.css"),			new webpack.DllReferencePlugin({				context: __dirname,				manifest: require("./wwwroot/dist/vendor-manifest.json")			}),			new webpack.DefinePlugin({				"process.env": {					"NODE_ENV": JSON.stringify(isDevBuild ? "development" : "production")				}			})		].concat(isDevBuild ? [			// Plugins that apply in development builds only			new webpack.SourceMapDevToolPlugin({				filename: "[file].map", // Remove this line if you prefer inline source maps				moduleFilenameTemplate: path.relative(clientBundleOutputDir, "[resourcePath]") // Point sourcemap entries to the original file locations on disk			})		] : [				// Plugins that apply in production builds only				new UglifyJsPlugin()			])	});	// Configuration for server-side (prerendering) bundle suitable for running in Node	const serverBundleConfig = merge(sharedConfig(), {		resolve: { mainFields: ["main"] },		entry: { "server": "./ClientApp/server.js" },		plugins: [			new webpack.DllReferencePlugin({				context: __dirname,				manifest: require("./ClientApp/dist/vendor-manifest.json"),				sourceType: "commonjs2",				name: "./vendor"			})		],		output: {			libraryTarget: "commonjs",			path: path.join(__dirname, "./ClientApp/dist")		},		target: "node",		devtool: "inline-source-map"	});	return [clientBundleConfig, serverBundleConfig];};```.csproj```xml<Project Sdk="Microsoft.NET.Sdk.Web">	<PropertyGroup>		<TargetFramework>netcoreapp2.1</TargetFramework>		<LangVersion>latest</LangVersion>		<TargetLatestRuntimePatch>true</TargetLatestRuntimePatch>	</PropertyGroup>	<ItemGroup>		<PackageReference Include="EPPlus" Version="4.5.2.1" />		<PackageReference Include="Microsoft.AspNetCore.App" />		<PackageReference Include="Microsoft.AspNetCore.SpaServices.Extensions" Version="2.1.1" />		<PackageReference Include="Pomelo.EntityFrameworkCore.MySql" Version="2.1.1" />		<PackageReference Include="System.Linq.Dynamic.Core" Version="1.0.8.13" />	</ItemGroup>	<ItemGroup>		<!-- Files not to publish (note that the 'dist' subfolders are re-added below) -->		<Content Remove="ClientApp\**" />	</ItemGroup>	<ItemGroup>		<None Include="wwwroot\favicon.ico" />	</ItemGroup>	<Target Name="DebugRunWebpack" BeforeTargets="Build" Condition=" '$(Configuration)' == 'Debug' And !Exists('wwwroot\dist') ">		<!-- Ensure Node.js is installed -->		<Exec Command="node --version" ContinueOnError="true">			<Output TaskParameter="ExitCode" PropertyName="ErrorCode" />		</Exec>		<Error Condition="'$(ErrorCode)' != '0'" Text="Node.js is required to build and run this project. To continue, please install Node.js from https://nodejs.org/, and then restart your command prompt or IDE." />		<!-- In development, the dist files won't exist on the first run or when cloning to         a different machine, so rebuild them if not already present. -->		<Message Importance="high" Text="Performing first-run Webpack build..." />		<Exec Command="node node_modules/webpack-cli/bin/cli.js --config webpack.config.vendor.js" />		<Exec Command="node node_modules/webpack-cli/bin/cli.js" />	</Target>	<Target Name="PublishRunWebpack" AfterTargets="ComputeFilesToPublish">		<!-- As part of publishing, ensure the JS resources are freshly built in production mode -->		<Exec Command="npm install" />		<Exec Command="node node_modules/webpack-cli/bin/cli.js --config webpack.config.vendor.js --env.prod" />		<Exec Command="node node_modules/webpack-cli/bin/cli.js --env.prod" />		<!-- Include the newly-built files in the publish output -->		<ItemGroup>			<DistFiles Include="wwwroot\dist\**; ClientApp\dist\**" />			<ResolvedFileToPublish Include="@(DistFiles->'%(FullPath)')" Exclude="@(ResolvedFileToPublish)">				<RelativePath>%(DistFiles.Identity)</RelativePath>				<CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>			</ResolvedFileToPublish>		</ItemGroup>	</Target></Project>```package.json```js{	"version": "1.0.0",	"name": "",	"private": true,	"scripts": {		"build-vendor": "webpack --color --config webpack.config.vendor.js",		"build-app": "webpack --color",		"build": "yarn build-vendor && yarn build-app"	},	"devDependencies": {		"@fortawesome/fontawesome-svg-core": "^1.2.0-14",		"@fortawesome/free-brands-svg-icons": "^5.1.0-11",		"@fortawesome/free-solid-svg-icons": "^5.1.0-11",		"@fortawesome/react-fontawesome": "^0.1.0-11",		"@types/history": "^4.6.2",		"@types/react": "^16.3.14",		"@types/react-dom": "^16.0.5",		"@types/react-hot-loader": "^4.1.0",		"@types/react-redux": "^6.0.0",		"@types/react-router": "^4.0.25",		"@types/react-router-dom": "^4.2.6",		"@types/react-router-redux": "^5.0.14",		"@types/webpack": "^4.4.0",		"@types/webpack-env": "^1.13.6",		"aspnet-prerendering": "^3.0.1",		"aspnet-webpack": "^3.0.0",		"aspnet-webpack-react": "^3.0.0",		"babel-core": "^6.26.3",		"babel-loader": "^7.1.4",		"babel-polyfill": "^6.26.0",		"babel-preset-env": "^1.7.0",		"babel-preset-react": "^6.24.1",		"babel-preset-stage-2": "^6.24.1",		"bulma": "^0.7.1",		"bulma-extensions": "^2.2.1",		"classnames": "^2.2.5",		"css-loader": "^1.0.0",		"domain-task": "^3.0.3",		"event-source-polyfill": "^0.0.12",		"extract-text-webpack-plugin": "^4.0.0-beta.0",		"file-loader": "^1.1.11",		"history": "^4.7.2",		"moment": "^2.22.1",		"node-noop": "1.0.0",		"node-sass": "^4.9.0",		"query-string": "^6.1.0",		"react": "^16.4.0",		"react-color": "^2.14.1",		"react-dom": "^16.4.0",		"react-hot-loader": "^4.2.0",		"react-redux": "^5.0.7",		"react-router-dom": "^4.2.2",		"react-router-redux": "^5.0.0-alpha.9",		"redux": "^4.0.0",		"redux-logger": "^3.0.6",		"redux-thunk": "^2.3.0",		"sass-loader": "^7.0.1",		"style-loader": "^0.21.0",		"uglifyjs-webpack-plugin": "^1.2.5",		"url-loader": "^1.0.1",		"webpack": "^4.10.2",		"webpack-cli": "^3.1.0",		"webpack-dev-middleware": "^3.1.3",		"webpack-hot-middleware": "^2.22.2",		"webpack-merge": "^4.1.2"	}}```Startup.cs```csusing Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.HttpsPolicy;using Microsoft.AspNetCore.Identity;using Microsoft.AspNetCore.Mvc;using Microsoft.AspNetCore.SpaServices.ReactDevelopmentServer;using Microsoft.AspNetCore.SpaServices.Webpack;using Microsoft.EntityFrameworkCore;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.DependencyInjection;using Newtonsoft.Json;namespace MyProject{    public class Startup    {        public Startup(IConfiguration configuration)        {            Configuration = configuration;        }        public IConfiguration Configuration { get; }        // This method gets called by the runtime. Use this method to add services to the container.        public void ConfigureServices(IServiceCollection services)        {			services.AddDbContext<ApplicationDbContext>(options => options.UseMySql(Configuration.GetConnectionString("DefaultConnection")));			services.AddIdentity<User, Role>()				.AddEntityFrameworkStores<ApplicationDbContext>()				.AddDefaultTokenProviders();            services.AddMvc()				.SetCompatibilityVersion(CompatibilityVersion.Version_2_1)				.AddJsonOptions(options => options.SerializerSettings.ReferenceLoopHandling = ReferenceLoopHandling.Ignore);        }        // This method gets called by the runtime. Use this method to configure the HTTP request pipeline.        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {				//app.UseBrowserLink();				app.UseDeveloperExceptionPage();				app.UseDatabaseErrorPage();				app.UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions				{					HotModuleReplacement = true,					ReactHotModuleReplacement = true				});			}			else            {                app.UseExceptionHandler("/Error");                app.UseHsts();            }            app.UseHttpsRedirection();            app.UseStaticFiles();			app.UseAuthentication();			app.UseMvc(routes =>            {                routes.MapRoute(                    name: "default",                    template: "{controller}/{action=Index}/{id?}");				routes.MapSpaFallbackRoute(					name: "spa-fallback",					defaults: new { controller = "Home", action = "Index" });			});        }    }}```
5578	area-mvc	SVG element attributes get mangled after build	In one of my components, I have a simple inline SVG with a path in it:```html<svg class="notif-icon" viewBox="0 0 24 24" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">            <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z" /></svg>```Notice the casing on `viewBox` and `preserveAspectRatio`.After building and running the page containing said component, The result looks like this:```html<svg class="notif-icon" viewbox="0 0 24 24" preserveaspectratio="none" xmlns="http://www.w3.org/2000/svg">            <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"></path></svg>```The CSS on that element, if that matters:```css.notif-icon {    fill: white;    width: 36px;    margin-left: 10px;    cursor: pointer;}```The casing on the attributes got flattened to lower-case in the process. At least in Firefox 61 and Chrome 68, This produces an invalid result. Applying any edit to the element in respective browser's devtools or simply correcting the casing produces the expected result.
4906	area-mvc	UrlResolutionTagHelper shoul have an asp-absolute-url attribute	What I'd like to see is as follows.If I have a tag in razor templates like `<img src="~/cats.png" asp-absolute-url="true">`, on a web app that IIS is serving from `http://whatever.domain/someroot` I would like the generated link to be `<img src="http://whatever.domain/someroot/cats.png" asp-absolute-url="true">` instead of `<img src="http://whatever.domain/someroot/cats.png" asp-absolute-url="true">`.Basically, code changes would be around here:https://github.com/aspnet/Mvc/blob/a67d9363e22be8ef63a1a62539991e1da3a6e30e/src/Microsoft.AspNetCore.Mvc.Razor/TagHelpers/UrlResolutionTagHelper.cs#L147 Why do I want this? Well I'm using Razor pages to write a custom login page Azure B2C. The way B2C works is it takes my custom login URL, reads that html as an Ajax call, and then injects it, with some customization into the login page served at `https://login.microsoftonline.com` Therefore relative URLs for the img and css don't work. Since I have a dev and production tenant, and want to be able to test out changes to the login page, I don't want to hard code the img and css urls.
5577	area-mvc	Remove the need for @addTagHelper	Ideally also this ties in with being namespace-sensitive when recognizing components.
5329	area-signalr	Implement IConnectionLifetimeFeature	This feature allows the application to forcefully abort the underlying transport without going through the pipe. It's implemented in Kestrel and should be implemented in the transport layer it should be implemented at the http.connections layer.
3814	area-servers	Add applicationHost.config reload tests	In addition to web.config ones
5575	area-mvc	ILLink incorrect parameters	I have issue which is similar to #356, but appear of different nature.```2018-08-13T17:41:23.3856861Z _LinkBlazorApplication:2018-08-13T17:41:23.3864968Z   dotnet "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\../tools/illink/illink.dll" -l none -c link -u link -b true -t --verbose  -d "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\../tools/mono/bcl/" -d "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\../tools/mono/bcl/Facades/" -o "c:\b\_work\17\s\MedNotes.Diagnostics\obj\Release\netstandard2.0\blazor/linker/" -x "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.aspnetcore.blazor.build\0.5.1\targets\BuiltInBclLinkerDescriptor.xml" -x "c:\b\_work\17\s\MedNotes.Diagnostics\obj\Release\netstandard2.0\blazor\linker.descriptor.xml" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\exceldatareader\3.4.0\lib\netstandard2.0\ExcelDataReader.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\htmlagilitypack\1.8.5\lib\netstandard2.0\HtmlAgilityPack.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\lucene.net\4.8.0-beta00005\lib\netstandard2.0\Lucene.Net.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\lucene.net.analysis.common\4.8.0-beta00005\lib\netstandard2.0\Lucene.Net.Analysis.Common.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\lucene.net.queries\4.8.0-beta00005\lib\netstandard1.6\Lucene.Net.Queries.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\lucene.net.queryparser\4.8.0-beta00005\lib\netstandard2.0\Lucene.Net.QueryParser.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\lucene.net.sandbox\4.8.0-beta00005\lib\netstandard1.6\Lucene.Net.Sandbox.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.aspnetcore.blazor\0.5.1\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.aspnetcore.blazor.browser\0.5.1\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.Browser.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.csharp\4.4.0\lib\netstandard2.0\Microsoft.CSharp.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.extensions.dependencyinjection\2.1.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.extensions.dependencyinjection.abstractions\2.1.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.Abstractions.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.jsinterop\0.5.1\lib\netstandard2.0\Microsoft.JSInterop.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\microsoft.rest.clientruntime\2.3.12\lib\netstandard1.4\Microsoft.Rest.ClientRuntime.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\mono.webassembly.interop\0.5.1\lib\netstandard2.0\Mono.WebAssembly.Interop.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\newtonsoft.json\9.0.1\lib\netstandard1.0\Newtonsoft.Json.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.buffers\4.4.0\lib\netstandard2.0\System.Buffers.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.collections.concurrent\4.3.0\lib\netstandard1.3\System.Collections.Concurrent.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.collections.immutable\1.5.0\lib\netstandard2.0\System.Collections.Immutable.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.configuration.configurationmanager\4.5.0\lib\netstandard2.0\System.Configuration.ConfigurationManager.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.diagnostics.diagnosticsource\4.3.0\lib\netstandard1.3\System.Diagnostics.DiagnosticSource.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.dynamic.runtime\4.0.11\lib\netstandard1.3\System.Dynamic.Runtime.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.io.filesystem.primitives\4.3.0\lib\netstandard1.3\System.IO.FileSystem.Primitives.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.linq\4.3.0\lib\netstandard1.6\System.Linq.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.linq.expressions\4.1.0\lib\netstandard1.6\System.Linq.Expressions.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.memory\4.5.1\lib\netstandard2.0\System.Memory.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.numerics.vectors\4.4.0\lib\netstandard2.0\System.Numerics.Vectors.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.objectmodel\4.0.12\lib\netstandard1.3\System.ObjectModel.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.reflection.emit\4.0.1\lib\netstandard1.3\System.Reflection.Emit.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.reflection.emit.ilgeneration\4.0.1\lib\netstandard1.3\System.Reflection.Emit.ILGeneration.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.reflection.emit.lightweight\4.0.1\lib\netstandard1.3\System.Reflection.Emit.Lightweight.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.reflection.typeextensions\4.1.0\lib\netstandard1.5\System.Reflection.TypeExtensions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.runtime.compilerservices.unsafe\4.5.0\lib\netstandard2.0\System.Runtime.CompilerServices.Unsafe.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.runtime.numerics\4.3.0\lib\netstandard1.3\System.Runtime.Numerics.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.runtime.serialization.primitives\4.1.1\lib\netstandard1.3\System.Runtime.Serialization.Primitives.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.security.accesscontrol\4.5.0\lib\netstandard2.0\System.Security.AccessControl.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.security.cryptography.openssl\4.3.0\lib\netstandard1.6\System.Security.Cryptography.OpenSsl.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.security.cryptography.primitives\4.3.0\lib\netstandard1.3\System.Security.Cryptography.Primitives.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.security.cryptography.protecteddata\4.5.0\lib\netstandard2.0\System.Security.Cryptography.ProtectedData.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.security.permissions\4.5.0\lib\netstandard2.0\System.Security.Permissions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.security.principal.windows\4.5.0\lib\netstandard2.0\System.Security.Principal.Windows.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.text.encoding.codepages\4.5.0\lib\netstandard2.0\System.Text.Encoding.CodePages.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.text.regularexpressions\4.3.0\lib\netstandard1.6\System.Text.RegularExpressions.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.threading\4.3.0\lib\netstandard1.3\System.Threading.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.threading.tasks.extensions\4.3.0\lib\netstandard1.0\System.Threading.Tasks.Extensions.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.xml.readerwriter\4.3.0\lib\netstandard1.3\System.Xml.ReaderWriter.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.xml.xdocument\4.0.11\lib\netstandard1.3\System.Xml.XDocument.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.xml.xmldocument\4.3.0\lib\netstandard1.3\System.Xml.XmlDocument.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.xml.xpath\4.3.0\lib\netstandard1.3\System.Xml.XPath.dll" -a "C:\WINDOWS\ServiceProfiles\NetworkService\.nuget\packages\system.xml.xpath.xmldocument\4.3.0\lib\netstandard1.3\System.Xml.XPath.XmlDocument.dll" -a "c:\b\_work\17\s\MedNotes.Api.Client\bin\Release\netstandard2.0\MedNotes.Api.Client.dll" -a "c:\b\_work\17\s\MedNotes.Core\bin\Release\netstandard2.0\MedNotes.Core.dll" -a "c:\b\_work\17\s\MedNotes.Diagnostics\obj\Release\netstandard2.0\MedNotes.Diagnostics.dll"2018-08-13T17:41:24.0026278Z   IL Linker2018-08-13T17:41:24.0056464Z ##[error]EXEC(0,0): Error : Expecting an option, got instead: c:\b\_work\17\s\MedNotes.Core\bin\Release\netstandard2.0\MedNotes.Core.dll2018-08-13T17:41:24.0062141Z EXEC : error : Expecting an option, got instead: c:\b\_work\17\s\MedNotes.Core\bin\Release\netstandard2.0\MedNotes.Core.dll [c:\b\_work\17\s\MedNotes.Diagnostics\MedNotes.Diagnostics.csproj]2018-08-13T17:41:24.0062611Z   illink [options] -x|-a|-i file2018-08-13T17:41:24.0062850Z      --about             About the IL Linker2018-08-13T17:41:24.0063090Z      --version           Print the version number of the IL Linker2018-08-13T17:41:24.0063358Z      --skip-unresolved   Ignore unresolved types, methods, and assemblies (true or false)2018-08-13T17:41:24.0091550Z      --verbose           Log messages indicating progress and warnings2018-08-13T17:41:24.0091945Z      --dependencies-file Specify the dependencies file path, if unset the default path is used: <output directory>/linker-dependencies.xml.gz2018-08-13T17:41:24.0092441Z      --dump-dependencies Dump dependencies for the linker analyzer tool2018-08-13T17:41:24.0092728Z      --reduced-tracing   Reduces dependency output related to assemblies that will not be modified2018-08-13T17:41:24.0093128Z      --used-attrs-only   Attributes on types, methods, etc will be removed if the attribute type is not used2018-08-13T17:41:24.0093453Z      --strip-security    In linked assemblies, attributes on assemblies, types, and methods related to security will be removed2018-08-13T17:41:24.0093795Z      --strip-resources   Remove link xml resources that were processed (true or false), default to true2018-08-13T17:41:24.0094081Z      --exclude-feature   Any code which has feature-name dependency will be removed2018-08-13T17:41:24.0094349Z      -out                Specify the output directory, default to `output'2018-08-13T17:41:24.0094655Z      -c                  Action on the core assemblies, skip, copy, copyused, addbypassngen, addbypassngenused or link, default to skip2018-08-13T17:41:24.0095003Z      -u                  Action on the user assemblies, skip, copy, copyused, addbypassngen, addbypassngenused or link, default to link2018-08-13T17:41:24.0095290Z      -p                  Action per assembly2018-08-13T17:41:24.0095513Z      -s                  Add a new step to the pipeline.2018-08-13T17:41:24.0095771Z      -t                  Keep assemblies in which only type forwarders are referenced.2018-08-13T17:41:24.0096047Z      -d                  Add a directory where the linker will look for assemblies2018-08-13T17:41:24.0096317Z      -b                  Generate debug symbols for each linked module (true or false)2018-08-13T17:41:24.0096597Z      -g                  Generate a new unique guid for each linked module (true or false)2018-08-13T17:41:24.0096863Z      -v                  Keep members needed by debugger (true or false)2018-08-13T17:41:24.0097128Z      -l                  List of i18n assemblies to copy to the output directory2018-08-13T17:41:24.0097403Z                            separated with a comma: none,all,cjk,mideast,other,rare,west2018-08-13T17:41:24.0097650Z                            default is all2018-08-13T17:41:24.0097878Z      -x                  Link from an XML descriptor2018-08-13T17:41:24.0098106Z      -a                  Link from a list of assemblies2018-08-13T17:41:24.0098369Z      -r                  Link from a list of assemblies using roots visible outside of the assembly2018-08-13T17:41:24.0098633Z      -i                  Link from an mono-api-info descriptor2018-08-13T17:41:24.0098895Z      -z                  Include default preservations (true or false), default to true2018-08-13T17:41:24.0099109Z   ```For now looks like I could workaround that with `<BlazorLinkOnBuild>false</BlazorLinkOnBuild>`, but issue appear more inside MSBuild setup for ILLink, then inside ILLink itself.
6024	area-identity	Rename JwtBearerOptionsConfiguration to (AzureAD|AzureADB2C)JwtBearerOptionsConfiguration	Currently as it stands, these two helpers cannot be used together because (so far as I can figure) one will overwrite the other, since they both have the same logical namespace path: `Microsoft.AspNetCore.Authentication.JwtBearerOptionsConfiguration`
5232	area-mvc	SyntaxError: Unexpected token {	https://github.com/jonasarcangel/ModuleIssueI'm getting the following error from my prerendered SPA using Angular Universal when using "dotnet run" and navigating to any route. It does not happen when I run in ClientApp folder using "npm run build:ssr && npm run start".```Request starting HTTP/1.1 GET https://localhost:5001/account/login  fail: Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware[1]An unhandled exception has occurred while executing the request.    Microsoft.AspNetCore.NodeServices.HostingModels.NodeInvocationException: Prerendering failed because of error: /Workspace/ModuleIssue/ClientApp/node_modules/apollo-angular/ApolloModule.js:1    (function (exports, require, module, __filename, __dirname) { import { NgModule } from '@angular/core';                                                                         ^SyntaxError: Unexpected token {    at new Script (vm.js:74:7)    at createScript (vm.js:246:10)    at Object.runInThisContext (vm.js:298:10)    at Module._compile (internal/modules/cjs/loader.js:657:28)    at Object.Module._extensions..js (internal/modules/cjs/loader.js:700:10)    at Module.load (internal/modules/cjs/loader.js:599:32)    at tryModuleLoad (internal/modules/cjs/loader.js:538:12)    at Function.Module._load (internal/modules/cjs/loader.js:530:3)    at Module.require (internal/modules/cjs/loader.js:637:17)    at require (internal/modules/cjs/helpers.js:20:18)Current directory is: /Workspace/ModuleIssue   at Microsoft.AspNetCore.NodeServices.HostingModels.HttpNodeInstance.InvokeExportAsync[T](NodeInvocationInfo invocationInfo, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.HostingModels.OutOfProcessNodeInstance.InvokeExportAsync[T](CancellationToken cancellationToken, String moduleName, String exportNameOrNull, Object[] args)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Builder.SpaPrerenderingExtensions.<>c__DisplayClass0_0.<<UseSpaPrerendering>b__1>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```Versions:- node 10.8.0 - npm 6.3.0- dotnet 2.1.300
5815	area-identity	Unsafe Two Factor Recovery Codes	Hi, i've noticed that the two factor recovery codes for authenticator logins are not stored as hashes in AspNetUserTokens table. Shouldn't those be hashed in database like passwords are?Best regardsMax
5428	area-mvc	Test failure: MvcTemplate_NoAuth_Works_NetCore_ForFSharpTemplate	This test [fails](http://aspnetci/viewLog.html?buildId=528510&buildTypeId=Lite_UniverseTest) occasionally with the following error:```System.Exception : Process exited with code 1StdErr: StdOut: Microsoft (R) Build Engine version 15.7.179.6572 for .NET CoreCopyright (C) Microsoft Corporation. All rights reserved.FSC : error FS0078: Unable to find the file 'C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\Windows.winmd' in any of\u001d C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\u001d C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\u001d C:\b\w\33bdfc1cae7b2a38\.dotnet\x64\sdk\2.1.302\FSharp\ [C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj]Build FAILED.FSC : error FS0078: Unable to find the file 'C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\Windows.winmd' in any of\u001d C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\u001d C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\u001d C:\b\w\33bdfc1cae7b2a38\.dotnet\x64\sdk\2.1.302\FSharp\ [C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj]    0 Warning(s)    1 Error(s)Time Elapsed 00:00:03.01   at Templates.Test.Helpers.ProcessEx.WaitForExit(Boolean assertSuccess) in /_/test/Templates.Test/Helpers/ProcessEx.cs:line 150   at Templates.Test.Helpers.AspNetProcess..ctor(ITestOutputHelper output, String workingDirectory, String projectName, String targetFrameworkOverride, Boolean publish) in /_/test/Templates.Test/Helpers/AspNetProcess.cs:line 70   at Templates.Test.TemplateTestBase.StartAspNetProcess(String targetFrameworkOverride, Boolean publish) in /_/test/Templates.Test/Helpers/TemplateTestBase.cs:line 212   at Templates.Test.MvcTemplateTest.MvcTemplate_NoAuthImpl(String targetFrameworkOverride, String languageOverride, Boolean noHttps) in /_/test/Templates.Test/MvcTemplateTest.cs:line 73------- Stdout: -------==> C:\b\w\33bdfc1cae7b2a38\.dotnet\x64\dotnet.exe new mvc --debug:custom-hive "C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\.templateengine" -lang F# [C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04]The template "ASP.NET Core Web App (Model-View-Controller)" was created successfully.This template contains technologies from parties other than Microsoft, see https://aka.ms/aspnetcore-template-3pn-210 for details.Processing post-creation actions...Running 'dotnet restore' on C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj...  Restoring packages for C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj...  Generating MSBuild file C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\obj\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj.nuget.g.props.  Generating MSBuild file C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\obj\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj.nuget.g.targets.  Restore completed in 1 sec for C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj.Restore succeeded.Building ASP.NET application...==> C:\b\w\33bdfc1cae7b2a38\.dotnet\x64\dotnet.exe build --no-restore -c Debug [C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04]Microsoft (R) Build Engine version 15.7.179.6572 for .NET CoreCopyright (C) Microsoft Corporation. All rights reserved.FSC : error FS0078: Unable to find the file 'C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\Windows.winmd' in any of\x1d C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\x1d C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\x1d C:\b\w\33bdfc1cae7b2a38\.dotnet\x64\sdk\2.1.302\FSharp\ [C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\AspNet.Template.c309de36e074442aaf98681b1bc5bf04.fsproj]Build FAILED.FSC : error FS0078: Unable to find the file 'C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\Windows.winmd' in any of\x1d C:\b\w\33bdfc1cae7b2a38\packages\microsoft.netcore.app\3.0.0-preview1-26810-02\ref\netcoreapp3.0\x1d C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04\x1d C:\b\w\33bdfc1cae7b2a38\.dotnet\x64\sdk\2.1.302\FSharp\ [C:\b\w\33bdfc1cae7b2a38\modules\Templating\test\Templates.Test\bin\Release\netcoreapp3.0\TestTemplates\AspNet.Template.c309de36e074442aaf98681b1bc5bf04...```Other tests within that build may have failed with a similar message, but they are not listed here. Check the link above for more info.This test failed on master.CC @mkArtakMSFTThis issue was made automatically. If there is a problem contact ryanbrandenburg.
3796	area-servers	TLS leak in out  of process	After recent changes, we started correctly unloading handler DLL and a new error appeared when running with AppVerifier on.The TSL token we allocate in https://github.com/aspnet/IISIntegration/blob/46285253018e1086cf4e9ba272c0efb86120c486/src/AspNetCoreModuleV2/OutOfProcessRequestHandler/dllmain.cpp#L208 is never freed on dll unload.
5573	area-mvc	Nested div onclick event	I have a overlay background element and dialog inside. The problem is that onclick event of overlay div is fired event if that div is under dialog. That cause me closing the dialog. Then I tried to solve that by addEventListener via JSInterop and use e.stopPropagation() but it fail another way. It stop all blazor onclick events inside of popup dialog. Blazor use document as the only point to attach event listeners. Should I use other way to stop propagation in blazor ?
5231	area-mvc	Support Webpack4 function export `argv` argument	The v4 of webpack introduced an `argv` as a second argument to the `webpack.config.js`  exported functionIt is useful to know in which environment this is running on, by using `argv.mode === 'production'`.Can you implement that in aspnet-webpack ?More info here : https://webpack.js.org/configuration/configuration-types/#exporting-a-function
5230	area-mvc	Microsoft.AspNetCore.NodeServices[0]  FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out o  f memory	Hi, I am using node service (Microsft.AspNetCore.NodeService 1.1.1) in my asp.net core web api service to generate the Stimulsoft Report as a string. NodeService added in the start up file like`  services.AddNodeServices(options =>            {                options.ProjectPath = Directory.GetCurrentDirectory();                options.InvocationTimeoutMilliseconds = 2000000;            });`Calling the node js method by using the following method`nodeServices.InvokeAsync<string>(`While running the code, I am getting the error 'Javascript heap out of memory'. Please see the details below> Microsoft.AspNetCore.NodeServices[0] FATAL ERROR: CALL_AND_RETRY_LAST Allocation failed - JavaScript heap out of memoryThis error occurs when the memory allocated for the execution application is less than the required memory when run application.By default the memory limit in Node.js is 512 mb. To solve this issue we need to increase the memory limit by setting the command max-old-space-size. I did the command `node --max-old-space-size=8192 MyNodeJSFileName.js`as per the link https://medium.com/@vuongtran/how-to-solve-process-out-of-memory-in-node-js-5f0de8f8464cBut still I am getting the same error. Is there any solution for this issue?
5572	area-mvc	UIKeyboardEventArgs.Code in Edge browser is always empty + problems with UIKeyboardEventArgs.Key	```html<div>    <input onkeydown="@OnKeyDown" />    <div>key: '@key'</div>    <div>code: '@code'</div></div>``````c#@functions{    string key;    string code;    void OnKeyDown(UIKeyboardEventArgs eventArgs)    {        key = eventArgs.Key;        code = eventArgs.Code;    }}```This code works in Firefox and Chrome but not in Edge.On Windows 10 I have the following browsers:* Firefox 61.0.1* Chrome 68.0.3440.84* Edge 16.16299I have standard US layout keyboard and Windows with Polish language.Edge does not return `Code` - we cannot distinguish between left and right shift/control/alt/menu start.***Edge returns Unidentified*** in `key` for all braces, punctuation characters, etc. ,./<>?;':"[]\{}|-=_+ For all characters above numbers !@#$%^&*() it returns numbers, which is correct, but without `Code` it is hard to guess what key was pressed.**Blazor 0.5.1**
4733	area-servers	ASP.NET Core 2.1: An existing connection was forcibly closed by the remote host	#2554After migrating to the last version of  asp net core 2.1 i start getting this exception:```An existing connection was forcibly closed by the remote hostSource:System.Private.CoreLibInnerException:System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.Internal.SocketAwaitable.GetResult()   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.Internal.SocketConnection.ProcessReceives()   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.Internal.SocketConnection.DoReceive()StackTrace:   at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1MessageBody.PumpAsync()   at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.MessageBody.ReadAsync(Memory`1 buffer, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 buffer, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.FileBufferingReadStream.ReadAsync(Byte[] buffer, Int32 offset, Int32 count, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.StreamHelperExtensions.DrainAsync(Stream stream, ArrayPool`1 bytePool, Nullable`1 limit, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Mvc.Formatters.JsonInputFormatter.ReadRequestBodyAsync(InputFormatterContext context, Encoding encoding)   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder.BindModelAsync(ModelBindingContext bindingContext)   at Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder.BindModelAsync(ActionContext actionContext, IModelBinder modelBinder, IValueProvider valueProvider, ParameterDescriptor parameter, ModelMetadata metadata, Object value)   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextExceptionFilterAsync() 2018-08-08 11:49:39.2834|7-5000075-17ef1173-99f0-e8cb-299d-ca9d9791f087|Catalogo|ERROR|Mensaje:An existing connection was forcibly closed by the remote hostSource:System.Private.CoreLibInnerException:System.Net.Sockets.SocketException (10054): An existing connection was forcibly closed by the remote host   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.Internal.SocketAwaitable.GetResult()   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.Internal.SocketConnection.ProcessReceives()   at Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets.Internal.SocketConnection.DoReceive()StackTrace:   at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.Http1MessageBody.PumpAsync()   at System.IO.Pipelines.PipeCompletion.ThrowLatchedException()   at System.IO.Pipelines.Pipe.GetReadResult(ReadResult& result)   at System.IO.Pipelines.Pipe.ReadAsync(CancellationToken token)   at System.IO.Pipelines.Pipe.DefaultPipeReader.ReadAsync(CancellationToken cancellationToken)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.MessageBody.ReadAsync(Memory`1 buffer, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Server.Kestrel.Core.Internal.Http.HttpRequestStream.ReadAsyncInternal(Memory`1 buffer, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.FileBufferingReadStream.ReadAsync(Byte[] buffer, Int32 offset, Int32 count, CancellationToken cancellationToken)   at Microsoft.AspNetCore.WebUtilities.StreamHelperExtensions.DrainAsync(Stream stream, ArrayPool`1 bytePool, Nullable`1 limit, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Mvc.Formatters.JsonInputFormatter.ReadRequestBodyAsync(InputFormatterContext context, Encoding encoding)   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder.BindModelAsync(ModelBindingContext bindingContext)   at Microsoft.AspNetCore.Mvc.ModelBinding.ParameterBinder.BindModelAsync(ActionContext actionContext, IModelBinder modelBinder, IValueProvider valueProvider, ParameterDescriptor parameter, ModelMetadata metadata, Object value)   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextExceptionFilterAsync() ```
4905	area-mvc	Provide a hook for RazorPage.ExecuteAsync()	Feature request:I can define a base class for the views, but there is no hook to execute some code before the view is executed. There is a method `ExecuteAsync` but it's not called on the base class.My suggestion is to either call the base class `ExecuteAsync()` if there is one which is not abstract, or provide a new method that can be implemented by base view classes.
5571	area-mvc	Move x-plat testing into VSTS	AppVeyor and Travis are still required to provide full test coverage. To make VSTS provide the same level of coverage, we need to* Enable selenium-standalone on VSTS* Add macOS and Linux build phases* Ensure tests run with `/p:BlazorAllTests=true` (or just make this default)
5081	area-mvc	ManualServerShutdown_NoPipeName_ShutsDownServer hangs on linux VSTS	After some investigation, it looks like this test is the culprit causing https://github.com/aspnet/Razor/issues/2507. I've disabled this test on crossplat. As this is not common case and is hard to integration test, we should either remove this test or cover this in a unit test.
5814	area-identity	Use inferred names in RCL Identity templates	VS Intellisense suggests [Use inferred names](https://docs.microsoft.com/en-us/visualstudio/ide/common-quick-actions#use-inferred-names)![image](https://user-images.githubusercontent.com/3605364/43803816-b9ce3254-9a4e-11e8-8490-1da9a2655f5b.png)![image](https://user-images.githubusercontent.com/3605364/43803890-fc75f5f6-9a4e-11e8-8b31-a3f569575727.png)Should I make a PR to use inferred member names in these anon types?CBA (Cost Benefit Analysis)Benefit: VS users aren't distracted by intellisense suggestion.Cost: That's a lot of work to review and risk of breaking something for cosmetic reasons. Most customers don't generate these templates, and those who do can make changes.[Login page](https://github.com/aspnet/Identity/blob/master/src/UI/Areas/Identity/Pages/Account/Login.cshtml.cs#L94)
5328	area-signalr	Consider adding Options Validation rules	https://github.com/aspnet/Options/pull/266 adds support for "Validation" rules that throw useful errors at startup when options are invalid. We should consider applying this to `.AddSignalR` and other places where we configure `IOptions<T>`.
5570	area-mvc	Trying to make editable text field - keeps disappearing.	I created a small "editable field" where if you click on the text, it'll change to a text box which you can then modify.However, I'm seeing some really strange behavior from hitting "Escape": If I click on the text, and edit the text, and hit "Enter" everything's fine. If I hit "Escape" it appears to delete the last element.So if I click on the Text, type something and hit "Escape" it deletes div "savedValue". If I do it again, it deletes span "textField".My intention was obviously to change "Text" back to "_savedValue" if they hit escape. And it seems like it might work, but it keeps deleting the elements.Any other warnings, caveats, or better ways to do what I'm trying to do appreciated.Thanks```<div>    @if (_editing)    {        <input id="textField" bind="Text" onkeyup="@OnKeyUp" />    }     else    {        <span id="textField" onclick="@OnTextClicked">@Text</span>    }    <div id="savedValue">@_savedValue</div></div>@functions{    [Parameter]    string Text { get; set; }    [Parameter]    private Action<string> TextChanged { get; set; }    bool _editing = false;    string _savedValue;    void OnTextClicked()    {        _editing = true;        _savedValue = Text;    }    void OnKeyUp(UIKeyboardEventArgs eventArgs)    {        if (eventArgs.Key == "Enter" || eventArgs.Key == "Escape") //This causes the issue        {            _editing = false;        }    }}```
5569	area-mvc	Allow for <script type="module"... in component libraries.	[JavaScript modules are supported by all of the evergreen browsers now.](https://caniuse.com/#search=modules) This has led me to experimenting with some ideas of how to tidy up JavaScript interops when using Blazor.I feel like having the ability to use native JavaScript modules could lead to some clean abstractions around JS interopos. The following code works when adding the scripts manually to index.html.Ex:```// FooHandler.jsfunction doFoo() { alert("Foo Triggered") }export { doFoo };``````// FooInterop.jsimport { doFoo } from './FooHandler.js';window.myNamespace = {    foo: doFoo}``````<!-- index.html --><script src="./FooInterop.js" type="module"></script>```The problem arises when you attempt this from a Blazor Component Library. Since the `<script>` tags are automagically added to index.html, there is no way to denote that they require the `type\module` attribute.The following line fails because it is added by the framework and misses the required `type\module` attribute.```<script src="_content/DownloadComponents/FooInterop.js">```In addition, any js files in the folder are also added. In the case of modules, and when using modules, they are not necessary to have.```<!-- Foo Handler is not needed because it's already imported via FooInterop --><script src="_content/DownloadComponents/FooHandler.js"><script src="_content/DownloadComponents/FooInterop.js">```This approach may be a bit forward thinking since most JS devs use some sort of bundle tool like Webpack. However, modules are now recognized by the browser, so why not embrace it?
5427	area-mvc	Ensure Angular idomaticness	We should do a pass through the Angular template now that we updated to 6 to ensure that it's idiomatic.
5326	area-signalr	Is there any way to log when a message is being sent to individual clients?	Setting SignalR to verbose does not display when individual messages are sent. However, I can set the _Microsoft.AspNetCore.Http.Connections.Internal.Transports.WebSockets_ logging to verbose and see when messages are being transmitted then correlate the connection ids but, unfortunately, I cannot see the contents of those messages.
5325	area-signalr	How to get Connection Id from client as in this example from Microsoft?	I'm following this article: https://msdn.microsoft.com/en-us/magazine/mt846469.aspxI want to achieve the same thing, create a signalR connection from the client, call a long running api method passing in my connection id, have my controller periodically report progress to that connection id. It seems it is no longer possible to get the connection id on the client? What's the recommended way of doing what the article is doing? I'm using ASP.net core 2.1 and the latest @aspnet/signalr package. Thanks,Cody
5229	area-mvc	Running "ng build" manually causes VS to stop recognizing client side file changes and breaks angular-cli hot updates	For an angular project, if you manually run ng build in a command prompt, it populates the dist folder. For some reason, this causes visual studio to stop recognizing changes to any client side files (css, scss, ts, html) and the hot updates for debugging stops working.The work around is to delete the dist folder. https://stackoverflow.com/questions/50867385/development-server-hot-updates-not-workingI'm using the latest template and Angular 6.1.1
4648	area-security	AddPolicyScheme changes the semantics of IAuthenticationSchemeProvider	I suspect my issue here will be too subtle to do anything about, but I need some guidance on this.My sense is that the introduction of the new virtual/dynamic policy schemes has in an odd way retroactively changed the semantics of the `IAuthenticationSchemeProvider` and its various `GetDefault...` scheme APIs. In doing so, I'd almost call this a breaking change since the semantics are now different (and even deprecated). As you all know, previously there was only one default authN scheme, sign in scheme, etc. and they all had a fallback to the default scheme. Now with the policy scheme handler, the semantics of what's default (via `ForwardDefaultSelector`) changes request by request. So now there is no longer the concept of default schemes, since they can change on every request. I'd say the semantics defined by `IAuthenticationSchemeProvider` is now pointless. Of course now the mechanics are relied upon to discover the virtual scheme, so it feels as if you've pained yourself into a corner and have to keep it.I know this issue isn't terribly actionable, but it breaks code that previously made assumptions about only one scheme for authentication, sign in, etc.This makes me think the design was incomplete. I also think there might be agreement on your side of that opinion. Perhaps the `IAuthenticationSchemeProvider` is what should have been made dynamic, not the schemes themselves. Though, there might be other use cases missed by that approach as well.So what I'm looking for here is what's the plan going forward for this dynamic policy feature? Is what was added officially suggested and supported as a feature, or is it discouraged until a more complete design can be done? I'd like to know because as of now IdentityServer is not compatible with the virtual scheme feature. If I am to make changes to make it compatible, I'd like to know it's going to fit well into the future work as well. But if this virtual scheme feature is not something that is considered really complete (or may change again in vNext), then perhaps I can postpone trying to rework our code to accommodate it, and I can tell people that we don't officially support it because it's not really a complete feature in ASP.NET Core.This predicament, as it seems to me, is yet again due to the lack of an isolated/multi-tenant pipeline in the DI system.Thanks for listening :/
5568	area-mvc	Bootstrap intellisense not working in Blazor projects in Visual Studio	Bootstrap intellisense isn't showing up in Blazor projects: ![image](https://user-images.githubusercontent.com/1874516/43605526-78b1338e-964d-11e8-8e01-7ad4804a954c.png)Visual Studio provides intellisense based on the CSS files in the project, but it only looks at the unminified versions. 
5567	area-mvc	favicon.ico gets reloaded every time tab is changed in server side rendering template	I'm using Blazor 0.5.1 and Chrome browser. If I click between Home, Counter and Fetch Data tabs favicon.ico gets reloaded everytime tab is changed.
3837	area-servers	Support environment variable alternatives from ANCM logging settings	When running in App Service with Run-From-Zip, files are read-only so user cannot tweak web.config to change things like `stdoutLogEnabled`. Having an environment variable alternative would solve this.This first came up on https://github.com/Azure/app-service-announcements-discussions/issues/32#issuecomment-407813574
5565	area-mvc	Fatal error in IL Linker	I builded solution, which created from Blazor (Server side in ASP.NET Core) template. Build solution was over by "Fatal error in IL Linker".Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.identitymodel.protocols.openidconnect\5.2.0\lib\netstandard1.4\Microsoft.IdentityModel.Protocols.OpenIdCnnect.dll, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null' ---> Mono.Cecil.AssemblyResolutionException: Failed to resolve assembly: 'C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.identitymodel.protocols.openidconnect\5.2.0\lib\netstandard1.4\Microsoft.IdentityModel.Protocols.OpenIdCnnect.dll, Version=0.0.0.0, Culture=neutral, PublicKeyToken=null'my system:dotnet -- version: 2.1.302Windows 10 Pro Build 1803 17134.167VS 2017 Community 15.7.5Blazor: 0.5.1
3827	area-servers	ANCM v1: Add retries for startup port collision failures	It appears ANCM v1 does **not** retry if an app fails to start the first time due to a port collision.  ANCM v2 has an additional loop for retries:https://github.com/aspnet/IISIntegration/blob/release/2.2/src/AspNetCoreModuleV2/OutOfProcessRequestHandler/serverprocess.cpp#L768Something similar should be added to ANCM v1.
4904	area-mvc	Support Bootstrap 4 based validation	Bootstrap 4 has it's own [validation](https://getbootstrap.com/docs/4.1/components/forms/#validation) that requires the use of specific classes. We need to make flexible enough to support this.
4903	area-mvc	Built in File Validation (Feature Request)	#Feature RequestAs noted in the [docs](https://docs.microsoft.com/en-us/aspnet/core/razor-pages/upload-files?view=aspnetcore-2.1#add-a-helper-method-to-upload-files) uploading files & validating them forces the developer to check for several validations & security threats. Any chance this could be simpler & built in somewhat to encourage best practices for common types of file uploads? 
5324	area-signalr	Frequent disconnects	I cannot make a whole day without some disconnects. They are very short (under 1 minute, and tipically below 10 s) and appear at irregular intervals (online: 1h, offline: 2 s, online: 30 min, offline 2s and so on)Only meaningful log I get is on client side complaining the server did not send a message:> [Error] Connection is shutting down due to an error.System.TimeoutException: Server timeout (6000.00ms) elapsed without receiving a message from the server.Web app is hosted on Azure.I have 2 clients and they both get disconnected simoultaneously. So I kind of excluding Client side errors. I can think about 2 options:- Misconfigured SignalR server/client (please Help!)- Network delays. As I wrote below I don't have any network traces yet, but as soon as I will have something, I'l post here.Although I set Always On for WebApp on Azure sometimes I see request response delays... Could this be an issue?What should I look for in server side logs to see that KeepAlive message have been sent correctly? I see in Fiddler that KeepAlive (Type: 6 messages) sometimes come at 4 seconds instead of 3. Could some long-running code on the web app to delay the KeepAlive sending?Configuration below:**Client**Microsoft.AspNetCore.SignalR v 1.0.0 ( Just updated to 1.0.2 I'll keep testing and come up with feedback)`HubConnection.ServerTimeout = TimeSpan.FromSeconds(6);`**Server**Microsoft.AspNetCore.SignalR (1.0.0)``` services.AddSignalR(                options =>                {                    options.KeepAliveInterval = TimeSpan.FromSeconds(3);                });```I have logs according to following article:https://github.com/aspnet/SignalR/wiki/Diagnostics-GuideNo network traces yet.**UPDATE:**As can be seen below, disconnect occur due to client not receiving the KeepAlive. ![image](https://user-images.githubusercontent.com/15249495/43461792-0265d7a0-94dd-11e8-8929-05096e4830cc.png)1. Can someone please confirm that type:6 is the KeepAlive2. I want to know where is the delay coming from. My code or the network. Please help.
5564	area-mvc	Don't include list of reference assemblies in blazor.boot.json for server-side apps	
5563	area-mvc	JSInterop cannot invoke instance methods	Right now if you try to invoke an instance method, like `localStorage.setItem`, then you'll receive an rather obscure error like `'setItem' called on an object that does not implement interface Storage.` which means that this line https://github.com/aspnet/Blazor/blob/f2232e0699dae28485e07244403385219c1a3832/src/Microsoft.JSInterop/JavaScriptRuntime/src/Microsoft.JSInterop.ts#L160uses apply to invoke the method on a null reference which isn't supported.
4902	area-mvc	Razor compilation APIs exposing Roslyn types being obsoleted in 2.2.0 and removed in 3.0.0	As part of the 2.1.0 release, ASP.NET Core added support for build time compilation of cshtml files (Razor Views & Razor Pages). This feature is on by default and allows build time verification of the correctness of Razor files, and also faster startup performance. Additionally, MVC watches for changes to cshtml files and seamlessly updates build-time compiled views with runtime compiled views. This allows editing cshtml files and then refreshing the browser to see the changes.MVC uses the app's compilation context, details about the references and settings that were used to compile the source code (.cs) in the app, to compile views at runtime. In addition to the compilation context, MVC exposes options such as [RazorViewEngineOptions.CompilationCallback](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.razor.razorviewengineoptions.compilationcallback?view=aspnetcore-2.1) and [AdditionalCompilationReferences](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.mvc.razor.razorviewengineoptions.additionalcompilationreferences?view=aspnetcore-2.1) that allow configuring compilation specifically for runtime. Runtime specific customizations are unavailable at build time and consequently the two outputs could be different.To address this inconsistency, we plan on removing APIs in MVC that change or modify runtime compilation. For 2.2.0, we're marking these APIs obsolete with the intent to remove them in 3.0.0. This is the list of affected APIs:* Properties on `Microsoft.AspNetCore.Mvc.Razor.RazorViewEngineOptions`    * `AdditionalCompilationReferences`    * `CompilationCallback`* `Microsoft.AspNetCore.Mvc.Razor.Compilation.MetadataReferenceFeature`* `Microsoft.AspNetCore.Mvc.Razor.Compilation.MetadataReferenceFeatureProvider`* `Microsoft.AspNetCore.Mvc.Razor.Compilation.RazorReferenceManager`No changes are required to your application if it does not use these APIs.Apps using these APIs to add assembly references to the compilation context for runtime compilation should instead use [`ApplicationPartManager.AddApplicationPart`](https://docs.microsoft.com/dotnet/api/microsoft.extensions.dependencyinjection.mvccoremvccorebuilderextensions.addapplicationpart) to add application parts for each assembly reference, or switch to a built-time compilation model (see [Create reusable UI using the Razor Class Library project](https://docs.microsoft.com/aspnet/core/razor-pages/ui-class)).Other scenarios blocked by the removal of these APIs and not covered by alternative MVC features should raised here.
3372	area-servers	Add default implementation for HttpContext.WebSockets.IsWebSocketRequest	We should provide a default implementation for this property, even when there is no feature installed. There's nothing in the logic for detecting a WebSocket request that inherently requires the middleware. This property should just check for:* `Connection: Upgrade` header* `Upgrade: WebSocket` headerIt's still up to the middleware to validate the `Sec-WebSocket-*` headers during `Accept`. Any request with the above two headers should be considered a WebSocket request though, even if the other headers are invalid (then it's an *invalid* WebSocket request).
5323	area-signalr	Client-server streaming support	This issue tracks things still to do before client-server streaming could be released:* [x] Server support (checked in to 3.0 `master`)* [x] .NET Client support (checked in to 3.0 `master`)* [ ] Update spec #2619 * [ ] TypeScript support #2595 * [ ] Java Support* [ ] Review protocol changes* [ ] Consider support for additional input types (`Stream` in C#, `Blob`/`FileReader` in TS, etc.)
5228	area-mvc	Long Time operation Fail after 2 minutes	Microsoft.AspNetCore.All Version 2.1.2Microsoft.AspNetCore.NodeServices Version 2.1.1Microsoft.NETCore.App Version 2.1.2TargetFramework netcoreapp2.1I'm doing something like this (generate a PDF file from HTML in node services, and them return the file to the user): https://code.msdn.microsoft.com/How-to-export-HTML-to-PDF-c5afd0ceI'm using the following plugin on node file:https://github.com/westy92/html-pdf-chromeNo problem generating some small report's, but when the operation take longer than 2 minutes, the request fail and I got the following exception:```System.Net.Http.HttpRequestException: An error occurred while sending the request. ---> System.IO.IOException: The server returned an invalid or unrecognized response.   at System.Net.Http.HttpConnection.FillAsync()   at System.Net.Http.HttpConnection.ReadNextResponseHeaderLineAsync(Boolean foldedHeadersAllowed)   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, CancellationToken cancellationToken)   --- End of inner exception stack trace ---   at System.Net.Http.HttpConnection.SendAsyncCore(HttpRequestMessage request, CancellationToken cancellationToken)   at System.Net.Http.HttpConnectionPool.SendWithRetryAsync(HttpRequestMessage request, Boolean doRequestAuth, CancellationToken cancellationToken)   at System.Net.Http.RedirectHandler.SendAsync(HttpRequestMessage request, CancellationToken cancellationToken)   at System.Net.Http.HttpClient.FinishSendAsyncBuffered(Task`1 sendTask, HttpRequestMessage request, CancellationTokenSource cts, Boolean disposeCts)   at Microsoft.AspNetCore.NodeServices.HostingModels.HttpNodeInstance.InvokeExportAsync[T](NodeInvocationInfo invocationInfo, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.HostingModels.OutOfProcessNodeInstance.InvokeExportAsync[T](CancellationToken cancellationToken, String moduleName, String exportNameOrNull, Object[] args)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   at TestPdf.Controllers.HomeController.About(INodeServices nodeServices) in C:\Users\matheus.avi\Documents\Visual Studio 2017\Projects\TestPdf\TestPdf\Controllers\HomeController.cs:line 59   at Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)   at System.Threading.Tasks.ValueTask`1.get_Result()   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```But the operation still's running and success is logged in the console.Also if I configure it to generate a local File, the file is generated.Startup.cs```c#services.AddNodeServices(options =>{    options.InvocationTimeoutMilliseconds = 600000;    options.NodeInstanceOutputLogger = _logger;    options.WatchFileExtensions = new string[] { };});```pdf2.js```jsmodule.exports = function (callback, html, header, footer) {    const htmlPdf = require('html-pdf-chrome');    const options = {        port: 9222,        printOptions: {            displayHeaderFooter: true,            headerTemplate: header,            footerTemplate: footer,            marginTop: 1.1,            marginBottom: 1,            marginLeft: 0,            marginRight: 0,        },        timeout: 600000    };    console.log('Create pdf');    htmlPdf.create(html, options)        .then(function (pdf) {            console.log('pdf created');            callback(null, JSON.parse(JSON.stringify(pdf.toBuffer())).data);        })        .catch(function (e) {            console.log('Error generating pdf');            console.log(e);            callback(e, null);        });}; ```HomeController.cs```c# public async Task<IActionResult> About([FromServices] INodeServices nodeServices){	HttpClient hc = new HttpClient();	hc.Timeout = TimeSpan.FromMinutes(10);	var htmlContent = await hc.GetStringAsync($"http://{Request.Host}/report.html");	var headerContent = await hc.GetStringAsync($"http://{Request.Host}/header.html");	var footerContent = await hc.GetStringAsync($"http://{Request.Host}/footer.html");	var result = await nodeServices.InvokeAsync<byte[]>("./pdf2", htmlContent, headerContent, footerContent);	HttpContext.Response.ContentType = "application/pdf";	HttpContext.Response.Headers.Add("x-filename", "report.pdf");	HttpContext.Response.Headers.Add("Access-Control-Expose-Headers", "x-filename");	HttpContext.Response.Body.Write(result, 0, result.Length);	return new ContentResult();}```
5322	area-signalr	Releases page - latest one is 1.0.0-alpha2	This issue is similar to https://github.com/aspnet/EntityFrameworkCore/issues/12550.When navigating to https://github.com/aspnet/SignalR/releases latest release is 1.0.0-alpha2,
6023	area-identity	Can't get the OnTokenValidated event	What's the proper way to add my custom claims to the validated token? I used to do it in the "OnTokenValidated" event by using something similar to:```builder.AddOpenIdConnect(o =>             {                o.Events = new OpenIdConnectEvents                 {                     OnTokenValidated = async ctx =>                     {                     ...```I'm no longer able to do this with the new AzureAD.UI package.
5227	area-mvc	Running angular and react apps side by side in a asp.net 2.1 core app	I posted a descriptive issue in [stack overflow](https://stackoverflow.com/questions/51582386/how-to-set-up-the-middleware-to-run-a-react-angular-apps-side-by-side-in-a-asp) about **running an angular and react app side by side**.Currently in my **asp.net core 1.1** app which I use for an year now, I use **gulp** tasks to bundle the apps after every code change to make both the angular and react apps work. I'm upgrading the app to using angular & react CLI because asp.net core 2.1 support it. The reason I want to keep both the apps in a single asp.net app is to host both the apps under the single domain and the navigation between both the apps can take place with the same auth.I followed the suggestion from @SteveSandersonMS to create two branches in the middleware which I think is working fine. But both the apps not able to locate the bundle files as I have described in the stack overflow question.
4901	area-mvc	Proposal: View Component Slots	# Feature ProposalProvide a built-in or otherwise framework supplied mechanism for View Components, when rendered via a tag helper, to render user-supplied child content that can be injected into the View Component's view template in pre-defined locations# Use CaseWhen building component based presentation a number of useful features present in other component inspired frameworks are missing in Mvc:* The ability to render user supplied child content from its invocation location in the component template* The ability to mark and control placement of multiple elements of user supplied child content in the component template* The ability to show default content if user supplied content was not provided* Child content mechanism is supplied and supported by the framework, standardizing syntax and usage.Allowing view components to accept child content provides new ways to build complex component driven presentation.## Use Case ExampleWithin some calling view, instantiating a View Component via a tag helper and supplying child content:Calling View:```html<vc:custom-view-component>    <p>My Default Slot Content!</p>    <p vc:slot="first">My First Slot Content!</p>    <p vc:slot="second">My Second Slot Content!</p>    <vc:custom-view-component vc:slot="nested">        <p>My NESTED Default Slot Content!</p>        <p vc:slot="first">My NESTED First Slot Content!</p>        <p vc:slot="second">My NESTED Second Slot Content!</p>    </vc:custom-view-component>    <p>More Default Slot Content!</p></vc:custom-view-component>```The ViewComponents view template would provide the slot mechanism to place the user defined child content:View Component View Template:```html<h1>Custom View Component</h1><h3>Second slot content</h3><vc:slot name="second"><p>please supply a value for my second slot</p></vc:slot><h3>First slot content</h3><vc:slot name="first"><p>please supply a value for my first slot</p></vc:slot><h3>Default slot content</h3><vc:slot><p>please supply a value for my default slot</p></vc:slot><h3>Repeating slots render the same data</h3><vc:slot name="first">please supply a value for my first slot</vc:slot><vc:slot name="second">please supply a value for my second slot</vc:slot><vc:slot><p>please supply a value for my default slot</p></vc:slot><h3>Nesting components with slots works</h3><div style="border-left:1px solid black;padding-left:20px;">    <vc:slot name="nested">no nested content supplied</vc:slot></div>```The View Component slotting mechanism will take care of rendering the user supplied child content into the correct slots in the View Component's user defined slot locations. Example output of the following:![slots_example_output](https://user-images.githubusercontent.com/1124388/43367302-ca48f6a6-9318-11e8-8916-2fc8260709cf.png)# InspirationContent slotting or otherwise rendering user supplied child content in a parent template is a known and useful pattern seeing fair usage today:* Web Component Slots (MDN): https://developer.mozilla.org/en-US/docs/Web/Web_Components/Using_templates_and_slots* vuejs Slots: https://vuejs.org/v2/guide/components-slots.html* Angular Template Outlet: https://angular.io/api/common/NgTemplateOutletPrimary insipriation is from the web component HTML templates spec# RequirementsSome potential requirements determined while researching this proposal:* View Component slots should re-use the existing View Component tag helper ```<vc:[component_kebab_case_name]>```* A new tag helper MUST be introduced (`<vc:slot>`) to mark locations in a View Component's view template where user supplied content can be placed* User supplied child content within the body of the View Component Tag Helper MUST be optional* All existing view attribute binding expression features MUST continue to work* The View Component slotting mechanism MUST properly handle nested View Component Tag Helpers and View Component slots to any arbitrary depth in user supplied child content* Users MUST be able to target zero or more named View Component slots within their supplied child content, whether or not a named slot exists in the View Component's view template.# Experimental ImplementationTo facilitate interest in this proposal a simple experiement was built to showcase the View Component Slotting mechanism in action. This experiement does not necessarly implement all identified requirements and is not guarenteed to be bug-free.https://github.com/rdlaitila/AspNetCore.Mvc.ViewComponentSlotswhat should work:* Invoking a view component from a tag helper (see differences)* Ability to supply arbitrary (non slot targeted) child content that will be placed in the parent View Component's default `<vc:slot>`* Ability to supply slot targeted child content that will be placed in a matching `<vc:slot>` element in the View Component's view template where a slot with attribute `name="[slot_name]"` exists (ex: `<vc:slot name="some-slot"`>)* Ability for View Component Slots to render default content if no user supplied child content targeting that slot was supplied.* Ability to render nested View Component Tag Helpers and slots* tag parameter expression binding within user supplied child contentdifferences:* Due to the inability to hook into the existing [View Component Tag Helper](https://docs.microsoft.com/en-us/aspnet/core/mvc/views/view-components?view=aspnetcore-2.1#invoking-a-view-component-as-a-tag-helper), a custom View Component Tag Helper was built that can invoke a view component by the tag elements name in either `kebab-case` or `PascalCase` where the tag contains attribute `vc` (ex: `<my-custom-component vc>` or `<MyCustomComponent vc>`)* slot elements are named `<vc:slot>` as well as the slot selector attribute  `vc:slot="[name]"`simply to match the existing View Component Tag Helper naming convention `<vc:[component-kebab-name]>` for consistency. There is no reason we could not adopt the current web component slot naming convension, or using some other name entirly.# Author's ContributionUnfortunatly I will be time limited to focus on a core contribution of View Component Slots to aspnet/Mvc and don't posses deep enough knolwedge of contribution guidelines or the Mvc sources to properly facilitate implementation of this proposal.I can however allocate some time to improve the [experimental proposal implementation](https://github.com/rdlaitila/AspNetCore.Mvc.ViewComponentSlots) as needed and respond to community issues and pull requests on a best-effort basis. I hope the experimental implementation can validate that this use case is valid and valuable to others.# Community ContributionI would be excited to see community members either help improve the example implementation or help propose how to best implement such a feature into the Mvc core.
5562	area-mvc	Server-side: handle reconnection, potentially to different server	If after a delay, or a lost network connection the websocket disconnects. It seems it will never reconnect.![image](https://user-images.githubusercontent.com/4673182/43357925-3038f85a-924f-11e8-981f-1b5cc50086c1.png)
5226	area-mvc	slow data fetching in asp core react redux template in VSCode 	Recently I created more than 3 times some Asp core react redux template with :dotnet new --install "Microsoft.DotNet.Web.Spa.ProjectTemplates"dotnet new reactreduxin VSCode and if I make any changes in the code ( for example change the js to jsx or change store)then in "Fetch data" section, it gets freeze ![2018-07-28_9-57-16](https://user-images.githubusercontent.com/29033729/43350696-e6724a8e-924c-11e8-8b38-2221b995fb74.png)
5560	area-mvc	Allow internal types to be invoked by JavaScript interop	We should be able to mark `public` methods on `internal` types as `[JSInvokable]` since most of the lib developer, like myself, don't want to expose internal types to the end user.I know that there is the idea that `JSInvokable` is inherently `public` and that mislead the idea that the types using it should be as well. I also know that you can hide a member with `EditorBrowseableAttribute(false)`, but that is just an IDE thing and not truly protecting internal APIs from misuse.So, please consider change the scan logic to also look into `internal` types.Thanks!
5426	area-mvc	Run browser tests on Mac and Linux on VSTS	Currently when we try to do this they don't run on Mac and they fail on Linux, so it's turned off via `HostSupportsBrowserAutomation`. We should resolve the problem, then always run the browser tests in VSTS.
5812	area-identity	Azure DevOps: 690 test failures. Many Identity + SQL Server tests fail to connect to LocalDB	Something about the way the EF Core tests are configured does not work in the Hosted VS2017 agent pool. It seems most of the EF Core + SQL server tests are broken.https://dotnet.visualstudio.com/public/_build/results?buildId=8559&view=ms.vss-test-web.test-result-details```System.Data.SqlClient.SqlException : Connection Timeout Expired. The timeout period elapsed while attempting to consume the pre-login handshake acknowledgement. This could be because the pre-login handshake failed or the server was unable to respond back in time. The duration spent while attempting to connect to this server was - [Pre-Login] initialization=44133; handshake=39; ---- System.ComponentModel.Win32Exception : The wait operation timed out.   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, UInt32 waitForMultipleObjectsTimeout, Boolean allowCreate, Boolean onlyOneCheckConnection, DbConnectionOptions userOptions, DbConnectionInternal& connection)   at System.Data.ProviderBase.DbConnectionPool.TryGetConnection(DbConnection owningObject, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal& connection)   at System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)   at System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)   at System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)   at System.Data.SqlClient.SqlConnection.Open()   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.Test.Utilities.SqlServerTestStore.DatabaseExists(String name) in /_/test/EF.Test/Utilities/SqlServerTestStore.cs:line 110   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.Test.Utilities.SqlServerTestStore.GetScratchDbName() in /_/test/EF.Test/Utilities/SqlServerTestStore.cs:line 44   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.Test.Utilities.SqlServerTestStore.CreateScratch(Boolean createDatabase) in /_/test/EF.Test/Utilities/SqlServerTestStore.cs:line 27   at Microsoft.EntityFrameworkCore.Internal.LazyRef`1.get_Value()   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.Test.ScratchDatabaseFixture.get_ConnectionString() in /_/test/EF.Test/Utilities/ScratchDatabaseFixture.cs:line 19   at Microsoft.AspNetCore.Identity.EntityFrameworkCore.Test.CustomPocoTest.CanCreateUserInt() in /_/test/EF.Test/CustomPocoTest.cs:line 100--- End of stack trace from previous location where exception was thrown -------- Inner Stack Trace -----```cc @HaoK 
5559	area-mvc	Chrome debug proxy apparently _requires_ to load debug symbols for all referenced assemblies	(See also #1199?)Debugging a Blazor project in Chrome as described in the 0.5 release notes fails as soon as a DLL is referenced for which debug symbols don't exist. (In my case, I had BlazorExtensions.Logging referenced.)Mono/Cecil reports an error of:```got exception System.AggregateException: One or more errors occurred. (Format of the executable (.exe) or library (.dll) is invalid.) ---> System.BadImageFormatException: Format of the executable (.exe) or library (.dll) is invalid.```And Chrome's debug session closes immediately, with:>Debugging connection was closed. reason: WebSocket disconnectedBlazor should probably skip trying to debug assemblies for which debug symbols cannot be loaded.This is distinct from #1199 in that @galvesribeiro hadn't actually even _tried_ to debug code (but I did), in which case loading debug symbols probably shouldn't happen at all.
5080	area-mvc	[Tracking] Razor parser improvements	As a follow-up to #2263 and as a prerequisite for a bunch of future Razor improvements, we want to have our current Razor parser to have a deeper understanding of HTML. Here is a detailed description of what this will enable us to do https://github.com/aspnet/Razor/issues/2211#issue-307854491.
4734	area-servers	Tune Window Update batching algorithm	Http2 request data flow control needs to periodically send window updates for both the stream and connection to inform the client they're allowed to send more data. The current algorithm uses a minWindowSizeIncrement to prevent sending updates too frequently. The default for this value is 32kb, half of the total window size of 64kb. That seems too large when most of HTTP/2 is over TLS and TLS frame sizes are limited to 16kb. We also plan to provide settings to raise the window size and may even set the default higher.Proposals:- Make initial window size and minWindowSizeIncrement independently configurable.- Run perf tests with different window sizes with particular attention to the TLS frame size.- Make sure the perf tests include variable levels of latency. High latency and infrequent window updates will cause significant jitter in the throughput.
5557	area-mvc	How to retain EventHandlerId	Consider this:```<button class="btn btn-primary"        onclick="@(e => IncrementCount(1))">    Click me +1</button>@for (int t = 2; t != 4; t++){    <button class="btn btn-primary"            onclick="@(e => IncrementCount(t))">        Click me +@t    </button>}@functions {  int currentCount = 0;  void IncrementCount(int t)  {      currentCount += t;      this.StateHasChanged();  }```blazor will generate three `EventHandlerId`. When I press the button, the first `EventHandlerId` is retained (just because the ladba "point" at the same address) but the others are simple new labda expression, so blazor will delete and recreate the handler. In a list with many elements and many handler, it's a performance problem.a way to retain can be:```@for (int t = 2; t != 4; t++){    <button class="btn btn-primary"            onclick="@Action(t, e => IncrementCount(t))">        Click me +@t    </button>}  Dictionary<MethodInfo, Dictionary<object, Action<UIEventArgs>>>    _retainedActions = new Dictionary<MethodInfo, Dictionary<object, Action<UIEventArgs>>>();  public Action<UIEventArgs> Action<T>(T args1, Action<UIEventArgs> action)  {      if (_retainedActions.TryGetValue(action.Method, out var list) == false)      {          list = new System.Collections.Generic.Dictionary<object, Action<UIEventArgs>>();          _retainedActions[action.Method] = list;      }      if (list.TryGetValue(args1, out var value) == false)      {          value = (e) => action(e);          list[args1] = value;      }      return value;  }```other ideas? 
5225	area-mvc	packages in current release/branches?	1. in the sample code why is there references to webpack version 1.13.3 when the latest is 4.xJavaScriptServices/samples/misc/Webpack/package.json2. error doing npm install 'couldn't find module extendify'
5224	area-mvc	Asp.net Core 2.1 Webpack 4 - HMR not updating page	HMR appears to be reloading/update js fine but the changes are not being reflected on the page.[HMR] connected client.js:88:22[HMR] bundle rebuilding client.js:228:9[HMR] bundle rebuilt in 47ms client.js:233:9[HMR] Checking for updates on the server... process-update.js:39:22[HMR] Updated modules: process-update.js:105:9[HMR]  - ./clientapp/main.js process-update.js:107:11[HMR] App is up to date. process-update.js:112:9 This is asp.net core 2.1 application, i tried in both firefox development browser and chrome.  Are there logs or something where I can look for a clue?I will include package.json and webpack.config to provide more detail with this application.```{  "name": "acesweb",  "description": "aces template",  "author": "here",  "version": "1.0.0",  "main": "index.js",  "scripts": {    "test": "echo \"Error: no test specified\" && exit 1",    "wbp": "webpack",    "dev": "cross-env ASPNETCORE_ENVIRONMENT=Development NODE_ENV=development dotnet run",    "build:prod": "cross-env NODE_ENV=production webpack --progress --hide-modules",    "build-vendor:prod": "cross-env NODE_ENV=production webpack --config webpack.config.vendor.js --progress",    "build-vendor:dev": "cross-env NODE_ENV=development webpack --config webpack.config.vendor.js --progress"  },  "keywords": [],  "license": "ISC",  "dependencies": {    "axios": "^0.18.0",    "vue": "^2.5.16"  },  "devDependencies": {    "aspnet-webpack": "^3.0.0",    "babel-core": "^6.26.3",    "babel-eslint": "^8.2.6",    "babel-loader": "^7.1.5",    "babel-plugin-transform-async-to-generator": "^6.24.1",    "babel-plugin-transform-runtime": "^6.23.0",    "babel-preset-es2015": "^6.24.1",    "babel-preset-stage-2": "^6.24.1",    "babel-register": "^6.26.0",    "bootstrap": "^4.1.3",    "cross-env": "^5.2.0",    "css-loader": "^1.0.0",    "file-loader": "^1.1.11",    "jquery": "^3.3.1",    "mini-css-extract-plugin": "^0.4.1",    "optimize-css-assets-webpack-plugin": "^5.0.0",    "popper.js": "^1.14.3",    "style-loader": "^0.21.0",    "url-loader": "^1.0.1",    "vue-html-loader": "^1.2.4",    "vue-loader": "^15.2.6",    "vue-template-compiler": "^2.5.16",    "webpack": "^4.16.2",    "webpack-cli": "^3.1.0",    "webpack-dev-middleware": "^3.1.3",    "webpack-hot-middleware": "^2.22.3"  }}```webpack.config.js```const path = require('path');const webpack = require('webpack');const bundleOutputDir = './wwwroot/dist'const VueLoaderPlugin = require('vue-loader/lib/plugin') //https://vue-loader.vuejs.org/guide/#vue-climodule.exports = (env) => {    const isDevBuild = !(env && env.prod);    return [{        mode: 'development',        //Hotmodule replacement requires an entry with an explicitly named “main” entry point.        //It also requires a “publicPath” specified in the “output” element.        entry: {            'main': './clientapp/main.js',            'processor': './clientapp/processor.js',            'app': './clientapp/app.vue',            'todo': './clientapp/todo-item.vue'        },        resolve: {            extensions: ['.js', '.vue'],            alias: isDevBuild ? {                'vue$': 'vue/dist/vue'                      } : {                }        },        output: {            path: path.resolve(__dirname, bundleOutputDir),            filename: '[name].js',            publicPath: 'dist/'        },        module: {            rules: [                {                    test: /\.vue$/,                    loader: 'vue-loader'                                  },                {                    test: /\.html$/,                    loader: 'vue-template-loader'                },                {                    test: /\.js/,                    loader: 'babel-loader'                                },                {                    test: /\.css$/,                    loader: isDevBuild ? ['style-loader', 'css-loader'] : ExtractTextPlugin.extract({ use: 'css-loader' })                },                {                    test: /\.(png|jpg|jpeg|gif|svg)$/,                    loader: 'url-loader?limit=25000'                 }             ]        },        plugins: [            // make sure to include the plugin!            new VueLoaderPlugin()        ]    }];};```my main.js```import Vue from 'vue'import App from './app.vue'Vue.component('todo-item', {    template: '<li><b>This is a list item3</b></li>'})new Vue({    el: '#app',    data: {        message: 'Hello Vue.!js!'    }})module.hot.accept();```and finally my index.cshtml```@{ ViewData["Title"] = "Home Page"; }<div id="app">    <ol>        <todo-item></todo-item>    </ol>    <p>{{ message }}</p></div><div></div>@section scripts {    <script src="~/dist/main.js" asp-append-version="true"></script>}```
5555	area-mvc	404 on PDBs	Hey folks!After the update to 0.5.0 on BlazorExtensions components, I'm starting to see weird errors on the console pointing that some .pdb files are missing:![image](https://user-images.githubusercontent.com/4714040/43269101-87d0b90a-90c8-11e8-8e22-4eec758112de.png)For the record, I'm not even trying to debug. Just running the [BlazorExtensions.Logger test project](https://github.com/BlazorExtensions/Logging/tree/master/test/Blazor.Extensions.Logging.Test) Can someone shed a light on that?
5321	area-signalr	Add possibility to inject json reviver function in Typescript client	Currently there is no possibility to customize in any way the behavior of JsonHubProtocol. It could pass a reviver function to the JSON.parse method. If a user could inject such function to the JsonHubProtocol it would be much easier to perform any data transformation (like converting date strings to Date objects).
5811	area-identity	RFC6238 AuthenticatorService	Can you please expose the internal Rfc6238AuthenticatorService ( and Base32 ), mostly so we are able to utilize it for TwoFactor authentication using the Google Authenticator class of apps.The existing TotpSecurityStampBaseTokenProvider cannot be used as the security stamp should not be involved in the code check.The TimeStep and interval range also needs to be customizable **per token provider** as the default TOTP settings are not always appropriate - effectively this forces us to re-implement ALL of the token providers.At the moment we have to import 3rd party libraries Base32 and OptSharp to be able to provide this functionalityThe PIN length consideration from #1564 should also be customizable.Lastly, please consider converting this to a instance class, not static, so we can configure the TOTP settings within individual token providers and set the TokenOptions provider instance ( I'd love to do this solely via DI but the MS DI engine cannot support parallel named DI graphs )
4649	area-security	Consider resolving IAuthenticationSchemeProvider from DI in Invoke in AuthenticationMiddleware	In short, accepting the IAuthenticationSchemeProvider as a ctor to the AuthenticationMiddleware forces it to be a singleton. I know the default is deigned that way and put in DI that way, but if someone wants to replace it (say with something that hits a DB) then it's difficult.
5810	area-identity	Why isn't MemoryStream in DataProtectionTokenProvider disposed?	This question is a duplicate from https://github.com/aspnet/AspNetIdentity/issues/7But since core has more contributors, I reissue it over here:The `MemoryStream `in `GenerateAsync `and `ValidateAsync `are both not disposed.https://github.com/aspnet/Identity/blob/c7276ce2f76312ddd7fccad6e399da96b9f6fae1/src/Identity/DataProtectionTokenProvider.cs#L72Also the disposing by the `BinaryReader `and `BinaryWriter `is "disabled" through setting the `leaveOpen `parameter to `true`.https://github.com/aspnet/Identity/blob/c7276ce2f76312ddd7fccad6e399da96b9f6fae1/src/Identity/DataProtectionTokenProvider.cs#L174Shouldn't the `MemoryStream `be disposed, cause we don't need him anymore?
5554	area-mvc	Enable HTTPS in all blazor templates	
5320	area-signalr	Handshake Response minorVersion needs to be added to HubProtocol spec	The master branch needs to be updated with the new information regarding the `minorVersion` field in the Handshake Response. 
5223	area-mvc	The SPA default page middleware could not return the default page '/index.html' in production application	I have an ASP.Net Core / Angular 5 application that is logging errors to the Windows Event Log in our production environment.  The following error is getting logged frequently but intermittently in production, and I have no idea why.  The application is definitely in production mode, has been published, and is functioning.`System.InvalidOperationException: The SPA default page middleware could not return the default page '/index.html' because it was not found, and no other middleware handled the request.Your application is running in Production mode, so make sure it has been published, or that you have built your SPA manually. Alternatively you may wish to switch to the Development environment.`AFAIK no users are experiencing a problem with the site when these errors occur.  Any idea why these errors are being thrown, and whether there is in fact a problem that needs to be addressed?
5809	area-identity	Remove Microsoft.AspNetCore.Identity.UI from Microsoft.AspNetCore.App	I'm not sure if this is the right project to place the issue in, as I'm not sure what project manages the relevant nuget package. But I believe Identity UI should be removed from `Microsoft.AspNetCore.App`. The reason for this is because if one chooses not to use Identity UI, and instead write their own UI for Identity, they're not going to be using any of Identity UI. I would imagine this is a common scenario, as most production websites aren't likely to be using Identity UI in my eyes. Normally, it's a non-issue. But because of the nature, it's likely people will be using the same names for their own implementation as are used in Identity UI, such as `LoginModel`, `LogoutModel`, etc. This presents issues when using something like ReSharper, which can automatically import missing namespaces. It quickly becomes cumbersome. I believe Visual Studio has a similar feature as well, which also becomes more cumbersome because of this.Normally, I wouldn't submit an issue over NuGet package organization, as it's largely cosmetic. But I believe that, because of the extremely high likelihood of your class names being the same as Identity UI class names, and the potential for error that this creates, it should be separated from the `Microsoft.AspNetCore.App` package. In my case, these issues have led me to move from using `Microsoft.AspNetCore.App` to manually adding the necessary individual nuget packages to my project to solve the issue. I don't feel this is the ideal scenario, as `Microsoft.AspNetCore.App` is a good package in my eyes. But because of these issues, this is my only acceptable option.Further, I don't believe that Identity UI will be used often enough in production projects to warrant including it in the all-encompassing package. I believe it is very likely Identity UI will only be used for prototyping projects at most and, therefore, doesn't really fit in `Microsoft.AspNetCore.App`.
5553	area-mvc	[Server side] Doing a blocking call on IJSRuntime.InvokeAsync ends up locking the server	Super nitpicky, but doing a .`Result` or '`Wait` on the task returned by `IJSRuntime` locks up the server. E.g. ```C#void DoLog(){    JSRuntime.Current.InvokeAsync<string>("console.log", "Hello world").Wait();}```The server does not respond to any further actions.
5552	area-mvc	[Server side] Exceptions thrown inside of a component are silently ignored	I updated `FetchData.OnInitAsync` to throw an exception:```C#@functions {    WeatherForecast[] forecasts;    protected override async Task OnInitAsync()    {        if (forecasts == null)        {            throw new ArgumentException();        }        forecasts = await ForecastService.GetForecastAsync(DateTime.Now);    }}```I can debug the component and see the exception, but the exception is not logged to the server debug logs or visible in the console
5551	area-mvc	Generics in event handler tool tips aren't showing up correctly	![image](https://user-images.githubusercontent.com/174281/43171299-472ef918-8f5e-11e8-9567-c802d7dbc1f1.png)My guess is that it's supposed to say > Sets the 'onclick' attribute to the provided string or delegate value. A delegate value should be of type `'System.Action<Microsoft.AspNetCore.Blazor.UIMouseEventArgs>'`
5550	area-mvc	Component tag helper matching should be case-sensitive	Initially started in #1155, make it possible to only match Blazor components as named by the C# class.The following 2 snippets are not equal: ```csharp<Form>...</Form>```is not equal to (mind the casing)```html<form>...</form>```We could make it easier for component libraries as BlazorStrap for example, which has a [workaround](https://github.com/chanan/BlazorStrap/blob/d771191f7572aae1aba540c8f87fe81695a621d5/src/Sample/Pages/forms.cshtml#L9). Basically this is also what React does.I'm not really sure if this is Blazor or Razor specific, so if I'm mistaken I do apologise.
5222	area-mvc	Http request to localhost breaks prerendering	Http request to any localhost url crashes angular app with server-side rendering. Calling external api or calling localhost without prerendering works.UPD: It works in production environment, but still crashes in dev environment with localhost.Expected behavior: Application worksCurrent behavior: API isn't called, angular app crashes.Nodejs: 8.11.3 or 10.7.0Yarn: 1.7.0AspNetCore: 2.1.2, IIS Express or Consoleaspnet-prerendering: 3.0.1Angular: 6.0.9Angular CLI: 6.0.8Visual studio 2017 Community 15.7.5Windows 10 Pro x64app.browser.module.ts```ts@NgModule({  declarations: [    AppComponent  ],  imports: [    BrowserModule.withServerTransition({ appId: 'vethelp' })  ],  bootstrap: [AppComponent],  providers: [    ConfigurationService,    {      provide: APP_INITIALIZER,      useFactory: (configService: ConfigurationService) => async () => {        await configService.loadConfiguration()      },      deps: [ConfigurationService],      multi: true    }})export class AppBrowserModule { }```configuration.service.ts```tsexport class Configuration {  constructor(    public abra?: string,    public kadabra?: string  ) { }}@Injectable({  providedIn: 'root'})export class ConfigurationService {  private _configuration: Configuration  get configuration(): Configuration {    return this._configuration  }  constructor(private readonly httpClient: HttpClient) { }  public async loadConfiguration(): Promise<Configuration> {    const url = 'api/ClientConfiguration'    return this.httpClient.get<Configuration>(url).toPromise().then(      result => {        return this._configuration = result      },      async error => {        return Promise.reject(error)      }    )  }}```app.server.module.ts```ts@NgModule({  imports: [    AppBrowserModule,    ServerModule,    ModuleMapLoaderModule  ],  bootstrap: [AppComponent],  providers: [    {      provide: HTTP_INTERCEPTORS,      useClass: ServerInterceptor,      multi: true    }  ]})export class AppServerModule { }```server.interceptor.ts```ts@Injectable({  providedIn: 'root'})export class ServerInterceptor implements HttpInterceptor {  constructor(@Optional() @Inject(SERVER_URL) private readonly origin: string) { }  intercept(req: HttpRequest<any>, next: HttpHandler): Observable<HttpEvent<any>> {    if (this.origin) {      const apiReq = req.clone({ url: `${this.origin}${req.url}` })      return next.handle(apiReq)    } else {      return next.handle(req)    }  }}```main.aspnetcore.ts```tsimport 'zone.js/dist/zone-node'import 'core-js/es7/reflect'if (environment.production) {  enableProdMode()}export { AppServerModule } from './app/app.server.module'export default createServerRenderer(params => {  const {    AppServerModule,    AppServerModuleNgFactory,    LAZY_MODULE_MAP  } = (module as any).exports  const options = {    document: params.data.originalHtml,    url: params.url,    extraProviders: [      provideModuleMap(LAZY_MODULE_MAP),      { provide: APP_BASE_HREF, useValue: params.baseUrl },      { provide: SERVER_URL, useValue: params.origin + params.baseUrl }    ]  }  const renderPromise = AppServerModuleNgFactory    ? /* AoT */ renderModuleFactory(AppServerModuleNgFactory, options)    : /* dev */ renderModule(AppServerModule, options)  return renderPromise.then(html => ({ html }))})```angular.json```json        "server": {          "builder": "@angular-devkit/build-angular:server",          "options": {            "outputPath": "dist/vethelp-aspnetcore",            "main": "src/main.aspnetcore.ts",            "tsConfig": "src/tsconfig.aspnetcore.json"          },          "configurations": {            "production": {              "optimization": true,              "sourceMap": false,              "namedChunks": false,              "extractLicenses": true,              "vendorChunk": false,              "fileReplacements": [{                "replace": "src/environments/environment.ts",                "with": "src/environments/environment.prod.ts"              }]            }          }        },``````cs    public class Startup    {        public const string ClientRoot = "Client";        public const string ClientDist = ClientRoot + "/dist";        public const string AngularDevPolicy = "AngularDev";        public const string AngularDevServerUri = "http://localhost:4200";        public const string HttpDevServerUri = "http://localhost:5000";        public const string HttpsDevServerUri = "https://localhost:44300";        public void ConfigureServices(IServiceCollection services)        {            if (Environment.IsDevelopment())            {                services.AddCors(options =>                {                    options.AddPolicy(AngularDevPolicy, builder =>                    {                        builder.WithOrigins(AngularDevServerUri, HttpDevServerUri, HttpsDevServerUri)                            .AllowAnyHeader()                            .AllowAnyMethod()                            .AllowCredentials();                    });                });            }            services.AddMvc((options) =>            {                // Add [Authorize] by default                var policy = new AuthorizationPolicyBuilder().RequireAuthenticatedUser().Build();                options.Filters.Add(new AuthorizeFilter(policy));            }).AddJsonOptions(options =>            {                options.SerializerSettings.ReferenceLoopHandling = ReferenceLoopHandling.Ignore;            }).SetCompatibilityVersion(CompatibilityVersion.Version_2_1);            services.Configure<ClientConfiguration>(options =>            {                options.Abra = "123";                options.Kadabra = "123";            });            services.AddSpaStaticFiles(configuration => configuration.RootPath = $"{ClientDist}/vethelp");        }        public void Configure(IApplicationBuilder app, IHostingEnvironment environment)        {            var isDev = environment.IsDevelopment();            if (isDev)            {                app.UseCors(AngularDevPolicy);                app.UseDeveloperExceptionPage();                app.UseDatabaseErrorPage();            }            app.UseHttpsRedirection();            app.UseStaticFiles();            app.UseSpaStaticFiles();            app.UseMvc();            app.UseSpa(configuration =>            {                const bool isSsr = true;                if (isSsr)                {                    configuration.UseSpaPrerendering(options =>                    {                        options.BootModulePath = $"{ClientDist}/vethelp-aspnetcore/main.js";                        options.ExcludeUrls = new[] { "/sockjs-node" };                        options.SupplyData = (context, data) =>                        {                            // We can provide data to our angular app here.                            // data['someData'] = "Some Data";                        };                    });                }            });        }    }}```Error```[21:30:54 Error] Microsoft.AspNetCore.NodeServicesERROR HttpErrorResponse {  headers:   HttpHeaders { normalizedNames: Map {}, lazyUpdate: null, headers: Map {} },  status: 0,  statusText: 'Unknown Error',  url: null,  ok: false,  name: 'HttpErrorResponse',  message: 'Http failure response for (unknown url): 0 Unknown Error',  error:   ProgressEvent {     type: 'error',     target:      XMLHttpRequest {        onloadstart: null,        onprogress: null,        onabort: null,        onerror: null,        onload: null,        ontimeout: null,        onloadend: null,        _listeners: [Object],        onreadystatechange: null,        _anonymous: undefined,        readyState: 4,        response: null,        responseText: '',        responseType: 'text',        responseURL: '',        status: 0,        statusText: '',        timeout: 0,        upload: [XMLHttpRequestUpload],        _method: 'GET',        _url: [Url],        _sync: false,        _headers: [Object],        _loweredHeaders: [Object],        _mimeOverride: null,        _request: null,        _response: null,        _responseParts: null,        _responseHeaders: null,        _aborting: null,        _error: null,        _loadedBytes: 0,        _totalBytes: 0,        _lengthComputable: false },     currentTarget:      XMLHttpRequest {        onloadstart: null,        onprogress: null,        onabort: null,        onerror: null,        onload: null,        ontimeout: null,        onloadend: null,        _listeners: [Object],        onreadystatechange: null,        _anonymous: undefined,        readyState: 4,        response: null,        responseText: '',        responseType: 'text',        responseURL: '',        status: 0,        statusText: '',        timeout: 0,        upload: [XMLHttpRequestUpload],        _method: 'GET',        _url: [Url],        _sync: false,        _headers: [Object],        _loweredHeaders: [Object],        _mimeOverride: null,        _request: null,        _response: null,        _responseParts: null,        _responseHeaders: null,        _aborting: null,        _error: null,        _loadedBytes: 0,        _totalBytes: 0,        _lengthComputable: false },     lengthComputable: false,     loaded: 0,     total: 0 } }[21:30:54 Error] Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareAn unhandled exception has occurred while executing the request.Microsoft.AspNetCore.NodeServices.HostingModels.NodeInvocationException: Http failure response for (unknown url): 0 Unknown Error   at Microsoft.AspNetCore.NodeServices.HostingModels.HttpNodeInstance.InvokeExportAsync[T](NodeInvocationInfo invocationInfo, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.HostingModels.OutOfProcessNodeInstance.InvokeExportAsync[T](CancellationToken cancellationToken, String moduleName, String exportNameOrNull, Object[] args)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   at Microsoft.AspNetCore.Builder.SpaPrerenderingExtensions.<>c__DisplayClass0_0.<<UseSpaPrerendering>b__1>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIIndexMiddleware.Invoke(HttpContext httpContext)   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)   at IdentityServer4.Hosting.IdentityServerMiddleware.Invoke(HttpContext context, IEndpointRouter router, IUserSession session, IEventService events) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\IdentityServerMiddleware.cs:line 72   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Cors.Infrastructure.CorsMiddleware.Invoke(HttpContext context)   at IdentityServer4.Hosting.BaseUrlMiddleware.Invoke(HttpContext context) in C:\local\identity\server4\IdentityServer4\src\IdentityServer4\Hosting\BaseUrlMiddleware.cs:line 36   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)   at NWebsec.AspNetCore.Middleware.Middleware.MiddlewareBase.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)[21:30:54 Error] Microsoft.AspNetCore.NodeServicesERROR { TypeError: Converting circular structure to JSON    at JSON.stringify (<anonymous>)    at readableObjectToString (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:652:63)    at resolvePromise (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:814:69)    at resolvePromise (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:771:17)    at C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:873:17    at ZoneDelegate.invokeTask (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:421:31)    at Object.onInvokeTask (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\@angular\core\bundles\core.umd.js:3804:37)    at ZoneDelegate.invokeTask (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:420:36)    at Zone.runTask (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:188:47)    at drainMicroTaskQueue (C:\Users\SpaierInstinct\Documents\Projects\VetHelp\src\Web\Client\node_modules\zone.js\dist\zone-node.js:595:35)  rejection:   HttpErrorResponse {     headers:      HttpHeaders { normalizedNames: Map {}, lazyUpdate: null, headers: Map {} },     status: 0,     statusText: 'Unknown Error',     url: null,     ok: false,     name: 'HttpErrorResponse',     message: 'Http failure response for (unknown url): 0 Unknown Error',     error:      ProgressEvent {        type: 'error',        target: [XMLHttpRequest],        currentTarget: [XMLHttpRequest],        lengthComputable: false,        loaded: 0,        total: 0 } },  promise:   ZoneAwarePromise {     __zone_symbol__state: 0,     __zone_symbol__value:      HttpErrorResponse {        headers: [HttpHeaders],        status: 0,        statusText: 'Unknown Error',        url: null,        ok: false,        name: 'HttpErrorResponse',        message: 'Http failure response for (unknown url): 0 Unknown Error',        error: [ProgressEvent] } },  zone:   Zone {     _properties: { isAngularZone: true },     _parent:      Zone {        _properties: {},        _parent: null,        _name: '<root>',        _zoneDelegate: [ZoneDelegate] },     _name: 'angular',     _zoneDelegate:      ZoneDelegate {        _taskCounts: [Object],        zone: [Circular],        _parentDelegate: [ZoneDelegate],        _forkZS: null,        _forkDlgt: null,        _forkCurrZone: [Zone],        _interceptZS: null,        _interceptDlgt: null,        _interceptCurrZone: [Zone],        _invokeZS: [Object],        _invokeDlgt: [ZoneDelegate],        _invokeCurrZone: [Circular],        _handleErrorZS: [Object],        _handleErrorDlgt: [ZoneDelegate],        _handleErrorCurrZone: [Circular],        _scheduleTaskZS: [Object],        _scheduleTaskDlgt: [ZoneDelegate],        _scheduleTaskCurrZone: [Circular],        _invokeTaskZS: [Object],        _invokeTaskDlgt: [ZoneDelegate],        _invokeTaskCurrZone: [Circular],        _cancelTaskZS: [Object],        _cancelTaskDlgt: [ZoneDelegate],        _cancelTaskCurrZone: [Circular],        _hasTaskZS: [Object],        _hasTaskDlgt: [ZoneDelegate],        _hasTaskDlgtOwner: [Circular],        _hasTaskCurrZone: [Circular] } },  task:   ZoneTask {     _zone:      Zone {        _properties: [Object],        _parent: [Zone],        _name: 'angular',        _zoneDelegate: [ZoneDelegate] },     runCount: 0,     _zoneDelegates: null,     _state: 'notScheduled',     type: 'microTask',     source: 'Promise.then',     data:      ZoneAwarePromise {        __zone_symbol__state: 0,        __zone_symbol__value: [HttpErrorResponse] },     scheduleFn: undefined,     cancelFn: null,     callback: [Function],     invoke: [Function] } }```
5808	area-identity	No way to resend confirmation email	From #1662**No way to resend confirmation email**If you somehow didn't receive (or accidentally deleted, etc.) your confirmation email, then your account is dead forever, because there's no way to resend it. It's worse still if v1 of your site didn't implement confirmation emails, but v2 does, because then all existing users lose their accounts.This is the `#1` ask from the docs feedback.
5549	area-mvc	In RazorCompiler, coalesce adjacent markup blocks	Follow up on #1146
5807	area-identity	Why you remove ApplicationUser?	In 2.0 we use to have an ApplicationUser class. I can add some custom fields and create relationship with another classes. Why you remove ApplicationUser class. Any reason?
4105	area-tooling	Using 'dotnet user-secrets set' reformats JSON and removes comments	First let me state begrudgingly I understand technically JSON doesn't support comments :DHowever - Visual Studio supports it just fine. If you edit your user secrets JSON in VS and create comments, it works ok. They load OK as well in the config system when you run your app. Once you go to the CLI and run the following`dotnet user-secrets set KeyName KeyValue`your secrets are reformatted and all commented items are lost. I wonder if VS should be consistent and not work with comments in JSON (hence force the user to use some convention like _comment) or the tool shouldn't remove what's in the file. As it stands now they operate a bit differently (and thus just lost a bunch of commented test values). Thoughts?
4735	area-servers	Consider using response headers & data padding	https://tools.ietf.org/html/rfc7540#section-6.1"   DATA frames MAY also contain padding.  Padding can be added to DATA   frames to obscure the size of messages.  Padding is a security   feature; see Section 10.7.""The HEADERS frame can include padding. "https://tools.ietf.org/html/rfc7540#section-10.7"   Padding can be used to obscure the exact size of frame content and is   provided to mitigate specific attacks within HTTP, for example,   attacks where compressed content includes both attacker-controlled   plaintext and secret data (e.g., [BREACH])."@blowdart 
3345	area-servers	Impossible to check if HttpContext-body is null/empty...	In ASP.NET-Core, there is no way to check if the request's body is NULL/empty...I make a fetch request ```    let result = <any>await fetch(markerUrl, {        "method": 'POST',        // "headers": {'auth': '1234','content-type': 'application/json'},        // https://stackoverflow.com/questions/38156239/how-to-set-the-content-type-of-request-header-when-using-fetch-api        "headers": new Headers({ 'content-type': 'application/json' }),        "body": null     })    .then(function (response) { return response.json(); })    ;```either with setting body to NULL or by omiting body altogether. In ASP.NET-Core, I get:```context.Responst.Body: is not NULL context.Request.Body.Length: System.NotSupportedException context.Request.Body.Position: System.NotSupportedException context.Request.Body.Seek(0, System.IO.SeekOrigin.End): System.NotSupportedException andcontext.Request.Body._body.IsEmpty: true ```there is no public empty property on Body...Consequentially, it's not possible to read the stream directly into a JSON-object, because there's no way to tell if there actually is a stream/empty-stream...```            if (string.Equals(context.Request.ContentType, "application/json", System.StringComparison.InvariantCultureIgnoreCase))            {                Newtonsoft.Json.Linq.JObject jsonData = null;                // Can only be read ONCE !                 using (System.IO.StreamReader reader = new System.IO.StreamReader(context.Request.Body, System.Text.Encoding.UTF8, false, 4096, true))                {                    using (Newtonsoft.Json.JsonTextReader jsonReader = new Newtonsoft.Json.JsonTextReader(reader))                    {                       // KABOOM !                         var a = Newtonsoft.Json.Linq.JToken.Load(jsonReader);                        System.Console.WriteLine(a);                        jsonData = Newtonsoft.Json.Linq.JObject.Load(jsonReader);                    } // End Using jsonReader                 } // End Using reader ```I don't want to use exceptions for this, because this is slowwwww...I don't want to read it into a string, because that shouldn't be necessary either...
4736	area-servers	Stop using InvalidOperationExceptions to signal invalid ASCII during parsing	GetAsciiStringNonNullCharacters() currently throws an InvalidOperationException fo invalid or chacters, and the parsing logic catches these InvalidOperationExceptions at [various](https://github.com/aspnet/KestrelHttpServer/blob/6551eae321cd6306b485906ea47e8d41e932d65b/src/Kestrel.Core/Internal/Http/Http1Connection.cs#L469) [layers](https://github.com/aspnet/KestrelHttpServer/blob/6551eae321cd6306b485906ea47e8d41e932d65b/src/Kestrel.Core/Internal/Http/Http1Connection.cs#L261) to handle the bad request appropriately.Ideally we could switch to calling a TryGetAsciiStringNonNullCharacters method, but if propagating failure down the stack proves too difficult, we should at least move to a custom exception type so we don't end up obscuring real product bugs by inadvertently swallowing InvalidOperationExceptions thrown by other methods.
5548	area-mvc	One single route is reported as 'The following routes are ambiguous'	I repeatedly get errors such as this:`Error: System.InvalidOperationException: Failed to compare two elements in the array. --->` `System.InvalidOperationException: The following routes are ambiguous:``'admin/product/{ProductUrl}' in 'X.Client.AdminWide.UpdateProduct'``'admin/product/{ProductUrl}' in 'X.Client.AdminWide.UpdateProduct'`I have only one route 'admin/product/{ProductUrl}' in that page. Also, that page has been working for a while, but only shows that errors after I create a new page with a dynamic url ("/user/{UserName}/orders"), which really has nothing related to it.The error only happens if the url is like "/admin/product" and doesn't happen when it's "/admin".The oddest thing is, *sometimes* I would edit the route of a wholly unrelated page into "/x/y" and a random other page would break.What could be the case here?
5806	area-identity	Make Context virtual in UserStore	Could the [Context property](https://github.com/aspnet/Identity/blob/9ecbefcf21d12d90ac187e1eefe02ed0219edc23/src/EF/UserStore.cs#L126) be marked as virtual in UserStore? I would like to implement my own getter so I can better manage the lifecycle of the DbContext (to enforce better control over the transaction boundaries).I have implemented an unit of work using the [DbContextScope library](https://github.com/apawsey/DbContextScope) and it's working great throughout my app, so I would like to use it for Identity as well.
5425	area-mvc	Firefox processes launched by Selenium don't always close	Firefox processes launched by Selenium don't always close, this is a possible cause of hangs in VSTS, pollutes our TC agents and likely contributes to unreliability/slowness of other Templating tests.
5805	area-identity	How can I inject custom code to account controller in Identity core 2.1	Dear Sir/Madam,I tried to update my project from .net core 2.0 to core 2.1 and could not find the place to inject my code to account controller. Do I have to change back to .net Identity core 2.0 code? Or could you give me some suggestions?Thanks.Regards,Max
5889	area-servers	Troubleshooting intermittent 503 errors	We are using WebListener version 1.1.4. We have an issue where approximately 1% of requests return a 503 error. We see these 503 errors in our GTM logs. I can't find anything in our application logs where requests have high latency that could result in timeouts. So I want to see if WebListener got these requests and what it responded with. 1. I see the following logs. I assume these are from .NET core itself, and not necessarily from WebListener. If so, how do I enable WebListener logs?> Microsoft.AspNetCore.Hosting.Internal.WebHost: Information: Request finished in 370.1088ms 200 application/json; charset=utf-82. We are using the default values for MaxAccepts and RequestQueueLimit. The intermittent 503 errors occur even during low traffic periods when CPU is under 20%, so I assume it can't be caused by these default values.3. A lot of online searches for 503 errors point at Application Pool configurations when using IIS. Does WebListener have a similar concept of Application Pools that might need configuring?https://weblog.west-wind.com/posts/2006/Dec/04/503-Service-Unavailable-in-IIS-7-watch-those-Application-Pools4. Is there a way to enable something similar to "Failed Request Tracing" in Web Listener?https://blogs.iis.net/richma/502-3-bad-gateway-the-operation-timed-out-with-iis-application-request-routing-arr5. Any other thoughts or suggestions or greatly appreciated :)
5079	area-mvc	Remove unused/legacy types for 3.0	This is a tracking issue to cover all the types I'd like to consider for removal. Lets update this list- [ ] RazorTemplateEngine
5221	area-mvc	The loading of the "aspnet-webpack" module does not follow Node.js rules	My particular situation is that I have multiple projects in my solution that make use of Node.js and its `/node_modules/` folder.  I want to have these projects share the same `/node_modules/` folder.  Each project copy is 350+Meg, plus I want to keep the projects using the same version of dependencies.Node.js doesn't require that `/node_modules/` be in the same directory as the **project**, only that it exist somewhere up the parent-tree: [https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders](https://nodejs.org/api/modules.html#modules_loading_from_node_modules_folders)I simply moved `/node_modules/` up one folder, so it's at the **solution** level, rather than the **project** level.  This works fine for everything except for `WebpackDevMiddleware.UseWebpackDevMiddleware(...)`.  It is looking for `/node_modules/` at the **project** level, and only there.  It will not do the traversal.  Hence this issue.I have found a workaround:  Create an empty `/node_modules/` folder at the **project** level, then add a symlink to the real location of "aspnet-webpack"_(In <project>/node_modules/)_`mklink /J aspnet-webpack ..\..\node_modules\aspnet-webpack` This works, but it does show that the problem is the search for "aspnet-webpack" is locked to the **project** folder only.
3331	area-middleware	Session OnStart and Session OnEnd	To reopen the issue #3025 https://github.com/aspnet/Home/issues/3025I hope Session can have "Session_Start" and "Session_End" event mechanism.If the mechanism is the same as Spring Session in Java Web, that's preferred.Spring Session has the similiar events such as "SessionCreatedEvent" and "SessionDestroyedEvent" ("SessionDestroyedEvent" includes "SessionDeletedEvent" and "SessionExpiredEvent".).The relevant web sites about Spring Session below:SessionCreatedEvent:https://docs.spring.io/spring-session/docs/1.3.0.RELEASE/reference/html5/#api-redisoperationssessionrepository-sessioncreatedeventSessionDestroyedEvent:https://docs.spring.io/spring-session/docs/1.3.0.RELEASE/reference/html5/#api-redisoperationssessionrepository-sessiondestroyedeventI think the mechanism is important to .NET developers, and it can make ASP.NET Core more perfect.So, "Session_Start" and "Session_End" events should be provided continuously in ASP.NET Core.Thanks!
4222	area-mvc	UseDispatcher multiple times	What should happen if `DispatcherMiddleware` is registered multiple times? Error? No op on second run for a request?
5547	area-mvc	Change standalone web.config to use Cache-Control headers	I published updated [project](http://lupusablazordemos.azurewebsites.net) to azure.When I navigate to site Chrome was showing old version, Firefox got error. Edge showed new version but I am not sure there was loaded and cashed previous version.**I manually cleared browsers cache**, Chrome and Firefox downloaded updated files and run site as expected.Of course we need user to see new version for after all new publishing.Should I trigger this somehow from my code or should blazor do it automatically?
5220	area-mvc	aspnet-webpack is failing and not working with spatemplates or manual configuration webpack dev middleware failed because of an error while loading 'aspnet-webpack'	_From @xtianus79 on May 16, 2018 20:44_I keep getting this error when running the example on this pagehttps://docs.microsoft.com/en-us/aspnet/core/client-side/spa-services?view=aspnetcore-2.0#webpack-dev-middleware`System.AggregateException: One or more errors occurred. (Webpack dev middleware failed because of an error while loading 'aspnet-webpack'. Error was: Error: Cannot find module 'webpack'    at Function.Module._resolveFilename (module.js:538:15)    at Function.Module._load (module.js:468:25)    at Module.require (module.js:587:17)    at require (internal/module.js:11:18)    at Object.<anonymous> (C:\Users\choles\source\repos\WebApplication1test\WebApplication1test\node_modules\aspnet-webpack\WebpackDevMiddleware.js:4:15)    at Module._compile (module.js:643:30)    at Object.Module._extensions..js (module.js:654:10)    at Module.load (module.js:556:32)    at tryModuleLoad (module.js:499:12)    at Function.Module._load (module.js:491:3)`_Copied from original issue: aspnet/Home#3151_
5804	area-identity	Can PasswordValidator errors pretty please be merged with UserValidator errors on user create?	Talking about https://github.com/aspnet/Identity/blame/master/src/Core/UserManager.cs#L597Could instead of returning on `!succeeded` store them, run CreateAsync and merge them with those errors.This is blocking a nice api where you get all errors of a registration in one go.
4900	area-mvc	Remove Roslyn types from the API surface of ASP.NET Core 3.0	We’re planning on building reference assemblies for ASP.NET Core 3.0 and putting them in a targeting pack. We would like to be able to remove Roslyn's types from the API surface of Razor/Mvc so we do not need to put a Roslyn ref assembly in the aspnet targeting pack.Proposed changes:* In 2.2, obsolete APIs which use roslyn types and provide a replacement which does not use Microsoft.CodeAnalysis types directly. The implementation can map our types into roslyn, but that should be internal implementation detail. For example, https://github.com/aspnet/Mvc/blob/a67d9363e22be8ef63a1a62539991e1da3a6e30e/src/Microsoft.AspNetCore.Mvc.Razor/Compilation/MetadataReferenceFeature.cs#L17 * In 3.0, remove the publicly visible Microsoft.CodeAnalysis types completelycc @pranavkm @rynowak 
5546	area-mvc	Add object pool for ServerSide RenderFrame serialization	Follow up item from #1116We should consider pooling the byte arrays/streams from the render frame writer.
3328	area-servers	Not allowing to post huge data in AJAX call in ASP .net core 2	_From @SattarMomin on May 16, 2018 9:52_# Issue TitleNot allowing to post huge data in AJAX call in ASP .net core 2# GeneralI have created 1 page in ASP .net core 2 MVC. Now I am posting data of form by AJAX call and calling Controller Action. But when data is huge on page it is giving error "Failed to load resource: the server responded with a status of 500 (Internal Server Error)", same is working fine when data is less.I am sure issue is due to exceeding data size limit. I have tried '[DisableRequestSizeLimit]' at action level and .UseKestrel(options => { options.Limits.MaxRequestBodySize = null; }) at global level, but giving same error.Kindly suggest_Copied from original issue: dotnet/core#1566_
3324	area-mvc	Remove `ResourceManagerWithCultureStringLocalizer` and `WithCulture` interface member	The [ResourceManagerWithCultureStringLocalizer](https://github.com/aspnet/Localization/blob/43b974482c7b703c92085c6f68b3b23d8fe32720/src/Microsoft.Extensions.Localization/ResourceManagerWithCultureStringLocalizer.cs#L18) and [WithCulture](https://github.com/aspnet/Localization/blob/master/src/Microsoft.Extensions.Localization/ResourceManagerStringLocalizer.cs#L154-L170) interface member are often sources of confusion for users of Localization, especially if they want to create their own `IStringLocalizer` implementation. These items give the user the impression that we expect an `IStringLocalizer` instance to be "per-language, per-resource", when actually they should only be "per-resource", with the language searched for determined by the `CultureInfo.CurrentUICulture` at execution time.Neither of these has any usage that I was able to find with a cursory search, and it's difficult for me to imagine when they would be the correct option, so let's just get rid of them in 3.0.
4899	area-mvc	Consider supporting unwrapping some expressions such as Task.FromResult in analyzer	Consider a code block like so:```C#public Task<IActionResult> Post(Model model){   if (!ModelState.IsValid) { return Task.FromResult(BadRequest()); }   return DoWorkAsync(model);}```Currently the analyzer does not unwrap the `Task.FromResult` expression and would instead treat it as if it were a model instance being returned. We could consider unwrapping some common expressions like this
5219	area-mvc	Microsoft.AspNetCore.NodeServices.HostingModels.NodeInvocationException : Cannot find module	Hi, I just began experimenting with the NodeServices lib and I'm getting the following error:My goal here is to create a less transpiler that can be called from other projects. I'm using a test project as entry point to test the functionality, but I don't know what is wrong (I could guess something related to the paths, but I don't know what is the expected behavior).**`dotnet test` result:**```Microsoft.AspNetCore.NodeServices.HostingModels.NodeInvocationException : Cannot find module 'C:\Users\usr\Source\Repos\Packer\Packer.Test\Fixtures\app\var less = require('less');module.exports = function (result, input) {    var options = {};    less.render(input, options, function (error, output) {        result.stream = output;    });}'Error: Cannot find module 'C:\Users\usr\Source\Repos\Packer\Packer.Test\Fixtures\app\var less = require('less');module.exports = function (result, input) {    var options = {};    less.render(input, options, function (error, output) {        result.stream = output;    });}'    at Function.Module._resolveFilename (internal/modules/cjs/loader.js:581:15)    at Function.Module._load (internal/modules/cjs/loader.js:507:25)    at Module.require (internal/modules/cjs/loader.js:637:17)    at require (internal/modules/cjs/helpers.js:20:18)    at C:\Users\usr\AppData\Local\Temp\potjf3xy.4jb:109:34    at IncomingMessage.<anonymous> (C:\Users\usr\AppData\Local\Temp\potjf3xy.4jb:133:38)    at IncomingMessage.emit (events.js:182:13)    at endReadableNT (_stream_readable.js:1081:12)    at process._tickCallback (internal/process/next_tick.js:63:19)Rastreamento de pilha:   at Microsoft.AspNetCore.NodeServices.HostingModels.HttpNodeInstance.InvokeExportAsync[T](NodeInvocationInfo invocationInfo, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.HostingModels.OutOfProcessNodeInstance.InvokeExportAsync[T](CancellationToken cancellationToken, String moduleName, String exportNameOrNull, Object[] args)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   at Packer.Core.Recipes.LessTranspiler.RunAsyn(String publicRoot, String projectRoot) in C:\Users\usr\Source\Repos\Packer\Packer.Core\Recipes\LessTranspiler.cs:line 22   at Packer.Test.Recipes.LessTranspilerTest.Should_Transpile_Less_Manifest() in C:\Users\usr\Source\Repos\Packer\Packer.Test\Recipes\LessTranspilerTest.cs:line 21--- End of stack trace from previous location where exception was thrown ---```I have this minimal repro here: [Packer.zip](https://github.com/aspnet/JavaScriptServices/files/2190101/Packer.zip)
3321	area-servers	Http.Internal.DefaultHttpRequest Get Query null exception	I developed an API and It's working on Docker, Nginx and Kube. I tried load test and i got this exception in internal http## **StackTrace**```System.NullReferenceException: Object reference not set to an instance of an object.   at Microsoft.AspNetCore.Http.Internal.DefaultHttpRequest.get_Query()   at Microsoft.AspNetCore.Mvc.ModelBinding.QueryStringValueProviderFactory.CreateValueProviderAsync(ValueProviderFactoryContext context)   at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.<CreateAsync>d__3.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()   at Microsoft.AspNetCore.Mvc.ModelBinding.CompositeValueProvider.<CreateAsync>d__2.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()   at Microsoft.AspNetCore.Mvc.Internal.ControllerBinderDelegateProvider.<>c__DisplayClass0_0.<<CreateBinderDelegate>g__Bind|0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.<InvokeInnerFilterAsync>d__14.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.<InvokeNextExceptionFilterAsync>d__23.MoveNext()```I looked HttpAbstractions and i found QueryFeature and got null exception
5218	area-mvc	Visual Studio 2017 Asp.net Core MVC Angular template problem	I've experimented the template provided in VS2017 (same using Version 15.7.4) :Web=>Application Web ASP.NET Core=>Angular.The solution is build but the npm branch show that Angular is not installed. (the restore npm package process never ends)After hours, the only solution I've found is to start the ugly (for me, I hate command line and prefer user friendly menus) Command line in my project directory and type "npm install angular".After that all is well except "angular2-router..." that is still not installed but after closing and reopening the solution, i can run the web application.Is there another way for restoring the angular package directly in VS2017 without command line?
4737	area-servers	Windows Authentication (Kerberos/NTLM) in asp.net core linux	Hello.Enterprise Application Development still requires Windows Authentication (via NTLM/Kerberos).It perhaps in asp.net core development model on kestrel server in Linux?
5078	area-mvc	Add support for foreach await	C# 8 is considering adding a `foreach await` syntax. Right now our understanding of `@foreach` doesn't support having an `await` identifier after it.Marking this as blocked until the C# 8 plans are more locked down on. 
5217	area-mvc	ASP.NET Core 2.1 fails with react / CRA template on start	_From @ajensenwaud on May 25, 2018 11:19_I created a new ASP.NET Core 2.1 app (on Linux x64 / Ubuntu) and am now trying to get it to work in Development mode. I used the react / CRA template following this guide: https://docs.microsoft.com/en-us/dotnet/core/tools/dotnet-run?tabs=netcore2xI got the following error when startintg:```aj@kennedy ~/romp $ export ASPNETCORE_ENVIRONMENT=Developmentaj@kennedy ~/romp $ dotnet run                               info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[0]      User profile is available. Using '/home/aj/.aspnet/DataProtection-Keys' as key repository; keys will not be encrypted at rest.info: Microsoft.AspNetCore.SpaServices[0]      Starting create-react-app server on port 41269...Hosting environment: DevelopmentContent root path: /home/aj/rompNow listening on: http://localhost:5000Application started. Press Ctrl+C to shut down.info: Microsoft.AspNetCore.SpaServices[0]      > romp@0.1.0 start /home/aj/romp/ClientApp      > rimraf ./build && react-scripts start            Starting the development server...      fail: Microsoft.AspNetCore.SpaServices[0]      events.js:165      npmfail: Microsoft.AspNetCore.SpaServices[0]            throw er; // Unhandled 'error' event            ^            Error: watch /home/aj/romp/ClientApp/public ENOSPC          at FSWatcher.start (fs.js:1402:19)          at Object.fs.watch (fs.js:1428:11)          at createFsWatchInstance (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:37:15)          at setFsWatchListener (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:80:15)          at FSWatcher.NodeFsHandler._watchWithNodeFs (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:228:14)          at FSWatcher.NodeFsHandler._handleDir (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:407:19)          at FSWatcher.<anonymous> (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:455:19)          at FSWatcher.<anonymous> (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:460:16)          at FSReqWrap.oncomplete (fs.js:171:5)      Emitted 'error' event at:          at FSWatcher._handleError (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/index.js:257:10)          at createFsWatchInstance (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:39:5)          at setFsWatchListener (/home/aj/romp/ClientApp/node_modules/webpack-dev-server/node_modules/chokidar/lib/nodefs-handler.js:80:15)          [... lines matching original stack trace ...]          at FSReqWrap.oncomplete (fs.js:171:5)      npm ERR! code ELIFECYCLE      fail: Microsoft.AspNetCore.SpaServices[0]      npm ERR! errno 1      npmfail: Microsoft.AspNetCore.SpaServices[0]      npm ERR! romp@0.1.0 start: `rimraf ./build && react-scripts start`      npm ERR!fail: Microsoft.AspNetCore.SpaServices[0]      npm ERR! Exit status 1      fail: Microsoft.AspNetCore.SpaServices[0]      npm ERR!       npm ERR! Failed at the romp@0.1.0 start script.      fail: Microsoft.AspNetCore.SpaServices[0]      npm ERR! This is probably not a problem with npm. There is likely additional logging output above.      fail: Microsoft.AspNetCore.SpaServices[0]      npm ERR! A complete log of this run can be found in:      ^CApplication is shutting down...```OK, fine, so rimraf and react-scripts npms were missing. I installed them manually + globally using npm install rimraf react-scripts --globalIssue persisted. I then read somewhere there is a potential issue with number of open filehandles on Linux. The following helped: ```aj@kennedy ~/romp $ echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p```And then it appears to compile + react the React midldleware. Is there an issue on Linux? _Copied from original issue: dotnet/core#1594_
5319	area-signalr	Update HubProtocol spec with new message types and changes	There are going to be some changes to our HubProtocol including changes to the `InvocationMessage` type and the addition of the new message type `StreamCompletionMessage`.Spec located here: https://github.com/aspnet/SignalR/blob/master/specs/HubProtocol.mdNote: These changes are going into 3.0, not 2.2 so this PR should be done directly on the `master` branch
4650	area-security	Encrypted userinfo jwt not working	I'm integrating with an identity provider who uses OpenId connect with userinfo in an encrypted jwt.Unfortunately, OpenIdConnectHandler is unable to handle this specific case. Crashes at: https://github.com/aspnet/Security/blob/beaa2b443d46ef8adaf5c2a89eb475e1893037c2/src/Microsoft.AspNetCore.Authentication.OpenIdConnect/OpenIdConnectHandler.cs#L815-L819 because userInfoEndpointJwt.Payload is null in this caseSee also https://github.com/aspnet/Security/pull/517#discussion_r42279158 where @PinpointTownes suggests it will possibly crash but he can't test it versus a server with this behavior.Since it's allowed in the openid connect spec, the handler should probably be able to handle it.I managed to make it work by replacing the code above with this:    else if (contentType.MediaType.Equals("application/jwt", StringComparison.OrdinalIgnoreCase))            {                var validationParameters = Options.TokenValidationParameters.Clone();                validationParameters.RequireSignedTokens = false;                validationParameters.ValidateLifetime = false;                if (_configuration != null)                {                    var issuer = new[] { _configuration.Issuer };                    validationParameters.ValidIssuers = validationParameters.ValidIssuers?.Concat(issuer) ?? issuer;                    validationParameters.IssuerSigningKeys = validationParameters.IssuerSigningKeys?.Concat(_configuration.SigningKeys)                                                             ?? _configuration.SigningKeys;                }                var princip = Options.SecurityTokenValidator.ValidateToken(userInfoResponse, validationParameters, out SecurityToken validatedToken);                var userInfoJwt = validatedToken as JwtSecurityToken;                user = JObject.FromObject(userInfoJwt.Payload);                userInfoResponse = new JwtSecurityTokenHandler().WriteToken(userInfoJwt.InnerToken);    }But this is just an ugly workaround for this specific provider, I'm sure someone can come up with a more generic implementation which fixes both cases. (The reason I'm replacing the userInfoResponse is because later in the method the userInfoResponse is being validated and this method ALSO assumes it's unencrypted)
6022	area-identity	Hard to diagnose exception thrown when AzureADOptions.Instance is not set	I was migrating an app that uses Azure AD auth from 1.x to 2.1, including using the new UI package. I had not set `AzureADOptions.Instance` (as this is new in 2.x and I didn't know it needed to be set). The exception that results does not have user-code on the stack, and thus has no line numbers. The exception is from the `Uri` constructor, which is being passed a null string (from [this line](https://github.com/aspnet/AADIntegration/blob/master/src/Microsoft.AspNetCore.Authentication.AzureAD.UI/OpenIdConnectOptionsConfiguration.cs#L32)).We should ensure we validate options properties before using them to create other types where they might throw, as it's incredibly hard for app devs to diagnose.@javiercn @blowdart 
5216	area-mvc	Microsoft.AspNetCore.SpaServices.Extensions 2.1.0 - UseSpaStaticFiles Issue	_From @TheMagnificent11 on May 14, 2018 3:26_I recently upgrade a ASP.Net Core 2.0 project to 2.1 RC.The project used the SPA Services and worked as expected in 2.0.I'm getting the following error after upgrading to 2.1.```System.InvalidOperationException  HResult=0x80131509  Message=To use UseSpaStaticFiles, you must first register an ISpaStaticFileProvider in the service provider, typically by calling services.AddSpaStaticFiles.  Source=Microsoft.AspNetCore.SpaServices.Extensions  StackTrace:   at Microsoft.Extensions.DependencyInjection.SpaStaticFilesExtensions.ShouldServeStaticFiles(IApplicationBuilder app, Boolean allowFallbackOnServingWebRootFiles, IFileProvider& fileProviderOrDefault)   at Microsoft.Extensions.DependencyInjection.SpaStaticFilesExtensions.UseSpaStaticFilesInternal(IApplicationBuilder app, StaticFileOptions staticFileOptions, Boolean allowFallbackOnServingWebRootFiles)   at Microsoft.Extensions.DependencyInjection.SpaStaticFilesExtensions.UseSpaStaticFiles(IApplicationBuilder applicationBuilder, StaticFileOptions options)   at Microsoft.Extensions.DependencyInjection.SpaStaticFilesExtensions.UseSpaStaticFiles(IApplicationBuilder applicationBuilder)   at Web.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\src\demo-me\Web\Startup.cs:line 64```My code, for adding/configuring SPA services, appears to be the same as the code generated from the Angular template for ASP.Net Core 2.1.Here's my code.**Project File**```<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <AssemblyName>Web</AssemblyName>    <RootNamespace>Web</RootNamespace>    <TargetFramework>netcoreapp2.1</TargetFramework>    <TypeScriptCompileBlocked>true</TypeScriptCompileBlocked>    <TypeScriptToolsVersion>Latest</TypeScriptToolsVersion>    <IsPackable>false</IsPackable>    <SpaRoot>ClientApp\</SpaRoot>    <DefaultItemExcludes>$(DefaultItemExcludes);$(SpaRoot)node_modules\**</DefaultItemExcludes>    <BuildServerSideRenderer>false</BuildServerSideRenderer>    <UserSecretsId>98409fa3-6e14-4655-93f1-941183396787</UserSecretsId>  </PropertyGroup>  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Debug|AnyCPU'">    <DocumentationFile>bin\Debug\netcoreapp2.0\Web.xml</DocumentationFile>    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>    <WarningsAsErrors />    <CodeAnalysisRuleSet>..\CodeAnalysis.ruleset</CodeAnalysisRuleSet>    <Features>IOperation</Features>    <NoWarn>1701;1702;1705;CA2007;CA1305</NoWarn>  </PropertyGroup>  <PropertyGroup Condition="'$(Configuration)|$(Platform)'=='Release|AnyCPU'">    <DocumentationFile>bin\Release\netcoreapp2.0\Web.xml</DocumentationFile>    <TreatWarningsAsErrors>true</TreatWarningsAsErrors>    <WarningsAsErrors />    <CodeAnalysisRuleSet>..\CodeAnalysis.ruleset</CodeAnalysisRuleSet>    <Features>IOperation</Features>    <NoWarn>1701;1702;1705;CA2007;CA1305</NoWarn>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Autofac" Version="4.8.1" />    <PackageReference Include="Autofac.Extensions.DependencyInjection" Version="4.2.2" />    <PackageReference Include="AutoMapper" Version="6.2.2" />    <PackageReference Include="AutoMapper.Extensions.Microsoft.DependencyInjection" Version="3.2.0" />    <PackageReference Include="Microsoft.AspNetCore.All" Version="2.1.0-rc1-final" />    <PackageReference Include="Microsoft.AspNetCore.Authentication.JwtBearer" Version="2.1.0-rc1-final" />    <PackageReference Include="Microsoft.AspNetCore.SpaServices.Extensions" Version="2.1.0-rc1-final" />    <PackageReference Include="Microsoft.CodeAnalysis.FxCopAnalyzers" Version="2.6.0" />    <PackageReference Include="StyleCop.Analyzers" Version="1.0.2" />    <PackageReference Include="Swashbuckle.AspNetCore" Version="2.4.0" />    <PackageReference Include="System.IdentityModel.Tokens.Jwt" Version="5.2.2" />  </ItemGroup>  <ItemGroup>    <DotNetCliToolReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Tools" Version="2.0.1" />    <DotNetCliToolReference Include="Microsoft.Extensions.SecretManager.Tools" Version="2.0.0" />  </ItemGroup>  <ItemGroup>    <!-- Files not to publish (note that the 'dist' subfolders are re-added below) -->    <Content Remove="ClientApp\**" />  </ItemGroup>  <ItemGroup>    <ProjectReference Include="..\Data.Interfaces\Data.Interfaces.csproj" />    <ProjectReference Include="..\Data.Models\Data.Models.csproj" />    <ProjectReference Include="..\Data\Data.csproj" />    <ProjectReference Include="..\Logic.Interfaces\Logic.Interfaces.csproj" />    <ProjectReference Include="..\Logic.Models\Logic.Models.csproj" />    <ProjectReference Include="..\Logic\Logic.csproj" />    <ProjectReference Include="..\Web.Models.Mappings\Web.Models.Mappings.csproj" />    <ProjectReference Include="..\Web.Models\Web.Models.csproj" />  </ItemGroup>  <ItemGroup>    <Folder Include="Properties\PublishProfiles\" />  </ItemGroup>  <ItemGroup>    <!-- Don't publish the SPA source files, but do show them in the project files list -->    <Content Remove="$(SpaRoot)**" />    <None Include="$(SpaRoot)**" Exclude="$(SpaRoot)node_modules\**" />  </ItemGroup>  <ItemGroup>    <Content Remove="swagger.json" />  </ItemGroup>  <ItemGroup>    <None Include="swagger.json" />  </ItemGroup>  <Target Name="DebugEnsureNodeEnv" BeforeTargets="Build" Condition=" '$(Configuration)' == 'Debug' And !Exists('$(SpaRoot)node_modules') ">    <!-- Ensure Node.js is installed -->    <Exec Command="node --version" ContinueOnError="true">      <Output TaskParameter="ExitCode" PropertyName="ErrorCode" />    </Exec>    <Error Condition="'$(ErrorCode)' != '0'" Text="Node.js is required to build and run this project. To continue, please install Node.js from https://nodejs.org/, and then restart your command prompt or IDE." />    <Message Importance="high" Text="Restoring dependencies using 'npm'. This may take several minutes..." />    <Exec WorkingDirectory="$(SpaRoot)" Command="npm install" />  </Target>  <Target Name="PublishRunWebpack" AfterTargets="ComputeFilesToPublish">    <!-- As part of publishing, ensure the JS resources are freshly built in production mode -->    <Exec WorkingDirectory="$(SpaRoot)" Command="npm install" />    <Exec WorkingDirectory="$(SpaRoot)" Command="npm run build -- --prod" />    <Exec WorkingDirectory="$(SpaRoot)" Command="npm run build:ssr -- --prod" Condition=" '$(BuildServerSideRenderer)' == 'true' " />    <!-- Include the newly-built files in the publish output -->    <ItemGroup>      <DistFiles Include="$(SpaRoot)dist\**; $(SpaRoot)dist-server\**" />      <DistFiles Include="$(SpaRoot)node_modules\**" Condition="'$(BuildServerSideRenderer)' == 'true'" />      <ResolvedFileToPublish Include="@(DistFiles->'%(FullPath)')" Exclude="@(ResolvedFileToPublish)">        <RelativePath>%(DistFiles.Identity)</RelativePath>        <CopyToPublishDirectory>PreserveNewest</CopyToPublishDirectory>      </ResolvedFileToPublish>    </ItemGroup>  </Target></Project>```**Startup**```using System;using System.Text;using Autofac;using Autofac.Extensions.DependencyInjection;using AutoMapper;using Common.Constants.Auth;using Data;using Data.Models.Auth;using Data.Models.Auth.Enums;using Logic;using Logic.Auth;using Logic.Models;using Microsoft.AspNetCore.Authorization;using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.AspNetCore.Identity;using Microsoft.AspNetCore.Mvc;using Microsoft.AspNetCore.SpaServices.AngularCli;using Microsoft.EntityFrameworkCore;using Microsoft.Extensions.Configuration;using Microsoft.Extensions.DependencyInjection;using Microsoft.IdentityModel.Tokens;using Swashbuckle.AspNetCore.Swagger;namespace Web{    /// <summary>    /// Startup    /// </summary>    public sealed class Startup    {        /// <summary>        /// Initializes a new instance of the <see cref="Startup"/> class        /// </summary>        /// <param name="configuration">Application configuration</param>        public Startup(IConfiguration configuration)        {            Configuration = configuration;        }        private IConfiguration Configuration { get; set; }        /// <summary>        /// Configures the HTTP request pipeline        /// </summary>        /// <param name="app">Application builder</param>        /// <param name="env">Hosting environment</param>        public static void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (app == null) throw new ArgumentNullException(nameof(app));            if (env == null) throw new ArgumentNullException(nameof(env));            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            else            {                app.UseHsts();            }            app.UseHttpsRedirection();            app.UseStaticFiles();            app.UseSpaStaticFiles();            app.UseAuthentication();            app.UseSwagger();            app.UseSwaggerUI(c =>            {                c.SwaggerEndpoint("/swagger/v1/swagger.json", "demo-me API");            });            app.UseMvc(routes =>            {                routes.MapRoute(                    name: "default",                    template: "{controller=Home}/{action=Index}/{id?}");            });            app.UseSpa(spa =>            {                spa.Options.SourcePath = "ClientApp";                if (env.IsDevelopment())                {                    spa.UseAngularCliServer(npmScript: "start");                }            });        }        /// <summary>        /// Configures application services        /// </summary>        /// <param name="services">Services collection</param>        /// <returns>Service provider</returns>        public IServiceProvider ConfigureServices(IServiceCollection services)        {            if (services == null) throw new ArgumentNullException(nameof(services));            services.Configure<AuthenticationSettings>(Configuration.GetSection("Authentication"));            services.AddSingleton(Configuration);            services.AddDbContextPool<DatabaseContext>(options =>                options.UseSqlServer(Configuration.GetConnectionString("DefaultConnection")));            services.AddIdentity<User, IdentityRole>()                .AddEntityFrameworkStores<DatabaseContext>()                .AddDefaultTokenProviders();            var tokenSigningKey = Configuration["Authentication:TokenSigningKey"];            services.AddAuthentication(options =>            {                options.DefaultAuthenticateScheme = "JwtBearer";                options.DefaultChallengeScheme = "JwtBearer";            })            .AddJwtBearer("JwtBearer", jwtBearerOptions =>            {                jwtBearerOptions.TokenValidationParameters = new TokenValidationParameters()                {                    ValidateIssuerSigningKey = true,                    IssuerSigningKey = new SymmetricSecurityKey(Encoding.UTF8.GetBytes(tokenSigningKey)),                    ValidateIssuer = true,                    ValidIssuer = Configuration["Authentication:Issuer"],                    ValidateAudience = true,                    ValidAudience = Configuration["Authentication:Audience"],                    ValidateLifetime = true,                    ClockSkew = TimeSpan.FromMinutes(60)                };            })            .AddFacebook(facebookOptions =>            {                facebookOptions.AppId = Configuration["Authentication:Facebook:AppId"];                facebookOptions.AppSecret = Configuration["Authentication:Facebook:AppSecret"];            });            services.AddMvc().SetCompatibilityVersion(CompatibilityVersion.Version_2_1);            ConfigureAuthorizationPolicies(services);            var apiKeyScheme = new ApiKeyScheme()            {                Description = "JWT Authorization Scheme",                Name = "Authorization",                In = "header",                Type = "apiKey"            };            services.AddSwaggerGen(c =>            {                c.SwaggerDoc("v1", new Info { Title = "demo-me API", Version = "v1" });                c.AddSecurityDefinition("Bearer", apiKeyScheme);            });            services.AddAutoMapper();            var builder = new ContainerBuilder();            builder.Populate(services);            builder.RegisterModule(new LogicModule());            services.AddSpaStaticFiles(configuration =>            {                configuration.RootPath = "ClientApp/dist";            });            return new AutofacServiceProvider(builder.Build());        }        private static void ConfigureAuthorizationPolicies(IServiceCollection services)        {            services.AddAuthorization(options =>            {                options.AddPolicy(ClaimPolicies.OwnUser, policy =>                {                    policy.Requirements.Add(new OwnUserRequirement());                });                options.AddPolicy(ClaimPolicies.ContentConsumer, policy =>                {                    policy.Requirements.Add(new TenantRoleRequirement(TenantRoleType.ContentConsumer));                });                options.AddPolicy(ClaimPolicies.ContentDistributor, policy =>                {                    policy.Requirements.Add(new TenantRoleRequirement(TenantRoleType.ContentDistributor));                });                options.AddPolicy(ClaimPolicies.ContentCreator, policy =>                {                    policy.Requirements.Add(new TenantRoleRequirement(TenantRoleType.ContentCreator));                });                options.AddPolicy(ClaimPolicies.TenantAdministrator, policy =>                {                    policy.Requirements.Add(new TenantRoleRequirement(TenantRoleType.Administrator));                });            });            services.AddSingleton<IAuthorizationHandler, OwnUserHandler>();            services.AddSingleton<IAuthorizationHandler, TenantRoleHandler>();        }    }}```_Copied from original issue: aspnet/Home#3140_
4738	area-servers	Microsoft Security Advisory ASPNETCore-July18: ASP.NET Core Denial Of Service Vulnerability	# Microsoft Security Advisory ASPNETCore-July18: ASP.NET Core Denial Of Service Vulnerability## <a name="executive-summary"></a>Executive summaryMicrosoft is releasing this security advisory to provide information about a vulnerability in ASP.NET Core 2.0 and 2.1. This advisory also provides guidance on what developers can do to update their applications to remove this vulnerability.Microsoft is aware of a denial of service vulnerability in ASP.NET Core when a malformed request is terminated. An attacker who successfully exploited this vulnerability could cause a denial of service attack.The update addresses the vulnerability by correcting how ASP.NET Core handles such requests.## AnnouncementThe original announcement for this issue can be found at https://github.com/aspnet/Announcements/issues/311### <a name="mitigation-factors"></a>Mitigation factors* If your application is behind a forwarding proxy such is Internet Information Server, Azure Application Gateway or nginx you will not be affected.### <a name="mitigation-factors"></a>Mitigation factors* If your application is behind a forwarding proxy such is Internet Information Server, Azure Application Gateway or nginx you will not be affected.## <a name="affected-software"></a>Affected softwareAny ASP.NET Core based application that uses Microsoft.AspNetCore.Server.Kestrel.Core with a vulnerable version listed below and not hosted behind a forwarding proxy.Package name | Vulnerable versions | Secure versions------------ | ---------------- | -------------------------Microsoft.AspNetCore.Server.Kestrel.Core | 2.0.0, 2.0.1, 2.0.2, 2.0.3 <br /> 2.1.0, 2.1.1 | 2.0.4 <br /> 2.1.2Microsoft.AspNetCore.All | 2.0.0, 2.0.1, 2.0.2, 2.0.3, 2.0.4, 2.0.5, 2.0.6, 2.0.7, 2.0.8 <br /> 2.1.0, 2.1.1  | 2.0.9 <br /> 2.1.2Microsoft.AspNetCore.App | 2.1.0, 2.1.1 | 2.1.2## <a name="advisory-faq"></a>Advisory FAQ### <a name="how-affected"></a>How do I know if I am affected?.NET Core has two types of dependencies: direct and transitive. Direct dependencies are dependencies where you specifically add a package to your project, transitive dependencies occur when you add a package to your project that in turn relies on another package.For example, the `Microsoft.AspNetCore.Mvc` package depends on the `Microsoft.AspNetCore.Mvc.Core` package. When you add a dependency on `Microsoft.AspNetCore.Mvc` in your project, you're taking a transitive dependency on `Microsoft.AspNetCore.Mvc.Core`.Any application that has a direct or transitive dependency on the [affected package](#affected-software) can be exposed to the vulnerability if it does not meet any of the [mitigation factors](#mitigation-factors).### <a name="how-fix"></a>How do I fix the issue?### ASP.NET Core 2.1To update ASP.NET Core 2.1 you should [download](https://www.microsoft.com/net/download) and install the .NET Core SDK 2.1.302 on your development machines and build servers, and the .NET Core Runtime 2.1.2 on your deployment servers. Your application will roll forward to these versions on an application restart.### ASP.NET Core 2.0If you're targeting ASP.NET Core 2.0 and using the `Microsoft.AspNetCore.All` metapackage update its version number to 2.0.9 to update the `Microsoft.AspNetCore.Server.Kestrel.Core` package, recompile, and redeploy. On your deployment servers, you should [download](https://github.com/dotnet/core/blob/master/release-notes/download-archives/2.0.9-download.md) and install the .NET Core 2.0.9 using the Windows Server Hosting Bundle for Windows and the `dotnet-hosting-2.0.9` package for Linux servers.### ASP.NET 2.0 & 2.1 not targeting the meta-packages.NET Core projects have two types of dependencies: direct and transitive. You must update your projects using the following instructions to address both types of dependency.#### Direct dependenciesDirect dependencies are discoverable by examining your `csproj` file. They can be fixed by [editing the project file](#direct-dependencies) or using NuGet to update the dependency.#### Transitive dependenciesTransitive dependencies occur when you add a package to your project that in turn relies on another package. For example, if Contoso publishes a package `Contoso.Utility` which, in turn, depends on `Contoso.Internals` and you add the `Contoso.Utility` package to your project now your project has a direct dependency on `Contoso.Utility` and, because `Contoso.Utility` depends 'Contoso.Internals', your application gains a transitive dependency on the `Contoso.Internals` package.Transitive dependencies are reviewable in three ways, depending on your [project format](#project-format):* In the Visual Studio Solution Explorer window, which supports searching.* By examining the `project.assets.json` file contained in the obj directory of your project for `csproj` based projects.The `project.assets.json`files are the authoritative list of all packages used by your project, containing both direct and transitive dependencies.#### <a name="direct-dependencies-vs2017"></a>Fixing direct dependencies in Visual Studio 2017Open *projectname.csproj* in your editor. If you're using Visual Studio, right-click the project and choose **Edit projectname.csproj** from the context menu, where projectname is the name of your project. Look for `PackageReference` elements. The following shows an example project file:```xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp2.0</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore.All" Version="2.0.8" />  </ItemGroup></Project>```The preceding example has a reference to the [vulnerable package](#affected-software), as seen by the single `PackageReference` element. The name of the package is in the `Include` attribute.The package version number is in the `Version` attribute. The previous example shows a single direct dependency on `Microsoft.AspNetCore.All` version 2.0.0.To update the version to the secure package, change the version number to the updated package version as listed on the table [previously](#affected-software).In this example, update `Microsoft.AspNetCore.All` to the appropriate [fixed package number](#affected-software) for your major version. Save the *csproj* file. The example *csproj* now looks as follows:```xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp2.0</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore.All" Version="2.0.9" />  </ItemGroup></Project>```If you're using Visual Studio and you save your updated *csproj* file, Visual Studio will restore the new package version.You can see the restore results by opening the **Output** window (Ctrl+Alt+O) and changing the **Show output from** drop-down list to **Package Manager**.If you're not using Visual Studio, open a command line and change to your project directory. Execute the `dotnet restore` command to restore the updated dependencies.Now recompile your application. If after recompilation you see a *Dependency conflict warning*, you must update your other direct dependencies to versions that take a dependency on the updated package.#### Discovering and fixing transitive dependenciesThere are two ways to view transitive dependencies. You can either [use Visual Studio’s Solution Explorer](#vs-solution-explorer), or you can review [the `project.assets.json` file](#project-assets-json) .##### <a name="vs-solution-explorer"></a>Using Visual Studio Solution ExplorerTo use Solution Explorer, open the project in Visual Studio, and then press Ctrl+; to activate the search in Solution Explorer. Search for the [vulnerable package](#affected-software) and make a note of the version numbers of any results you find.For example, searching for `Microsoft.AspNetCore.Mvc.Core` in an example project that contains a package that takes a dependency on `Microsoft.AspNetCore.Mvc` shows the following results in Visual Studio 2017:![Screenshot of search results in Visual Studio 2017](https://cloud.githubusercontent.com/assets/796298/25858816/8ecdc2b4-3491-11e7-9363-746804bb9832.png)The search results appear as a tree. In the previous results, you can see that a reference to `Microsoft.AspNetCore.Mvc.Core` version 1.1.2 is discovered.Under the Dependencies node is a NuGet node. Under the NuGet node is the list of packages you have directly taken a dependency on and their versions.In screenshot, the application takes a direct dependency on `Microsoft.AspNetCore.Mvc`. `Microsoft.AspNetCore.Mvc` in turn has leaf nodes that list its dependencies and their versions.The `Microsoft.AspNetCore.Mvc` package takes a dependency on a version of `Microsoft.AspNetCore.Mvc.ApiExplorer`, that in turn takes a dependency on a version of `Microsoft.AspNetCore.Mvc.Core`.##### <a name="project-assets-json"></a> Manually reviewing project.assets.jsonOpen the *project.assets.json* file from your project’s obj directory in your editor. We suggest you use an editor that understands JSON and allows you to collapse and expand nodes to review this file.Visual Studio and Visual Studio Code provide JSON friendly editing.Search the *project.assets.json* file for the [vulnerable package](#affected-software), using the format `packagename/` for each of the package names from the preceding table. If you find the assembly name in your search:* Examine the line on which they are found, the version number is after the `/`.* Compare to the [vulnerable versions table](#affected-software).For example, a search result that shows `Microsoft.AspNetCore.Server.Kestrel.Core/2.0.0` is a reference to version 2.0.0 of `Microsoft.AspNetCore.Server.Kestrel.Core`.If your *project.assets.json* file includes references to the [vulnerable package](#affected-software), then you need to fix the transitive dependencies.If you have not found any reference to any vulnerable packages, this means either* None of your direct dependencies depend on any vulnerable packages, or* You have already fixed the problem by updating the direct dependencies.If your transitive dependency review found references to the [vulnerable package](#affected-software), you must add a direct dependency to the updated package to your *csproj* file to override the transitive dependency.Open *projectname.csproj* in your editor. If you're using Visual Studio, right-click the project and choose **Edit projectname.csproj** from the context menu, where projectname is the name of your project.Look for `PackageReference` nodes, for example:```xml<Project Sdk="Microsoft.NET.Sdk.">  <PropertyGroup>    <TargetFramework>net461</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="ThirdParty.NotUpdatedYet" Version="2.0.0" />  </ItemGroup></Project>```You must add a direct dependency to the updated version of the [vulnerable package](#affected-software) by adding it to the *csproj* file.You do this by adding a new line to the dependencies section, referencing the fixed version.For example, if your search showed a transitive reference to a vulnerable `Microsoft.AspNetCore.Server.Kestrel.Core` version, you'd add a reference to the [fixed package number](#affected-software).```xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>net461</TargetFramework>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore.Server.Kestrel.Core" Version="2.0.34 />    <PackageReference Include="ThirdParty.NotUpdatedYet" Version="2.0.0" />  </ItemGroup></Project>```After you've added the direct dependency reference, save your *csproj* file.If you're using Visual Studio, save your updated *csproj* file and Visual Studio will restore the new package versions.You can see the restore results by opening the **Output** window (Ctrl+Alt+O) and changing the **Show output from** drop-down list to **Package Manager**.If you're not using Visual Studio, open a command line and change to your project directory. Execute the `dotnet restore` command to restore the new dependencies.#### Rebuilding your applicationFinally you must rebuild your application, test, and redeploy.## Other Information### Reporting Security IssuesIf you have found a potential security issue in .NET Core, please email details to secure@microsoft.com. Reports may qualify for the .NET Core Bug Bounty. Details of the .NET Core Bug Bounty including terms and conditions are at [https://aka.ms/corebounty](https://aka.ms/corebounty).### SupportYou can ask questions about this issue on GitHub in the .NET Core or ASP.NET Core organizations. These are located at https://github.com/dotnet/ and https://github.com/aspnet/. The Announcements repo for each product (https://github.com/dotnet/Announcements and https://github.com/aspnet/Announcements) will contain this bulletin as an issue and will include a link to a discussion issue. You can ask questions in the discussion issue.### DisclaimerThe information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.### RevisionsV1.1 (July 10, 2018): Added .App meta-package details.V1.0 (July 10, 2018): Advisory published._Version 1.0__Last Updated 2018-07-10_
5215	area-mvc	How to upgrade existing project with older template version to latest template version?	I've just converted my existing Angular .Net Core 2.1 project in VS 2017 15.7.4 to the latest released version of the template (I was using the older version that came installed with VS). I installed the template with _dotnet new --install Microsoft.AspNetCore.SpaTemplates::*_, created a default project and them manually reworked my project by comparing the two. My question is, when version 2.1 is officially released, what is the best way to update my project to include the changes from 2.0.7 to 2.1? Do I need to do the same and compare the changed files or is there a better way?
5318	area-signalr	How do I test my signalr service	How do I test the signalr service load。How the client perceives the link state
4898	area-mvc	Add additional configuration sources for the WebHostBuilder in the WebApplicationFactory	#### Is this a Bug or Feature request?:Feature request.#### Description of the problem:There are some situations where users have manifested the desire to configure some aspects of the app for testing purposes through environment variables and other mechanisms.We normally recommend overriding ConfigureWebHostBuilder to do these types of changes, but there are a couple of opinions that the WebApplicationFactory makes about what environment the app is using and where the content root is found from.In both cases, these pieces of data are defined statically in code. * In the default setup of the WebApplicationFactory for the environment the tests run on.* In the WebApplicationFactoryContentRoot attributes for the content roots of the app.I've discussed this with a bunch of people and we want to switch to a system based on config to allow these things to be configured based on the environment. This way, these settings that the factory needs to correctly boot up the project can be defined when the tests are going to run in addition to at compile time without users customizing the factory.#### Proposed changes* Add an additional step to WebApplicationFactory to add additional configuration sources to the webhostbuilder we create.* Switch from custom implementations for determining the content root and the environment to run on to use config.* Provide three additional configuration sources in the appropriate order:  * Static config source. Maps our attributes to config keys and defaults the environment to "Development"* Environment variables provider. Maps environment variables with a prefix ASPNETCOREINTEGRATIONTEST* Optional json file appSettings.integrationtests.json to allow these things to be specified on a json file.Any new customization that needs to be added for testing purposes will be done this way.
4739	area-servers	Add connection handshake perf scenario	One scenario that's not covered today is the cost of creating new connections, especially over TLS. This will be even more relevant for Http/2 where Tls is defacto and there's also a settings handshake.
5803	area-identity	Why are the `DbSet`s in `IdentityUserContext` non-virtual?	In ASP.NET Core 2.x the `DbSet`s defined in the abstract classes `IdentityDbContext` and `IdentityUserContext` are all non-virtual making it much harder to effectively mock my database context that is built on them. It looks like they were virtual in ASP.NET Core 1.x, although the library was arranged differently then, so I am not 100% sure on that. Is there a reason that they cannot just be made virtual to facilitate unit testing? I really don't like having to resort to something drastic like Fakes when I could just use Moq etc.If there is a reason they can't be made virtual I would really appreciate it if any one has any ideas on how  I can proceed with mocking my db context that implements `IdentityDbContext`! 
5802	area-identity	Feature Request—Consider providing ACL in ASP.NET Core Identity	To get some context about the request, see the issue https://github.com/aspnet/Identity/issues/1859## Consider providing ACL in IdentityWell as in the title: consider providing ACL in ASP.NET Core though Identity.### Some arguments- ACL is not something too much complex for enterprise level app… - What Identity provides today, **about group management**, is out to date (again see the issue [1859](https://github.com/aspnet/Identity/issues/1859))…- Other frameworks oriented **enterprise level app/webapp**, provide, out of the box, ACL support. (See, Zend frameworks, Joomla, etc…)    - **With all due respect, In comparison, Identity looks like a back to the Past…(there is simply no ACL support at all)**- Nothing prevents to suggest some improvements, **[or do not mention community involvement](https://www.asp.net/open-source)**…- You should "write" [for customers, **not for simplicity sake**, nor without listening customers](https://github.com/aspnet/Identity/issues/1859#issuecomment-403067317)… And I used to think that ASP.NET Core was for writing enterprise level app, not to write simple blog CMS, **with simplistic group support**…- it will not cost so much for you, to add ACL support.### DesignIt will be simple to integrate some ACL support to Identity, without breaking anything (simply by adding few line of codes, again, take a look at [1859](https://github.com/aspnet/Identity/issues/1859)).For the sake of demonstration:- Add an Acl table like `IdentityAcl`- Add a many-to-many relationship table between `IdentityRoles` and `IdentityAcl`;- Add to `ClaimsIdentity` and `ClaimsPrincipal` … the adequat properties (to avoid having recourse to `Scope` and `IdentityDbContext` for `AuthorizationHandler`)…- Good doc…### Some thoughtsWe do not ask you to write for us our apps, but to provide us with a good, up to date, and real world use framework (**like other frameworks in the market**).
3304	area-servers	IFormFile bug	_From @cristian1975 on July 5, 2018 9:21_If you upload a excel file to a web api endpoint,  IFormFile object type from Request.Form.Files collection  has bigger size than the original excel file and if you try to open the uploaded file from the upload folder is in incorrect format. The method to upload a file is taken from .net core 2.1 documentation site:```c#           using (var stream = new FileStream(filePath, FileMode.Create))            {                await formFile.CopyToAsync(stream);            }```where fromFile is IFormFile type.This bug is happen from .net core version 2.0.6 and above._Copied from original issue: dotnet/corefx#30842_
3303	area-mvc	ExceptionHandlerMiddleware log message too generic	_From @kanadaj on July 6, 2018 20:43_Using ASP.NET Core 2.1.1, the error message logged by the ExceptionHandlerMiddleware is far too generic.It really feels like the default handler should either use `Exception.Message` or the type of the `Exception` as part of the logged message for the sake of being able to identify at least the exception type from the log message.![image](https://user-images.githubusercontent.com/3247357/42399367-70c9f1a8-8165-11e8-8313-dab6c178cf1a.png)_Copied from original issue: aspnet/Mvc#8025_
4740	area-servers	Convert Write100ContinueAsync to sync	IHttpOutputProducer.Write100ContinueAsync is only ever called synchronously from HttpProtocol.ProduceContinue. It can and should be reimplemented synchronously.https://github.com/aspnet/KestrelHttpServer/blob/2191327b59f87f23f69fff2ac0dba9e58b67141b/src/Kestrel.Core/Internal/Http/HttpProtocol.cs#L969
5930	area-hosting	Deadlock when calling System.Environment.Exit(int exitCode) during Startup.Configure(..)	In some situations my web application requires to immediately quit during start-up. When doing so via `System.Environment.Exit(int exitCode)`, the dotnet process does not exit.Minimal set-up to reproduce:```csharppublic static void Main(string[] args){    var host = new WebHostBuilder()        .UseKestrel()        .UseStartup<Startup>()        .Build();    host.Run();}``````csharppublic override void Configure(IApplicationBuilder app){	System.Environment.Exit(1);}```It seems that in this scenario `Set()` will no longer be called on the instance of ManualResetEventSlim passed to `AttachCtrlcSigtermShutdown(..)` resulting in the `Shutdown()` method to block indefinitely.https://github.com/aspnet/Hosting/blob/97c9510a95e676324ed8fa03d8b6dcf3b1c19ccf/src/Microsoft.AspNetCore.Hosting/WebHostExtensions.cs#L134-L162One possible solution could be applying the `WebHostOptions.ShutdownTimeout` when waiting for the manual reset event._System Info:_- dotnet core: 2.1- Microsoft.AspNetCore.Hosting: 2.1.1
5077	area-mvc	Token replacement in @page directive?	I'm trying to create a custom route for my Razor page, via the `@page` directive.When using the `RouteAttribute` on a controller, we have access to the following [token replacements](https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/routing?view=aspnetcore-2.1#token-replacement-in-route-templates-controller-action-area): > The tokens [action], [area], and [controller] will be replaced with the values of the action name, area name, and controller name from the action where the route is defined.However, such replacement doesn't seem to occur with the `@page` directive:`@page "/[area]/{name}"` doesn't work.Is there anything approaching this for Razor pages?__Background__I'm trying to migrate the following controller to Razor pages:```[Route("[controller]")]public class MyFeatureController : Controller{	[HttpGet("")]	public IActionResult Index()	{		return View();	}		[HttpGet("{name}")]	public IActionResult GetProduct(string name)	{		return View("Product", name);	}}```
5214	area-mvc	Question about implementi VueJs Cli integration	Hi,i would like to use vuejs cli with aspnet core projects.I tried to use UseAngularCliServer with vue command and it "almost" worked as is ! app.UseSpa(spa =>            {                spa.Options.SourcePath = "clientApp";                spa.UseAngularCliServer("serve");            });The only line i had to change is this line, what do you think ? Would you accept a pull request for this feature ? Since i just had to change a line, would you like to configure it ? but then the whole api would not reflect the support for vue, so maybe maybe refactor it out is a better choice (CliBuilder/CliMiddleware and AngularCliMiddlewareExtension, VueJsCliMiddlewareExtension)![image](https://user-images.githubusercontent.com/1522516/42328511-bb2b6ee0-806e-11e8-8ad1-3130c3adb1cf.png)
5213	area-mvc	Can't run sample app "Webpack"	### Can't run sample app with hot reloading* ### Functional impactApp runs but all requests to http://localhost:5000/__webpack_hmr are 404s### Minimal repro steps1. Clone this repo2. Open sample app "WebPack"3. Change target framework to netcoreapp2.1 as 2.2 isn't installed4. Build, run the app5. Check the network traffic/console - see that requests are failing### Expected resultHMR requests work### Actual resultPeriodic requests to the __webpack_hmr page fail### Further technical detailsλ dotnet --version2.1.300λ node --versionv8.9.0λ npm --version5.5.1
5212	area-mvc	Angular: Prerendering does not work when app is published on server, does not display HTML tags on ViewSource page. On Local host It is working fine	I have create the application with [ASP.NET Core X Angular] (14) - Server side rendering for SEO. All is working fine when publishing on local host but when I published on Server it is not working, It doesn't display HTML tags on view source.Hope anyone find anything which can be helpful to me.ThanksMilan.
5316	area-signalr	Additional streaming parameter types	Currently the user can pass in `ChannelReader<T>`.Want to expand this to accept the `Stream` class, possible the new `Pipeline` class, etc. Make a common pattern for adding on additional types, maybe somehow tied to `IEnumerableAsync`.
5315	area-signalr	StreamItem InvocationId cleanup	Previously, stream items were returned from the server in response to an invocation, and so carried an invocation id for routing purposes.Now, stream items can be sent to the server, and are sorted based on stream id.  Regardless of direction, all id values are stored under the `InvocationId` field on `StreamItem`. This is poor naming and rather misleading.Possible solutions include:- StreamItem has two fields, `StreamId` and `InvocationId`, only one of which can be filled at a time- StreamItem has one field, `RoutingId`, which is used both ways. This breaks backwards compatibility.- Make a new class `StreamParameterItem` that's identical to stream item but has a `StreamId` field instead.None of these solutions feels very clean.
5314	area-signalr	@aspnet/signalr - make connection id available	I have a reactive angular app where its services contain observables to allow components to react to certain events. i.e. saving a form will cause the adjacent index component to reload. This all works reasonably well, until I have added SignalR into the mix to broadcast these same events between clients. Essentially the same services/observables used to perform the intra-client events are now emitting events when the socket receives the respective event too. The problem i now have is that the components receive two events per action, one raised internally when the http request completes (client service -> obserable -> component), and the other from the socket (controller -> hubcontext -> client hubconnection -> client service -> observable -> component).I need both event sources as I don't want to rely on the socket to perform intra-app communication and it also provides a consistent way, from the subscribing components perspective, to get events.Ideally I would like to ignore the client who sent the http from getting the signalr message so dont have to do any hacky buffering and grouping on the client app. A good solution would be to include the signalr connection id as a header in the http request which i could then use to filter hubcontext clients.In the meantime, accessing the connection id via sending an initial message to the client will suffice. Seems odd that the connection id is unavailable client-side. Using groups only works in certain situations.Appreciate any feedback.
5076	area-mvc	Generated code references MVC's HelperResult	**Description:**I want to use Razor as a standalone templating component (outside of ASP.NET Core). This is working really well so far, with one minor problem: when an HTML attribute contains Razor code, the generated code references `Microsoft.AspNetCore.Mvc.Razor.HelperResult` by default. The source of this reference is in the default value of `Microsoft.AspNetCore.Razor.Language.CodeGeneration.RuntimeNodeWriter.TemplateTypeName`.I would like to change this to my own template type, but there seems to be no straightforward way to accomplish this (e.g. with the `RazorProjectEngineBuilder`). Right now I have a rather clumsy workaround involving a custom `IRazorEnginePhase` that sets a custom `CodeTarget` on the `DocumentIntermediateNode`, which in turn sets the desired template type in `CreateNodeWriter`.I propose to set the default value of `RuntimeNodeWriter.TemplateTypeName` to something neutral like `"Template"` (like in #952, a similar issue with `TemplateTargetExtension`) and allow some mechanism for easy customization.**Steps to reproduce:*** Create a .NET console app* Reference Microsoft.AspNetCore.Razor.Language 2.1.1* Add this code to `Program.cs`    ```csharp    using System;    using Microsoft.AspNetCore.Razor.Language;    namespace RazorStandalone    {        public class Program        {            public static void Main(string[] args)            {                var razorEngine = RazorProjectEngine.Create(                    RazorConfiguration.Default,                    RazorProjectFileSystem.Create("Views"));                var item = razorEngine.FileSystem.GetItem("Test.cshtml");                var cSharpDocument = razorEngine.Process(item).GetCSharpDocument();                Console.WriteLine(cSharpDocument.GeneratedCode);            }        }    }    ```* Add `Views/Test.cshtml`, set "Copy to Output Directory" to "Copy if newer"    ```html    <test attr="@if (@Model) {}"></test>    ```* Run the program. The output reads:    ```    #pragma checksum "C:\Users\reima\Documents\Visual Studio 2017\Projects\RazorStandalone\bin\Debug\Views\Test.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "9734701e05be2ab9082d029532e0b68293680ed2"    // <auto-generated/>    #pragma warning disable 1591    [assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(Razor.Template), @"default", @"/rs/reima/Documents/Visual Studio 2017/Projects/RazorStandalone/bin/Debug/Views/Test.cshtml")]    namespace Razor    {        #line hidden        [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"9734701e05be2ab9082d029532e0b68293680ed2", @"/rs/reima/Documents/Visual Studio 2017/Projects/RazorStandalone/bin/Debug/Views/Test.cshtml")]        public class Template        {            #pragma warning disable 1998            public async override global::System.Threading.Tasks.Task ExecuteAsync()            {                WriteLiteral("<test");                BeginWriteAttribute("attr", " attr=\"", 5, "\"", 27, 1);                WriteAttributeValue("", 12, new Microsoft.AspNetCore.Mvc.Razor.HelperResult(async(__razor_attribute_value_writer) => {                    PushWriter(__razor_attribute_value_writer);    #line 1 "C:\Users\reima\Documents\Visual Studio 2017\Projects\RazorStandalone\bin\Debug\Views\Test.cshtml"                 if (@Model) {}    #line default    #line hidden                    PopWriter();                }                ), 12, 15, false);                EndWriteAttribute();                WriteLiteral("></test>");            }            #pragma warning restore 1998        }    }    #pragma warning restore 1591    ```
5545	area-mvc	Enable control over event propagation and default actions	There are lots of scenarios where this is needed. See descriptions in #715.Since we don't want to rely on synchronous APIs, the solution will probably be a variation on event registration syntax, e.g.,    <button onclick=@MyHandler onclick-stop-propagation="true" />We still need to design what terminology to use (e.g., "propagation" vs "bubbling") and what features to include (e.g., whether there is also control over "preventDefault").
5211	area-mvc	minifying/webpack node_modules for NodeServices	Hi,I have a dotnet core Web Api that makes use of NodeServices. To deploy this to a local IIS site during the build I do `npm install` and then copy the `node_modules` folder into the publish folder.This is now taking ~25 mins to build due to the size of node_modules and the number of files within.I've had a look at the samples but can't see anything related to server side use. The examples are usually webpack'd and then the output file is referenced in the client HTML but in my case there is no client, just server side. Is it possible to webpack or minify this? Also it's obviously looking at the node_modules folder for it's references, if this was minified can I tell it to look at a different folder?
5801	area-identity	Make ExternalLoginsPageFilter accessible	Scaffold identity, but want to remove the "Identity" area folder. Have to add Razor page options to new area. Would be nice if we didn't have to duplicate ExternalLoginsPageFilter because its internal to UI. If we're scaffolding identity, one can assume we'd want this filter, too.
5424	area-mvc	Add checks of JS dependencies as part of the build	We should write a quick script to test our JS dependencies for vulnerabilities and add it to the build for templating. Checking for vulnerabilities is as simple as running "npm audit", but sometimes there are packages without a fix available, or the vulnerability is the dependency of say, Angular. Where possible we should remove dependencies that aren't patching in a timely manner, but that's not always feasible, so we'll likely need an exclusion system (which still sucks in case they do eventually update).
4741	area-servers	Libuv.Internal.Networking.UvException: Error -4095 EOF end of file 	The following exception is being logged by Kestrel when performing HTTP requests to our application hosted in an Azure Web App. All requests were returning 400 HTTP status. The service was running without any problem from quite a while but all of sudden throwing 400 status and after restarting it all resolved. Do we have anywhere the description of error code published (4095)? Version: 2.0.8```StackTrace:Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.UvException: Error -4095 EOF end of file   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.Networking.LibuvFunctions.ThrowError(Int32 statusCode)   at Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.Internal.ListenerPrimary.PipeReadContext.ReadCallback(UvStreamHandle dispatchPipe, Int32 status)fail: Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv[0]      ListenerPrimary.ReadCallback```
5313	area-signalr	Investigate redis streams for the backplane implementation	Investigate redis streams https://redis.io/topics/streams-intro as a backplane. Support coming in SS.Redis: https://github.com/StackExchange/StackExchange.Redis/pull/860
5210	area-mvc	Debug performance terrible	I am currently debugging a reasonably substantial and complex angular-cli application in the dot net core environment on a corporate Windows 7 desktop. I have Visual Studio 2017 Professional 15.7.4 installed. I used the latest JavaSciptServices Angular template, and upgraded it to Angular 6. I run my application and my first run at this took about 40 seconds for an application to update after a change (hot module replacement, IIS Express). So I thought that's no good, and looked up lots of docs and found I could bypass the local server and use node, using the following document: [Use the Angular project template with ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/client-side/spa/angular?view=aspnetcore-2.1&tabs=visual-studio#run-ng-serve-independently) Essentially, I have overridden the `spa.UseAngularCliServer(npmScript: "start")` statement and execute `spa.UseProxyToSpaDevelopmentServer("http://localhost:4200");` instead and on the command line in the ClientApp folder, I execute `npm start`, which proxies the dev server to node. This is supposed to speed things up, and while the compilation itself seems a lot faster, it seems to take forever to download the script files to the browser client. I do have plenty of modules, probably about 15. Many of these modules seem to get stuck downloading.  Chrome says they are pending, and sometimes they arrive, but sometimes they don't. This is the latest version of Chrome. We also have access to IE11 and FireFox, but Chrome is the debugger of choice because it is the only one guaranteed to be up to date.I'm pretty sure things shouldn't be this slow, with the app getting caught on downloading module scripts. I am using configuration provided in the new angular.json file.```"configurations": {            "production": {              "fileReplacements": [                {                  "replace": "src/environments/environment.ts",                  "with": "src/environments/environment.prod.ts"                }              ],              "optimization": true,              "outputHashing": "all",              "sourceMap": false,              "extractCss": true,              "namedChunks": false,              "aot": true,              "extractLicenses": true,              "vendorChunk": false,              "buildOptimizer": true            }          }```Any ideas what I might be doing wrong?
5544	area-mvc	Firing onchange before painting on input	Hello everyone,I have an input that I need that the user only writes in upper case.I tried to do the following:```<input value="@Name" onchange="@ChangeName" />``````void ChangeName(UIChangeEventArgs e){    var value = (string)e.Value;    Name = value.ToUpper();}```The result:The user writes in lowercase and when the user left focus, then the content transform to upper.I tried too a hardcode value of Name property and left ChangeName method in blank like this:```<input class="form-control" value="@Name"/>``````string Name = "Foo";void ChangeName(UIChangeEventArgs e){    // } ```I expected the original value of input return to "Foo", but when I leave the focus, the changed value stayed in the input.Is possible make the value of input doesn't change if the value of `value` property doesn't change even if user type letters? (like `readonly` property)Is possible to fire the onchange method before painting the input value to get in the input the value directly transformed while writing instead on lose focus? (like ReactJS)
3797	area-servers	Incorrect whitespace in IIS Express applicationhost.config after running ANCM IIS Express MSIs	It appears the ANCM IIS Express MSIs generate incorrect whitespace when modifying `applicationhost.config`.# Repro Steps1. Install IIS Express but not ANCM MSIs```<sectionGroup name="system.webServer">    ...    <section name="webSocket" overrideModeDefault="Deny" /></sectionGroup>```2. Install ANCM MSIs## Actual```<sectionGroup name="system.webServer">    ...    <section name="webSocket" overrideModeDefault="Deny" /><section name="aspNetCore" overrideModeDefault="Allow" /></sectionGroup>```## Expected```<sectionGroup name="system.webServer">    ...    <section name="webSocket" overrideModeDefault="Deny" />    <section name="aspNetCore" overrideModeDefault="Allow" /></sectionGroup>```
5312	area-signalr	[3.0.0] Breaking Change Tracking	This issue is to track breaking changes implemented or planned for 3.0 to ensure they get announced properly* [ ] Minor Version property added to `IHubProtocol`
5209	area-mvc	Clash between server and client side routing for serving of js files and images	I'm having an issue where my Angular app, hosted by ASP.NET Core MVC, isn't serving images and files like vendor.js, with a `Failed to load resource: the server responded with a status of 404 (Not Found)` error.I'm using an Angular app template called ngx-admin, and it has an option to prepend the app's routing with /#/ (so the full url would be `https://localhost:5001/#/pages/dashboard`). With this enabled everything works fine, and the images are served from the angular app /assets/ folder as expected; however because I can't use fragments (#) in a callback URL for Azure AD B2C authentication that I'm currently setting up, I can't use this hash option. I think the issue is that without the hash, the server side routing is clashing with the client side routing, and it's looking for images and scripts in `wwwroot` instead of the Angular application. How can I go about changing the routing so there aren't any clashes? Would really appreciate any help here (happy to share code examples etc.)Thanks in advance!
5543	area-mvc	CultureInfo didn't set appropriately	In a Blazor cshtml, add "@CultureInfo.CurrentCulture.DisplayName", and then get "Invariant Language (Invariant Country)" while I expect "中文(简体，中国)". DateTime.Now is not correct also.
5423	area-mvc	Is there any guide how to enable SSR for Angular6 template?	Is there any guide how to enable SSR for Angular6 template?
3817	area-servers	Backend fails to start if you try to connect to physical path with a custom identity	_From @shirhatti on September 20, 2017 23:32_Fails to start backend process on UNC path even though the worker process has the access permission for the UNC![image](https://user-images.githubusercontent.com/4734691/30672432-fc7057be-9e31-11e7-8e98-5bdf3ccc3168.png)_Copied from original issue: aspnet/AspNetCoreModule#162_
5208	area-mvc	Base class for ReactDevelopmentServerMiddleware and AngularCliMiddleware	Some time ago I created `VueDevelopmentServerMiddleware` based on `ReactDevelopmentServerMiddleware`.Actually difference between my vue middleware and react middleware is regexp to find out "is dev server started". But I copied to many util classes in my project.I think that this is a good idea to provide public abstract base classes for creating own middlewares that based on running npm script.Will such pull request be accepted?
5207	area-mvc	Remove CRA dependence of ReactDevelopmentServerMiddleware	At the moment, the `ReactDevelopmentServerMiddleware` just works with apps bootstrapped by create-react-app, since in [ReactDevelopmentServerMiddleware.cs#L87](https://github.com/aspnet/JavaScriptServices/blob/cf659b3fda367619f3873bd5f0e445698cebe340/src/Microsoft.AspNetCore.SpaServices.Extensions/ReactDevelopmentServer/ReactDevelopmentServerMiddleware.cs#L87) it waits for a specific text output "Starting the development server".Custom react/webpack dev server apps work, as soon as one adds a `console.log('Starting the development server');`. I wonder if there would be another solution possible (or at least adding a parameter which skips this check and assumes, that the server is ready as soon as we start it)?
4101	area-tooling	How to set a secret to null or "" using dotnet user-secrets?	Here's my use case: I'm trying to override [`Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerOptions.Authority`](https://docs.microsoft.com/en-us/dotnet/api/microsoft.aspnetcore.authentication.jwtbearer.jwtbeareroptions.authority?view=aspnetcore-2.1#Microsoft_AspNetCore_Authentication_JwtBearer_JwtBearerOptions_Authority) with either `null` or empty string `""` to disable the authority during development time. Next I would set [`Microsoft.IdentityModel.Tokens.TokenValidationParameters.IssuerSigningKey`](https://docs.microsoft.com/en-us/dotnet/api/microsoft.identitymodel.tokens.tokenvalidationparameters.issuersigningkey?view=aspnetcore-2.1#Microsoft_IdentityModel_Tokens_TokenValidationParameters_IssuerSigningKey) (hey, missing docs) to a symmetric key and use a JWT signed by that with my rest client.However when documenting this procedure, I ran in to a issue with `dotnet user-secrets` that it does not accept eg. `--null`, `""`, `''` as the value parameter. As a workaround in this case I can use `" "` and it'll work, because I'm checking the authority with `string.IsNullOrWhiteSpace`. Someone else might not have this option. Can we draft how this should work?Directly editing `$env:APPDATA\Microsoft\UserSecrets\x\secret.json` works perfectly.
5206	area-mvc	Incorrect Markup Tag	in: JavaScriptServices/samples/misc/NodeServicesExamples/Views/Home/Prerendering.cshtmlLine 7 has a closing tag where an opening tag should be
5311	area-signalr	Test concurrent connection limit on different Azure VM sizes	Collect connection count, CPU %, Memory UsageMachine Sizes:- [ ] B1s (4,900 connections, 1GB RAM limiting factor, CPU ~10%) Specs: 1GB RAM, 1 CPU- [ ] B2s (82,000 connections, CPU and RAM basically 100%) Specs: 4 GB RAM, 2 CPU- [ ] D2s_v3 (110,000 connections, CPU 100%, RAM 80%) Specs: 8 GB RAM, 2 CPU- [ ] D4s_v3 (160,000 connections, CPU 100%, RAM 50%, connections started disconnecting) Specs: 16 GB RAM, 4 CPU- [ ] D8s_v3 Specs: 32 GB RAM, 8 CPU- [ ] D16s_v3 Specs: 64 GB RAM, 16 CPU- [ ] D32s_v3 Specs: 128 GB RAM, 32 CPU- [ ] D64s_v3 Specs: 256 GB RAM, 64 CPUNote: Test Linux vs. Windows VMs to see if there is a difference
5075	area-mvc	ASP.NET Core tag helpers don't allow me to escape attributes annotated with @	Hello guys.While migrating an existing app, I've noticed that the new tag helpers won't let me escape attributes annotated with  @. In my case, I have an existing MVC 5 app that I'm migrating to the ASP.NET Core. The existing code looked like this:```html<form action="@Url.Action(...)" @@submit="save()">```The server side is trying to use the shortcut notation for Vue's v-on: and the generated HTML looked like this:```html<form action="/..." @submit="save()">```When this view got migrated to ASP.NET Core, the code was changed to look like this:```html<form asp-action="..." asp-controller="..." @@submit="save()">```However, now the @«submit attribute isn't outputted (it's simply discarded from the generated HTML).Is this a bug? If that is not the case, how can I output attributes annotated with @? @Thanks.Luis
6012	area-middleware	Support for request de-compression	https://tools.ietf.org/html/rfc7694Advertise Accept-Encoding on some responses (by content-type?). This is similar to Accept-Ranges where the client is allowed to use it if it has seen it advertised in the past.Automatically decompress if encoded.This is functionally symmetric with response compression.What clients support this?
5205	area-mvc	HotModuleReplacement requires config to resolve `.js` extensions	Whilst attempting to experiment with how HMR works when enabling using `HotModuleReplacement = true`  I encountered the following console error at runtime:```Uncaught Error: Cannot find module 'webpack-hot-middleware/client?path=__webpack_hmr&dynamicPublicPath=true'    at webpackMissingModule (client:1)    at eval (client:1)    at Object.0 (main.bundle.js:813)    at __webpack_require__ (main.bundle.js:722)    at main.bundle.js:789    at main.bundle.js:792```This was due to my `webpack.config.ts` containing:``` resolve: { extensions: ['.ts'] },````Instead of``` resolve: { extensions: ['.js', '.ts'] },````I figured that my application was only going to be written in TypeScript and therefore I could omit `'.js'`. However I now realise that the HotModuleReplacement results in the modification of entry points to add the `webpackHotMiddlewareEntryPoint` which is a js file.What are your thoughts on adding a check to error if `.js` is not contained within the extensions array or alternatively force adding it to the end of the array?At very least I'm happy to have documented this for anyone else who may experience this 'issue'. I searched online only to find those who encountered the error [never shared the fix](https://github.com/aspnet/JavaScriptServices/issues/628#issuecomment-276346359) 🤦‍♂️ 
5542	area-mvc	Route precedence 	I have an app with two routes:`@page "/{multiple}/catalog/new"``@page "/{multiple}/catalog/{catalogId}"`When accessing the /{multiple}/catalog/new URL, the router seems to be taking me to the /{multiple}/catalog/{catalogId} route. This used to work the other way around for me. Is this a bug, or am I doing something wrong?This is on Blazor 0.5.0-preview1
5204	area-mvc	Node.js processes don't quit after stopping debugging	Please refer to https://github.com/OmniSharp/omnisharp-vscode/issues/2387 for details.If there has been a fix, let me know how.
5203	area-mvc	DefaultSpaStaticFileProvider should allow RootPath to be absolute or relative	**Issue**Currently the `RootPath` that is specified in `SpaStaticFilesOptions` must be relative to the environment's `ContentRootPath`. This means you must keep your SPA source files under the containing project.It is currently a silent failure if someone were to pass in an absolute path.```services.AddSpaStaticFiles(configuration =>{    configuration.RootPath = "ClientApp/dist";})```**Requested feature**`RootPath` should be able to be an absolute path. This would allow me to keep my SPA files outside of my 'bootstrapping' project. It would also reduce confusion if somebody tries to pass in a root path - which currently will be ignored.```services.AddSpaStaticFiles(configuration =>{    configuration.RootPath = @"d:\SharedAngularStuff\AngularProject1";})```Currently doing this will fail because [`DefaultSpaStaticFileProvider.cs`](https://github.com/aspnet/JavaScriptServices/blob/30333e250abbfa8ce45cdcdb5b575f0397403a05/src/Microsoft.AspNetCore.SpaServices.Extensions/StaticFiles/DefaultSpaStaticFileProvider.cs) just uses `Path.Combine` to construct the absolute root path.There also doesn't seem to be a way to pass in an alternative FileProvider.**Complexity of fix**Very simple:```var absoluteRootPath = Path.IsFullyQualified(options.RootPath) ? options.RootPath : Path.Combine(                env.ContentRootPath,                options.RootPath);```Must use `IsFullyQualified` and [not]((https://github.com/dotnet/corefx/issues/22345)) `IsPathRooted`.(This would only apply to people who modify the .csproj file to change the source 
4742	area-servers	Use Huffman code in HPackEncoder	Currently we are using a direct encoding when we encode headers. We can optimize by using Huffman code: https://tools.ietf.org/html/rfc7541#section-2.4. Related work:- Static compression #2950- Dynamic compression #2951
5202	area-mvc	SSR Publishing - Unable to copy file node_modules\.cache\uglifyjs-webpack-plugin\content-v2\sha512...	Hi, When attempting to publish (to folder) the SSR version of the Angular Template it fails trying to copy dev deps over with the error:> Severity	Code	Description	Project	File	Line	Suppression State> Error		Unable to copy file "G:\users\markp\source\repos\cbl-5ssr\MergateCottage\ClientApp\node_modules\.cache\uglifyjs-webpack-plugin\content-v2\sha512\94\0b\d3cf31226e585196aa96c3622c8466b425df3355dd7a7cfde2f6b2fd035eac22af113377667b301007c33ff35cbf2e53176bf339b369ffd3931dec2e1dff" to "G:\users\markp\source\repos\cbl-5ssr\MergateCottage\obj\Release\netcoreapp2.1\PubTmp\Out\ClientApp\node_modules\.cache\uglifyjs-webpack-plugin\content-v2\sha512\94\0b\d3cf31226e585196aa96c3622c8466b425df3355dd7a7cfde2f6b2fd035eac22af113377667b301007c33ff35cbf2e53176bf339b369ffd3931dec2e1dff". The specified path, file name, or both are too long. The fully qualified file name must be less than 260 characters, and the directory name must be less than 248 characters.	MergateCottage		0	>  Even when I changed the target location to the root of my drive.  I remember reading that when publishing this template using ssr it VS trys to copy the whole node_modules folder, but I didn't expect it to not work at all. Here's my package.json:```{  "name": "MergateCottage",  "version": "0.0.0",  "license": "MIT",  "scripts": {    "ng": "ng",    "start": "ng serve --extract-css",    "build": "ng build --extract-css --aot",    "build:ssr": "npm run build -- --app=ssr --output-hashing=media",    "test": "ng test",    "lint": "ng lint",    "e2e": "ng e2e"  },  "private": true,  "dependencies": {    "@angular/animations": "^5.2.9",    "@angular/common": "^5.2.9",    "@angular/compiler": "^5.2.9",    "@angular/core": "^5.2.9",    "@angular/forms": "^5.2.9",    "@angular/http": "^5.2.9",    "@angular/platform-browser": "^5.2.9",    "@angular/platform-browser-dynamic": "^5.2.9",    "@angular/platform-server": "^5.2.9",    "@angular/router": "^5.2.9",    "@nguniversal/aspnetcore-engine": "^6.0.0",    "@nguniversal/common": "^6.0.0",    "@nguniversal/module-map-ngfactory-loader": "^5.0.0-beta.5",    "angular-bootstrap-md": "^6.1.3",    "angular-oauth2-oidc": "^4.0.2",    "aspnet-prerendering": "^3.0.1",    "bootstrap": "^4.1.1",    "chart.js": "^2.7.2",    "core-js": "^2.4.1",    "font-awesome": "^4.7.0",    "hammerjs": "^2.0.8",    "ng-recaptcha": "^3.0.3",    "primeicons": "^1.0.0-beta.8",    "primeng": "^6.0.0-rc.1",    "rxjs": "^5.5.6",    "smart-buffer": "^4.0.1",    "source-map": "^0.7.3",    "zone.js": "^0.8.19"  },  "devDependencies": {    "@angular/cli": "~1.7.0",    "@angular/compiler-cli": "^5.2.9",    "@angular/language-service": "^5.2.9",    "@types/jasmine": "~2.8.3",    "@types/jasminewd2": "~2.0.2",    "@types/node": "~6.0.60",    "codelyzer": "^4.0.1",    "jasmine-core": "~2.8.0",    "jasmine-spec-reporter": "~4.2.1",    "karma": "~2.0.0",    "karma-chrome-launcher": "~2.2.0",    "karma-coverage-istanbul-reporter": "^1.2.1",    "karma-jasmine": "~1.1.0",    "karma-jasmine-html-reporter": "^0.2.2",    "protractor": "~5.1.2",    "ts-node": "~4.1.0",    "tslint": "~5.9.1",    "typescript": "~2.5.3"  },  "optionalDependencies": {    "node-sass": "^4.9.0"  }}```Are there any work arounds?
4897	area-mvc	AsyncValidationAttribute	As others have said #786, #7791, I think adding AsyncValidationAttribute would be beneficial.This feature would allow doing non blocking validation logic in the attributes which are highly composable and reusable.Thanks
5310	area-signalr	Is there any client implementation for use with flutter ?	Hi guys I dont know if here is the right place to ask this, but I`ve looked for it and doesnt find any client implementation for dart with flutter anywhere, do you guys has any tips on how to do it ?
3830	area-servers	Investigation: Impersonation issue for inprocess to access  app folder	IIS allows user to specific user name and password to access the application folder. Worker process will impersonate the configured user when access files in the application folder. This impersonation is not a big issue for out process as user must grant worker process access permission to the application folder due to the fact of Kestrel child process. For in-process, we need verify, whether there is any issue for such scenario.    
4743	area-servers	Replace locking with EventLoop for response framing	Edit: This is needed for stream prioritization. (When we do it.)
5800	area-identity	Wrong media type	The JSON file to download is served with the file type `text/json`. The proper media type is `application/json`.https://github.com/aspnet/Identity/blob/release/2.1/src/UI/Areas/Identity/Pages/Account/Manage/DownloadPersonalData.cshtml.cs#L70Since it sets the "Content-Disposition" to "attachment" perhaps `JsonResult` could be used instead of `FileContentResult`, else perhaps there is an overload to specify it to be served as an attachment with a filename.
5201	area-mvc	No connection could be made because the target machine actively refused it 	Running a VueJs app using Webpack middleware (Microsoft.AspNetCore.SpaServices 2.1.1) with hot reloading after a period of time it appears the node dev server falls over and a restart of the app is required. We start getting exceptions to anything that would be proxied, so HMR requests and assets under the public path:````System.Net.Http.HttpRequestException: An error occurred while sending the request. ---> System.Net.WebException: Unable to connect to the remote server ---> System.Net.Sockets.SocketException: No connection could be made because the target machine actively refused it 127.0.0.1:55139   at System.Net.Sockets.Socket.InternalEndConnect(IAsyncResult asyncResult)   at System.Net.Sockets.Socket.EndConnect(IAsyncResult asyncResult)   at System.Net.ServicePoint.ConnectSocketInternal(Boolean connectFailure, Socket s4, Socket s6, Socket& socket, IPAddress&address, ConnectSocketState state, IAsyncResult asyncResult, Exception& exception)   --- End of inner exception stack trace ---   at System.Net.HttpWebRequest.EndGetResponse(IAsyncResult asyncResult)   at System.Net.Http.HttpClientHandler.GetResponseCallback(IAsyncResult ar)   --- End of inner exception stack trace ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Net.Http.HttpClient.<FinishSendAsyncUnbuffered>d__59.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at Microsoft.AspNetCore.SpaServices.Webpack.ConditionalProxyMiddleware.<PerformProxyRequest>d__8.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.SpaServices.Webpack.ConditionalProxyMiddleware.<Invoke>d__7.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.SpaServices.Webpack.ConditionalProxyMiddleware.<Invoke>d__7.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.<Invoke>d__7.MoveNext()````
4744	area-servers	Support HTTP/2 response headers with END_STREAM, no body	If the response completes without a body there's no reason to send a data frame. Flush the headers with an End_Stream flag.
4896	area-mvc	Add client code generation from OpenAPI documents	#### Is this a Bug or Feature request?:Feature request#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):See comments in aspnet/specs#159 and aspnet/specs#161 about client code generation for services described using OpenAPI. The most specific comments are in the **API client generation (C# & TypeScript)** section of aspnet/specs#161#### Description of the problem:With a focus on MSBuild integration, build one or more wrappers for tools that can generate client code for a service described using OpenAPI. This includes:- OpenAPI document available at a URI- OpenAPI document available in a file on disk  - This may be treated as a derivative case of URIs. Could also require some special-casing. For example, though not required initially, we may eventually want to refresh clients in a running application when the OpenAPI document changes i.e. file watching / cache flushes similar to how we handle .cshtml file changes at runtime.- Project-to-project references that indicate the "other" project can provide an OpenAPI document  - Most general case i.e. something independent of _how_ that document is produced may be a way to start a project, use a described URI to download the OpenAPI document, then generate a client for that document.  - As mentioned in aspnet/specs#161, an "inside man" approach may also be useful when tighter integration with whatever generates the OpenAPI document may be helpful.#### Code generation itselfTo the extent possible, will outsource the exact OpenAPI to C# or TypeScript conversion. This interface is likely to be behind a small MSBuild `Task` that can be easily overridden or a set of properties that control the exact `Exec` task used to perform code generation.#### Inspirations to investigate- [x] https://github.com/aspnet/scaffolding  - Scaffolding provides a relatively simple approach for wrapping very different code generators into a common command-line UI. Though the lower (Razor-based) code generators are likely to be irrelevant, this high-level integration may provide an intuitive CLI for our users. Likely not needed until we're done providing MSBuild itegration.- [x] Add Service Reference  - What artifacts remain in the project after a service reference is added? Can we reuse some of these artifacts for generator-to-project and generator-to-URI integration?- [x] `<Compile>` and `<EmbeddedResource>` links  - Can we reuse some of these artifacts and their specific metadata for generator-to-project and generator-to-URI integration?  - If we decide to do something completely different on one side or the other, what inspiration can we take from the `<Compile>` and `<EmbeddedResource>` linkage approach
3792	area-servers	Turn HRs into error messages when logging to event log	It might give customers a bit more information to diagnose the issue.Use https://msdn.microsoft.com/en-us/library/ms679351%28v=vs.85%29.aspx
5200	area-mvc	Add create-react-app SSR template	It looks like the templates have moved to using create-react-app. This is great and makes things more standard.We still need server side rendering.I've been looking into this a little and there seems to be some libraries that claim to add SSR to a CRA project without ejecting. Here are a couple.https://github.com/antonybudianto/cra-universalhttps://github.com/smooth-code/loadable-componentsIt would be nice if there was an option when doing `dotnet new` to create a react/redux project that has SSR built in for ASPNET Core. `dotnet new reactreduxssr` or something like that.Not having SSR really makes CRA apps not usable for public websites.
4209	area-mvc	Handle optional extension in conventional route via dispatching	Imagine this conventional route: `"{controller}/{action}.{ext?}"`When calculating endpoints it is updated to: `"TestController/TestAction.{ext?}"`The updated template is a problem because the optional extension is following more than just a `.` literal.
5199	area-mvc	InvokeAsync<Task<Stream>> react streaming	Hello,I would like to use react **streaming** server side rendering.To do this I can't  wait for whole resposnse from `InvokeAsync<Task<Stream>>`does this library support this approach?My code is simple:```            Console.WriteLine(DateTime.Now + " start");            Task<Stream> task = nodeServices.InvokeAsync<Task<Stream>>("./async-react");```Adding on the bottom:`var stream = task.Result;`blocks response till streaming ends.Thanks for any help.
5309	area-signalr	Get Java client integrated into build process	* [x] Integrate into `build.cmd` with **automatic skipping when Java is not present** (#2678)  * I think we should try to **fail** the build if Java is not present when on the CI though to avoid accidentally forgetting to build it because we spun up a new agent and didn't install Java.  * Stretch goal: Acquire Java as part of the build (only on CI)* [x] Make sure VSTS and Jenkins agents have the necessary JDK installed* [x] Make sure TeamCity (if we're still using it by then ;)) has the necessary JDK installed.* [x] Integrate JAR signing into the build* [ ] Publish packages to a MyGet Maven feed as part of the build on the CI* [ ] Integrate GPG signing into build* [ ] Consider publishing packages to Maven Central Staging feed as part of build.
5198	area-mvc	Overload should inherit from previously configured DI options	Shouldnt the linked overload be retrieving the static file options from DI rather than "newing" an instance?https://github.com/aspnet/JavaScriptServices/blob/15d2f5a898da584433e38c82d5b09c375d9f87b7/src/Microsoft.AspNetCore.SpaServices.Extensions/StaticFiles/SpaStaticFilesExtensions.cs#L54
3835	area-servers	Process crash in hostpolicy.dll when throwing exception in main.	Repro steps:1. Run an inprocess application.2. In program main, add `throw new Exception();`3. Run the application.4. Send http request, receive response, but w3wp crashes in hostpolicy with the following stack trace.```c++ 	hostpolicy.dll!std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> >::assign(class std::basic_string<wchar_t,struct std::char_traits<wchar_t>,class std::allocator<wchar_t> > const &,unsigned __int64,unsigned __int64)	C++ 	hostpolicy.dll!breadcrumb_writer_t::write_callback(void)	C++ 	hostpolicy.dll!breadcrumb_writer_t::write_worker_callback(class breadcrumb_writer_t *)	C++ 	hostpolicy.dll!std::_LaunchPad<class std::unique_ptr<class std::tuple<void (*)(class breadcrumb_writer_t *),class breadcrumb_writer_t *>,struct std::default_delete<class std::tuple<void (*)(class breadcrumb_writer_t *),class breadcrumb_writer_t *> > > >::_Run(class std::_LaunchPad<class std::unique_ptr<class std::tuple<void (*)(class breadcrumb_writer_t *),class breadcrumb_writer_t *>,struct std::default_delete<class std::tuple<void (*)(class breadcrumb_writer_t *),class breadcrumb_writer_t *> > > > *)	C++>	hostpolicy.dll!std::_Pad::_Call_func(void *)	C++```
5888	area-servers	Windows Authentication	Hi , I have a REST API appilcation hosted on HTTP.Sys with windows authetication option enabled . The REST API is  protected by "Bearer" authentication scheme . Once the API invoked with invalid token the authentication scheme returns 401 with "WWW-Authenticate" "Bearer" header . Since application is hosted on  HTTP.Sys  the additional "WWW-Authenticate" "Negotiate" header has been added by  AuthenticationManager of Http.Sys .  The application uses windows authentication only in the user authentication endpoint . Is there a way to add windows authentication to specific route once hosted on http.sys ?
5197	area-mvc	__webpack_hmr is being requested in release/production build	This results in the following error printed out every 20 seconds in browser console. 20 seconds the timeout set in HMR.**EventSource's response has a MIME type ("text/html") that is not "text/event-stream". Aborting the connection.**My configure doesn't have anything funny for the production case:`if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();                app.UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions                {                    HotModuleReplacement = true                });            }            else            {                app.UseExceptionHandler("/Home/Error");            }`And I **don't** get any message saying "Angular is running in development mode. Call enableProductionMode()" so I am hoping production mode is turned on.My guess is, my configuration is still somewhere telling it's a debug env. In that case, I need to know what's the right way to set env mode.My setup is:- ASP.NET CORE 2.x, - Used Visual Studio 2017 Angular project template to create the project- Angular 6- "webpack": "4.11.0",    "webpack-command": "0.2.0",    "webpack-hot-middleware": "2.22.2",    "webpack-merge": "4.1.2"- Azure for production deployment- The publish GUI in visual studio to deploy/publish.
5196	area-mvc	EventSource's response has a MIME type ("text/html") that is not "text/event-stream". Aborting the connection.	I have looked at the existing threads on this. But my issue is happening on production mode, not development. So the > HotModuleReplacementEndpoint = "/dist/__webpack_hmr"Fix doesn't work for me.I am using ASP.NET Core 2, Angular 6, Webpack, Visual studio.
5195	area-mvc	Pre-populating redux state on the server	I noticed that the `reactredux` template includes a reference to server side rendering, but I can't find any guidance on how to actually fill that (idiomatically)```C#// Get the application-wide store instance, prepopulating with state from the server where available.const initialState = window.initialReduxState;const store = configureStore(history, initialState);```that `initialReduxState` is exactly what I want to pre-fill, but index.html that comes with the template is static
5308	area-signalr	How to get a .Net Core Framework SignalR Core client to connect to .Net Server (SignalR)?	I am working on ASP.NET Core2.1. I implemented a SignalR Core Client in asp.net core. I want to build the connection between SignalR Core Client and a SignalR Hub (i.e. AspNet.SignalR). Is there a way can fix the issue?
5194	area-mvc	What version of node is used in Microsoft.AspNetCore.NodeServices?	I was trying code-splitting + SSR with packages like react-loadable, react-async-component etc. For dynamic import to work as expected, module="esnext" was supposed to be added to the tsconfig.json file.Post adding this, when SSR happens via the main-server.js file which is generated, I get the below shown error.**Exception: Call to Node module failed with error: Prerendering failed because of error: \main-server.js:627import('./store').then(function (nextRootReducer) {^^^^^^**Considering that node version 8.x supports the import syntax, i assumed this would work for SSR. What is the version of Node.js used in Microsoft.AspNetCore.NodeServices? If this is older than 8.x what is the workaround to get this to work with the react-redux template? 
5929	area-hosting	IApplicationLifetime.StopApplication() does not work when using webhost.RunAsService()	How can an aspnet core 2.1 web app be terminated gracefully when running as a Windows service?Injecting IApplicationLifetime into a service and calling StopApplication() works fine when running as console application or IISExpress, but it stops working when running as Windows service.
5541	area-mvc	Cannot bind to nullable types (bool?, int?, etc)	A lot of work has been done for the bind method, let's add the one for nullable bool. `bool?`Current error:Uncaught (in promise) Error: System.ArgumentException: 'bind' does not accept values of type System.Nullable`1[[System.Boolean, mscorlib, Version=2.0.5.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]. To read and write this value type, wrap it in a property of type string with suitable getters and setters.
5193	area-mvc	npm is not looked up in External Web Tools Path	Here's the reference sourcecode where npm is invoked with a cmd command  https://github.com/aspnet/JavaScriptServices/blob/dev/src/Microsoft.AspNetCore.SpaServices.Extensions/Npm/NpmScriptRunner.csIt looks like if for some reason we don't include node path in environment's path npm is not found. npm should be looked up in External Web Tools Path first. If not found then should be invoked like `cmd /c npm ....`Here's an example, how node is updated for VS and it will not work if we don't update environment's path. https://stackoverflow.com/questions/43849585/update-node-version-in-visual-studio-2017
4895	area-mvc	CompareAttribute not working properly with bound properties on the Razor Page's PageModel	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferably a link to a GitHub repo with a repro project):See [This Repo](https://github.com/RKDMax/ReproduceCompareAttributeBug) to reproduce#### Description of the problem:When using a compare attribute on bound properties in the PageModel itself, the otherProperty parameter is not getting honoured and results in a "Could not find a property named &lt;otherProperty&gt;".#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:Microsoft.AspNetCore.App 2.1.0
5540	area-mvc	State is not being updated on button click	1: Download the source from this branch https://github.com/mrpmorris/blazor-fluxor/tree/bug/StateNotChanging2: Set this project as your startup project MiddlwareSample.Server (in the 04-MiddlewareSample solution folder)3: Run it4: Now click either of the buttons. Both should update their own counter, but neither do. (If it works then refresh the page and try again to break it).If you get rid of the `@inherits` line from `index.cshtml` then the counter example with in-view state works (the bottom button) but then the global-state change detection cannot work.This worked in 0.30
5539	area-mvc	VS shouldn't offer to scaffold MVC controllers inside Blazor client apps	Currently with Blazor 0.4 when you try to add a new Controller VS 2017 shows the dialog below:![image](https://user-images.githubusercontent.com/7632824/41413153-8194b6d8-6fe2-11e8-98f6-5928dada073f.png)However no mater what you choose it will hang VS for minutes, or indefinitely. So most of the times I have to kill the process. But it doesn't mater VS was able to finish the setup or not because you wont be able to build that project again... Severity	Code	Description	Project	File	Line	Suppression StateError		rzc generate exited with code 1.	BlazorTest	C:\Users\imre\.nuget\packages\microsoft.aspnetcore.blazor.build\0.4.0\targets\RazorCompilation.targets	184	
5192	area-mvc	POST /index.html fails with 500 error	Microsoft.AspNetCore.SpaServices.SpaDefaultPageMiddleware+<>c__DisplayClass0_0.<Attach>b__1No doubt this is the result of people trying to hack our site by POSTing instead of GETing but it's throwing 500 errors as a result:The SPA default page middleware could not return the default page '/index.html' because it was not found, and no other middleware handled the request.Your application is running in Production mode, so make sure it has been published, or that you have built your SPA manually. Alternatively you may wish to switch to the Development environment.This was fine in RC2 but now errors in Final of 2.1
5307	area-signalr	Provide a better error message when TransportMaxBufferSize exceeded in a single message	Right now, if you send a single message that serializes to larger than 32KB, you get:```fail: Microsoft.AspNetCore.SignalR.HubConnectionHandler[2]      Error when processing requests.System.InvalidOperationException: Advancing examined to the end would cause pipe to deadlock because FlushAsync is waiting.   at System.IO.Pipelines.ThrowHelper.ThrowInvalidOperationException_BackpressureDeadlock()   at System.IO.Pipelines.Pipe.AdvanceReader(BufferSegment consumedSegment, Int32 consumedIndex, BufferSegment examinedSegment, Int32 examinedIndex)   at System.IO.Pipelines.Pipe.AdvanceReader(SequencePosition& consumed, SequencePosition& examined)   at System.IO.Pipelines.Pipe.DefaultPipeReader.AdvanceTo(SequencePosition consumed, SequencePosition examined)   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.DispatchMessagesAsync(HubConnectionContext connection)   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)      fail: Microsoft.AspNetCore.SignalR.HubConnectionHandler[2]      Error when processing requests.System.InvalidOperationException: Advancing examined to the end would cause pipe to deadlock because FlushAsync is waiting.   at System.IO.Pipelines.ThrowHelper.ThrowInvalidOperationException_BackpressureDeadlock()   at System.IO.Pipelines.Pipe.AdvanceReader(BufferSegment consumedSegment, Int32 consumedIndex, BufferSegment examinedSegment, Int32 examinedIndex)   at System.IO.Pipelines.Pipe.AdvanceReader(SequencePosition& consumed, SequencePosition& examined)   at System.IO.Pipelines.Pipe.DefaultPipeReader.AdvanceTo(SequencePosition consumed, SequencePosition examined)   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.DispatchMessagesAsync(HubConnectionContext connection)   at Microsoft.AspNetCore.SignalR.HubConnectionHandler`1.RunHubAsync(HubConnectionContext connection)```These errors are unpleasant. They occur because we are trying to read a single message that is larger than the backpressure size. We should provide a better error message in this case (heck, even if it takes just catching the exception). Something like "Message exceeded the maximum buffer size of {TransportMaxBufferSize} bytes"It may be difficult to do this though, so we'll need to design this a bit (and may decide it's not feasible in the process).
5306	area-signalr	Require Authorization on Hubs as a Global Option	I was thinking we could introduce a global hub option for requiring auth on all hubs. There was a way to do this in classic SignalR but for ASP.NET Core SignalR you'd have to add the `Authorize` tag to each hub.It could look something like ```csharpservices.AddSignalR(options => {    options.RequireAuthorization = true})```
5305	area-signalr	Insufficient Documentation Regarding Scaling  	Hi,Apologies for asking this here not sure where else to turn :(I have been searching endlessly for any decent documentation regarding scaling benchmarks / architecture for SignalR .Net Core 2. I have seen the documents for the Redis cache but this does not provide any benchmarks and scale out limitations. At the moment I am just trying to figure out if it is at all possible to scale out SignalR to millions of connected uses (my use case is MMO gaming), from what I have seen so far this does not seem possible) I am also looking at Azure SignalR Service but there is even less documentation for this, please can you point me to some documentation that could indicate:Approximately how many connected clients are supported base on the Azure App Service server instance size i.e. some benchmark guidelines. (I feel this is a very reasonable request that many people would be interested in especially if they are considering SignalR for massive scale and this has not as far as I can tell been addressed anywhere)What type of latency is introduced by implementing Redis cache as you scale out to 100's of nodes. Again it would be nice to see some actual benchmarks. What are the maximum number of concurrent users the SignalR architecture team team has managed to successfully test (for real time communication) and how was this accomplished?Thanks for the help.Regards,Warren   
5928	area-hosting	Serialize response context as a response header	## MotivationIn distributed tracing scenarios it is not uncommon to return extra context as a response headers when possible. DiagnosticsSource Acitvity should implement API that will allow to set the [response context](https://github.com/dotnet/corefx/issues/30335). Fields populated by this API should be serialized as http response headers.CC: @seth-capistron, @vancem, @jacpull, @lmolkova, @glennc, @davidfowl
5927	area-hosting	Use TraceIdentifier of HttpContext as a span in W3C when possible	## MotivationTraceIdentifier is represented as a unique string. Implementation of TraceIdentifier should be aligned with migration to W3C. TraceIdentifier should match the `span-ID` in W3C distributed tracing context when possible.CC: @seth-capistron, @vancem, @jacpull, @lmolkova, @glennc, @davidfowl
5926	area-hosting	Ambient distributed tracing context	## MotivationPropagate W3C headers to dependant components and make distributed tracing context available even when monitoring is not enabled.Propagation of headers will ensure that distributed trace will correlate services even when unmonitored ASP.NET app is deployed in-the-middle. Let's take service `A` that injects distributed tracing context and calls ASP.NET app `B`. Service `B` calls service `C` that expects distributed tracing context in incoming request.If `B` is not being monitored for distributed traces - it should propagate distributed tracing context unmodified. When analysing telemetry from services `A` and `C` it will look like `A` calls `C` directly. Once distributed tracing monitoring will be enabled for `B` - `B` have to start modifying context according to W3C specification. So telemetry analysis will show `A` calls `B` which calls `C`. In both scenarios any other telemetry like `ILogger` traces or stack dumps can be attributed with the distributed tracing context. This will allow to correlate failures of service `B` with the distributed trace those failures affected.CC: @seth-capistron, @vancem, @jacpull, @lmolkova, @glennc, @davidfowl
5925	area-hosting	Support W3C format for distributed trace context propagation	## MotivationSupport extraction and injection of distributed tracing context in a format of [W3C headers](https://github.com/w3c/distributed-tracing).Support for new headers in ASP.NET depend on [support](https://github.com/dotnet/corefx/issues/30331) for `tracestate` collection in `Activity` class of `DiagnosticsSource`.CC: @seth-capistron, @vancem, @jacpull, @lmolkova, @glennc, @davidfowl
5191	area-mvc	publish ssr angular example doesn't work	When we use your example in Visual Studio 2017 with the angular template and want publish with server side rendering we get an errror:Unable to find app with name or index. Verify the configuration in `.angular-cli.json`We have only changed the property BuildServerSideRenderer=true in the project file "csproj". All other code was not changed.Regardsj-nord
5537	area-mvc	DateTimeOffset client side always show UTC Time	 **var time = DateTimeOffset.Now;****time.ToLocalTime().ToString("yyy-MM-dd HH:mm:ss")}"time.ToUniversalTime().ToString("yyy-MM-dd HH:mm:ss")}"**Both cases show the same result: UTC time.
5534	area-mvc	dotnet command with path parameter uses parent folder casing	To reproduce (note the casing):1. `dotnet new blazor -o Repro`2. `dotnet build repro/Repro.csproj`This fails with a whole bunch of errors about not being able to find the namespace `Repro.Shared`, because the build uses the path name specified in the dotnet build/run/publish command as the namespace name. This means that e.g. MainLayout.g.i.cs *defines* the namespace `repro.Shared`, but everything *uses* `Repro.Shared`.
5533	area-mvc	Linker enhancements	Ways we'd like to improve it in the short term:* Update to the latest linker tooling. We've heard from the Mono team that they've made many improvements.* Add and document a simpler mechanism for customising the linker's behavior. The linker already accepts `.xml` config files to control in more detail which types/methods are strippable/retainable. We should make it easier to supply a custom config alongside (or instead of) the default one.
5190	area-mvc	Angular SPA Template Returning Status Code from Angular App	It seems that the SpaPrerendering services support returning proper status code such as 404 for not found error (https://github.com/aspnet/JavaScriptServices/issues/1423).But the documentation lacks the details on how do we return the status code from the Angular App.Can you please guide and update the docs?Thank you
5189	area-mvc	ReactDevelopmentServer does not honor ContentRoot	I noticed that `ReactDevelopmentServer` starts a process with [working directory set to `SourcePath`](https://github.com/aspnet/JavaScriptServices/blob/96d7f853277788d52dc33027f31a8db4c4786cf1/src/Microsoft.AspNetCore.SpaServices.Extensions/Npm/NpmScriptRunner.cs#L56)  from `SpaOption` without considering that it may be relative, and thus should be relative to the [content root](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/index?view=aspnetcore-2.1&tabs=aspnetcore2x#content-root).I think that it would make sense to append content root to `SourcePath` if `SourcePath` is relative. Then, as a bonus, I think it would be nice if an `DirectoryNotFoundException` was thrown if the source path doesn't exist. I got tricked by [generic error message](https://github.com/aspnet/JavaScriptServices/blob/96d7f853277788d52dc33027f31a8db4c4786cf1/src/Microsoft.AspNetCore.SpaServices.Extensions/Npm/NpmScriptRunner.cs#L122) when this failed for me and started to troubleshoot elsewhere.
5188	area-mvc	Too limited	I develop using vue with hot reloading (meaning that my node server is in port 8080 with a websocket for hot reloading).Using the react spa option the hot reloading kinda works, but the port is random (I have cookies and other stuff that cannot be lost between compilations - a random port for each execution is so stupid).Using the proxy version disables the hot reload.So... pretty useless =\
5799	area-identity	Customize Identity User 	How can use my AppUser without having properties of IdentityUser properties in AppUser, for example, I only want AppUser table will be created on database according to my AppUser class properties, not with IdentityUser properties.
5532	area-mvc	Setting and clearing data for DragDrop operations	Can we get methods to SetData, ClearData on DataTransfer object for DragDrop?https://developer.mozilla.org/en-US/docs/Web/API/DataTransferhttps://html.spec.whatwg.org/multipage/dnd.html#dom-datatransfer-setdatahttps://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/dropEffecttake a look at the example (scroll down)
5187	area-mvc	Location of aspnet-webpack	I'm building a development docker container, so the ASPNETCORE_ENVIRONMENT is set to Development, as i would like to support hmr in the development container.However, i keep running into the following issue.Error was: Error: Cannot find module 'aspnet-webpack'I guess it's not clear to me where this file is supposed to exist. If i'm running in development mode natively, then it's a few folder up in node_modules from the application.dll. I've looked through the source code and it's still unclear to me what the path to the 'aspnet-webpack' from the application.dll is supposed to be?
4216	area-mvc	Update AuthZ middleware to use dispatcher	- [x] Write AuthorizationMiddleware- [ ] No op MVC authorization filter when enabled- [ ] Consider warning/error when endpoints have IAuthorizeData metadata but no AuthorizationMiddleware is registered in application
4210	area-mvc	Update CORS middleware to use dispatcher	
5798	area-identity	Nuget Package URI Error	Upon downloading the Microsoft.AspNetCore.Identity.UI 2.1.0 package, there appears to be an error in the package structure.  When opening the package I get a "Part URI cannot start with two forward slashes" error.  I'm not actually sure where this is occurring, as the metadata appears correct.Here's a screenshot of the error:![nugeterror](https://user-images.githubusercontent.com/40006478/41063609-a52b9532-69c8-11e8-91d0-546c1ac4b667.png)
5304	area-signalr	Communication between two WebAPIs possible?	Hi guys,I am a super noob when it comes to WebSockets and SignalR. I am currently looking for a way to speed up one of our projects which consists of multiple WebAPI projects and a MVC project which communicate with each other. Basically, one WebAPI project serves the data, one acts as a central hub and one acts as the UI.Currently, we use REST calls and timers to periodically transfer data between each project. However, we need to optimize the time it takes for the data to reach its destination. So I thought of using SignalR. But every example I find uses the classic Server-Client scenario. What I need is a WebAPI-WebAPI-Client scenario.So is this possible? If yes, could you give a very basic example on how this could be done?
3799	area-servers	Loopback connection	Hi, I raise this issue to ask about something I don't understand and cannot found any explanation in ms docs.What are the loopback connections? Are they connection of IIS making to my dotnet.exe process?It's always growing until I restart my application. What could be the cause, is that an issue at all?My application is an web api, and additionally it allows web sockets connection. Outbound traffic is HTTP.I also use azure PostgreSQL. Would collecting a network trace and analysing it somehow help me reveal this mystery ;)Thanks in advance![image](https://user-images.githubusercontent.com/731552/41039718-a319d20a-699a-11e8-94dc-60e78684e00a.png)
5924	area-hosting	Make web specific IHostingEnvironment and IApplicationLifetime inherit from generic host versions	We made the concrete implementations work this way so that you could write types that took in IHostingEnvironment and IApplicationLifetime but we didn't do it for the interfaces themselves. If you have methods that take the generic IHostingEnvironment and IApplicationLifetime, then you can't just pass the implementation you got from the web host into these methods e.g.Library```C#public static class CustomEnvironmentExtensions{    public static bool IsCustomDevelopment(this Extensions.Hosting.IHostingEnvironment env) { ... }}```ASP.NET Core app```C#public void Configure(IHostingEnvironment env){    // This is a compile error    if (env.IsCustomDevelopment())    {            }}```See https://github.com/aspnet/Hosting/issues/1218#issuecomment-394956520 for more info.
4148	area-hosting	Undo the change to make the IServiceProvider in Configure scoped	Turns out people were capturing the IServiceProvider here to store in statics. Initially this change was made to make running EF migrations easier but then that pattern was moved into Program.Main. We've had several reports about this breaking things so we should consider reverting it.Here's the initial change:https://github.com/aspnet/Hosting/pull/1106We can consider this for a later patch as well.
4745	area-servers	Http/2 support for HTTP_1_1_REQUIRED	https://tools.ietf.org/html/rfc7540#section-7   HTTP_1_1_REQUIRED (0xd):  The endpoint requires that HTTP/1.1 be use instead of HTTP/2.This may require a public API for the application to request a downgrade. E.g. If you go to a websocket endpoint over http/2. Windows auth is another scenario. Any other use cases? Sending a 400 Bad Request is the workaround. 
4746	area-servers	Server unexpectedly returns http status 200 (OK) with empty content in release 2.1.0	@halter73 After upgrading from AspNetCore NuGet package **2.1.0-rc1-final** to **2.1.0-rtm-30787** that [differ](https://github.com/aspnet/KestrelHttpServer/compare/2.1.0-rc1-final...da21fc8) slightly with #2533 and #2562 we noticed instances of 200 server responses containing empty content. This behavior messes with JSON-RPC client functionality. The behavior is intermittent in our production environment. We can not reliably reproduce (i.e. trigger in a controllable manner). In our view the change to optional `_streams?.Abort` in https://github.com/aspnet/KestrelHttpServer/pull/2533/commits/6e003d8847040c2c64cb41f0d87bf6c825548ccf```            if (error != null)            {                 _streams?.Abort(error);	                         }```could have had wider effect than for WebSocket connections only.The issue #2530 mentions #2533 may or may not be similar and we are not sure about the timing wither it preceded or followed the change.Note that HttpProtocol.Abort in [dev branch](https://github.com/aspnet/KestrelHttpServer/blob/dev/src/Kestrel.Core/Internal/Http/HttpProtocol.cs) has remained untouched v.s. [release/2.1](https://github.com/aspnet/KestrelHttpServer/blob/release/2.1/src/Kestrel.Core/Internal/Http/HttpProtocol.cs) leaving `_streams?.Abort` non-optional. It has been changed in #2612 but essentially remained intact.Is this (the empty response symptom and the differences between the branches) something that you can give some insight or there is a duplicate issue I missed? Thanks.  
5797	area-identity	Alternative to AuthenticationResponseGrant?	Is there any alternative to the following code in AspNet Core 2?```var identity = HttpContext.User.Identity as ClaimsIdentity;identity.RemoveClaim(Identity.FindFirst("AnnounceCount"));identity.AddClaim(new Claim("AnnounceCount", "Updated Value"));var authenticationManager = System.Web.HttpContext.Current.GetOwinContext().Authentication;authenticationManager.AuthenticationResponseGrant = new AuthenticationResponseGrant(new ClaimsPrincipal(identity), new AuthenticationProperties() { IsPersistent = true });```I would like to change some User Principal values inside the cookie and I do not intend to persist those in the database. Is something like the above code possible in the Asp Net Core version 2? I looked into `OnValidatePrincipal`, `IClaimsTransformation` implementations, but both of those don't fit my needs. Am I missing something here?Thanks
5531	area-mvc	Config	Provide a model for app configuration, like specifying the URL for an API endpoint. Would we use Microsoft.Extensions.Configuration for this? Where config source would we use? Local storage? Embedded resources?How would change notification work?
6021	area-identity	HTTP 404 when redirecting to the AccessDenied page	### Functional impact When accessing a page with no access permissions, an HTTP 404 error is returned (after an HTTP 302 redirect to an invalid location) instead of the AccessDenied page.### Minimal repro steps1. Set up a simple project using the ASP.NET Core 2.1 MVC template and add Azure AD authentication.2. Annotate a controller action with some dummy role requirement that won't be fulfilled (e.g. HomeController.Contact).3. Launch, navigate to the annotated action (e.g. Home/Contact)4. An HTTP 302 is returned, redirecting to /Account/AccessDenied, missing the /AzureAD prefix.### Expected resultAn HTTP 302 redirecting to /AzureAD/Account/AccessDenied### Actual resultAn HTTP 302 redirecting to /Account/AccessDenied### Further technical detailsCookieAuthentication Login, Logout and AccessDeniedPath properties are not updated to reflect the new /AzureAD/ area due to a bug in the [CookieOptionsConfiguration](https://github.com/aspnet/AADIntegration/blob/dev/src/Microsoft.AspNetCore.Authentication.AzureAD.UI/CookieOptionsConfiguration.cs) class.When configuring CookieAuthenticationOptions, the scheme name is compared with the OpenIdConnectScheme name instead of the CookieScheme name. [This check](https://github.com/aspnet/AADIntegration/blob/268e97c42453ff33ff7d0ad927b6d93ef201b157/src/Microsoft.AspNetCore.Authentication.AzureAD.UI/CookieOptionsConfiguration.cs#L42) causes the  [GetAzureADScheme](https://github.com/aspnet/AADIntegration/blob/268e97c42453ff33ff7d0ad927b6d93ef201b157/src/Microsoft.AspNetCore.Authentication.AzureAD.UI/CookieOptionsConfiguration.cs#L38) method to return null and to skip the CookieAuthenticationOptions configuration.
5074	area-mvc	Use document snapshots when parsing Razor files.	Today the parser is highly coupled to the idea of a background parser that requires in-depth knowledge of what makes up a documents context (project file path, its project engine etc.) and to idea of a background queue of changes pumping through the system.A major cost in this issue is testing.
5303	area-signalr	Use Karma to run JavaScript functional tests in browsers	* [x] Convert tests to use [Karma](https://karma-runner.github.io/2.0/index.html) when running locally* [x] Use [`karma-sauce-launcher`](https://github.com/karma-runner/karma-sauce-launcher) to run tests on SauceLabs* [x] Create VSTS build that runs these tests* [ ] Report VSTS build results to email and GitHub checks.* [ ] Consider running builds on PRs (only ones issues by or approved by team members though)
4894	area-mvc	CreateSanitizedId should change to reflect HTML5 latest spec	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferrably a link to a GitHub repo with a repro project):Repo: https://github.com/doggy8088/ASPNETCORE_HTML5_IdSteps:1. `git clone https://github.com/doggy8088/ASPNETCORE_HTML5_Id.git`2. `cd ASPNETCORE_HTML5_Id/ASPNETCORE_HTML5_Id`3. `dotnet run`4. Navigate to https://localhost:5001/Home/Test5. Check the following `id` attribute:  ![image](https://user-images.githubusercontent.com/88981/40888684-542339ca-678d-11e8-821f-bdb0c287b7bc.png)#### Description of the problem:Here is my model:![image](https://user-images.githubusercontent.com/88981/40888682-4dd51f16-678d-11e8-8743-3dd13dc6ccfc.png)The HTML output become:![image](https://user-images.githubusercontent.com/88981/40888691-70149bba-678d-11e8-8c8e-6a7b79aee658.png)There is a [`CreateSanitizedId` method](https://github.com/aspnet/Mvc/blob/9d38e2523c88b190e8df7665ad8cc1da06519a8f/src/Microsoft.AspNetCore.Mvc.ViewFeatures/Rendering/TagBuilder.cs#L141-L144) in the `Microsoft.AspNetCore.Mvc.Rendering.TagBuilder` class.  In this method, it sanitized all the `id` attribute for all HTML tags to apply HTML4.01 spec for a long time which is no problem at all. The HTML 4.01 spec states that ID tokens must begin with a letter ([A-Za-z]) and may be followed by any number of letters, digits ([0-9]), hyphens (-), underscores (_), colons (:), and periods (.).  HTML5 gets rid of that restrictions on the `id` attribute now. For a modern web framework, I think it should align with the HTML5 specification and deprecated the old behavior.#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`: All of them.  All versions.
5530	area-mvc	Exception in VS when renaming a Blazor component in a Blazor component library	I got an exception in VS when renaming a Blazor component in a Blazor component library.https://github.com/danroth27/BlazorClipboard/commit/5c5a31716324fdf09f5af0afa35011e4130eedf3![image](https://user-images.githubusercontent.com/1874516/40883477-f59ff526-66b2-11e8-8b3f-a456206e6d2c.png)[ActivityLog.xml.txt](https://github.com/aspnet/Blazor/files/2065696/ActivityLog.xml.txt)
4651	area-security	Log decryption failures	"Correlation failed" is one of the most common failures in OIDC or OAuth flows. Many of the things that can go wrong here happen on the client and can't be traced from the server. However there's one scenario where everything does flow back to the server and the server fails to decrypt the values. This can happen in a multi-node environment with misconfigured dataprotection (RE: https://github.com/aspnet/Security/issues/1755). We can highlight this by logging decryption failures in OAuth, OIDC, and CookieAuth.
5796	area-identity	[feature request] user activity	I saw #106, #650, #1278, and #1281One year passed, is there any plan for the account activity feature?Or if the schema changes have been done and the project is ready for the activity feature with a pull request?
5529	area-mvc	Router does not find inherited RouteAttribute	Since component is not a partial class the issue is that when i specify route (e.g. `/interop`) in base class and i won't use `@page` in the view but use `@inherits` - i've got issue in console in the browser: ```MonoPlatform.ts:70 Uncaught (in promise) Error: System.InvalidOperationException: Failed to compare two elements in the array. ---> System.InvalidOperationException: The following routes are ambiguous:'interop' in 'blazorfirststandaloneapplication.Base.InteropBase''interop' in 'blazor_first_standalone_application.Pages.Interop'```If it's inheritance - in my opinion it should derive Route attribute.
5186	area-mvc	Exception on project startup when calling UseWebpackDevMiddleware	Current project is targeting .NET Core 2.0, configured Webpack with Vue.js, everything works as expected with HMR. After following the migration guide at https://docs.microsoft.com/en-us/aspnet/core/migration/20_21?view=aspnetcore-2.1 to move to .NET Core 2.1, the project builds but fails to start with the following exception:> System.AggregateException: One or more errors occurred. (Unexpected response content type: text/html) ---> System.InvalidOperationException: Unexpected response content type: text/html   at Microsoft.AspNetCore.NodeServices.HostingModels.HttpNodeInstance.InvokeExportAsync[T](NodeInvocationInfo invocationInfo, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.HostingModels.OutOfProcessNodeInstance.InvokeExportAsync[T](CancellationToken cancellationToken, String moduleName, String exportNameOrNull, Object[] args)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)   --- End of inner exception stack trace ---   at System.Threading.Tasks.Task`1.GetResultCore(Boolean waitCompletionNotification)   at Microsoft.AspNetCore.Builder.WebpackDevMiddleware.UseWebpackDevMiddleware(IApplicationBuilder appBuilder, WebpackDevMiddlewareOptions options)   at WebApp.Startup.Configure(IApplicationBuilder app, IHostingEnvironment env) in C:\Projects\Git\TOPFAS\Develop\Source\NATO\EB\WebApps\WebApp\Startup.cs:line 36--- End of stack trace from previous location where exception was thrown ---   at Microsoft.AspNetCore.Hosting.ConventionBasedStartup.Configure(IApplicationBuilder app)   at Microsoft.AspNetCore.HostFilteringStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder app)   at Microsoft.AspNetCore.Hosting.Internal.AutoRequestServicesStartupFilter.<>c__DisplayClass0_0.<Configure>b__0(IApplicationBuilder builder)   at Microsoft.AspNetCore.Hosting.Internal.WebHost.BuildApplication()---> (Inner Exception #0) System.InvalidOperationException: Unexpected response content type: text/html   at Microsoft.AspNetCore.NodeServices.HostingModels.HttpNodeInstance.InvokeExportAsync[T](NodeInvocationInfo invocationInfo, CancellationToken cancellationToken)   at Microsoft.AspNetCore.NodeServices.HostingModels.OutOfProcessNodeInstance.InvokeExportAsync[T](CancellationToken cancellationToken, String moduleName, String exportNameOrNull, Object[] args)   at Microsoft.AspNetCore.NodeServices.NodeServicesImpl.InvokeExportWithPossibleRetryAsync[T](String moduleName, String exportedFunctionName, Object[] args, Boolean allowRetry, CancellationToken cancellationToken)<---My Main code:public class Program    {        public static void Main(string[] args)        {            CreateWebHostBuilder(args).Build().Run(); // fail point        }        public static IWebHostBuilder CreateWebHostBuilder(string[] args) =>            WebHost.CreateDefaultBuilder(args)                .UseStartup<Startup>();    }My Startup code:    public class Startup    {        public Startup(IConfiguration configuration)        {            Configuration = configuration;        }        public IConfiguration Configuration { get; }        public void ConfigureServices(IServiceCollection services)        {            //services.Configure<CookiePolicyOptions>(options =>            //{            //    options.CheckConsentNeeded = context => true;            //    options.MinimumSameSitePolicy = SameSiteMode.None;            //});            services.AddMvc();        }        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();                app.UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions                {                    HotModuleReplacement = true                });            }            else            {                app.UseExceptionHandler("/Home/Error");                app.UseHsts();            }            app.UseHttpsRedirection();            app.UseStaticFiles();            //app.UseCookiePolicy();            app.UseMvc(routes =>            {                routes.MapRoute(                    name: "default",                    template: "{controller=Home}/{action=Index}/{id?}");                routes.MapSpaFallbackRoute(                    name: "spa-fallback",                    defaults: new { controller = "Home", action = "Index" });            });        }    }Commenting out the app.UseWebpackDevMiddleware block removes the exception (but also the HMR, naturally). Any ideas?
5185	area-mvc	app.UseWebpackDevMiddleware throw error	At app.UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions { HotModuleReplacement = true });I got this error after npm package updated from 2.0.3 to 3.0.0 and my Asp.Net Core app updated from 2.0 to 2.1.NodeInvocationException: Error: Cannot find module 'webpack-dev-middleware'    at Function.Module._resolveFilename (module.js:547:15)    at Function.Module._load (module.js:474:25)    at Module.require (module.js:596:17)    at require (internal/module.js:11:18)    at attachWebpackDevMiddleware (C:\work\Traveller\Traveller.Web.Portal\node_modules\aspnet-webpack\WebpackDevMiddleware.js:72:13)    at C:\work\Traveller\Traveller.Web.Portal\node_modules\aspnet-webpack\WebpackDevMiddleware.js:271:25    at Array.forEach (<anonymous>)    at Server.<anonymous> (C:\work\Traveller\Traveller.Web.Portal\node_modules\aspnet-webpack\WebpackDevMiddleware.js:234:36)    at Object.onceWrapper (events.js:313:30)    at emitNone (events.js:106:13)    at Server.emit (events.js:208:7)    at emitListeningNT (net.js:1394:10)    at _combinedTickCallback (internal/process/next_tick.js:135:11)    at process._tickCallback (internal/process/next_tick.js:180:9)
4747	area-servers	Misleading TaskCanceledException	I have a WebApi endpoint that parses out the Request.Body itself rather than using Model binding due to performance reasons.During some requests, I was getting a TaskCanceledException from a TextReader that I never gave any CancellationTokens too. After investigation, I found out that any read operations on the Request.Body after the Request was aborted will throw TaskCanceledExceptions. The stack trace at the time didn't list any Kestrel level code so I spent a lot of time trying to find out how a Stream can possibly cancel a token I never gave it.This is a bit misleading and should probably change I think.
5528	area-mvc	NavLink customizable tag	The `<NavLink>` by default becomes an `<a>` tag. As I wanted to implement a standard bootstrap navbar, the `active` class needed to be on a `<li>` tag instead.I therefore created a `TaggableNavLink` class that takes an additional parameter```cs[Parameter]string Tag { get; set; }```to specify the tag, and used this in the `private void Render(...)` function, where I now write```csbuilder.OpenElement(0, Tag);```instead of hard-coding```csbuilder.OpenElement(0, "a");```I also included logic to parse the parameter and have `<a>` as the default tag.As I stated, this is part of a small project I'm doing with blazor and as far as I can tell so far, it works without problems and shouldn't have any side effects.---Given that this was quite trivial to implement, there might has been a design choice made to hard-code this instead of exposing it as a parameter.If it was just not considered as a requirement before, I'll happily submit my solution as a PR once I tested it a bit more thoroughly.
4748	area-servers	http/2: Trailers	We need to re-visit trailers to design a consistent consumption model whether you're using http/1.1 or http/2
6020	area-identity	[Authorize(AuthenticationSchemes = AzureADDefaults.BearerAuthenticationScheme)] generates compiler error CS0182	According to the [documentation](https://docs.microsoft.com/en-us/aspnet/core/security/authorization/limitingidentitybyscheme?view=aspnetcore-2.0&tabs=aspnetcore2x) it should be possible to explicitly specify or override the AuthenticationScheme for a controller with the Authorize attribute.The following snippet is from the ValuesController.cs file in the base ASP.NET Core Web Application API template with "Work or School accounts" authentication.`[Route("api/[controller]")]``[Authorize(AuthenticationSchemes = AzureADDefaults.BearerAuthenticationScheme)]``[ApiController]``public class ValuesController : ControllerBase``{ ... } `However, the above code generates compiler error CS0182: An attribute argument must be a constant expression, typeof expression or array creation expression of an attribute parameter type.A potential fix could be to change the member properties of AzureADDefaults from **static readonly** to **const** as in the [JwtBearerDefaults class](https://github.com/aspnet/Security/blob/dev/src/Microsoft.AspNetCore.Authentication.JwtBearer/JwtBearerDefaults.cs)`public const string BearerAuthenticationScheme = "AzureADBearer";`
5795	area-identity	RoleManager.UpdateRole caused  EF ChangeTracker already being tracked exception	## Steps to reproduce:```var trackedRole = await RoleManager.FindByNameAsync("admin");var nonTrackedRole = new Role { Id = trackedRole .Id, Name = trackedRole .Name };await RoleManager.UpdateAsync(nonTrackedRole );```Got the exception`value for {'Id'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.'`## Assumption I understand the main reason for this issue but have just wanted to clarify whether the team is going to do something about this?
5184	area-mvc	aspnet-prerendering doesn't work after ng upgraded to v6	Recently, I upgraded aspnetspa-angular project to v6 via the [guide](https://update.angular.io/).I updated these:1. `package.json`: `"build:ssr": "npm run build -- --project=ssr --output-hashing=media",`1. Add another project named `ssr` in `angular.json````"ssr": {      "root": "",      "sourceRoot": "src",      "projectType": "application",      "architect": {        "build": {          "builder": "@angular-devkit/build-angular:browser",          "options": {            "outputPath": "dist-server",            "index": "src/index.html",            "main": "src/main.server.ts",            "tsConfig": "src/tsconfig.server.json",            "progress": true,            "polyfills": "src/polyfills.ts",            "assets": [              "src/assets"            ],            "styles": [              "src/styles.css",              "node_modules/bootstrap/dist/css/bootstrap.min.css"            ],            "scripts": []          },          "configurations": {            "production": {              "optimization": true,              "outputHashing": "all",              "sourceMap": false,              "extractCss": true,              "namedChunks": false,              "aot": true,              "extractLicenses": true,              "vendorChunk": false,              "buildOptimizer": true,              "fileReplacements": [                {                  "replace": "src/environments/environment.ts",                  "with": "src/environments/environment.prod.ts"                }              ]            }          }        },        "serve": {          "builder": "@angular-devkit/build-angular:dev-server",          "options": {            "browserTarget": "ssr:build"          },          "configurations": {            "production": {              "browserTarget": "ssr:build:production"            }          }        },        "extract-i18n": {          "builder": "@angular-devkit/build-angular:extract-i18n",          "options": {            "browserTarget": "ssr:build"          }        },        "test": {          "builder": "@angular-devkit/build-angular:karma",          "options": {            "main": "src/test.ts",            "karmaConfig": "./karma.conf.js",            "polyfills": "src/polyfills.ts",            "tsConfig": "src/tsconfig.spec.json",            "scripts": [],            "styles": [              "src/styles.css",              "node_modules/bootstrap/dist/css/bootstrap.min.css",              "node_modules/ngx-toastr/toastr.css"            ],            "assets": [              "src/assets"            ]          }        },        "lint": {          "builder": "@angular-devkit/build-angular:tslint",          "options": {            "tsConfig": [              "src/tsconfig.app.json",              "src/tsconfig.spec.json"            ],            "exclude": [              "**/node_modules/**"            ]          }        }      }    },```and the error was thrown on `dotnet publish -c Release````ERROR in ./node_modules/aspnet-prerendering/Prerendering.jsModule not found : error : Can't resolve 'domain' in '/My_Project_Path/ClientApp/node_modules/aspnet-prerendering' [/My_Project_Path/My_Project.csproj]  ERROR in ./node_modules/domain-context/lib/index.jsModule not found : error : Can't resolve 'domain' in '/My_Project_Path/ClientApp/node_modules/domain-context/lib' [/My_Project_Path/My_Project.csproj]  ERROR in ./node_modules/domain-task/main.jsModule not found : error : Can't resolve 'domain' in '/My_Project_Path/ClientApp/node_modules/domain-task' [/My_Project_Path/My_Project.csproj]```  
3818	area-servers	Add Win7 and Win8 agents to pull requests	As there are many OS specific nuances with IISIntegration, we should enable win7 and win8 jenkins agents for PR builds.
5183	area-mvc	Incorrect angular cli port when running using UseAngularCliServer middleware	Is this me or something's wrong when trying to run with UseAngularCliServer I get this:![image](https://user-images.githubusercontent.com/3470892/40681322-b90fb8a6-6380-11e8-8c63-b482ec15d45a.png)As can be seen that the port that angular cli is running is wrong. I also tried running using --port=4200 but then I get this in browser:![image](https://user-images.githubusercontent.com/3470892/40681469-2025c9d6-6381-11e8-85be-4b6992b1ba6a.png)I have just updated SPA extension package to 2.1.Can be replicate in [this](https://github.com/asadsahi/AspNetCoreSpa/tree/sln) branch
5073	area-mvc	Implement DocumentSnapshot tracking in VS 4 Mac	When we eventually move all of our internal parsing infrastructure to use DocumentSnapshots we'll need to  have the correct information flowing through the VS4Mac side of the world.
4652	area-security	Empty body responses can violate content security policy	# OverviewI have a basic MVC website utilizing OIDC with authorization code flow for authentication. After implementing a content security policy, remote sign out will no longer function.On remote signout the OpenIdConnectHandler will respond with a response of code 200 but with no body. As a result, browsers will interpret the response by improvising the text/html content. This can result in a content security policy violation based on the browser's improvisation.# Reproduction[I have a repository with the most basic configuration.](https://github.com/null-d3v/OidcCsp)Using Chrome, navigate directly to the `RemoteSignOutPath` (/signout-oidc)Chrome will report a content security policy violation from the pre element's inline style:```<html>    <head></head>    <body>        <pre style="word-wrap: break-word; white-space: pre-wrap;"></pre>    </body></html>```Currently there is limited recourse. I understand I have several options: using 'unsafe-inline', overriding the remote sign out implementation via the `OnRemoteSignOut` event, or add middleware to change the content security policy for the `RemoteSignOutPath` specifically. These options are somewhat contrived and not what I would think ideal. However, if there is a better solution that I am overlooking I would appreciate any insight.I would request consideration for the text/html status code 200 HTTP responses include a body to avoid this browser improvisation.
5527	area-mvc	Invalid route throws a silent exception	Set up a page, and put the following at the top:`@page "/ShouldWork/{ID: int}"`(Note the space between the `:` and the `int`.)Build and run.  Everything builds without error, but when attempting to run, after "Loading..." disappears, no content appears to replace it; you just end up with a blank browser window, and no error in the console.The only way to figure out what's going wrong is putting a try-catch block around the `BrowserRenderer.AddComponent` invocation in Program.cs, and having it print the error to the console.  You end up with something like this:> WASM: BR ready MonoPlatform.ts:191:25WASM: System.ArgumentException: Unsupported constraint ' int' in route '/ShouldWork/{ID: int}'. MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Routing.RouteConstraint.Parse (System.String template, System.String segment, System.String constraint) <0x1c42b88 + 0x0008c> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Routing.TemplateSegment+<>c__DisplayClass0_0.<.ctor>b__0 (System.String token) <0x1c42450 + 0x0001c> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at System.Linq.Enumerable+SelectListPartitionIterator\`2[TSource,TResult].ToArray () <0x1c41e90 + 0x00068> in <87b8d63555bf4cccb15cd79d953a359d>:0 MonoPlatform.ts:191:25WASM:   at System.Linq.Enumerable.ToArray[TSource] (System.Collections.Generic.IEnumerable\`1[T] source) <0x1c41c20 + 0x0003c> in <87b8d63555bf4cccb15cd79d953a359d>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Routing.TemplateSegment..ctor (System.String template, System.String segment, System.Boolean isParameter) <0x1c31db8 + 0x00102> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Routing.TemplateParser.ParseTemplate (System.String template) <0x1c2f758 + 0x001ea> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Routing.RouteTable.Create (System.Collections.Generic.IEnumerable\`1[T] types) <0x1c0e7c8 + 0x0005a> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Routing.Router.SetParameters (Microsoft.AspNetCore.Blazor.Components.ParameterCollection parameters) <0x19dfd88 + 0x0003e> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.InitializeNewComponentFrame (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 frameIndex) <0x1bde5d0 + 0x0007a> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.InitializeNewSubtree (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 frameIndex) <0x1bde440 + 0x00086> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.InsertNewFrame (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 newFrameIndex) <0x1bdde48 + 0x000bc> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.AppendDiffEntriesForRange (Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder+DiffContext& diffContext, System.Int32 oldStartIndex, System.Int32 oldEndIndexExcl, System.Int32 newStartIndex, System.Int32 newEndIndexExcl) <0x1bd8d68 + 0x0025e> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.RenderTree.RenderTreeDiffBuilder.ComputeDiff (Microsoft.AspNetCore.Blazor.Rendering.Renderer renderer, Microsoft.AspNetCore.Blazor.Rendering.RenderBatchBuilder batchBuilder, System.Int32 componentId, Microsoft.AspNetCore.Blazor.RenderTree.ArrayRange\`1[T] oldTree, Microsoft.AspNetCore.Blazor.RenderTree.ArrayRange\`1[T] newTree) <0x1bd87c8 + 0x000a2> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Rendering.ComponentState.RenderIntoBatch (Microsoft.AspNetCore.Blazor.Rendering.RenderBatchBuilder batchBuilder, Microsoft.AspNetCore.Blazor.RenderFragment renderFragment) <0x1bd3a88 + 0x000b4> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Rendering.Renderer.RenderInExistingBatch (Microsoft.AspNetCore.Blazor.Rendering.RenderQueueEntry renderQueueEntry) <0x1bd3630 + 0x00040> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Rendering.Renderer.ProcessRenderQueue () <0x1bd2d88 + 0x00048> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Rendering.Renderer.AddToRenderQueue (System.Int32 componentId, Microsoft.AspNetCore.Blazor.RenderFragment renderFragment) <0x1bd1e88 + 0x00068> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Components.RenderHandle.Render (Microsoft.AspNetCore.Blazor.RenderFragment renderFragment) <0x1bd1b70 + 0x00036> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Components.BlazorComponent.StateHasChanged () <0x1bd1a78 + 0x00048> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Components.BlazorComponent.SetParameters (Microsoft.AspNetCore.Blazor.Components.ParameterCollection parameters) <0x1bc37b0 + 0x000b2> in <0d9c96ffc9704aa9b088cbbe138126c6>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Browser.Rendering.BrowserRenderer.AddComponent (System.Type componentType, System.String domElementSelector) <0x1b9fa50 + 0x0005e> in <92ed9c6772a34798bccecc99cc26cbcd>:0 MonoPlatform.ts:191:25WASM:   at Microsoft.AspNetCore.Blazor.Browser.Rendering.BrowserRenderer.AddComponent[TComponent] (System.String domElementSelector) <0x1b9b698 + 0x00020> in <92ed9c6772a34798bccecc99cc26cbcd>:0 MonoPlatform.ts:191:25WASM:   at DungeonEpicSpa.Program+<>c+<<Main>b__0_0>d.MoveNext () <0x18e8038 + 0x001ce> in <66587a3e6a964a25bf7b20a708681e76>:0 MonoPlatform.ts:191:25There are two problems here.  First, the URL parser apparently can't deal with whitespace, for no good reason.  And second, this failure causes an unhandled exception that doesn't get reported in the browser's console.  (Which means it's probably handled at some point, but not before it escapes the project code and unwinds into the Blazor framework, rendering everything useless.)
5526	area-mvc	InvalidOperationException when cancelling a HttpClient request	Given some code like this```try{    if (requestToken != null)    {        requestToken.Cancel();    }        requestToken = new CancellationTokenSource();    var moviesResult = await _movieService.FindMoviesByPattern(SearchMovieTitle, page, requestToken.Token);    ...}catch (OperationCanceledException){    Console.WriteLine("Task cancelled");}``````public async Task<MovieSearchResult> FindMoviesByPattern(string pattern, int page, CancellationToken cancelationToken){    var responseJson = await httpClient.GetAsync($"{_baseUrl}&s={pattern}&page={page}", cancelationToken);    var content = await responseJson.Content.ReadAsStringAsync();    var movies = JsonUtil.Deserialize<MovieSearchResult>(content);    return movies;}```If ai call twice the function that cancel the token before the async task completes, after the console log I get an exception```MonoPlatform.ts:70 Uncaught (in promise) Error: System.InvalidOperationException  at System.Threading.Tasks.TaskCompletionSource`1[TResult].SetResult (TResult result) <0x1f1d830 + 0x0001c> in <97087b6ddfa745d994b6c273654c5fd6>:0   at Microsoft.AspNetCore.Blazor.Browser.Http.BrowserHttpMessageHandler.ReceiveResponse (System.String id, System.String responseDescriptorJson, System.String responseBodyText, System.String errorText) <0x1ef7f70 + 0x000d4> in <92ed9c6772a34798bccecc99cc26cbcd>:0   at System.Threading.Tasks.TaskCompletionSource`1[TResult].SetResult (TResult result) <0x1f1d830 + 0x0001c> in <97087b6ddfa745d994b6c273654c5fd6>:0   at Microsoft.AspNetCore.Blazor.Browser.Http.BrowserHttpMessageHandler.ReceiveResponse (System.String id, System.String responseDescriptorJson, System.String responseBodyText, System.String errorText) <0x1ef7f70 + 0x000d4> in <92ed9c6772a34798bccecc99cc26cbcd>:0     at Object.callMethod (MonoPlatform.ts:70)    at dispatchResponse (Http.ts:71)    at dispatchSuccessResponse (Http.ts:44)    at Http.ts:32    at step (LogicalElements.ts:161)    at Object.next (LogicalElements.ts:161)    at fulfilled (LogicalElements.ts:161)```It can be reproduced at my project: https://github.com/rpedretti/BlazorApp/tree/version_0_3_0 at the Movies menu, on a paged grid
5302	area-signalr	Please add WebRTC support 	I would like to use SignalR as a mediator/rendezvous/fallback for WebRTC.  It would be great if I could facilitate direct peer to peer communications via signal r.I realize this is a big enhancement.Thanks for all your hard work.
5301	area-signalr	C++ Client Work	- [x] Review public API- [ ] Add SignalR Service support, mainly add redirect and auth from handshake response- [ ] Review configuration options- [ ] Add new tests (probably mostly around protocol)- [ ] Remove unrelated tests- [ ] Remove remnants of classic ASP.NET protocol- [ ] Add different protocol support (json is fairly hard-coded currently)- [ ] CI build integration- [ ] Cross-platform builds?- [ ] Client-Side pinging- [ ] Add Streaming support- [ ] Add MessagePack- [ ] Other transports, LongPolling and ServerSentEvents
5182	area-mvc	Provide hooks to allow for integration with other JavaScript frameworks	I am looking into creating a Vue template that works with the Vue CLI. Similar to what was done with the provided Angular and React templates.Following the path of `UseReactDevelopmentSever` I was able to get an example up and running, but to do so I ended up copying and pasting about 6 class from this repo that are marked as internal.  All of the added classes came in when I got to the point to converting `StartCreateReactAppServerAsync`.Would it be possible to add new hooks to making interation with other framework easier or make the existing classes public?For reference the classes I had to import were:* EventedStreamStringReader* LoggerFinder* NpmScriptRunner* TaskTimeoutExtensions* TcpPortFinderWhile none of these classes are huge it would be nice to not have to manually keep them in sync with changes in this repo.
5422	area-mvc	Identify ASP.NET template version installed or used in project	How can I identify the version of ASP.NET templating currently installed or via `dotnet` commands?  Is this possible; otherwise, an enhancement deemed worthwhille?  Or would this be an issue with the scaffolding project?For example, ASP.NET Templating repo updated to version 2.0.8 two weeks ago.Inside Visual Studio, when I look at the templates installed I'm not seeing an identifier that I can correlate back to the template version:WebTemplateCore.vstemplate```<VSTemplate Version="3.0.0" xmlns="http://schemas.microsoft.com/developer/vstemplate/2005" Type="ProjectGroup">  <TemplateData>    <Name Package="{0CD94836-1526-4E85-87D3-FB5274C5AFC9}" ID="6001"/>    <Description Package="{0CD94836-1526-4E85-87D3-FB5274C5AFC9}" ID="6002"/>    <Icon Package="{AAB75614-2F8F-4DA6-B0A6-763C6DBB2969}" ID="4" />    <ProjectType>CSharp</ProjectType>    <ProjectSubType>Web</ProjectSubType>    <TemplateGroupID>Web</TemplateGroupID>    <TemplateID>Microsoft.DotNet.CSharp.ASPNET.WebCore</TemplateID>```Issuing the `dotnet new` command doesn't give any version of the templates installed```Templates                                         Short Name       Language          Tags               --------------------------------------------------------------------------------------------------------Console Application                               console          [C#], F#, VB      Common/Console     Class library                                     classlib         [C#], F#, VB      Common/Library     Unit Test Project                                 mstest           [C#], F#, VB      Test/MSTest        xUnit Test Project                                xunit            [C#], F#, VB      Test/xUnit         ASP.NET Core Empty                                web              [C#], F#          Web/Empty          ASP.NET Core Web App (Model-View-Controller)      mvc              [C#], F#          Web/MVC            ASP.NET Core Web App                              razor            [C#]              Web/MVC/Razor Pages```Where I personally would desire this information the most is within the generated templates, such as a comment in the generated code.  This way, I could refer to that version information within a project to understand which templates were used in the solution.
4893	area-mvc	Things to do in 3.0	This issue is to track a repo wide impacting changes:### Remove the compatibility switches - [ ] Remove compat switch for Enum DataAnnotation localization. In #7748 we decided to fix the fact that Enum localization didn't use DataAnnotationLocalizerProvider behind a compat switch because it was a breaking change. For 3.0.0 we should remove that compat switch and only support the new behavior (usage of DataAnnotationLocalizerProvider).### Remove all the obsolete methods- [ ] See https://github.com/aspnet/Mvc/issues/6497### Unit testing cleanup- [ ] Make `ControllerBase.User` virtual for unit testability.
4892	area-mvc	Improve automated browser testing with real server	Feedback from @shanselman:We should do better with testing. There's issues with moving from the inside out:### LEVELS OF TESTING* GOOD - Unit Testing - Make a PageModel and call On Get* GOOD - Functional Testing - Make a WebApplicationFactory and make in-memory HTTP calls * BAD - Automated Browser Testing with Real Server - can't easily use Selenium or call a real server. I shouldn't have to do this. We should decouple the WebApplicationFactory from the concrete TestServer implementation. @davidfowl ```public class RealServerFactory<TStartup> : WebApplicationFactory<Startup> where TStartup : class{    IWebHost _host;    public string RootUri { get; set; }    public RealServerFactory()    {        ClientOptions.BaseAddress = new Uri("https://localhost");    }    protected override void ConfigureWebHost(IWebHostBuilder builder)    {        builder.UseEnvironment("Development"); //will be default in RC1    }    protected override TestServer CreateServer(IWebHostBuilder builder)    {        //Real TCP port        _host = builder.Build();        _host.Start();        RootUri = _host.ServerFeatures.Get<IServerAddressesFeature>().Addresses.FirstOrDefault();        //Fake Server we won't use...sad!        return new TestServer(new WebHostBuilder().UseStartup<TStartup>());    }    protected override void Dispose(bool disposing)     {         base.Dispose(disposing);         if (disposing)         {                _host.Dispose();            }        }}```/cc @javiercn 
4891	area-mvc	Consider caching more delegates in CachedExpressionCompiler 	`CachedExpressionCompiler.CompileFromConstLookup` and `CachedExpressionCompiler.CompileCapturedConstant` produces a new delegate per invocation. In addition, there's other classes of expression that could be possibly cached (e.g. indexer or array accessors). Benefits would include fewer null refs during execution of ModelExpression and possibly faster runtime perf.
5300	area-signalr	Set up alerting and monitoring for performance scenarios	Now that we have long running job support for our benchmarking runs we should add a long running test that is under constant load. The recommendation is creating a custom workload that causes ~50% CPU for the entire duration of the job.
5794	area-identity	Upgrade Identity UI to use 3.2.10 version of jquery unobtrusive scripts	
5793	area-identity	Cannot create a DbSet for 'IdentityUserClaim<string>' because this type is not included in the model for the context	`2.1.0-rc1-final` version throws `Cannot create a DbSet for 'IdentityUserClaim<string>' because this type is not included in the model for the context` exeption on `SignInManager<TUser>.PasswordSignInAsync`:```Microsoft.EntityFrameworkCore.Internal.InternalDbSet<TEntity>.get_EntityType()Microsoft.EntityFrameworkCore.Internal.InternalDbSet<TEntity>.get_EntityQueryable()Microsoft.EntityFrameworkCore.Internal.InternalDbSet<TEntity>.System.Linq.IQueryable.get_Provider()System.Linq.Queryable.Where<TSource>(IQueryable<TSource> source, Expression<Func<TSource, bool>> predicate)Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore<TUser, TRole, TContext, TKey, TUserClaim, TUserRole, TUserLogin, TUserToken, TRoleClaim>.GetClaimsAsync(TUser user, CancellationToken cancellationToken)Microsoft.AspNetCore.Identity.UserManager<TUser>.GetClaimsAsync(TUser user)Microsoft.AspNetCore.Identity.UserClaimsPrincipalFactory<TUser>.GenerateClaimsAsync(TUser user)Microsoft.AspNetCore.Identity.UserClaimsPrincipalFactory<TUser, TRole>.GenerateClaimsAsync(TUser user)Microsoft.AspNetCore.Identity.UserClaimsPrincipalFactory<TUser>.CreateAsync(TUser user)Microsoft.AspNetCore.Identity.SignInManager<TUser>.CreateUserPrincipalAsync(TUser user)Microsoft.AspNetCore.Identity.SignInManager<TUser>.SignInAsync(TUser user, AuthenticationProperties authenticationProperties, string authenticationMethod)Microsoft.AspNetCore.Identity.SignInManager<TUser>.SignInOrTwoFactorAsync(TUser user, bool isPersistent, string loginProvider, bool bypassTwoFactor)Microsoft.AspNetCore.Identity.SignInManager<TUser>.PasswordSignInAsync(TUser user, string password, bool isPersistent, bool lockoutOnFailure)Microsoft.AspNetCore.Identity.SignInManager<TUser>.PasswordSignInAsync(string userName, string password, bool isPersistent, bool lockoutOnFailure)Project.Controllers.AccountController.Login(LoginViewModel model, string returnUrl) in AccountController.cs+ var result = await _signInManager.PasswordSignInAsync(model.Email, model.Password, model.RememberMe, lockoutOnFailure: false);Microsoft.AspNetCore.Mvc.Internal.ActionMethodExecutor+TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, object controller, object[] arguments)System.Threading.Tasks.ValueTask<TResult>.get_Result()Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeActionMethodAsync()Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeNextActionFilterAsync()Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Rethrow(ActionExecutedContext context)Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.Next(ref State next, ref Scope scope, ref object state, ref bool isCompleted)Microsoft.AspNetCore.Mvc.Internal.ControllerActionInvoker.InvokeInnerFilterAsync()Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeNextResourceFilter()Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Rethrow(ResourceExecutedContext context)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.Next(ref State next, ref Scope scope, ref object state, ref bool isCompleted)Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeFilterPipelineAsync()Microsoft.AspNetCore.Mvc.Internal.ResourceInvoker.InvokeAsync()Microsoft.AspNetCore.Builder.RouterMiddleware.Invoke(HttpContext httpContext)Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.StaticFiles.StaticFileMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.MigrationsEndPointMiddleware.Invoke(HttpContext context)Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)Microsoft.AspNetCore.Diagnostics.EntityFrameworkCore.DatabaseErrorPageMiddleware.Invoke(HttpContext httpContext)Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)```Issue does not occur on Windows, but occurs on Linux (both using Kestrel), downgrading to current stable version solves the issue.Failing:```<PackageReference Include="Microsoft.AspNetCore.All" Version="2.1.0-rc1-final" /><PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="2.1.0-rc1-final" />```Passing:```<PackageReference Include="Microsoft.AspNetCore.All" Version="2.0.8" /><PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="2.0.3" />```
4890	area-mvc	IUrlHelper.Link generation from action names	Currently `IUrlHelper.Link` allows for generating absolute URLs when passing to it [route names which must be unique application-wide](https://docs.microsoft.com/en-us/aspnet/core/mvc/controllers/routing?view=aspnetcore-2.0#route-names). This method looks like this: `string Link(string routeName, object values)` and this is currently the only official way when implementing HATEOAS or any hypermedia format.[**This doesn't work when someone works with generic controllers**](https://stackoverflow.com/questions/48633939/route-name-for-httpget-attribute-name-for-base-generic-controller-class-in-asp-n).It would be nice if absolute URL could be generated using action name which should always work even with derived controllers with the same action method names.Currently I solved it with extension defined in my project:```csharppublic static class UrlHelperExtensions{    /// <summary>    /// Generates an absolute URL for the specified <paramref name="actionName"/> and action    /// <paramref name="values"/>, which contains the protocol (such as "http" or "https") and host name from the    /// current request.    /// </summary>    /// <param name="actionName">The name of the action that is used to generate URL.</param>    /// <param name="values">An object that contains action values.</param>    /// <returns>The generated absolute URL.</returns>    public static string LinkAction(this IUrlHelper urlHelper, string actionName, object values)    {        var httpContext = urlHelper.ActionContext.HttpContext;        return urlHelper.Action(new UrlActionContext()        {            Action = actionName,            Protocol = httpContext.Request.Scheme,            Host = httpContext.Request.Host.ToUriComponent(),            Values = values        });    }}```
5923	area-hosting	Remove logging config files in deployers	The apphost.config files for IIS and IISExpress are ~1000 lines long. It bloats the logs significantly whenever there is a failed test. If there were modifications done to the apphost.config, maybe we can print the diff rather than the whole file.
5792	area-identity	Identity errors not displayed properly when using UseStatusCodePagesWithReExecute	When using UseStatusCodePagesWithReExecute, custom error StatusCodes like those found in GenerateRecoveryCodes.cshtml.cs do not display using the route as defined by UseStatusCodePagesWithReExecute  in the startup config.Eg. `return NotFound($"Unable to load user with ID '{_userManager.GetUserId(User)}'.");` Retuning a `StatusCode(404)` without an object displays fine in the custom error layout, but when returned with an object like `StatusCode(404, "Custom message...")`, it's returned as a string result.
4889	area-mvc	Razor tooling broken for ClassLibrary  on Visual Studio for mac	#### Is this a Bug or Feature request?:Bug#### Steps to reproduce (preferrably a link to a GitHub repo with a repro project):Tried with my own project but found the same issue as with the example repo from docs.https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/razor-pages/ui-class/samples/cli#### Description of the problem:When running the project from Visual Studio for Mac or Jetbrains Rider if you try to access the feature page inside the classlib you will get a 404. But if you execute the same code from command line everything works as expected.
5299	area-signalr	Allow more granular control over the ApplicationMaxBufferSize	Today the ApplicationMaxBufferSize is a single setting per server, we should consider a callback model where this can be configured per connection. That would give more control over which connections get to buffer more incoming data than other connections.We could also consider 2 limits:- Anonymous users and Authenticated usersThe default limits are there to protect against unauthenticated users from blowing up server buffers but if users are authenticated the limits might be purely driven by your application. Also, since users are authenticated you have a way to audit and disallow misbehaving users.Related to https://github.com/aspnet/SignalR/issues/2266
5791	area-identity	Issues with Personal Data page (does not delete saved tokens when deleting user)	It looks like the personal data pages were added with the EU GDPR regulations in mind, the pull is here:[https://github.com/aspnet/Identity/pull/1559](https://github.com/aspnet/Identity/pull/1559)However using the dotnet-sdk-2.1.300-rc1 identity scaffolded files, when deleting a user, any saved tokens for the user that are stored in the database table "AspNetUserTokens" are left behind so it is not fully deleting the user and their personal data. The User Claims are correctly deleted from "AspNetUserClaims" table. Not sure about other related tables as i haven't got around to trying out the roles etc.This can easily be fixed by modifying the deletion code in the scaffolded files but really needs to be correct from the start.Another issue is that when downloading personal data, the User Claims are not downloaded from the database, these are relevant as it is personal data that is stored in the database. Obviously if you have a custom user class and have added your own fields then you will need to update the download code to include them, but there is no reason that the claims should not be downloaded by default.Technically any stored 3rd party provider access tokens should also be included in the download as it is still personal data. I think the hashed password of the local login doesn't count as personal data with it being a hash which is irreversible.
5421	area-mvc	Move scaffolding content to from aspnet/scaffolding to aspnet/templating	Here is the equivalent issue in aspnet/scaffolding https://github.com/aspnet/Scaffolding/issues/798(Work needs to be done in both repos).
5524	area-mvc	Namespaces dependent on solution folder name?	- Blazor 0.3.0- VS 2017 15.7.1Created a new solution via PowerShell:```c:\projects\CoolNewProject\ dotnet new blazor```Created a new project in c:\projects\CoolNewProject called CoolNewProject.Normally I like to have my .sln file a directory above my projects, i.e.```c:\projects\CoolNewProject\CoolNewProject.sln```Then throw all of my src in 'src'.```c:\projects\CoolNewProject\src\CoolNewProject.csproj``` and all of my other project files.The second I move everything into the 'src' folder from my newly created Blazor project I can no longer compile:```Error | CS0246 | The type or namespace name 'App' could not be found (are you missing a using directive or an assembly reference?) | CoolNewProject | C:\projects\CoolNewProject\src\Program.cs | 17 | Active```Additionally, none of the Pages can find their namespaces either, i.e.```Error | CS0234 | The type or namespace name 'Shared' does not exist in the namespace 'CoolNewProject' (are you missing an assembly reference?) | CoolNewProject | C:\Projects\CoolNewProject\src\obj\Debug\netstandard2.0\Pages\Counter.g.i.cs | 21 | Active```
5523	area-mvc	Add support for binding decimal, double, float data type with configurable formatting	This should work```HTML<input bind="@price"/>``````C#@functions{    decimal price;}```but currently we get an exception:`Error: System.ArgumentException: 'bind' does not accept values of type System.Decimal. To read and write this value type, wrap it in a property of type string with suitable getters and setters.`Decimal data type is paramount in every business application. We don't want to use "hacks" and convert it to/from string manually every time.Support for formatting is also crucial (number of decimal places, decimal and thousandth separators)
5522	area-mvc	"Attribute 'Format' was matched by multiple bind attributes" error when a Razor component @inherits a BlazorComponent that has a [Parameter]	### Title"Attribute 'Format' was matched by multiple bind attributes" error when a Razor component @inherits a BlazorComponent that has a [Parameter]### Functional impactWon't compile while the BlazorComponent class has a [Parameter]### Minimal repro stepsTest project: https://github.com/vatara/BlazorTest/tree/94ce188e4ff6680778a3781488149af74fa9a212### Expected resultNo error### Actual resultThis compile error:```The attribute 'Format' was matched by multiple bind attributes. Duplicates:BlazorTest.Client.Pages.DateTimeBlazorTest.Client.Display.Elements.DateTime```### Further technical detailsI have a page DateTime that uses @inheritshttps://github.com/vatara/BlazorTest/blob/94ce188e4ff6680778a3781488149af74fa9a212/BlazorTest.Client/Pages/DateTime.cshtmlThe DateTime BlazorComponent it @inherits has a [Parameter] named Formathttps://github.com/vatara/BlazorTest/blob/94ce188e4ff6680778a3781488149af74fa9a212/BlazorTest.Client/Display/Elements/DateTime.cs#L10-L11When a page using component tries to set the [Parameter] it gives the error above:https://github.com/vatara/BlazorTest/blob/6445791d32d329b190448a8ae2cd92cec98fb517/BlazorTest.Client/Pages/Index.cshtml#L7It seems like the [Parameter] is getting counted twice, once on the BlazorComponent and again on the Razor page that @inherits it.It worked fine when I had the BlazorComponent in the Razor .cshtml page instead of inheriting.It also works fine if I don't try to set the [Parameter] or remove it entirely.
5922	area-hosting	Deployers for IIS Express and NGinx should provide default config files	Test sites have boilerplate DeploymentParameters code to run any IIS or Nginx site.```                    ServerConfigTemplateContent = Helpers.GetConfigContent(variant.Server, "Http.config", "nginx.conf"),                    SiteName = "MusicStoreTestSite",```Try bundling these with IntegrationTesting and using them by default if none are provided.
3147	area-tooling	React template index.html caching?	Hi,I seem to be facing a problem when deploying a new build to my server. It seems that index.html is cached by the browser and tries to load the old bundle, which leads to a 404.Any ideas how to fix this?Thanks!
5298	area-signalr	Run automated testing in Xamarin scenarios	The SignalR C# client unit tests should be run on Xamarin iOS and Android to detect bugs that are specific to those runtimes.Example of a C# client bug that is specific to Android: https://github.com/aspnet/SignalR/issues/2232
5790	area-identity	Consider adding overloads of IsInRole(Async) and other methods which accept user id	The old version of ASP.NET Identity had a lot of overloads of different methods that accepted user id instead of user object. In the current version only the User object overloads are left. This forces us to write code like this`UserManager.IsInRoleAsync(new User { Id = userId }, "Admin");`Please consider adding the overloads that accept userId.
5072	area-mvc	Allow Core Razor editor to work in non-project scenarios.	Today if a Razor file is opened outside of the context of a project (diffing two Razor files) there is no IVsHierarchy and therefore no project path or any project information.Our system relies on the idea that a document conceptually has a project; however, this is not true in the diff scenario and technically not true in the ctrl + o scenario for a Razor file (ctrl + o uses old Razor editor today).This crashes VS.
6011	area-middleware	HttpsRedirectionMiddleware will not redirect to HTTPS if no port is available	Discussion for: https://github.com/aspnet/Announcements/issues/301
6009	area-middleware	DI extension methods for configuring HTTPS in Builder namespace	The `AddHttpsRedirection` and `AddHsts` extension methods live in the `Microsoft.AspNetCore.Builder` namespace rather than in usual `Microsoft.Extensions.DependencyInjection` namespace. Is this intentional? See:https://github.com/aspnet/BasicMiddleware/blob/f263e72389fe4468c1c353d2b97ea82704001c31/src/Microsoft.AspNetCore.HttpsPolicy/HstsServicesExtensions.cs#L8-L13https://github.com/aspnet/BasicMiddleware/blob/f263e72389fe4468c1c353d2b97ea82704001c31/src/Microsoft.AspNetCore.HttpsPolicy/HttpsRedirectionServicesExtensions.cs#L8-L13
3137	area-servers	Posting empty file input behaves differently in 2.0 and 2.1	When a form is posted that has an empty file input in it, ASP.NET Core 2.0 represents the value as an `IFormFile` of 0 bytes, while 2.1 represents it as a single empty string value.When the file input has an actual empty file, behaviour is the same (0-byte `IFormFile`).I noticed this when trying to update an existing app. Is this an intentional change in behaviour?# Steps to reproduceCode: https://github.com/chrarnoldus/FileInput* Run `dotnet run`* Go to [localhost:5000](http://localhost:5000) in a browser (I tried Firefox 60.0 and Chrome 66.0)* Click submit (do NOT select a file)When the package version in the project file is set to `2.0.8`, the output is:```file: 0 bytes```which means that there are no entries in `Form`, while there is a single 0-byte entry in `Form.Files`. When the version is `2.1.0-rc1-final`, the output is:```file (1): ''```which means that there is a single entry in `Form`, with a single (empty) value.
3800	area-servers	ANCM Installer Removes Custom Settings	The ANCM installer removes custom settings, such as`<aspNetCore lockAllAttributesExcept="processPath,arguments,stdoutLogEnabled,stdoutLogFile,forwardWindowsAuthToken,disableStartUpErrorPage,hostingModel" />`, from applicationHost.config during installation. Of course, this breaks things. #824
5789	area-identity	Consider using URL safe base64 tokens for email verification instead of URL encoding	As shown in this email verification example, it is required to URL encode the base64 email confirmation token before sending them in an email:https://github.com/aspnet/Identity/blob/47060f5e529ee4b872d9fcf66774935dafb051fc/samples/IdentitySample.DefaultUI/Areas/Identity/Pages/Account/Register.cshtml.cs#L100This works the majority of the time. However, at no fault of our own, there are email providers out there that will still re-encode `%` characters that appear in anchor tags with `%25`, resulting in invalid tokens.For example, `==` (original b64 characters) → `%3D%3D` (correct) → `%253D%253D` (incorrect).This is obviously a bug with the email client itself, but we have come across the case several times with multiple different email clients (for example, mailbox.org will do this).Since this really effects everyone (though most may not have noticed), I would propose that the team here should consider using URL safe base64 strings by default within the framework. This would eliminate the need for us to manually create our own TokenProvider, which we've had to resort to today. URL safe base64 strings are used, for example, in JWT tokens as a standard. Here is some sample code that we use to achieve it:        public static string Base64UrlEncode(byte[] input)        {            var output = Convert.ToBase64String(input)                .Replace('+', '-')                .Replace('/', '_')                .Replace("=", string.Empty);            return output;        }        public static byte[] Base64UrlDecode(string input)        {            var output = input;            // 62nd char of encoding            output = output.Replace('-', '+');            // 63rd char of encoding            output = output.Replace('_', '/');            // Pad with trailing '='s            switch(output.Length % 4)            {                case 0:                    // No pad chars in this case                    break;                case 2:                    // Two pad chars                    output += "=="; break;                case 3:                    // One pad char                    output += "="; break;                default:                    throw new InvalidOperationException("Illegal base64url string!");            }            // Standard base64 decoder            return Convert.FromBase64String(output);        }
5521	area-mvc	bind-value-oninput throws	Currently when we use `<input bind="@myVariable" />` variable is updated when input field looses focus (onchange event is called). Popular requirement in many applications is to implement incremental search. To do this we need:- binding which updates variable after every input field change- throttling - this is necessary if we want to do incremental search on the server or we have a big collection to filter; we should be able to specify a delay in milliseconds and our variable should be updated only after user stops typing for the specified period of timeI believe that throttling can be useful for other events also, for example mouse move, mouse wheel scrolling, etc.
5788	area-identity	Invalid Token Error when hosted on thrid-party Server	var result = await _userManager.ConfirmEmailAsync(user, code);This code will never work and always ends up with "Invalid Token" when hosted from a third-party hosting provider where there is no RDP and where I cannot change any IIS Server Settings. Even if you submit the token manually using a POST instead of GET it will fail. I have used encode/decode and examined the token thoroughly.It works perfectly on the local development machine and always fails on the hosted server.
5520	area-mvc	.cshtml does not accept 'string' for a 'object' type parameter	I've created a button with```[Parameter]public object Content {get;set;}<XButton Content="Click Me !" Clicked="@MyHandler" ref="_button"></XButton>```Visual studio does not recognize 'Content' value, Error:![image](https://user-images.githubusercontent.com/5623089/39875008-98d9ce6e-5499-11e8-8d70-a521ddbf7873.png)
5519	area-mvc	Support binding to <select multiple>, getting/setting the selection as an array	With the following code``` <select name="cars" multiple onchange="@SelectionChanged">        <option value="volvo">Volvo</option>        <option value="saab">Saab</option>        <option value="opel">Opel</option>        <option value="audi">Audi</option>    </select> void SelectionChanged(UIChangeEventArgs e)        {            Console.WriteLine(e.Value);        }```Holding down the ctrl key, if you select 'volvo' first and then any other value, e.value is always 'volvo'. It basically returns the top selected item in the list.
5921	area-hosting	Test deployers leaking processes	Recently I've noticed a lot of orphaned processes after running functional tests in IISIntegration, ServerTests, etc.. There are lots of dotnet.exe and similar left over after the test run.Name	PID	Status	User name	CPU	Memory (private working set)	Command line	Descriptiondotnet.exe	9464	Running	chrross	00 	24,592 K	"dotnet" run --no-restore --framework netcoreapp2.1 -- --server.urls http://localhost:7834/  --server Microsoft.AspNetCore.Server.Kestrel	.NET Core Hostdotnet.exe	30744	Running	chrross	00 	11,604 K	"dotnet" exec "D:\github\AspNet\ServerTests\test\ServerComparison.TestSites\bin\Debug\netcoreapp2.1\ServerComparison.TestSites.dll" --server.urls http://localhost:7827/ --server Microsoft.AspNetCore.Server.Kestrel	.NET Core HostServerComparison.TestSites.exe	5232	Running	chrross	00 	6,704 K	"D:\github\AspNet\ServerTests\test\ServerComparison.TestSites\bin\Debug\net461\ServerComparison.TestSites.exe"  --server.urls http://localhost:8119/ --server Microsoft.AspNetCore.Server.HttpSys	ServerComparison.TestSitesThese appear to be from the self-host deployer.TaskKill doesn't work for getting rid of them, but PsKill does.
5920	area-hosting	On Linux, failing to bind the address on Start generates a coredump	When starting Kestrel on a port that is taken an exception is thrown. e.g.:> System.IO.IOException: Failed to bind to address https://127.0.0.1:5001: address already in useSince this exception is not handled, the runtime calls `abort` which (normally) generates a coredump (see https://github.com/dotnet/coreclr/issues/17929).The behavior seems excessive for failing to bind the port. Maybe there should be a try/catch somewhere to turn this into a non-success process exit?It may not be obvious these coredumps are being generated. And when seeing these dumps on their system, users may get the wrong impression dotnet failed in some bad way.CC @davidfowl @halter73 @mikem8361
3798	area-servers	Drop support for processesPerApplication	There's a fair amount of cruft around the usage of `processesPerApplication`. We should remove it completely and even considering removing this attribute from ANCMv2 schema.
4888	area-mvc	Customize error handling for [ApiController]	#### Is this a Bug or Feature request?:Feature Request / Question#### Steps to reproduce or link to a repro project:```cs[ApiController][Produces("application/json")][Route("api/v1/value")]public class ValueApiController : Controller{    [HttpGet]    public ActionResult<string[]> Get()    {        throw new Exception("bam");    }}```**Startup.cs**```csif (env.IsDevelopment()){    app.UseDeveloperExceptionPage();}else{    app.UseExceptionHandler("/Error");    app.UseStatusCodePagesWithReExecute("/Error");}```#### Description of the problem:When an error occurs in Controller classes marked with `[ApiController]`, I don't want them to return HTML but JSON instead:- In development, instead of Developer Exception Page, ideally the API Controller should return stack trace in plain text / JSON.- In production, instead of a custom HTML error response, ideally the API Controller should return a plain text / JSON with like `"An error occurred while processing your request."`When using Core MVC < 2.1, I have been able to do this by using code like:```csapp.UseWhen(context => context.Request.Path.Value.StartsWith("/api", StringComparison.OrdinalIgnoreCase), builder =>{    builder.UseExceptionHandler(configure =>    {        configure.UseMiddleware<ApiExceptionHandlerMiddleware>(env.IsDevelopment());    });});app.UseWhen(context => context.Request.Path.Value.StartsWith("/api", StringComparison.OrdinalIgnoreCase) == false, builder =>{    if (env.IsDevelopment())    {        builder.UseDeveloperExceptionPage();    }    else    {        builder.UseExceptionHandler("/error");        builder.UseStatusCodePagesWithReExecute("/error");    }});```However, seeing that the purpose of the `[ApiController]` is: (written on the XML doc)> Indicates that a type and all derived types are used to serve HTTP API responses. The presence of this attribute can be used to target conventions, filters and other behaviors based on the purpose of the controller., I would like to know how to alter the error behavior when this attribute is encountered. (Instead of checking whether the request starts with `/api`)#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:```xml<PackageReference Include="Microsoft.AspNetCore.App" Version="2.1.0-rc1-final" />```
4887	area-mvc	[Consumes] and CORS together doesn't work without a spooky workaround	#### Is this a Bug or Feature request?:feature request#### Steps to reproduce or link to a repro project:#### Description of the problem:I'd like to be able to consume either posted JSON or form data at the same endpoint.  As things stand, I get:```fail: Microsoft.AspNetCore.Mvc.Internal.ActionSelector[1]      Request matched multiple actions resulting in ambiguity. Matching actions: :fail: Microsoft.AspNetCore.Server.Kestrel[13]      Connection id "0HLDLB0LJCPJ4", Request id "0HLDLB0LJCPJ4:00000001": An unhandled exception was thrown by the application.Microsoft.AspNetCore.Mvc.Internal.AmbiguousActionException: Multiple actions matched. The following actions matched route data and had all constraints satisfied:```https://andrewlock.net/model-binding-json-posts-in-asp-net-core/ suggests using different endpoints, but I can't do that on this occasionhttps://massivescale.com/web-api-routing-by-content-type/ suggests a way to do it for asp.net; is something like this available in core mvc?His solution looks like:```[ContentTypeRoute("api/test/bytype", "application/json")]or[ContentTypeRoute("api/test/bytype", "application/x-www-form-urlencoded")]``` in Java's JAX-RS for example, there is @Consumes#### Version of `Microsoft.AspNetCore.Mvc` or `Microsoft.AspNetCore.App` or `Microsoft.AspNetCore.All`:<!--                                    --- NOTE ---1.  Try enabling logging (in the most verbose level) and see if the details help you in fixing    the issue you are seeing. Share the logs too if it helps in diagnosing the issue faster.    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging2.  If you are seeing an exception, include the full exceptions details (message and stack trace).    More info: https://docs.microsoft.com/en-us/aspnet/core/fundamentals/error-handling3.  If you believe you have an issue that affects the security of the platform please do    not create an issue, instead email your issue to 'secure@microsoft.com'. Your report may    be eligible for our bug bounty. More info: https://technet.microsoft.com/en-us/mt764065.aspx-->
3824	area-servers	Server.MapPath in AspNetCore	My company's website's (MVC 5) architecture uses a bunch of IIS sub-applications to organize/sub-divide pieces of the site and we have a couple of components that rely on IIS Server.MapPath functionality to figure out what folders those sub-applications are pointed towards.I know this sort of thing isn't exactly a high priority, but is there any chance we might see something along the lines of the .Net Core 2.1 Windows Compatibility pack to help those of us that don't need cross-platform support get back some of these Windows + IIS features?
3123	area-middleware	StaticFiles that return a 404 could use more diagnostic information	_From @csharpfritz on May 5, 2018 16:36_A little diagnostic information when logging a 404 for a static file would be very helpful.Perhaps adding something like "searched in folder '/app/wwwroot/lib/WHATEVER'" would be beneficial to help debug simple configuration errors_Copied from original issue: aspnet/KestrelHttpServer#2549_
3122	area-servers	Unix socket bidding with Owin not working	Hi,I'm trying to use unix socket with Owin and Nancy activated. With the `ListenUnixSocket()` all of my requests return `500` whereas with the standard tcp bidding `Listen()` everything is fine !Here is the stack trace, thanks to `UseDeveloperExceptionPage()`:```   at Microsoft.AspNetCore.Owin.OwinEnvironment.<>c.<.ctor>b__2_50(IHttpConnectionFeature feature)   at Microsoft.AspNetCore.Owin.OwinEnvironment.FeatureMap`1.<>c__DisplayClass2_0.<.ctor>b__0(Object feature)   at Microsoft.AspNetCore.Owin.OwinEnvironment.FeatureMap.TryGet(HttpContext context, Object& value)   at Microsoft.AspNetCore.Owin.OwinEnvironment.System.Collections.Generic.IDictionary<System.String,System.Object>.TryGetValue(String key, Object& value)   at Nancy.Owin.NancyMiddleware.Get[T](IDictionary`2 env, String key)   at Nancy.Owin.NancyMiddleware.<>c__DisplayClass2_1.<<UseNancy>b__1>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.GetResult()   at Microsoft.AspNetCore.Owin.WebSocketAcceptAdapter.<>c__DisplayClass6_0.<<AdaptWebSockets>b__0>d.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.GetResult()```My code that bind the unix socket :```csharp				var host = new WebHostBuilder()					.UseKestrel(k =>					{						k.Listen(IPAddress.Any, port);						if (!string.IsNullOrEmpty(kestrelSocketPath))							k.ListenUnixSocket(kestrelSocketPath);					})					.UseContentRoot(Directory.GetCurrentDirectory())					.UseStartup<Startup>()					.Build();```Any ideas ?Dotnet and owin version --> 2.0.2Nancy --> 2.0.0Thanks.
5518	area-mvc	Invalid XHTML markup causes lockup	Invalid xhtml markup in the form of an unterminated tag causes the CPU to hit 100% and for the page to become completely unresponsive until chrome asks you if you wish to kill the page.```@page "/example"<h5 class="card-title">(some text)</h5><p class="card-text">    (Some text as well)<p class="card-text">   (Some other text)</p>```As seen, the first p tag is not terminated. 
5517	area-mvc	Blazor dev tools browser extension	Other frameworks like [Vue](https://chrome.google.com/webstore/detail/vuejs-devtools/nhdogjmejiglipccpnnnanhbledajbpd) and [Redux](https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd) have some pretty nice dev tools browser extensions. We should consider having a Blazor dev tools browser extension. Potential scenarios:- Inspect components- Update components with live reloading
5420	area-mvc	Create aspnet testing templates	Following up to https://github.com/aspnet/Mvc/issues/7710. We could consider shipping (either OOB or as part of the next SDK release) a template illustrating how to set up a test project for aspnet apps. The difference between this template and the normal test template is an additional reference `<PackageReference Include="Microsoft.AspNetCore.App" />` and changing the SDK from `Microsoft.NET.Sdk` to `Microsoft.NET.Sdk.Web`.
5516	area-mvc	Provide a way to create private Components using Razor syntax	As a Component library creator, I would like to create some components that are used internally only. Currently, you can do that by creating a private class and using the builder to create a component, however it would be great if there were a way to do the same thing using Razor syntax.
5515	area-mvc	JS Interop doesnt handle arrays well	Javscript:```Blazor.registerFunction('BlazorLogger.Logger.Log', function (args) {    if (Array.isArray(args)) {        console["log"].apply(this, args)    } else {        console.log(args);    }    return true;});```C# Interop:```public static void Log(params object[] list){  var _list = new List<object>(list);  RegisteredFunction.Invoke<bool>("BlazorLogger.Logger.Log", _list);}```Note the first line is needed.C# Calling code:```var person = new Person { FirstName = "John", LastName = "Smith" };var message = "Hello, %O, you have been called %i times";for (int i = 0; i < 5; i++){  Logger.Log(message, person, i + 1);}```Without the first line in the interop code `var _list = new List<object>(list);` The output on the console is : `Hello, %O, you have been called %i times`. With the first line the output is as expected:```Hello, ObjectFirstName:"John"LastName:"Smith"__proto__:Object, you have been called 1 times```
3112	area-mvc	Antiforgery : API misleading	`IAntiforgery` - `Task<bool> IsRequestValidAsync(HttpContext httpContext);`If you setup Antiforgery with header name `Foo` and on the client set this value and try a POST/PUT, all is well.On the client then add the header again.What you end up with is a header with that key with two values.Agreed, not what you should do but lets look over that.Send a request and you get:```System.InvalidOperationException: The antiforgery token could not be decrypted. ---> System.FormatException: The input is not a valid Base-64 string as it contains a non-base 64 character, more than two padding characters, or an illegal character among the padding characters.```This is because https://github.com/aspnet/Antiforgery/blob/dev/src/Microsoft.AspNetCore.Antiforgery/Internal/DefaultAntiforgeryTokenStore.cs#L41 pulls out the header as `StringValues` which will have a 2 values. Then passes this to the constructor of `AntiforgeryTokenSet` whose first argument is a string. Converting a `StringValues` to `string` implicitly with more than one value will pull out the first value.  In our case the incorrect value.Further down the stack where it takes this value and calls `IAntiforgeryTokenSerializer.Deserialize` it blows up with the exception not return an expected false.
5071	area-mvc	Syntax for writing a dictionary of attributes onto an element	This issue is being opened by request of @SteveSandersonMS Please see the full issue details https://github.com/aspnet/Blazor/issues/735 in the Blazor Repo.The summary is that will be nice to be able to pass arbitrary attributes from a custom component down to an HTML element. For example:`<MyComponent id="myid" />`in the component render it as:`<button id="myid" />`without having to code every single attribute possible. Not mention allowing attributes such data-* to be passed down. 
5514	area-mvc	Generated __MyComponent class mismatch with 'this' keyword	Consider the following senario:#### _MyComponent.cshtml_```xml<div> My component </div>@functions{             public void override OnInit()         {                 MyHelperClass.InitMyComponent(this);         }}```#### _MyHelperClass.cs_```csharppublic static class MyHelperClass{         public static void InitMyComponent(MyComponent myComponent)         {                   // do stuff here         }}```This code will not compile because, the keyword `this `is referencing the `__MyComponent `generated class. Any workarounds or fixes ?
5513	area-mvc	Make Blazor component library template show up in VS	
5512	area-mvc	Make Blazor component libraries work with autobuild	
5070	area-mvc	Make it easier to use static assets that are part of a RCL project	A RCL project could have static assets like css, js and images. Currently these files don't get published to the referencing application's published `wwwroot` folder. They need to be included as embedded files in a RCL project and need to use `ManifestEmbeddedFileProvider` to serve their contents. Its a lot of work for users to set this up. To give an idea, this is what IdentityUI does currently:https://github.com/aspnet/Identity/blob/dev/src/UI/IdentityDefaultUIConfigureOptions.cs#L50-L66
5069	area-mvc	Referenced RCL project is built even though there are no recent changes to it	Repro:- Create a RP web application- Add a RCL project to the solution | reference this RCL project from the RP application- Build RP application- Update the RCL project's Page1.cshtml's title to something else- Build RP application (this is expected)- Build RP application again (you see that the RCL project is being built again even though there aren't any changes)**Build output (in sequence...check the title for more info):**https://gist.github.com/kichalla/6a099b89d4aad043a3971f3b43b4f157https://gist.github.com/kichalla/a9e9a5eb952f7adde54e568ef79b57c1https://gist.github.com/kichalla/d0f4337bad4137934362566cd436888b**When I enabled Info level logging, I see the following output:**```1>FastUpToDate: Latest write timestamp on input is 5/1/2018 11:18:25 AM on 'C:\Users\kichalla\source\repos\WebApplication28\RCL\Areas\MyFeature\Pages\Page1.cshtml'. (RCL)1>FastUpToDate: Earliest write timestamp on output is 5/1/2018 11:16:45 AM on 'C:\Users\kichalla\source\repos\WebApplication28\RCL\bin\Debug\netstandard2.0\RCL.dll'. (RCL)1>FastUpToDate: Output is newer than input, not up to date. (RCL)1>FastUpToDate: Project is not up to date. (RCL)1>------ Build started: Project: RCL, Configuration: Debug Any CPU ------1>You are working with a preview version of the .NET Core SDK. You can define the SDK version via a global.json file in the current project. More at https://go.microsoft.com/fwlink/?linkid=8694521>RCL -> C:\Users\kichalla\source\repos\WebApplication28\RCL\bin\Debug\netstandard2.0\RCL.dll1>RCL -> C:\Users\kichalla\source\repos\WebApplication28\RCL\bin\Debug\netstandard2.0\RCL.Views.dll2>FastUpToDate: Latest write timestamp on input is 5/1/2018 11:16:45 AM on 'C:\Users\kichalla\source\repos\WebApplication28\RCL\bin\Debug\netstandard2.0\RCL.dll'. (WebApplication28)2>FastUpToDate: Earliest write timestamp on output is 5/1/2018 11:16:52 AM on 'C:\Users\kichalla\source\repos\WebApplication28\WebApplication28\bin\Debug\netcoreapp2.1\WebApplication28.dll'. (WebApplication28)2>FastUpToDate: Latest write timestamp on input marker is 5/1/2018 11:18:30 AM on 'C:\Users\kichalla\source\repos\WebApplication28\RCL\obj\Debug\netstandard2.0\RCL.csproj.CopyComplete'. (WebApplication28)2>FastUpToDate: Write timestamp on output marker is 5/1/2018 11:16:57 AM on 'C:\Users\kichalla\source\repos\WebApplication28\WebApplication28\obj\Debug\netcoreapp2.1\WebApplication28.csproj.CopyComplete'. (WebApplication28)2>FastUpToDate: Input marker is newer than output marker, not up to date. (WebApplication28)2>FastUpToDate: Project is not up to date. (WebApplication28)2>------ Build started: Project: WebApplication28, Configuration: Debug Any CPU ------2>WebApplication28 -> C:\Users\kichalla\source\repos\WebApplication28\WebApplication28\bin\Debug\netcoreapp2.1\WebApplication28.dll2>WebApplication28 -> C:\Users\kichalla\source\repos\WebApplication28\WebApplication28\bin\Debug\netcoreapp2.1\WebApplication28.Views.dll========== Build: 2 succeeded, 0 failed, 0 up-to-date, 0 skipped ==========```Notice the following block...can it say 'Latest write timestamp' on both these lines? and also it should be input is newer than output?1>FastUpToDate: **Latest** write timestamp on input is 5/1/2018 11:18:25 AM on 'C:\Users\kichalla\source\repos\WebApplication28\RCL\Areas\MyFeature\Pages\Page1.cshtml'. (RCL)1>FastUpToDate: **Earliest** write timestamp on output is 5/1/2018 11:16:45 AM on 'C:\Users\kichalla\source\repos\WebApplication28\RCL\bin\Debug\netstandard2.0\RCL.dll'. (RCL)1>FastUpToDate: **Output is newer than input, not up to date.** (RCL)1>FastUpToDate: Project is not up to date. (RCL)cc @pranavkm 
5181	area-mvc	New Angular Spa Template Typescript Errors in Definitions	The latest version of the ASP.NET SPA template seems to cause un-resolvable typescript errors with the latest version of visual studio. This template flags multiple definition files. See attached screen shot.![image](https://user-images.githubusercontent.com/1992395/39476726-fd6cf48a-4d2a-11e8-98f7-217c8214cd55.png)
5419	area-mvc	Bring back "Cloud-Single Organization" templates	For on-premises ADFS, both WS-Fed and ODIC (so we'd need to discover what version of ADFS they're running)From https://github.com/aspnet/Home/issues/3107
5511	area-mvc	Allow coder to specify BindingFlags in JsonUtil	I want my state to be read-only, but I also need to be able to serialise/deserialise that state using JsonUtil. As they have private setters these properties are not being set.Please could you add a BindingFlags parameter to the Deserialize() method which will allow me to tell it to set properties with private setters? 
3106	area-mvc	CORS security: reflecting any origin header value when configured to *  is dangerous	When CORS policy is configured to `WithOrigins("*")`, asp.net CORS will actively convert it to reflect any Origin header value. This kind of behavior is dangerous and has caused many security problems in the past.Some similar security issues:[cyu/rack-cors#126](https://github.com/cyu/rack-cors/issues/126)[https://nodesecurity.io/advisories/148](https://nodesecurity.io/advisories/148)Some related blog posts:[https://ejj.io/misconfigured-cors/](https://ejj.io/misconfigured-cors/)[http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html](http://blog.portswigger.net/2016/10/exploiting-cors-misconfigurations-for.html)
5510	area-mvc	Route segments are not decoded	### TitleRoute segments are not decoded### Functional impactSpaces, non-ASCII characters, or other unsafe characters will not work properly inside URLs out of the box.This impacts routes such as ````@page "/ブラゾル" ````, or any route parameter that would contain unsafe characters.### Minimal repro steps1. Create a new Blazor application2. Create a page like this one:````@page "/wiki/{topic}"<p>@Topic</p>@functions {    public string Topic { get; set; }}````3. Start the application and navigate to "/wiki/déjà vu" in your Browser### Expected resultI expect the page to display "déjà vu"### Actual resultInstead, I see "d%C3%A9j%C3%A0%20vu"### Further technical detailsI tested this on Chrome 65 and Firefox 59.It seems that the simplified parsing implementation in [RouteContext](https://github.com/aspnet/Blazor/blob/dev/src/Microsoft.AspNetCore.Blazor/Routing/RouteContext.cs) could easily be improved for handling this scenario.I'm ok with providing a PR for this, if needed.
5787	area-identity	Migration Table name override not honored	_From @snovak7 on April 27, 2018 20:25_First I create my custom DbContext```c#public class DbContext :     IdentityDbContext<User, Role, Guid, UserClaim, UserRole, UserLogin, RoleClaim, UserToken> {}```My User looks like this```c#[Table("MyCustomUser", Schema = "users")]    public class User : IdentityUser<Guid> {}```I setup environment that I can generate my migration code.For the test case I included Schema, which worked...```c#            migrationBuilder.CreateTable(                name: "AspNetUsers",                schema: "users",``````c#                    b.ToTable("AspNetUsers","users");```### Further technical detailsEF Core version: 2.0.2-rtmDatabase Provider: Microsoft.EntityFrameworkCore.SqlServer, Npsql.EntityFrameworkCore.PostgreSQLOperating system: MacOS High Sierra 10.13.4IDE: dotnet cli for Migrations, Visual Studio Enterprise 2017 for Mac (Preview)Version 7.5 Preview (7.5 build 1222)_Copied from original issue: aspnet/EntityFrameworkCore#11843_
3104	area-mvc	Enhancement to JsonPatch to provide a comparison method which compares two objects and returns a JsonPatchDocument	Would you consider a pull request to implement this? I was thinking the API would be a static method like     /// <summary>    /// Compares two objects and returns a JsonPatchDocument describing the changes    /// </summary>    /// <param name="original">original object</param>    /// <param name="modified">modified object</param>    /// <returns></returns>    public static JsonPatchDocument CreatePatch(object original, object modified)called like so:     JsonPatchDocument patch = JsonPatchDocument.CreatePatch(originalObject, modifiedObject);
5297	area-signalr	Call Access Token Factory once and cache the result until a 401 occurs	To improve the ability to "refresh" expired tokens, we should consider caching the access token provided by the factory. Then, when an HTTP request gets a `401`, we call the factory again before re-issuing the request. That way the user can configure a process to "refresh" the token without forcing the connection to be reestablished* For the WebSockets transport, this has no effect. There is only ever a single request. This logic would **not** cover reconnecting in the event of something like #1159 (where the WebSocket is terminated when the token expires)* For the SSE transport, this only affects `POST` (send) requests. We would call the token factory again and re-issue the send. The unsent data would stay buffered in the pipe* For Long Polling, this affects `POST` requests like SSE, and the `GET` (poll) requests. The client would assume that a `401` error indicates that the data is **still in the pipe** for them to read. The server would be expected to keep data in the pipe in the case of a `401`
6008	area-middleware	Consider a new middleware for the simple security headers.	Inspired by https://github.com/aspnet/templating/issues/497- X-Content-Type- X-Frame-Options- X-XSS-ProtectionBut not Content-Security-Policy because that's very app dependent to be on by default, and never ever public-key-pins because that's going away because it sucked.
5418	area-mvc	'x-content-type-options' header is not specified	default ASP.NET Core Web Application using Kestrel- `<script src="/lib/bootstrap/dist/js/bootstrap.js"></script>`- `<link rel="stylesheet" href="/css/site.css">`- `<link rel="stylesheet" href="/lib/bootstrap/dist/css/bootstrap.css">`- `<script src="/lib/jquery/dist/jquery.js"></script>`- `<script src="/js/site.js?v=ji3-IxbEzYWjzzLCGkF1KDjrT2jLbbrSYXw-AhMPNIA"></script>`[Require `X-Content-Type-Options` HTTP response header](https://sonarwhal.com/docs/user-guide/rules/rule-x-content-type-options/)
3099	area-middleware	JavaScript content-type should be "text/javascript" instead of "application/javascript" and should contain charset=utf-8	[The WHATWG recommendation is to use `text/javascript`](https://html.spec.whatwg.org/multipage/infrastructure.html#dependencies)![image](https://user-images.githubusercontent.com/606594/39325448-10fa2c94-4947-11e8-9452-9edc83aeb7c0.png)Also, text based resources should contain `charset=utf-8` (if they are in `utf-8` which should be the case):* [make sure things render correctly](https://www.w3.org/International/questions/qa-what-is-encoding)* prevent the browsers from going down more complicated paths to guess what's the right charset of the fileThere's more documentation in [this documentation](https://sonarwhal.com/docs/user-guide/rules/rule-content-type/)
5068	area-mvc	[Razor Sdk]: Consider not setting PreserveCompilationContext in class library projects	Related issue: https://github.com/dotnet/cli/issues/9135. We set PreserveCompilationContext=true for all project types in the Razor.Sdk. This results in an `refs` directory to be created in the build output directory which is undesirable. We should consider setting PreserveCompilationContext=true only if the app's an executable. 
3093	area-middleware	UseStaticFiles with [ or ] gives error 404	_From @fredriksknese on April 25, 2018 15:1_In my Configure I have added ```app.UseStaticFiles(new StaticFileOptions() { RequestPath = "/archive", FileProvider = new PhysicalFileProvider("e:\\") });app.UseDirectoryBrowser(new DirectoryBrowserOptions() { FileProvider = new PhysicalFileProvider("e:\\"), RequestPath = "/archive" });```and it works. When I then browse to http://localhost:5000/archive/ it shows the files and I can click to view all files except files that contain ```[``` and ```]```. It handles spaces and åäö (swedish characters) perfectly.In console it prints```info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET http://localhost:57205/archive/%5BWindows%5D%20tor.dockerinfo: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 1.1952ms 404```I'm using Microsoft.AspNetCore.All version ```2.0.6``` and TargetFramework ```netcoreapp2.0```_Copied from original issue: aspnet/AspNetKatana#197_
5509	area-mvc	Not able to use Layouts in nested sub-folders	Hi team,I tried to use the layouts in nested "Shared" sub-folder but not able to use, the site will freeze once you access to the subpages. Please help advise.![image](https://user-images.githubusercontent.com/3785721/39239777-26af1b80-48ac-11e8-96e5-3704ddbf0122.png)Thanks.
3806	area-servers	Expose IHttpResponse::SuppressHeaders	In some advanced scenarios, user may want to write raw http response. IIS API SuppressHeaders allows users to remove all http headers. https://msdn.microsoft.com/en-us/library/ms689172(v=vs.90).aspx
4886	area-mvc	Plugin System—Providing PartialViewResult with no Model	Could be related:https://github.com/aspnet/Mvc/issues/6984https://github.com/aspnet/Home/issues/343https://github.com/aspnet/Mvc/issues/4572#issuecomment-216351033What about providing `RenderPartialAsync/RenderPartialCoreAsync` versions without `object model, ViewDataDictionary viewData`?Coupled with Application Parts, we would have, out of the box, everything ready to add a Plugin System.(Each Plugin with its own MVC, embedded in the "webapp-host" pages.)
5919	area-hosting	Startup assembly StartupBootstrapper failed to execute	Im getting this error in my logs currently:2018-04-23 18:10:25.818 +00:00 [Fatal] Hosting startup assembly exceptionSystem.InvalidOperationException: Startup assembly StartupBootstrapper failed to execute. See the inner exception for more details. ---> System.IO.FileNotFoundException: Could not load file or assembly 'StartupBootstrapper, Culture=neutral, PublicKeyToken=null'. The system cannot find the file specified.   at System.Reflection.RuntimeAssembly._nLoad(AssemblyName fileName, String codeBase, Evidence assemblySecurity, RuntimeAssembly locationHint, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, Boolean suppressSecurityChecks, IntPtr ptrLoadContextBinder)   at System.Reflection.RuntimeAssembly.InternalLoadAssemblyName(AssemblyName assemblyRef, Evidence assemblySecurity, RuntimeAssembly reqAssembly, StackCrawlMark& stackMark, IntPtr pPrivHostBinder, Boolean throwOnFileNotFound, Boolean forIntrospection, IntPtr ptrLoadContextBinder)   at System.Reflection.Assembly.Load(AssemblyName assemblyRef)   at Microsoft.AspNetCore.Hosting.WebHostBuilder.BuildCommonServices(AggregateException& hostingStartupErrors)   --- End of inner exception stack trace ---Im using the following version of microsoft.aspnetcore:\.nuget\packages\microsoft.aspnetcore\2.0.1\lib\netstandard2.0\Microsoft.AspNetCore.dllAm i missing something or is this a known bug? Im hosting this in an Azure App Service.
5508	area-mvc	Generate definition files for blazor.js	We should generate d.ts files for our javascript component and publish them to typings or somewhere similar. @SteveSandersonMS am I missing something here?I want to be able to reference blazor.d.ts from a ts file and access to everything in a strongly typed way.
5507	area-mvc	Events inside ChildContent are being dispatched to incorrect component	Repro:```html<NavLink href="/">    <button onclick="@(_ => { Console.WriteLine("Hello"); })">Click me</button></NavLink>```Clicking the button fails with *The component of type Microsoft.AspNetCore.Blazor.Routing.NavLink cannot receive events because it does not implement Microsoft.AspNetCore.Blazor.Components.IHandleEvent.*.The event should be dispatched to the owner component, not to the `NavLink`.In most cases it's currently possible to work around this by calling `StateHasChanged` inside the event handler delegate, because any component that inherits `BlazorComponent` does implement `IHandleEvent` and handles events by invoking the supplied delegate. But that workaround doesn't work when the event-receiving component doesn't implement `IHandleEvent`, and in general it's still wrong because you shouldn't have to do this.**Possible solution**The intent is for events to be dispatched to the component whose code declares the event handler, not the component whose rendering logic added it to the RenderTree.We could change the signature of `BindMethods.GetEventHandlerValue<T>(value)` to `BindMethods.GetEventHandlerValue<T>(IComponent target, value)` (for each of the `value` type overloads). Then we change the Razor compiler to supply the value `this` for `target`, hence we've captured a `target` value matching the component whose code contains the actual `onevent=...` syntax. In typical cases where the delegate represents an instance method, the lambda already captures `this` so this change wouldn't trigger any more allocations than we already do.Then, the overloads of `GetEventHandlerValue` that return `MulticastDelegate` could be changed to return some new `struct`, `ComponentEventDelegate` that has two properties: `IComponent target` and `MulticastDelegate delegate`.Then we'd change `RenderTreeBuilder`'s `AddAttribute` so that it has an explicit overload for `ComponentEventDelegate` instead of ones for `MulticastDelegate`. Inside that overload, we do the same logic that we used to for `MulticastDelegate`, but on the resulting `RenderTreeFrame`, we also store information about the target component. (To fit into the existing `RenderTreeFrame` memory layout, we might want to locate and store the target component's **id** here rather than a pointer to the actual instance, since pointers are 8-bytes, and we only have 4 bytes spare without expanding the size of a frame).Then, we change the `AssignEventHandlerId` logic (and data storage) so that it stores the target component ID on the `_eventHandlersById` dictionary entry as well as the delegate itself.Finally we can remove the whole notion of specifying a component ID during the event dispatching process. It will only be necessary to specify the `eventHandlerId`, and the `Renderer` code will be able to find the correct target component from that alone.
5786	area-identity	stay logged in for longer than 30 minutes - why is this so confusing - can anyone help?	Hello.  So there's a ton of information regarding cookies and expiration, and the ticket vs the cookie containing the ticket.  I get that.I just need my users to be able to stay logged in, for let's say for 8 hours, if they choose "remember" me, which then gets passed to signinmanager.signinasync().  My "cookie" shows 2 weeks of life in the browser .. which I believe this is from the options.expiretimespan property.  I'm ok with this.I just do not understand from other articles and logged issues how to allow that 14 day cookie to actually contain "something" (need the term please) that allows them to close the browser, re-open it in 4 hours, and have to log back in because of a 401.  What is the term i am looking for, and where can I set it to make their "credentials via the cookie" value say for 4 hours.  4 hours is probably a good example.From more reading today -- it looks like i could maybe accomplish this by calling SignInAsync and CheckPasswordSignInAsync, instead of PasswordSignInAsync, for the sole reason of passing AuthenticationProperties containing an ExpiresUtc on the auth ticket.I hope this is not the case, but it's extremely confusing how I make the auth good for any length of time.  Please help.
5506	area-mvc	[PROPOSAL] Support DOM properties binding as HTML attribute.	A DOM object has attributes (set by HTML attributes) and properties, set or get by dot notation in DOM object.An example:```// HTML<input id="name" value="Monty" />// Assume I render the page and change the content of textbox from Monty by Anna.// JavaScriptvar name = document.getElementById("name");name.getAttribute("value"); // Montyname.value; // Anna```As see, the value of the attribute is not the same than the property.Because the text of textbox rendered by `input` tag is in the property and not in the HTML attribute, if we bind the attribute and change the value of the bound field, nothing occurs in rendered textfield.```<input value"@Name" id="name" />@functions{    public string Name = "Monty";} ```If we use value instead of bind attribute, if `Name` field change, nothing is reflected in rendered textfield.I propose a syntax to bind field to DOM property.An possible example:```<input $value="@Name" />```This syntax, bind `Name` field to DOM property instead of HTML attribute.Why?- Consistency, instead of new attribute called `bind`, you know what is binding really.- Some webcomponents, use new properties, for example:```// HTML<my-calendar id="calendar" />// JavaScriptvar calendar = document.getElementById("calendar");calendar.day; // 13calendar.month; //4calendar.year; // 2017calendar.value; // undefined```In this case, I can't use `bind` attribute, but I can do:```<my-calendar $day="Day" $month="Month" $year="Year" />@functions{    public int Day { get; set; }    public int Month { get; set; }    public int Year { get; set; }}```
5296	area-signalr	C# client Stop can take a while if it spams Sends then tries to Stop	```while (someCondition == false){    _ = hubConnection.SendAsync("Ping");}// Takes a long time to completehubConnection.StopAsync();// orhubConnection.DisposeAsync();```The `SendAsync`'s are all waiting on a lock and when `StopAsync/DisposeAsync` tries to run it waits on the same lock. And I've observed it taking over a minute for the Stop/Dispose to finish
4653	area-security	UseAuthorization middleware	UseAuthentication runs in the pipeline and automatically applies the default authentication handler. There is no corrilary for authorization. This would be useful for scenarios like authorized static files:https://github.com/aspnet/AuthSamples/issues/28.UseAuthorization should have parameters that mimic the Authorize attribute. Failing any parameters, it should run the default policy (which is hard to do yourself https://github.com/aspnet/Security/issues/1733).Here's the minimal AuthN code you have to write today and it doesn't run any policy:https://github.com/aspnet/AuthSamples/blob/c7bb6607307072f6e098d0e4a2c9fa7e6d017916/samples/StaticFilesAuth/Startup.cs#L120-L134
5417	area-mvc	Enable docker feature for SPA templates	Currently when you create a new Angular/React project, the *Enable Docker support* option is disabled because the template config doesn't declare support for that.We should implement support for this. AFAIK it should be able to work the same way as other ASP.NET templates.
5067	area-mvc	Build server pid files should be properly cleaned up when the process is killed on Unix	More context here https://github.com/aspnet/Razor/pull/2285#discussion_r182893605
6019	area-identity	Get access token	Following this [azure-sample](https://github.com/Azure-Samples/active-directory-b2c-dotnetcore-webapp) I'm able to retrieve access_token and sent it to B2C secured webapi.Have you planned this feature in this library?
5785	area-identity	UserManager.FindByNameAsync doesn't get roles [QUESTION]	I recently just migrated my .NET Core 1.1.4 app over to .NET Core 2. Everything builds and compiles, but my identity stuff are all messed up. When I do a call to `UserManage.FindByNameAsync(email)`, The correct user is found. However, his role count is 0.I read somewhere that Net Core 2 no longer eager/lazy loads. I'm still new to .NET Core environment and have been put in the deep end. How would I work around this to get the UserManager to work again? It used to work fine in .NET Core 1.1
5505	area-mvc	Can't change folder structure of Blazor (ASP.NET Cloud hosted) template	I was playing around with the project structure and was seeing how far I could go before I broke it and that took no time at all.So the default template produces a folder structure like ```WebApplication1├── WebApplication.sln├── WebApplication1|   ├── WebApplication1.Client|   ├── WebApplication1.Server|   └── WebApplication1.Shared```I am trying to make the folder structure look like this```WebApplication1├── WebApplication.sln├── Client├── Server└── Shared```What I have ended up with is...```WebApplication1├── WebApplication.sln├── WebApplication.Client├── Server└── Shared```For some weird reason when I try to change `WebApplication.Client` to just `Client` the client stops compiling. I can commit my code to GitHub with the before and after if you would like. I am guessing this is breaking some convention that I am not aware of and would love to know what that is. 
5504	area-mvc	Support chained 'bind' on components	I must be doing something wrong.Made this component:```<div>    <input bind="@myValue" /></div>@functions{    public string myValue { get; set; }    public Action<string> myValueChanged { get; set; }}```And use this in a page like this:```<input bind="@Test" /><br /><myInput bind-myValue="@Test"></myInput><br />test: @Test@functions {    public string Test { get; set; }}````Now I expect that typing in either input on this page would result in the same values in both inputs. But this seems to work only one-way: from the input to the control and not the other way around.This is supposed to work right? What am I doing wrong? # Note (from @SteveSandersonMS)I expect fixing this will also fix #1490. Any proposed fix for this issue should also be checked to verify it accounts for the scenarios raised at #1490, and if it doesn't we'll reopen #1490 as a separate issue.
5295	area-signalr	Wildcards in MapHub path	Hi, we've just upgraded to preview2 as we've been having issues with websocket connections not closing properly on disconnects/reconnects when interacting with an azure webapp. In the alpha2 build I could specify an url as {tenant}/hub with the {tenant} part serving as a wildcard that would respond to tenant1/hub, dude1/hub etc.This was useful for us as we're storing authentication specific cookies on each tenant path. If we were to be using a generic /hub map, onConnected will no longer resolve the user.identity correctly (as auth cookies are not present for this path).Is there a way with preview2 to replicate the previous functionality?Thank you, and great job on what you are doing with this project :) 
5784	area-identity	ASP.NET Identity Core 2.0 - Expiration phone token	One of the methods exposed by UserManager is GenerateChangePhoneNumberTokenAsync.Looking to the code, I noticed that the method mentioned is calling Rfc6238AuthenticationService.GenerateCode. It seems to me that the lifetime of the token is hardcoded to 3 minutes as showed bellow.```private static readonly TimeSpan _timestep = TimeSpan.FromMinutes(3);        // More info: https://tools.ietf.org/html/rfc6238#section-4        private static ulong GetCurrentTimeStepNumber()        {            var delta = DateTime.UtcNow - _unixEpoch;            return (ulong)(delta.Ticks / _timestep.Ticks);        }        // More info: https://tools.ietf.org/html/rfc6238#section-4        private static ulong GetCurrentTimeStepNumber()        {            var delta = DateTime.UtcNow - _unixEpoch;            return (ulong)(delta.Ticks / _timestep.Ticks);        }        public static int GenerateCode(byte[] securityToken, string modifier = null)        {            if (securityToken == null)            {                throw new ArgumentNullException(nameof(securityToken));            }            // Allow a variance of no greater than 9 minutes in either direction            var currentTimeStep = GetCurrentTimeStepNumber();            using (var hashAlgorithm = new HMACSHA1(securityToken))            {                return ComputeTotp(hashAlgorithm, currentTimeStep, modifier);            }        }```Source: https://github.com/aspnet/Identity/blob/85f8a49aef68bf9763cd9854ce1dd4a26a7c5d3c/src/Core/Rfc6238AuthenticationService.csAm I correct? Is this the lifetime of the phone token?If yes, since the value is hardcoded, any ideas how to change it?
5503	area-mvc	Can't set custom 'value' attribute for a checkbox	The following code in .html file works but not in a page (.cshtml)```<fieldset>  <legend>Choose your interests</legend>  <div>    <input type="checkbox" id="coding" name="interest" value="coding" checked>    <label for="coding">Coding</label>  </div>  <div>    <input type="checkbox" id="music" name="interest" value="music">    <label for="music">Music</label>  </div></fieldset>```
5066	area-mvc	Improve the experience for generated delarations	Today Razor doesn't have a good way to map lines for declarations (model type, class declaration, `@inject`'ed properties).The effect of this is that errors in declarations (such as missing a using) won't map to a line in the original source code. Clicking on the error in the error list won't take you to the source file.We have a pretty good experience and coverage for errors in expressions and code blocks, but we haven't needed to solve this problem before for declarations.----We need to come up with a strategy for improving the test coverage of this area first, so we can use our existing integration tests, and know which cases where the user typed code that doesn't get line-mapped. All of these are potential errors that don't take you to the source file.
4655	area-security	SameSite default value update	According to https://github.com/hapijs/bell/pull/355 (which I found as it links to https://github.com/aspnet/Security/issues/1231) chrome > v65 has fixed their samesite behavior to be in line with other browsers. This should allow `SameSite.Strict` in a few cases again.I haven't tested this but I do think it's important to see if the default security can be increased again.
5918	area-hosting	Parent Request Id is mislabeled as Correlation Id in log scope	For the upcoming for ASP.Net Core 2.1; pull #1138 added to the log scope a `CorrelationId`, but the contents are only the parent request identifier and does not appear to be set if there was no parent request (no `Request-Id` header in the incoming HTTP request).There is documentation/specifications (mostly by @lmolkova) around these terms at:* [HttpCorrelationProtocol](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/HttpCorrelationProtocol.md)* [FlatRequestId](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/FlatRequestId.md)* [HierarchicalRequestId](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/HierarchicalRequestId.md)Specifically in the [Activity User Guide](https://github.com/dotnet/corefx/blob/master/src/System.Diagnostics.DiagnosticSource/src/ActivityUserGuide.md), it says:> When application calls external dependency to complete an operation, it may need to pass some of the context (e.g. ___correlation id___) [emphasis added] along with dependency call to be able to correlate logs from multiple service.I see that the expectation is that in the logs, there will be a "correlation id" of the context, or `CorrelationId` if you will, that can be used to link the logs entries across multiple services handling a single user request.In the current preview code, the Log scope outputs a `CorrelationId` which is the value of an incoming header `Request-Id`, and only if that header is set.  This is not useful for seeing the entire request across multiple services in the logs.  What is needed is adding to the log scope the root request id to the log scope of all services involved in handling the request, including within the root service that generated the first request id.
5783	area-identity	AuthenticationMethod for 2FA	I wonder if the the `SignInManager.DoTwoFactorSignInAsync` should be adding an explicit `AuthenticationMethod` to the `SignInMAnager.SignInAsync` call to indicate that the login used 2FA.Currently, it is difficult for an application using aspnet Identity to determine, whether 2FA was used during the sign in. The `amr` claim contains only `password`, regardless of whether the login was 1FA or 2FA.
3058	area-mvc	SetDoNotCacheHeaders overwrites cache headers	Following on from https://github.com/aspnet/Home/issues/2414I do not believe this issue is considered closed as I have situations that require "Cache-Control: private, no-cache, no-store, max-age = 0, must-revalidate"  and it is being overridden by the default CSRF token implementation.Is there any desire to update this for 2.1 to allow control over this?
6018	area-identity	Issue with build using ASPNET.CORE 2.1.0-preview2	I'm receiving the following issue when building a ASP.NET Web Application with AzureADB2C System.IO.FileNotFoundException HResult=0x80070002  Message=Related assembly 'Microsoft.AspNetCore.Authentication.AzureADB2C.UI.Views' specified by assembly 'Microsoft.AspNetCore.Authentication.AzureADB2C.UI' could not be found in the directory C:\Users\...\source\repos\WebApplication\WebApplication\bin\Debug\netcoreapp2.1. Related assemblies must be co-located with the specifying assemblies.  Source=Microsoft.AspNetCore.Mvc.Core  StackTrace:   at Microsoft.AspNetCore.Mvc.ApplicationParts.RelatedAssemblyAttribute.GetRelatedAssemblies(Assembly assembly, Boolean throwOnError, Func`2 fileExists, Func`2 loadFile)   at Microsoft.AspNetCore.Mvc.ApplicationParts.RelatedAssemblyAttribute.GetRelatedAssemblies(Assembly assembly, Boolean throwOnError)   at Microsoft.AspNetCore.Authentication.AzureADB2CAuthenticationBuilderExtensions.<GetAdditionalParts>d__7.MoveNext()   at Microsoft.AspNetCore.Authentication.AzureADB2CAuthenticationBuilderExtensions.<>c__DisplayClass6_0.<AddAdditionalMvcApplicationParts>b__1(ApplicationPartManager apm)   at Microsoft.Extensions.DependencyInjection.MvcCoreMvcBuilderExtensions.ConfigureApplicationPartManager(IMvcBuilder builder, Action`1 setupAction)   at Microsoft.AspNetCore.Authentication.AzureADB2CAuthenticationBuilderExtensions.AddAdditionalMvcApplicationParts(IServiceCollection services)   at Microsoft.AspNetCore.Authentication.AzureADB2CAuthenticationBuilderExtensions.AddAzureADB2C(AuthenticationBuilder builder, String scheme, String openIdConnectScheme, String cookieScheme, String displayName, Action`1 configureOptions)   at Microsoft.AspNetCore.Authentication.AzureADB2CAuthenticationBuilderExtensions.AddAzureADB2C(AuthenticationBuilder builder, Action`1 configureOptions)   at WebApplication.Startup.ConfigureServices(IServiceCollection services) in C:\Users\...\source\repos\WebApplication\WebApplication\Startup.cs:line 28
5502	area-mvc	Wrap requestAnimationFrame as OnRender interface	I would like to propose interface or virtual function that wrap around `requestAnimationFrame` functionBecause `requestAnimationFrame` should be called only once at a time and triggered only when any data was changed. So it would be great if the framework would wrap and manage this function instead of us using it directlyIt could be that we would have interface contain `void OnRender()`. And whenever the data was changed it would trigger the `requestAnimationFrame` to call all `OnRender` in the listIf possible, I think every component should run on this render callback instead of the main thread
5294	area-signalr	What should HubConnection.StopAsync cancellation token do?	https://github.com/aspnet/SignalR/pull/2000#discussion_r181334729> Not sure yet. Need to look deeper. Maybe we need to pass it to DisposeAsync or use it from the outside to cancel dispose. But we can just not support it for now. File an issue.
5065	area-mvc	IR Lowering tests should pass the design time options properly	Follow up to #2273. Now that we have switched over to using RazorProjectEngine in tests which doesn't differentiate Runtime and designtime engine, we should update our test infrastructure to be consistent with that. Example, https://github.com/aspnet/Razor/blob/b732f8013e377b0bca976e392cc687ba5927d4cc/test/Microsoft.AspNetCore.Mvc.Razor.Extensions.Test/ModelDirectiveTest.cs#L319.
5415	area-mvc	Update project templates to use LibMan	LibMan now ships in VS 15.7. It will soon be followed by a CLI tool that will enable it for cmd line scenarios. When that happens, we need to update the templates to use LibMan for managing client dependencies. This will involve including a `libman.json` file in the root of the projects, configured to bring in the required client libs (jQuery, jQuery Validate, jQuery Validation Unobtrusive, and Bootstrap).Note this is blocked on getting confirmation from @ChrisSfanos RE approval/requirements for using cdnjs as the configured source in VS and templates.
5782	area-identity	Figure out how to protect login provider key	We were unable to do this in 2.1 due to key rotation issues.Potential solns: Modify the scheme or make changes to the value converters to allow passing context ("the key to use")@ajcvickers do you want me to file a bug in EF about value converter changes?
5781	area-identity	Use partial tag helper in Identity UI	Use partial tag helper instead of @Html.Partial in Identity UI razor pages. Eg:https://github.com/aspnet/Identity/blob/dev/src/UI/Areas/Identity/Pages/Account/Manage/Disable2fa.cshtml#L8
4656	area-security	[ASPNET Core 2.0]Authorization Policy ignoring Authentication	_From @allevyMS on April 11, 2018 17:10_I am trying to set up authentication and authorization but I am seeing unexpected behavior.I am running an ASPNET Core 2.0 app on windows (tried this on windows 10 and in a docker container  with the following image 2.0.6-sdk-2.1.104-nanoserver-sac2016) and I have my authentication and authorization set up like this:using Nuget package: Microsoft.AspNetCore.All 2.0.0 and also tried with 2.0.6        public void ConfigureServices(IServiceCollection services)        {            services.AddAuthorization(options =>            {                options.AddPolicy("Test", policy =>                {                    policy.Requirements.Add(new TestRequirement());                });            });            services.AddSingleton<IAuthorizationHandler, TestAuthorizationHandler>();            services.AddMvc();            services.AddAuthentication(JwtBearerDefaults.AuthenticationScheme)                .AddJwtBearer();            services.AddSingleton<IConfigureOptions<JwtBearerOptions>>(sp =>            {                return new ConfigureNamedOptions<JwtBearerOptions>(                    JwtBearerDefaults.AuthenticationScheme,                    options =>                    {                        options.TokenValidationParameters = new TokenValidationParameters                        {                            RequireSignedTokens = true,                            ValidateIssuer = false,                            ValidateAudience = false,                            ValidateLifetime = true,                            IssuerSigningKey = rsaSecurityKey                        };                    });            });        }        public void Configure(IServiceProvider sp, IApplicationBuilder app, IHostingEnvironment env, ILoggerFactory loggerFactory)        {            loggerFactory.AddConsole(Configuration.GetSection("Logging"));            app.UseAuthentication();            app.UseMvc();        }My requirement is empty and this is my authorization handler:    public class TestAuthorizationHandler : AuthorizationHandler<TestRequirement>    {        protected override Task HandleRequirementAsync(AuthorizationHandlerContext context,                                                       TestRequirement requirement)        {            context.Succeed(requirement);            return Task.CompletedTask;        }    }My Controller get method:        [Authorize(Policy = "Test")]        [HttpGet]        [Route("Data")]        public async Task<string> GetDataAsync()        {            return await Task.FromResult("data");        }The unexpected behavior:Authentication is always ignored for that controller method, my authorization handler and controller are always reached, even if I don't supply an Authentication header or supply an invalid token.Expected behavior:Authorization should use the supplied default scheme in AddAuthentication to challenge the Authentication and not allow these calls through unless Authentication was successful.Workaround:Add the default scheme directly to the policy and require the user to be authenticatedpolicy.AuthenticationSchemes.Add(JwtBearerDefaults.AuthenticationScheme);policy.RequireAuthenticatedUser();When these are added I see the behavior I expect.Am I misunderstanding the expected flow? Is this the expected behavior and RequireAuthenticatedUser is needed explicitly to block unauthenticated requests to go through authorization?_Copied from original issue: aspnet/Home#3046_
5501	area-mvc	Add more special-case event types	We need to add support for more kinds of strongly typed events to the Blazor library, and then add more mappings for tooling support.We're considering these lists of event types as a starting point for what we want to include as first class events. https://github.com/Microsoft/TypeScript/blob/master/lib/lib.dom.d.ts#L3475https://github.com/Microsoft/TypeScript/blob/master/lib/lib.dom.d.ts#L5472First, we're eliminating anything that is vendor specific. That's all of the stuff with `MS` or `webkit`. This items tracks our progress as well as future work. Note that you aren't blocked for using these events just because we haven't added them. This just makes it a little nicer.In 0.3 we've added the basic plumbing for these events as well as defined new `UIEventArgs`-derived classes where needed. However we didn't try to add all of the relevant data to these classes. If you look at an example like https://github.com/aspnet/Blazor/blob/dev/src/Microsoft.AspNetCore.Blazor/UIEventArgs.cs#L32 - we don't include the `dataType` and `data` - https://developer.mozilla.org/en-US/docs/Web/API/ClipboardEvent/ClipboardEventWe'd be super interested in contributions to help fill out these data types as well as to add tests where they are missing and possible to add.Note also that in 0.3 the path has been cleared for you to handle arbitrary events as long as you don't need to pass any data through the event.#### Added in 0.3:```    "abort": UIEvent;    "activate": Event;    "beforeactivate": Event;    "beforecopy": Event;    "beforecut": Event;    "beforedeactivate": Event;    "beforepaste": Event;    "canplay": Event;    "canplaythrough": Event;    "change": Event;    "click": MouseEvent;    "contextmenu": PointerEvent;    "copy": ClipboardEvent;    "cuechange": Event;    "cut": ClipboardEvent;    "dblclick": MouseEvent;    "deactivate": Event;    "drag": DragEvent;    "dragend": DragEvent;    "dragenter": DragEvent;    "dragleave": DragEvent;    "dragover": DragEvent;    "dragstart": DragEvent;    "drop": DragEvent;    "durationchange": Event;    "emptied": Event;    "ended": Event;    "error": ErrorEvent;    "fullscreenchange": Event;    "fullscreenerror": Event;    "input": Event;    "invalid": Event;    "keydown": KeyboardEvent;    "keypress": KeyboardEvent;    "keyup": KeyboardEvent;    "load": Event;    "loadeddata": Event;    "loadedmetadata": Event;    "loadstart": Event;    "mouseenter": MouseEvent;    "mouseleave": MouseEvent;    "mousewheel": WheelEvent;    "paste": ClipboardEvent;    "pause": Event;    "play": Event;    "playing": Event;    "pointerlockchange": Event;    "pointerlockerror": Event;    "progress": ProgressEvent;    "ratechange": Event;    "readystatechange": Event;    "reset": Event;    "scroll": UIEvent;    "seeked": Event;    "seeking": Event;    "select": UIEvent;    "selectionchange": Event;    "selectstart": Event;    "stalled": Event;    "stop": Event;    "submit": Event;    "suspend": Event;    "timeupdate": Event;    "touchcancel": TouchEvent;    "touchend": TouchEvent;    "touchmove": TouchEvent;    "touchstart": TouchEvent;    "volumechange": Event;    "waiting": Event;}```
5064	area-mvc	ExtensionDependencyChecker/Loader incorrectly recognizes different version of assemblies as same	We see errors like the following in the Razor build server when upgrading packages```Extension assembly 'Microsoft.AspNetCore.Blazor.Razor.Extensions' at 'C:\Users\username\.nuget\packages\microsoft.aspnetcore.blazor.build\0.2.0-preview1-10195\tools\Microsoft.AspNetCore.Blazor.Razor.Extensions.dll' has a different ModuleVersionId than loaded assembly 'Microsoft.AspNetCore.Blazor.Razor.Extensions, Version=0.2.0.0, Culture=neutral, PublicKeyToken=null'  Extensions could not be loaded. See output for details.C:\Users\username\.nuget\packages\microsoft.aspnetcore.blazor.build\0.2.0-preview1-10195\targets\RazorCompilation.targets(179,5): error : rzc generate exited with code 1 ```There are a few issues with this.It would firstly be great to know which other assembly is loaded and where it was loaded from - my guess is that this happened when updating the packages used by our templates, or by mixing our templates with a repo-local build.Secondly, I think this is just a bug. The assembly loading logic we use for Razor is supposed to be based on paths for 'top level' extensions, meaning that we should be able to load two copies of `Microsoft.AspNetCore.Blazor.Razor.Extensions`. We should investigate this and see if it's possible.Lastly, this **must not** fail the build. We expect users to mix and match dependencies and this is intended to 'just work'. 
5780	area-identity	Q: Is WebAuthn planned to be implemented by aspnet.identity?	Hello,The API should be available in Chrome and Firefox May release.Starting to look at it and be ready for it could be a good idea?[webauthn specs](https://www.w3.org/TR/webauthn/)(Question initially posted on [aspnet/Security here](https://github.com/aspnet/Security/issues/1725#issuecomment-380487325))
5293	area-signalr	Nagle sends from server	In high traffic scenarios it is better to try and buffer sends so clients get multiple messages at a time instead of 1 per read.Did a quick test and got ~2x throughput improvement on WebSockets by attempting to buffer sends
4657	area-security	Q: Is WebAuthn planned to be implemented by aspnet.security?	Hello,The API should be available in Chrome and Firefox May release.Starting to look at it and be ready for it could be a good idea?[webauthn specs](https://www.w3.org/TR/webauthn/)
4126	area-security	Add a multitenant auth options sample	See https://github.com/aspnet/Security/issues/1718 for more context
5414	area-mvc	Are ASP.NET scaffolded templates Section 508 (Accessibility standard) compliant?	Per discussion on this week's ASP.NET Community Standup, we need to check if the scaffolded templates are compliant with [Section 508](https://www.section508.gov/content/learn).
4658	area-security	Creating JwtSecurityToken vs using OpenID connect for Web API	I currently create JwtSecurityToken and return the token to the user after request to /account/login. I use jwt bearer middleware that handles token verification upon each request. Everything works fine. I don't use OpenID Connect nor OAuth2. Does it also mean I use my own protocol?Now, what would be the advantage over this approach if I used OpenID Connect (through IdentityServer or OpenIddict)?I'm still new to these protocols and I'm only familiar with JWT (format) itself. From my basic understanding OAuth2 or OpenID Connect is used when I want to expose my API to third parties, but what if I need to  secure my private API and I don't want anything else except my programs (native,mobile,web) to have access to it. Would those protocols still help?I was reading one advantage is Single sign-on (SSO) but if JWT itself can be shared across domains etc. wouldn't it mean I can achieve the same without OpenID?Please note that I know JWT is format and OpenID Connect is extended OAuth2 protocol standard that use JWT. And IdentityServer, OpenIddict are implementations of these protocols.
3042	area-middleware	Re-initialize Session middleware from controller	_From @dinesh-r on Tuesday, April 10, 2018 5:53:32 AM_We have requirement to configure Session Idle Timeout from administration screen and that should be reflected immediately (after saving it into database). Is there any way to re-initialize Session middleware from Controller. _Copied from original issue: aspnet/Session#214_
5292	area-signalr	Review the use of EnsureSuccessStatusCode in the client transports implementation	Today it looks like we're using EnsureSuccessStatusCode then catching the exception, then logging. It might be better if we just used IsSuccessStatusCode and removed exceptions from this path completely. We can log the response and the status code instead of catching exceptions.
5063	area-mvc	Include the new Razor directive icon glyph in the RazorExtension.	https://devdiv-design.visualstudio.com/DevDiv%20Design/_workitems/edit/2540
5500	area-mvc	Ensure nested event handlers work correctly	If element `A` contains element `B`, and they both declare (say) an `onclick` handler, and the user clicks on `B`, then you'd expect both event handlers to run.Currently they do both try to run (first `B`, then `A`, as the event bubbles up), but with a render cycle between them. The render cycle might dispose the handler for `A` before we try to run it, which would lead to a crash.We should avoid this issue by capturing the list of all event handler IDs to be invoked, pass them all to .NET atomically, and have it run all the corresponding delegates before any render cycle occurs.
5180	area-mvc	"npm run build" fails with "Cannot find type definition file for 'node'"	### Environment:Windows 10 x64Node JS v8.11.1NPM 5.6.0### Steps:1. `git checkout https://github.com/aspnet/JavaScriptServices.git`2. `cd JavaScriptServices\src\Microsoft.AspNetCore.NodeServices`3. `npm install`4. `npm run build`### Actual resultBuild fails with the error:```> npm run build> nodeservices@1.0.0 build C:\projects\aspnet\JavaScriptServices\src\Microsoft.AspNetCore.NodeServices> webpackts-loader: Using typescript@2.8.1 and C:\projects\aspnet\JavaScriptServices\src\Microsoft.AspNetCore.NodeServices\TypeScript\tsconfig.jsonHash: 8c194b09b39807c882c3Version: webpack 1.15.0Time: 2109ms             Asset     Size  Chunks             Chunk Namesentrypoint-http.js  16.1 kB       0  [emitted]  entrypoint-http   [0] multi entrypoint-http 28 bytes {0} [built]    + 7 hidden modulesERROR in ./TypeScript/Util/PatchModuleResolutionLStat.ts(1,23): error TS2307: Cannot find module 'path'.ERROR in ./TypeScript/Util/PatchModuleResolutionLStat.ts(3,20): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/Util/PatchModuleResolutionLStat.ts(33,17): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/Util/PatchModuleResolutionLStat.ts(39,28): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/Util/OverrideStdOutputs.ts(18,31): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/Util/OverrideStdOutputs.ts(19,31): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/Util/OverrideStdOutputs.ts(21,54): error TS2503: Cannot find namespace 'NodeJS'.ERROR in ./TypeScript/Util/ExitWhenParentExits.ts(42,13): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/Util/ExitWhenParentExits.ts(60,9): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/Util/ExitWhenParentExits.ts(70,9): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/HttpNodeInstanceEntryPoint.ts(5,23): error TS2307: Cannot find module 'http'.ERROR in ./TypeScript/HttpNodeInstanceEntryPoint.ts(6,23): error TS2307: Cannot find module 'path'.ERROR in ./TypeScript/HttpNodeInstanceEntryPoint.ts(56,47): error TS2304: Cannot find name 'process'.ERROR in ./TypeScript/HttpNodeInstanceEntryPoint.ts(70,30): error TS2304: Cannot find name 'process'.ERROR in C:\projects\aspnet\JavaScriptServices\src\Microsoft.AspNetCore.NodeServices\TypeScript\tsconfig.jsonerror TS2688: Cannot find type definition file for 'node'.```### Expected result:Build completes without errors
5291	area-signalr	Optimize Groups data structure	Groups are basically stored as `ConcurrentDictionary<string, ConcurrentDictionary<string, HubConnectionContext>>` (groups by name, containing connections by ID)`ConcurrentDictionary` uses a lot of memory. Optimize how groups are stored to use a more light-weight data structure on the server to increase scalability.
5499	area-mvc	DataContractSerializer is not available	This code throws an exception (shown below):```c#      var source = new List<string>();      source.Add("a");      source.Add("b");      using (System.IO.MemoryStream stream = new System.IO.MemoryStream())      {        var serializer = new System.Runtime.Serialization.DataContractSerializer(typeof(List<string>));        serializer.WriteObject(stream, source);        stream.Flush();        errorText = stream.ToArray().ToString();      }```I strongly suspect it is because these two assemblies can't be referenced by a Blazor project without causing a linker/compiler issue:```    <PackageReference Include="System.Runtime.Serialization.Xml" Version="4.3.0" />    <PackageReference Include="System.Runtime.Serialization.Formatters" Version="4.3.0" />```Here's the exception when attempting to use the DCS:```System.NullReferenceException: Object reference not set to an instance of an object. at System.Runtime.Serialization.XmlFormatWriterInterpreter.WriteCollection (System.Runtime.Serialization.CollectionDataContract collectionContract) <0x1d54f00 + 0x002c6> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlFormatWriterInterpreter.WriteCollectionToXml (System.Runtime.Serialization.XmlWriterDelegator xmlWriter, System.Object obj, System.Runtime.Serialization.XmlObjectSerializerWriteContext context, System.Runtime.Serialization.CollectionDataContract collectionContract) <0x1d44758 + 0x00082> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlFormatWriterGenerator+CriticalHelper+<>c__DisplayClass1_0.<GenerateCollectionWriter>b__0 (System.Runtime.Serialization.XmlWriterDelegator xw, System.Object obj, System.Runtime.Serialization.XmlObjectSerializerWriteContext ctx, System.Runtime.Serialization.CollectionDataContract ctr) <0x1d444c0 + 0x00030> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at (wrapper delegate-invoke) <Module>.invoke_void_XmlWriterDelegator_object_XmlObjectSerializerWriteContext_CollectionDataContract(System.Runtime.Serialization.XmlWriterDelegator,object,System.Runtime.Serialization.XmlObjectSerializerWriteContext,System.Runtime.Serialization.CollectionDataContract) at System.Runtime.Serialization.CollectionDataContract.WriteXmlValue (System.Runtime.Serialization.XmlWriterDelegator xmlWriter, System.Object obj, System.Runtime.Serialization.XmlObjectSerializerWriteContext context) <0x1d41978 + 0x0003a> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlObjectSerializerWriteContext.WriteDataContractValue (System.Runtime.Serialization.DataContract dataContract, System.Runtime.Serialization.XmlWriterDelegator xmlWriter, System.Object obj, System.RuntimeTypeHandle declaredTypeHandle) <0x1d41658 + 0x0002c> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlObjectSerializerWriteContext.SerializeWithoutXsiType (System.Runtime.Serialization.DataContract dataContract, System.Runtime.Serialization.XmlWriterDelegator xmlWriter, System.Object obj, System.RuntimeTypeHandle declaredTypeHandle) <0x1d2a7e8 + 0x000ac> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.DataContractSerializer.InternalWriteObjectContent (System.Runtime.Serialization.XmlWriterDelegator writer, System.Object graph, System.Runtime.Serialization.DataContractResolver dataContractResolver) <0x1d1c9c8 + 0x00178> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.DataContractSerializer.InternalWriteObject (System.Runtime.Serialization.XmlWriterDelegator writer, System.Object graph, System.Runtime.Serialization.DataContractResolver dataContractResolver) <0x1cec2a8 + 0x00034> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlObjectSerializer.WriteObjectHandleExceptions (System.Runtime.Serialization.XmlWriterDelegator writer, System.Object graph, System.Runtime.Serialization.DataContractResolver dataContractResolver) <0x1cebc48 + 0x000b6> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlObjectSerializer.WriteObjectHandleExceptions (System.Runtime.Serialization.XmlWriterDelegator writer, System.Object graph) <0x1ceb790 + 0x0001a> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlObjectSerializer.WriteObject (System.Xml.XmlDictionaryWriter writer, System.Object graph) <0x1ceb648 + 0x0001c> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at System.Runtime.Serialization.XmlObjectSerializer.WriteObject (System.IO.Stream stream, System.Object graph) <0x1ac65c0 + 0x0003c> in <9ee5fdf5d52d425ea81327a2faa4d90b>:0 at BlazorExample.Client.Pages.Counter.LoadPerson () <0x1ac5350 + 0x00056> in <0543c94a70574af0ac2cc0e8b470a824>:0 ```
5498	area-mvc	.NET Core sln template has issues referencing some assemblies	The .NET Core hosted template has an issue where it can't reference some assemblies or NuGet packages.Suppose you have a component that has the same assembly name (like `x.dll`) but is built once for wasm and once for .NET Core - so there are two assemblies named `x.dll` _but they are different builds of the same code_.(This scenario might seem odd - but it isn't uncommon, especially with something like Blazor where the mono runtime on the client is not the same as the netcore runtime on the server. The solution is to have a codebase that is "the same" except with compiler directives to fix the differences between platforms. Yes, netstandard _should_ fix this, but is not a perfect solution.)Right now, if you reference the mono-built `x.dll` in the Blazor app, and the netcore-built `x.dll` in the server app, the server app will fail to build.
3032	area-mvc	Add OperatingSystems.NonWindows or OSSkipNonWindowsCondition and OSSkipWindows	When using OSSkipCondition on tests the most common combinations are:`[OSSkipCondition(OperatingSystems.Linux | OperatingSystems.MacOSX)]``[OSSkipCondition(OperatingSystems.Windows)]`These are used extensively in MusicStore, ServerTests, and also in a few places in HttpSys. These could be consolidated down to `[OSSkipCondition(OperatingSystems.NonWindows)]` or even further to  `[OSSkipWindowsCondition]` and `[OSSkipNonWindowsCondition]`
5779	area-identity	Would it be possible to separate the AspNetCoreCompat DbContext and CookieInterop classes in separate NuGet packages?	Hi there :wave:,We have an existing EF6-, Identity v2-based solution that targets .NET 4.5.1.We want to create a new ASP.NET Core 2.0 application that targets the same database.Since ASP.NET Core only supports Identity v3, it means the schema needs to be updated.This is where the `Microsoft.AspNet.Identity.AspNetCoreCompat` comes into play.From what I understand, this package allows an application based on Identity v2 to be compatible with the Identity v3 schema. This is done by using the classes in that package.Now, in our case, since we want to keep the Identity v2 bits running as-is, we're not interested in sharing cookies between the v2 and v3 apps. Still, the package comes with the OWIN-compatible secure data format that allows it to decrypt cookies issues with the new .NET Core DataProtection stack.This has two implications for us: - The need to upgrade every single project that uses the ASP.NET Identity v2 to .NET 4.6.1 to be able to install the NuGet package - Since it depends on the new DataProtection stack and the OWIN-interop, it installs 27 dependent packages that we don't useIs there a possibility to separate these two capabilities in separate NuGet packages?
5497	area-mvc	Create components using dependency injection	From what I see, it would be changing this line: https://github.com/aspnet/Blazor/blob/5be754e75def0c4134e379a6440c6b284828f01e/src/Microsoft.AspNetCore.Blazor/Components/ComponentFactory.cs#L35Another change would be to allow for interfaces that derives from IComponent in the language service.The usecases are the following: 1. Allow for code only components to use constructor injection. The property injection support was native in Asp.Net core while it was in its early stages and was later removed to make the DI simpler and more focussed. This seems to be a step backwards.2. Allow this pattern: ```csharp//In assembly Apublic interface IMyComponent : IComponent { int SomeParameter{get;set;} }//In assembly Bpublic class MyComponent: BlazorComponent, IMyComponent { }//In the blazor app: //Setting up dependency injectionclass Program{    static void Main(string[] args)    {        var serviceProvider = new BrowserServiceProvider(configure =>        {            //Potentially load implementation dynamically here            configure.Add(ServiceDescriptor.Transient(typeof(IMyComponent), typeof(MyComponent)));        });        new BrowserRenderer(serviceProvider).AddComponent<App>("app");    }}//in cshtml page<IMyComponent SomeParameter="22" />```How would this be useful: it would become possible to expose components as a contract between multiple assemblies, potentially multiple repositories. This could become the base for a micro-ui architecture where each service could expose their UI components as a contract thus removing the need for a fully pre-built application and allowing dynamically loading components for A/B testing or for testing new features behind feature flags.
5179	area-mvc	Corrupted characters in response	I found this code in HttpNodeInstanceEntryPoint.ts file. As I understand, it read and parse request stream and chunk is a byte array. We convert it to string and append to requestBodyAsString.In utf-8 a symbol could be represented not only by a single byte, but by sequence of bytes. So, the start or the end of the chunk could contain incomplete character sequence.``` typescriptfunction readRequestBodyAsJson(request, callback) {    let requestBodyAsString = '';    request.on('data', chunk => { requestBodyAsString += chunk; });    request.on('end', () => { callback(JSON.parse(requestBodyAsString)); });}```
4885	area-mvc	Why doesn't the ViewComponentResultExecutor use the IHttpResponseStreamWriterFactory	I'm trying to replace the HttpResponseStreamWriter with a (potentially) more efficient version and it turns out the ViewCompomentResultExector doesn't use it https://github.com/aspnet/Mvc/blob/133dd964abb1c2a4167cf38faa38fe0319b7b931/src/Microsoft.AspNetCore.Mvc.ViewFeatures/ViewFeatures/ViewComponentResultExecutor.cs#L108. Is that intentional or just an oversight?/cc @rynowak @pranavkm 
5778	area-identity	Localize the default UI	Now that we have Identity UI in a library, we should consider having it use `IViewLocalizer` and `IStringLocalizer` to support localization of the various strings. I think it might be possible to just wrap all strings with calls to these interfaces, but **not** provide any resources, but rather have them picked up via the app if they're provided and configured correctly (we added features in 2.0 if I recall to enable this scenario).
5062	area-mvc	Ship Razor design time targets with MPack file	Essentially do this - https://github.com/aspnet/Razor/issues/2069 - for VS for Mac
4749	area-servers	Config support for SNI	In 2.1 preview2 we added support for SNI:https://github.com/aspnet/KestrelHttpServer/issues/2357This is a code only approach and isn't supported by the new config system also introduced in 2.1.Proposal: See if there's sufficient user demand for supporting SNI from config.Recommend revisit in 2.2.
3024	area-middleware	How to get number of session	_From @lillo42 on Tuesday, March 20, 2018 11:31:14 AM_Hi,How can I get number of session ?_Copied from original issue: aspnet/Session#211_
3022	area-servers	OwinFeatureCollection throwing exception in IHttpResponseFeature.OnCompleted and breaks AspNetCore model binding	When running AspNetCore on an owin pipeline, `[FromBody]` model binding fails because of [this exception being thrown](https://github.com/aspnet/HttpAbstractions/blob/ce49e95239cfca6f857716082fda767ee6590bf3/src/Microsoft.AspNetCore.Owin/OwinFeatureCollection.cs#L172):![image](https://user-images.githubusercontent.com/57436/38307376-d652b51e-3813-11e8-883c-8243dd8a4ff9.png)![image](https://user-images.githubusercontent.com/57436/38307394-e848a30a-3813-11e8-90d1-d1d36cd044c5.png)```   at Microsoft.AspNetCore.Owin.OwinFeatureCollection.Microsoft.AspNetCore.Http.Features.IHttpResponseFeature.OnCompleted(Func`2 callback, Object state)   at Microsoft.AspNetCore.Http.Internal.DefaultHttpResponse.OnCompleted(Func`2 callback, Object state)   at Microsoft.AspNetCore.Http.HttpResponse.RegisterForDispose(IDisposable disposable)   at Microsoft.AspNetCore.Http.Internal.BufferingHelper.EnableRewind(HttpRequest request, Int32 bufferThreshold, Nullable`1 bufferLimit)   at Microsoft.AspNetCore.Mvc.Formatters.JsonInputFormatter.<ReadRequestBodyAsync>d__10.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinder.<BindModelAsync>d__7.MoveNext()```I copied the `OwinFeatureCollection` code into my own project and commented out the throw...![image](https://user-images.githubusercontent.com/57436/38307487-3009f93c-3814-11e8-9349-e3c3730f3326.png)... and model binding now works:![image](https://user-images.githubusercontent.com/57436/38307554-5ba93df0-3814-11e8-9838-0b72b8e0b0ec.png)
5061	area-mvc	Add line endings on to RazorCodeGenerationOptions	We have special hooks that we use for testing to mess with line endings for Razor. There's no good reason why we shouldn't just make the line endings configurable.
5060	area-mvc	Feature Request/Question: Ability to easily author/inject new directives for Razor?	_From @fir3pho3nixx on March 24, 2018 18:58_Currently, I cannot find an easy way to author/inject custom directives into Razor whilst using ASPNET Core Mvc(Kestrel). I can see that the `@Inject` directive gets registered within razor [here](https://github.com/aspnet/Razor/blob/2f79b90af5cbd9499f012c204f5bf4bb413ae61b/src/Microsoft.AspNetCore.Mvc.Razor.Extensions/RazorExtensions.cs#L20). Now if I wanted to inject a custom directive to MVC on startup how would I achieve that easily? Imagining for a second I wanted to create a '@FooInjector'. I can see you offer access to [RazorViewEngineOptions](https://github.com/aspnet/Mvc/blob/dfa085afaf4ddb0b1063eed35e070d6189acaca2/src/Microsoft.AspNetCore.Mvc.Razor/RazorViewEngineOptions.cs) is this potentially where you guys would expose something like this?_Copied from original issue: aspnet/Mvc#7540_
3791	area-servers	Investigate HTTP/2 behavior for RequestAborted and Abort	For Http/1.x RequestAborted is used to detect early disconnects and Abort is used to force them.For HTTP/2 requests can be multiplexed over a single connection and it's possible to terminate individual requests while leaving the connection active. Investigate how Http.Sys/IIS surfaces this behavior and if RequestAborted and Abort can be adapted accordingly. We may also need to introduce a lower level connection Abort API to kill the underlying connection (if Http.Sys/IIS allows that).
5496	area-mvc	In DI, consider supporting component-scoped services, and auto-disposing transient services	Given a service:```public class Repository : IRepository, IDisposable { ... }```It is injected as a transient:```static void Main(string[] args){    var serviceProvider = new BrowserServiceProvider(configure =>    {        configure.Add(ServiceDescriptor.Transient<IRepository, Repository>());    });    new BrowserRenderer(serviceProvider).AddComponent<App>("app");}```If this service is injected into a component, it is never disposed even when navigating away from the component:```@page "/"@inject IRepository Repository...```Is this a bug or is there a functionality available to dispose injected services implementing `IDisposable`?
4884	area-mvc	Would we simplify the process of WebApi ?	Sometimes we dont need the Razor、View etc.. It is no use for the simple or WebApi-Interface-Services.So we can remove some services from the function of UseMvc().Such as:[https://github.com/NMSAzulX/WebApiMiddleware/blob/master/WebApiMiddleware/WebApiExtentsion.cs](https://github.com/NMSAzulX/WebApiMiddleware/blob/master/WebApiMiddleware/WebApiExtentsion.cs)
5495	area-mvc	OnClick from button inside ChildContent fails to pass a member variable into subcomponents	This is a tricky one to describe so I've created a minimal project that shows the issue.https://github.com/JimLynn/BlazorTagHelperChildContentWhat the index page wants to do is take a name and description, create an instance of a Thing class, set that as a member of the Index page, which is also used as a member of a subcomponent, called Outer. The Outer component displays the contents of the Thing.Index has a single method, which takes the Name and Description properties, and creates a Thing, and sets its own Thing property to that new object. I would expect this to then cause the Outer component to display the new contents.The markup for Index has two buttons. The blue button is just in the regular markup, and it calls the method to generate and set the Thing. Click on this with something in the two fields and you should see the displayed data in the Outer component change. You can do this several times with different values to see that it changes each time.The second button, the green one, is inside another component, the WithChild component. All that does is wrap the child content of the tag in some markup. The wrapped content should be otherwise unchanged.Here's where the bug seems to manifest. This button calls exactly the same method as the working button, but for reasons I can't fathom, setting the Thing property this time does not pass it through to the Outer component. You can see from the Console.WriteLine at the end of the method that the Thing property in Index has been set correctly, as it's echoing its properties.So somehow, calling a method from a click inside some child content isn't behaving the same as when the same method is called in the main body of the component.The console isn't showing any uncaught exceptions, but it feels like something is silently failing, possibly because the context is different when it's child content. Maybe the re-rendering gets stalled before the components get re-rendered.
4750	area-servers	Upgraded request body should not create a request body pipe	This needlessly copies bytes from the transport pipe into the body pipe. We can avoid this whole dance to improve the websocket performance.Related to https://github.com/aspnet/KestrelHttpServer/issues/2340./cc @BrennanConroy @halter73 
4659	area-security	Back-channel logout support for OpenIdConnect?	There is a default endpoint for front-channel signout: signout-oidcIs there a plan to include a similar endpoint for back-channel signout in 2.1 release?Spec: http://openid.net/specs/openid-connect-backchannel-1_0.htmlThank you.
5494	area-mvc	For missing C# reference, it's going to a compiled code instead of original place.	I create a basic application. remove the Forecast from C# code and Change it to Task class which I create myself.Now I am compiling my code. Since WeatherForecast is not exist, Views is not compiling. The compiling error click in error window must be lead user to view. Currently it's leading to compiled .cs file which is a bit harsh if user have too much classes.it can be improved. Like If things crash the YSOD show the exact code line with call stack and stack trace.![11](https://user-images.githubusercontent.com/2105258/38166999-624a7c6c-354b-11e8-8815-d4487c444aa8.png)
5290	area-signalr	Add Redis benchmark to BenchmarkServer	There should be an option to run the benchmarks against redis. We'll also need to be able to point to an existing redis instance from the application.
5289	area-signalr	Consider sending authentication data over the handshake request	Now that we have a handshake, we can consider adding support for sending authentication data over the transport instead of using the query sting (primarily for websockets). The other transports can use headers like normal but we would support sending the access token over the websocket channel./cc @blowdart @anurse 
5288	area-signalr	Consider caching connection list for HubLifetimeManager operations	![capture](https://user-images.githubusercontent.com/7574801/38157793-1a896a76-343f-11e8-9b81-27b2d1b6055e.JPG)We can cache the connectionlist on access and update it whenever a connection is added or removed
3801	area-servers	ANCM: Inprocess App fails to start if a request is sent before switching hostingModel from out-of-process is completed	STEPS TO REPRO:1.	Set outofprocess mode2.	Send a request which takes 10 seconds to finishFYI, you can use /aspnetcoreapp/DoSleep10000 if you use our test app. Or, you can put 10 seconds sleep to the aspnetcore app when program exits.3.	Before the request of the step 2 is completed, switch hostingModel to inprocess and then send a new requestEXPECTED:No errorACTUAL:Inprocess app can’t start.![image](https://user-images.githubusercontent.com/20650163/38151572-b32ebf50-3418-11e8-96b3-fe84464d7257.png)
5777	area-identity	Add sample views for Managing Roles, Users in Roles etc.	Please add some additional sample views for roles, users in roles, roles containing user.Number of failed login attempts in one hour. with lock out option.https://github.com/aspnet/Identity/tree/dev/samples/IdentitySample.Mvc/Views/Account
5776	area-identity	Check loglevel for some log statements in DefaultUI	Currently we have log statements in DefaultUI where we try to log user id, but we try to get the user id irrespective of whether the loglevel was enabled or not. 
5346	area-servers	Add In-process ANCM tests/ Re-enable ANCM out of process tests. 	
5775	area-identity	The ability to use different types for the Users table's pk and the roles table pk	As per this SO question:[https://stackoverflow.com/questions/49567477/](https://stackoverflow.com/questions/49567477/)We cannot use different types for the primary keys in the users table and the roles table.This can cause some limitations for people like me if for example wanted to use int for the Users key and enum for the Roles key.
5774	area-identity	Simplify using a custom TUser with DefaultUI	This came up as a part of investigating the fix to https://github.com/aspnet/Identity/issues/1679Today to add additional basic data to a custom user requires overriding the Register/Manage pages,which is still somewhat involved, see [DefaultUI sample](https://github.com/aspnet/Identity/tree/dev/samples/IdentitySample.DefaultUI/Areas/Identity/Pages/Account)```   public class MyUser : IdentityUser {       public string Name { get; set; }       public int Age { get; set; }   }```I think we can simplify this to only needing to define only the additional properties + the corresponding input model if we add a basic mechanism for generating the appropriate inputs and introduce a new abstraction in the UI package around updating/creating the actual TUser:```C#   public class MyUser : IdentityUser {       public string Name { get; set; }       public int Age { get; set; }   }   public class MyUserInputModel : RegisterInputModel, ManageInputModel {            [Required]            [DataType(DataType.Text)]            [Display(Name = "Full name")]            public string Name { get; set; }            [Required]            [Range(0,199, ErrorMessage = "Age must be between 0 and 199 years")]            [Display(Name = "Age")]            public int Age { get; set; }   }```We would have to introduce a couple of new abstractions/services in the UI package and update the Register/Manage pages to use them: ```C#   // Default implementation would reflect to work against properties   // only users with truly custom POCOs would need to implement this.   public interface IUserFactory<TUser> {       TUser Create(IUserData data); // Register calls this to create a new user       void Update(TUser user, IUserData data); // Manage uses this to update the user   }    // Similarly we could generate the Register/manage inputs from the models   // we could some minor ability to customize the classes names if needed    IInputGenerator.Generate(InputModel):    // generates the:            <div class="form-group">                <label asp-for="Input.Name"></label>                <input asp-for="Input.Name" class="form-control" />                <span asp-validation-for="Input.Name" class="text-danger"></span>            </div>            <div class="form-group">                <label asp-for="Input.Age"></label>                <input asp-for="Input.Age" class="form-control" />                <span asp-validation-for="Input.Age" class="text-danger"></span>            </div>```
5773	area-identity	Consider option to treat email as the username	And automatically keep in sync. We got so many issues because the templates conflate the two in a poor way, and the mirroring of this is manual and patchy.
5917	area-hosting	Improve usability of our deployer framework	Writing a functional test that uses deployer is very verbose (~20 lines of deployer related code per test) we need to improve on that and make usage simpler.
5493	area-mvc	Avoid 'dist' subdirectory in published artifacts (requires changing UseBlazor middleware)	On publish, the assets are going into a folder with the same name as the app and *web.config* sits at the root of *publish* with rewrite rules to serve from *{app_name}/dist*.```publish    -- StandaloneApp        -- dist            -- _framework            -- css            -- index.html    -- web.config```... but I was expecting a much flatter structure akin to what has been done with ASP.NET Core ... something along the lines of ...```publish   -- _framework   -- css   -- index.html   -- web.config```I have the notion that *dist* is a holdover from other frameworks. Having the app name in the mix seems strange. Just wondering why it was setup this way?Would it be an improvement to use the flatter structure (following the ASP.NET Core publishing philosophy these days)? The structure is simpler and the rewrite rules can be dropped. There might be an additional reason to use the flatter structure: My understanding was that the *web.config* was placed into a flat structure in ASP.NET Core because it allows publishing of multiple apps with WebDeploy. cc/ @shirhatti        
5772	area-identity	Consider moving to a per login factor secret for TFA	See https://github.com/aspnet/Identity/issues/626 for more context
4751	area-servers	Benchmark corefx Sockets epoll exhaustion strategy	When there is a lot of I/O transfer, at some point the epoll thread becomes the bottleneck.There are two ways to deal with that:- create multiple epoll threads- delegate I/O transfer to the threadpoll, so epoll thread only handles notificationcorefx does both, implemented in https://github.com/dotnet/corefx/pull/19820 and https://github.com/dotnet/corefx/pull/23115 respectively.That doesn't make much sense.It would be nice if we could benchmark the two and keep the one that performs best.CC @geoffkizer @halter73 @stephentoub @vancem @davidfowl 
3000	area-servers	System.IO.IOException thrown by MultipartReaderStream	_From @dvdobrovolskiy on March 25, 2018 0:28_Have this code [FileUploadSample](https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/file-uploads/sample/FileUploadSample)works perfectly well on 2.0 but is I implement it in 1.0 (version 1.1.7) project throws "'System.IO.IOException' in mscorlib.dll" exception.Here controller```c#        [HttpPost]        [DisableFormValueModelBinding]        [ValidateAntiForgeryToken]        public async Task<IActionResult> Upload()        {            if (!MultipartRequestHelper.IsMultipartContentType(Request.ContentType))            {                return BadRequest($"Expected a multipart request, but got {Request.ContentType}");            }            // Used to accumulate all the form url encoded key value pairs in the             // request.            var formAccumulator = new KeyValueAccumulator();            string targetFilePath = null;            var boundary = MultipartRequestHelper.GetBoundary(                MediaTypeHeaderValue.Parse(Request.ContentType),                _defaultFormOptions.MultipartBoundaryLengthLimit);            var reader = new MultipartReader(boundary, HttpContext.Request.Body);            var section = await reader.ReadNextSectionAsync();     //<===Exception here```Sorry if I forgot to set temp path somewhere but I am far before reading data to my stream or temp file_Copied from original issue: dotnet/coreclr#17197_
4752	area-servers	Consider letting the transport own the creation of IDuplexPipe	Today the transport is responsible for exposing properties on the connection that can be used by Kestrel to create a duplex pipe. It does this today for a few reasons:- It wants to directly apply the MaxResponseBufferSize and MaxRequestBuffer size to pipe options- It communicates "fin" via cancelling the transport's output reader (this is super hacky and we should get rid of it anyways).- It wants to control where "user code" runs. This includes:  - ConnectionAdapters (soon to be deprecated)  - CancellationToken callbacks  - the request processing delegateDelegating to the transport has some other benefits:- Transports aren't tied to a specific pipe implementation.- We can potentially delete ITransportSchedulerFeature, IApplicationTransportFeature To make this change though, we need to pass the relevant settings from kestrel to the transport without coupling. My current though is to pass a settings object to ITransportFactory.Create.See https://github.com/geoffkizer/KestrelHttpServer/blob/7bd21cdb1581fc3559479842262a24deecf171bb/src/Kestrel.Transport.Sockets/Internal/SocketConnection.cs for an example of the socket transport with a direct pipe implementation./cc @tmds @benaadams (only other people that wrote transports 😄)
5492	area-mvc	Build Error when referencing a bunch of standard libraries	First of all: Thanks for the great work. I love that project and I want to support it as much as i can.I started with a simple Blazor (not hosted) project and referenced some of my existing .net standard projects incl. some 3rd party packages like selenium (WebDriver and WebDriver.Support) and Docker.DotNet.When I try to build the app I get the following build error:```Severity	Code	Description	Project	File	Line	Suppression StateError	MSB3073	The command "dotnet "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\../tools/illink/illink.dll" -c link -u link -t --verbose  -d "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\../tools/mono/bcl/" -d "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\../tools/mono/bcl/Facades/" -o "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BlazorApp\obj\Debug\netstandard2.0\blazor/linker/" -x "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\BuiltInBclLinkerDescriptor.xml" -x "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BlazorApp\obj\Debug\netstandard2.0\blazor\linker.descriptor.xml" -a "C:\Development\Git\Nuget\packages\docker.dotnet\3.125.1\lib\netstandard2.0\Docker.DotNet.dll" -a "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor\0.1.0\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.dll" -a "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.browser\0.1.0\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.Browser.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.csharp\4.3.0\lib\netstandard1.3\Microsoft.CSharp.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.dependencyinjection\2.0.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.dependencyinjection.abstractions\2.0.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.Abstractions.dll" -a "C:\Development\Git\Nuget\packages\newtonsoft.json\10.0.3\lib\netstandard1.3\Newtonsoft.Json.dll" -a "C:\Development\Git\Nuget\packages\selenium.support\3.10.0\lib\netstandard2.0\WebDriver.Support.dll" -a "C:\Development\Git\Nuget\packages\selenium.webdriver\3.10.0\lib\netstandard2.0\WebDriver.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.buffers\4.4.0\lib\netstandard2.0\System.Buffers.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.collections.nongeneric\4.3.0\lib\netstandard1.3\System.Collections.NonGeneric.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.collections.specialized\4.3.0\lib\netstandard1.3\System.Collections.Specialized.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.componentmodel\4.3.0\lib\netstandard1.3\System.ComponentModel.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.componentmodel.primitives\4.3.0\lib\netstandard1.0\System.ComponentModel.Primitives.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.componentmodel.typeconverter\4.3.0\lib\netstandard1.5\System.ComponentModel.TypeConverter.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.dynamic.runtime\4.3.0\lib\netstandard1.3\System.Dynamic.Runtime.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.io.filesystem.primitives\4.3.0\lib\netstandard1.3\System.IO.FileSystem.Primitives.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.linq\4.3.0\lib\netstandard1.6\System.Linq.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.linq.expressions\4.3.0\lib\netstandard1.6\System.Linq.Expressions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.objectmodel\4.3.0\lib\netstandard1.3\System.ObjectModel.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit\4.3.0\lib\netstandard1.3\System.Reflection.Emit.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit.ilgeneration\4.3.0\lib\netstandard1.3\System.Reflection.Emit.ILGeneration.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit.lightweight\4.3.0\lib\netstandard1.3\System.Reflection.Emit.Lightweight.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.typeextensions\4.3.0\lib\netstandard1.5\System.Reflection.TypeExtensions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.runtime.serialization.formatters\4.3.0\lib\netstandard1.4\System.Runtime.Serialization.Formatters.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.runtime.serialization.primitives\4.3.0\lib\netstandard1.3\System.Runtime.Serialization.Primitives.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.text.regularexpressions\4.3.0\lib\netstandard1.6\System.Text.RegularExpressions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.threading\4.3.0\lib\netstandard1.3\System.Threading.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.threading.tasks.extensions\4.3.0\lib\netstandard1.0\System.Threading.Tasks.Extensions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.xml.readerwriter\4.3.0\lib\netstandard1.3\System.Xml.ReaderWriter.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.xml.xmldocument\4.3.0\lib\netstandard1.3\System.Xml.XmlDocument.dll" -a "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BusinessLogic\bin\Debug\netstandard2.0\FFXIVCollector.BusinessLogic.dll" -a "C:\Development\Git\NetStandard.Extensions\TomSun.NetStandard.Extensions\bin\Debug\netstandard1.0\TomSun.NetStandard.Extensions.dll" -a "C:\Development\Git\NetStandard.Platform\TomSun.NetStandard.Platform\bin\Debug\netstandard1.0\TomSun.NetStandard.Platform.dll" -a "C:\Development\Git\Selenium.Extensions\TomSun.Selenium.Extensions\bin\Debug\netstandard2.0\TomSun.Selenium.Extensions.dll" -a "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BlazorApp\obj\Debug\netstandard2.0\FFXIVCollector.BlazorApp.dll"" exited with code 1.	FFXIVCollector.BlazorApp	C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\Blazor.MonoRuntime.targets	429	```The build output is:```1>------ Build started: Project: FFXIVCollector.BlazorApp, Configuration: Debug Any CPU ------1>----- Smart Resolve References -----1>FFXIVCollector.BlazorApp -> C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BlazorApp\bin\Debug\netstandard2.0\FFXIVCollector.BlazorApp.dll1>Cannot find declaration of exported type 'System.Threading.Semaphore' from the assembly 'System.Threading, Version=4.0.12.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'1>Cannot find declaration of exported type 'System.Reflection.Emit.DynamicMethod' from the assembly 'System.Reflection.Emit.Lightweight, Version=4.0.2.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a'1>Processing embedded resource linker descriptor: mscorlib.xml1>Fatal error in IL Linker1>Mono.Linker.MarkException: Error processing method: 'System.Boolean System.Linq.Expressions.Compiler.ILGen::ShouldLdtoken(System.Reflection.MethodBase)' in assembly: 'System.Linq.Expressions.dll' ---> Mono.Cecil.ResolutionException: Failed to resolve System.Reflection.Emit.DynamicMethod1>   at Mono.Linker.Steps.MarkStep.HandleUnresolvedType(TypeReference reference)1>   at Mono.Linker.Steps.MarkStep.MarkType(TypeReference reference)1>   at Mono.Linker.Steps.MarkStep.MarkInstruction(Instruction instruction)1>   at Mono.Linker.Steps.MarkStep.MarkMethodBody(MethodBody body)1>   at Mono.Linker.Steps.MarkStep.ProcessMethod(MethodDefinition method)1>   at Mono.Linker.Steps.MarkStep.ProcessQueue()1>   --- End of inner exception stack trace ---1>   at Mono.Linker.Steps.MarkStep.ProcessQueue()1>   at Mono.Linker.Steps.MarkStep.ProcessPrimaryQueue()1>   at Mono.Linker.Steps.MarkStep.Process()1>   at Mono.Linker.Steps.MarkStep.Process(LinkContext context)1>   at Mono.Linker.Pipeline.Process(LinkContext context)1>   at Mono.Linker.Driver.Run(ILogger customLogger)1>   at Mono.Linker.Driver.Execute(String[] args, ILogger customLogger)1>C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\Blazor.MonoRuntime.targets(429,5): error MSB3073: The command "dotnet "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\../tools/illink/illink.dll" -c link -u link -t --verbose  -d "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\../tools/mono/bcl/" -d "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\../tools/mono/bcl/Facades/" -o "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BlazorApp\obj\Debug\netstandard2.0\blazor/linker/" -x "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.build\0.1.0\targets\BuiltInBclLinkerDescriptor.xml" -x "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BlazorApp\obj\Debug\netstandard2.0\blazor\linker.descriptor.xml" -a "C:\Development\Git\Nuget\packages\docker.dotnet\3.125.1\lib\netstandard2.0\Docker.DotNet.dll" -a "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor\0.1.0\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.dll" -a "C:\Development\Git\Nuget\packages\microsoft.aspnetcore.blazor.browser\0.1.0\lib\netstandard2.0\Microsoft.AspNetCore.Blazor.Browser.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.csharp\4.3.0\lib\netstandard1.3\Microsoft.CSharp.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.dependencyinjection\2.0.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\microsoft.extensions.dependencyinjection.abstractions\2.0.0\lib\netstandard2.0\Microsoft.Extensions.DependencyInjection.Abstractions.dll" -a "C:\Development\Git\Nuget\packages\newtonsoft.json\10.0.3\lib\netstandard1.3\Newtonsoft.Json.dll" -a "C:\Development\Git\Nuget\packages\selenium.support\3.10.0\lib\netstandard2.0\WebDriver.Support.dll" -a "C:\Development\Git\Nuget\packages\selenium.webdriver\3.10.0\lib\netstandard2.0\WebDriver.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.buffers\4.4.0\lib\netstandard2.0\System.Buffers.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.collections.nongeneric\4.3.0\lib\netstandard1.3\System.Collections.NonGeneric.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.collections.specialized\4.3.0\lib\netstandard1.3\System.Collections.Specialized.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.componentmodel\4.3.0\lib\netstandard1.3\System.ComponentModel.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.componentmodel.primitives\4.3.0\lib\netstandard1.0\System.ComponentModel.Primitives.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.componentmodel.typeconverter\4.3.0\lib\netstandard1.5\System.ComponentModel.TypeConverter.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.dynamic.runtime\4.3.0\lib\netstandard1.3\System.Dynamic.Runtime.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.io.filesystem.primitives\4.3.0\lib\netstandard1.3\System.IO.FileSystem.Primitives.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.linq\4.3.0\lib\netstandard1.6\System.Linq.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.linq.expressions\4.3.0\lib\netstandard1.6\System.Linq.Expressions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.objectmodel\4.3.0\lib\netstandard1.3\System.ObjectModel.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit\4.3.0\lib\netstandard1.3\System.Reflection.Emit.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit.ilgeneration\4.3.0\lib\netstandard1.3\System.Reflection.Emit.ILGeneration.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.emit.lightweight\4.3.0\lib\netstandard1.3\System.Reflection.Emit.Lightweight.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.reflection.typeextensions\4.3.0\lib\netstandard1.5\System.Reflection.TypeExtensions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.runtime.serialization.formatters\4.3.0\lib\netstandard1.4\System.Runtime.Serialization.Formatters.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.runtime.serialization.primitives\4.3.0\lib\netstandard1.3\System.Runtime.Serialization.Primitives.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.text.regularexpressions\4.3.0\lib\netstandard1.6\System.Text.RegularExpressions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.threading\4.3.0\lib\netstandard1.3\System.Threading.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.threading.tasks.extensions\4.3.0\lib\netstandard1.0\System.Threading.Tasks.Extensions.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.xml.readerwriter\4.3.0\lib\netstandard1.3\System.Xml.ReaderWriter.dll" -a "C:\Program Files\dotnet\sdk\NuGetFallbackFolder\system.xml.xmldocument\4.3.0\lib\netstandard1.3\System.Xml.XmlDocument.dll" -a "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BusinessLogic\bin\Debug\netstandard2.0\FFXIVCollector.BusinessLogic.dll" -a "C:\Development\Git\NetStandard.Extensions\TomSun.NetStandard.Extensions\bin\Debug\netstandard1.0\TomSun.NetStandard.Extensions.dll" -a "C:\Development\Git\NetStandard.Platform\TomSun.NetStandard.Platform\bin\Debug\netstandard1.0\TomSun.NetStandard.Platform.dll" -a "C:\Development\Git\Selenium.Extensions\TomSun.Selenium.Extensions\bin\Debug\netstandard2.0\TomSun.Selenium.Extensions.dll" -a "C:\Development\Git\FFXIVCollector.WebApi\FFXIVCollector.BlazorApp\obj\Debug\netstandard2.0\FFXIVCollector.BlazorApp.dll"" exited with code 1.1>Done building project "FFXIVCollector.BlazorApp.csproj" -- FAILED.========== Build: 0 succeeded, 1 failed, 4 up-to-date, 0 skipped ==========```Is there somewhere  a "not yet supported" list? 
4753	area-servers	Remove use of TestSink in functional tests	Use the TestApplicationLogger
5059	area-mvc	Use JoinableTaskFactory whenever we jump threads in VS.	Today we utilize `Task.Factory.StartNew` and pass in the appropriate scheduler to jump threads. This has led to some confusion in our dispatching in regards to dispatching priorities in the WTE editor. For now these issues have been worked around but we should make our move to hop threads like everyone else does in VS tooling./cc @ToddGrun 
5490	area-mvc	Blazor Language Services for Mac	I think [that](https://developercommunity.visualstudio.com/content/problem/67655/cant-install-vsix-to-vs-for-mac.html) means I need an mpack instead of a vsix? 
5058	area-mvc	Future Investments: Replace Partial Parsing	## SummaryRazor (in the editor) runs a parsing loop on edits to update the extents of projection buffers when edits occur. The primary goal of this process is to do as little work as possible while ensuring that the state of the various buffers reflects an accurate understanding of the document.  When an edit occurs, the editor will attempt to apply that edit to a buffer based on its bounds. Our algorithm attempts to understand if the edit being applied changes the document in a fashion that makes the underlying buffers incorrect, and will run the code generation process, and then update the buffers after a background parse to the correct extents. We refer to an edit which requires no action from us as *accepted*, and an edit which requires us to update the buffers as *rejected*. As a secondary goal, the parsing loop must avoid interfering with various editor systems that provide Intellisense features. This means that we need to defer changes that would update the underlying buffers while completion is being shown, or about to be shown. We do this by introducing the concept of a *provisional* change, where we temporarily treat an edit as *accepted*, but queue a background update of the buffers to ensure that the result is correct eventually.To determine which of these three states an edit falls into, we have a subsystem referred to as *partial parsing* - comprised of an annotated syntax tree and a dedicated thread per-editor. The partial parsing system is pessimistic, and does not reuse the actual Razor parser. Instead, the partial parsing system has special case code that must be correct for many basic editing and intellisense features to function.These two goals are in tension. An algorithm that is maximally pessimistic for accepting changes would always partition the buffers correctly, but would be slow to use and prevent completion from functioning. An algorithm that was maximally permissive would get lots of things wrong, including showing lots of incorrect colorization and completion.I don't believe the current approach will meet all of our goals long terms. We are aware of IDE features that are currently broken such as signature help, and the path that we have to enable these features using the current approach is very challenging. The proposal here is to consider replacing this hand-tuned system with smarter reuse of our actual Razor parser.## Problems with the current approach**Changing projection buffers is expensive** When we redraw the projection buffer boundaries, this causes a bunch of other parts of the editor (C# and HTML) to do work. Currently we don't any differential updates in the case of a *rejected* edit, it updates everything. **Correctness is ad-hoc** [This is](https://developercommunity.visualstudio.com/content/problem/214257/razor-doesnt-recognize-a-changed-model-type-until.html?childToView=219299#comment-219299) an example of a bug that occurs when we're not pessimistic enough.**Pessimism breaks Intellisense** [This is](https://github.com/aspnet/Razor/issues/1255) and example of a bug that occurs when we're too pessimistic.**We're duplicating the code** The more we improve the fidelity of partial parsing without addressing the design issues, the more functionality we duplicate.## Proposed solutionThe proposed solution is that we keep the core idea of a *reactive* parser that updates buffers, but that we use the *real* Razor parser and apply a diff to determine whether to accept or reject a parse. That means that we need to build ideas like provisional changes and regions that should always reject a change into the actual syntax tree. What this looks like end-to-end:- Add *provisional* data to the syntax tree- Add *rejected* data to the syntax tree - Run the *real* parser not the *partial parser*- Apply a diff to the syntax tree and determine if delta matches the edit## Prioritization and costingWe should consider carefully what we're trading off here. On one hand, expanding the set of *partial parser* cases is expensive, ad hoc and error-prone. On the other hand, doing a big investment is risky, time consuming, and doesn't deliver any user value unless we actually address the problems identified here.Our prioritization may change based on a few planned other investments:- If we needed to build a 'component mode' for the Razor parser (Blazor), we would need to retrofit the Razor parser with a deeper understanding of HTML which would be almost a rewrite. - If we were working on VS Code, we might want a language design that is less "chatty", in which case we would care deeply about the performance cost of partial parsing.- If we found more significant IDE features that don't work correctly, that might raise the priority.------The biggest cost, and value of the Razor parser system currently is the tests. Our tests are critical since they are the best 'spec' we have for the Razor language, and the tests for the actual parser are fairly thorough. If we chose to invest here, the first step would be to modernize these tests and reduce the cost of maintenance by moving the baselines into a serialization format. Using serialization and baselines makes it easy to inspect deltas in our parser's behavior, and makes it easy to automate evolution of the parser and syntax design.We additionally should improve our coverage of the editor tests, by building a framework for  *the parser in motion*. This could look similar to what [Roslyn has](https://github.com/dotnet/roslyn/blob/master/src/EditorFeatures/CSharpTest/EditAndContinue/StatementEditingTests.cs). Currently our testing of the *partial parser* is ad-hoc and adding new tests is tedious.These investments could happen at any time without risk or substantial diversion of our resources.I think only after doing these improvements would we have the confidence to do this work in earnest.-----As to the costing of rewriting the *partial parser* to use the actual parser, I think the cost is probably about 3 weeks for a single engineer. This includes getting rid of the concept of 'edit handler' and replacing it with a more semantic notion on each syntax tree node. We also need to account for the cases that currently are treated as provisional in the syntax tree, so that we can still behave correctly in those cases. We need to write a *diff* algorithm to determine how the syntax tree differs and whether to *reject* the edit.
2986	area-middleware	Server side session state in dotnet core web api - How to benchmark and validate if it will benefit my application scalability?	Hi, Our team is writing an Angular + Dotnet Core 2.0 Web API project. We are expecting this application to scale rapidly in the near future and therefore have some questions below:Is maintaining server side state using sessions in a web api project a good practice? I understand this is not how REST works however would like to find out if maintaining server side state would benefit my application. We are expecting this application to scale fast in the near feature. Can someone help me with how to benchmark and find out numbers to validate our choice? - be it a REST ful approach where we send state with each request or persist session state at server and minimize request payload and database trips..? I don't know where to start hence seeking some guidance.
5057	area-mvc	Explicit expressions in tag helper attributes are ignored by the parser, lowered to IR incorrectly	Consider these two usages of a tag helper....```@{ var x = "hi"; }<Foo bar="@x" /><Foo bar="@(x)" />```These two expressions will be lowered differently in the IR, which results in different codegen, and is visible to extensibility.```CSharpExpression:  Token "x"VS CSharpExpression:  Token "("  Token "x"  Token ")"```This is bad because in other places where explicit expressions occur the parenthesis are just delimiters and are considered metacode, not C#. Explicit expressions have the same syntactic form as an implicit expression surrounded by parens, which is why this is egregious. 
5178	area-mvc	aspnet-webpack-react not compatible with react-hot-loader v4	Hello,react-hot-loader/patch has been removed from react-hot-loader v4: [See documentation here](https://github.com/gaearon/react-hot-loader#no-patch-required)A new package for aspnet-webpack-react (v4.0.0?), removing support of "reactHotLoaderPatch", need to be created I suppose.[To remove?](https://github.com/aspnet/JavaScriptServices/blob/04b8c17bdded1d7652f18587a920f740d42985ff/src/Microsoft.AspNetCore.SpaServices/npm/aspnet-webpack-react/src/HotModuleReplacement.ts#L4)```typescriptconst reactHotLoaderPatch = 'react-hot-loader/patch';```[To remove?](https://github.com/aspnet/JavaScriptServices/blob/04b8c17bdded1d7652f18587a920f740d42985ff/src/Microsoft.AspNetCore.SpaServices/npm/aspnet-webpack-react/src/HotModuleReplacement.ts#L52)```typescript        let entryValueArray = entryConfig[entrypointName] as string[];        if (entryValueArray.indexOf(reactHotLoaderPatch) < 0) {            entryValueArray.unshift(reactHotLoaderPatch);        }```[react-hot-loader release note](https://github.com/gaearon/react-hot-loader/issues/707)
5054	area-mvc	Consider not showing Html intellisense after the semicolon following a directive	Follow up to https://github.com/aspnet/Razor/pull/2196.```c#@model DateTime  ;  |```Ideally we don't want to show any intellisense at the end of a directive line. But the fix for this could be complicated as discussed in the PR. IMO we should probably keep this in the back burner and do it if more people are sad about this.Note: We already do the right thing (Not show intellisense) in the most common scenario below,```c#@model DateTime |```
5053	area-mvc	Rzc should use PhysicalRelativePath when logging errors 	Compare an error from csc:```Views\Home\Index.cshtml(3,15): error CS0029: Cannot implicitly convert type 'int' to 'string' [D:\work\Razor\test\testapps\SimpleMvc\SimpleMvc.csproj]```to the one from rzc```D:\work\Razor\test\testapps\SimpleMvc\Views\Home\Index.cshtml(1,2): error RZ1006: The code block is missing a closing "}" character.  Make sure you have a matching "}" character for all the "{" characters within this block, and that none of the "}" characters are being interpreted as markup. [D:\work\Razor\test\testapps\SimpleMvc\SimpleMvc.csproj]```
2979	area-servers	Move BindingAddress to public namespace	I'm not sure why this was made pubternal instead of public and why we're even using pubternal APIs across assemblies. We should fix this and BindingAddress should be public.PS: This will break https://github.com/aspnet/BasicMiddleware/blob/726035e3fb8c4ee31a32522c16ff73278b9b13e7/src/Microsoft.AspNetCore.HttpsPolicy/HttpsRedirectionMiddleware.cs#L124, I'm not sure where else we use it./cc @Tratcher @jkotalik 
5489	area-mvc	Routing enhancements	This issue is to track routing features we're likely to want to add in the future:* Review exactly which parameter constraints we really want to support. For example maybe add `regex`; maybe remove `bool` or limit the set of `datetime` formats more precisely. See #295 for more discussion.* Catch-all segments (e.g., `/products/{*categoryAndName}`)* 404 handler (it's probably not enough just to have a component that matches `/{*anythingElse}`, because for SSR you'd want to know it's really not a match so you could actually return a 404)* Simple method for accessing querystring/hash values (e.g., via new properties on `IUriHelper`)* Multiple nested routers* Outbound URL generation (e.g., `<a page=@About>About us</a>`, or perhaps just by codegenning methods like `<a href=@Products.Url(53)>Duck boots</a>` for each `@page` declaration)* In the `@page` directive, allow the use of compile-time constant expressions, not just literal strings (e.g., #1363).Also the items from #636 that were not yet finalised: * Discover `[Route]` attributes on types in referenced assemblies that themselves reference `Microsoft.AspNetCore.Blazor` transitively * Discover `[Route]` attributes on component base classes (i.e., inherit=true) * In the `Router` component, make it simple to subclass and override a virtual method to change the logic for locating the `IComponent` for a given URL. Currently there's no virtual method for this. * Make `RouteTable`'s `Routes` property `get`-only * Cache route tables per assembly
4754	area-servers	Is a Null Header Value a Set header value?	Setting a Header to null * doesn't change its count (stays at zero)* doesn't change the Response output (header is not output)However it will cause an error if a real value is added after:```csharpapp.Run(async (context) =>{    var resposne = context.Response;    // Prints zero    Console.WriteLine(resposne.Headers["warning"].Count);    // Does not change response    resposne.Headers.Add("warning", new StringValues((string)null));    // Prints zero    Console.WriteLine(resposne.Headers["warning"].Count);    // Throws: System.ArgumentException: An item with the same key has already been added.    resposne.Headers.Add("warning", new StringValues("Hello"));    await context.Response.WriteAsync("Hello World!");});```If you can't smell it, see it, taste it, does it exist?Should it not throw, but set the value? (as no value is set)From https://github.com/aspnet/KestrelHttpServer/pull/2347 (which was treating it as not set for perf reasons; i.e. don't expend extra cycles tracking nothing for no effect other than to just to throw an error on a second add)/cc @halter73 @davidfowl 
5488	area-mvc	Trigger a js custom event after Blazor boot complete	I need to register some javascript functions (using Interop.registerFunction.ts), but currently I can't because `window ['Blazor'].registerFunction` is made available only after booting.Is it possible to insert a 'BlazorOnLoad' event after boot() in boot.ts?
5487	area-mvc	Proposal: make autogenerated BlazorComponent views partial class	I would like to split the Razor c # + html template from the purely functional code of the view and I tried to make every generated class contained in "BlazorRazorComponents.g.cs" with the partial modifier (simply adding it in "Microsoft.AspNetCore.Blazor.Razor. Extensions \ BlazorRazorEngine.cs ").So my views are composed innomeview.cshtml       <- html layoutnomeview.cshtml.cs   <- functional codeThe compilation works without problems.The problem is Visual Studio is unable to "read" the contents of the code in cshtml.cs, showing the error CS1061 'Class' does not contain a definition for 'Method'.Now, adding the directive`@inherits <name of the same class>`instead Visual Studio works correctly, while, obviously, the compilation is not successful because the autogenerated code becomes`public partial class <classname>: <classname> <- the same`But if the code remain`public partial class <classname>: BlazorComponent`both the compilation and Visual Studio would work.Is it possible to make that if implements the same class, BlazorComponent is kept as a base class?
5287	area-signalr	What is the proper way to reconnect?	Since reconnect is gone, when using WebSocket as transport layer what is the advisable way for attempting to maintain a connection always on (by attempting reconnection when connection drop is detected)?It is more like a documentation issue since I didn't find it in documentation.On **server side** I have set a KeepAlive of 3 seconds. I have also seen a NegotiateTimeout property. What is it for?```services.AddSignalR(                options =>                {                    options.KeepAliveInterval = TimeSpan.FromSeconds(3);                    //What is this for?                    //options.NegotiateTimeout                });```On **client side** I have requested for WebSockets with KeepAlive 3 seconds.``` HubConnection = new HubConnectionBuilder()                    .WithTransport(Microsoft.AspNetCore.Sockets.TransportType.WebSockets)                    .WithWebSocketOptions(a => a.KeepAliveInterval = TimeSpan.FromSeconds(3))                    .Build();```There is also ServerTimeout option. What is it for?```HubConnection.ServerTimeout = TimeSpan.FromSeconds(9);```I am currently handling the closing event and performing following actions:```  await HubConnection.StopAsync();await Task.Delay(2000); HubConnection = new HubConnectionBuilder()                    .WithTransport(Microsoft.AspNetCore.Sockets.TransportType.WebSockets)                    .WithWebSocketOptions(a => a.KeepAliveInterval = TimeSpan.FromSeconds(3))                    .Build();//subscribe to eventsawait HubConnection.StartAsync();```Is this the correct way to do it, by building a new HubConnection on closing?Before StopAsync() and starting it again I placed a 2 seconds delay. Should I keep it?
5771	area-identity	Improve external login token/claim flow to identity in default templates	While we have various features today to make this possible it requires a fair bit of wire up and its pretty complex.  See (https://github.com/aspnet/AuthSamples/tree/dev/samples/Identity.ExternalClaims)This issue is to track making the two following scenarios easier:1. Ability to flow any AuthenticationTokens(i.e. refresh/access) to the Identity database2. Ability to flow any claims that are part of the external claims identity into the Identity databaseRelated: https://github.com/aspnet/Identity/issues/628 https://github.com/aspnet/Security/issues/1685
5916	area-hosting	Requests to TestHost do not await the `RequestEnd` diagnostic events.	[I'm writing an OpenTracing instrumentation library](https://github.com/opentracing-contrib/csharp-netcore) that uses the BeginRequest/RequestEnd `DiagnosticSource` events and I'd like to use `TestHost` to write some unit/integration tests.However, it seems like the HttpClient currently only awaits the response and it doesn't wait until _application.DisposeContext() is called (which then creates the DiagnosticSource events). https://github.com/aspnet/Hosting/blob/a041b368bb18a00e4c05c6de36928cf0174a6f60/src/Microsoft.AspNetCore.TestHost/HttpContextBuilder.cs#L70-L71As `TestHost` is for testing the server, it would be great if the client would wait until the request is 100% processed on the server. I currently have to wait/poll a little bit until the underlying task is actually finished.Would you accept a PR for this?
5915	area-hosting	Add graceful shutdown feature to deployers	Enables us to test gracefull shutdown scenarios in functional tests.Send `Q` to IIS Express and `Ctrl+C` to other servers.Possibly throw if the server doesn't stop after a timeout.Required for https://github.com/aspnet/IISIntegration/issues/672
5052	area-mvc	Pasting content prior to @model's TypeName selects everything pasted.	The scenario:```@model Person@using Some.Namespace```Now imagine you want to get rid of the using statement so you copy `Some.Namespace` and paste it right before `Person`.You'd expect for the paste to go through and then to type `.`. What actually happens is the `Some.Namespace` is selected and then you end up replacing it with `.`.VS: 15.7 preview1Chances are this is an external issue but we should investigate nevertheless./cc @sebastienros 
5486	area-mvc	Standalone dev server can't determine whether to run in Debug or Release mode	Currently, the standalone dev server in `Microsoft.AspNetCore.Blazor.Cli` is hardcoded to look for app binaries in `(sourceRoot)\bin\Debug`. If you're launching from the command line, it isn't aware of any `-c Release` flag, and if you're launching from VS, it doesn't know which solution configuration you have enabled.At the moment although I have an idea of how we could fix it for the command line, I'm not sure how we can make it aware of the active VS solution configuration.The main limitation seems to be that we're using the Web SDK. If the standalone app didn't use the Web SDK and was instead more like a pure console app, then on startup the process working directory would be set to the client app's active `bin\(Debug|Release)\(framework)` directory, which would be ideal because then we'd know precisely which `dist` directory to serve. Unfortunately this doesn't work if you use the web SDK because VS *always* sets the working directory to the project root if you're using the Web SDK (https://github.com/dotnet/cli/issues/4473#issuecomment-256674279).In the Web SDK source, there's [a flag called `EnableDefaultRunWorkingDirectory`](https://github.com/aspnet/websdk/blob/dev/src/ProjectSystem/Microsoft.NET.Sdk.Web.ProjectSystem.Targets/netstandard1.0/Microsoft.NET.Sdk.Web.ProjectSystem.targets#L22) that you can set to `false` to cause the working directory to be the bin dir (i.e., `bin\(Debug|Release)\(framework)`). That would be perfect, except it seems that VS doesn't know about this flag and still uses the project root anyway.Putting this on backlog because it's not an insane limitation that the dev server only supports Debug builds (after all, it is the *dev* server).@BillHiebert Do you know:* If there's any way to make VS launch web projects with the CWD set to the active bin folder instead of the project root directory?* And if not, is there any way for a launched executable (set via `<RunCommand>`) to know which solution configuration is currently active?* And if not, might it be possible to extend the VS tooling to respect the `EnableDefaultRunWorkingDirectory` flag in the future?Thanks!
2958	area-middleware	ResponseCaching with Authorization header	Hi,I'm trying to implement ResponseCaching but all my request are Authenticated. My exact needs are to cache all GET request varying on all the query (with *) and on the Authorization header.I don't find a way to do this and the official page that you can't cache requests with the Authorization header. Since near all the applications needs some kind of authentication, I can't find a way to not support this. It can even validate the authorization but returning the cached result instead of calculating it.
2957	area-middleware	Response caching middleware doesn't allow injection of IResponseCache	The response caching middleware uses a MemoryCache object to cache responses and it is hardcoded in the public constructor to use it. See: https://github.com/aspnet/ResponseCaching/blob/master/src/Microsoft.AspNetCore.ResponseCaching/ResponseCachingMiddleware.cs. This makes it impossible to provide your own implementation of IResponseCache. I would for example like to create a DistributedResponseCache so I can have better horizontal scaling.
5286	area-signalr	Support testing with the TestServer	Right now it's not possible to use the SignalR client with the test server for websockets. We should make it possible (other transports work though).
5914	area-hosting	Add a way to configure the IHttpRequestIdentifierFeature to read a configurable header	I am facing the same dilemma as https://github.com/aspnet/KestrelHttpServer/issues/2153. > Setting the trace identifier on the HttpContext isn't particularly helpful for logging because the request start scope was started before any middleware is called, so all logs use the traceidentifer set by Kestrel.Basically, we force all incoming requests to our services to have a correlation-id header as we want to track the whole flow coming from the front-end or any other consumers of our APIs. We also prefer using `X-Correlation-Id` instead of `Request-Id`.Although it seems a workaround is mentioned there by @davidfowl, i think it is valuable having that option configurable at the early stages of creating the webhost.It would great to be able to read from a header or (any other delegate/provider). And propagating that change across to `HostingApplicationDiagnostics.cs` instead of setting it always to look for `Request-Id` header.Also making the property name in the log name configurable is valuable too as it is also statically set to `CorrelationId` as shown in https://github.com/aspnet/Hosting/blob/dev/src/Microsoft.AspNetCore.Hosting/Internal/HostingLoggerExtensions.cs or `RequestId` - for 2.0 - which has the value of the httpcontext.TraceIdentifier that we manually set from our x-correlation-id header.
5485	area-mvc	Extreme E2E test	Now we have project templates and publishing, we should have a maximally end-to-end test that: * Installs the project template package * Creates a new project via `dotnet new` * Restores and builds, launches it in the dev server, verifies it works via browser automation * Check that live reloading works when a source file is edited (when live reloading is implemented) * Publishes * Launches it in the production server, verifies it works via browser automationWe have the majority of the infrastructure we need already (e.g., for starting up test servers and doing browser automation) but this will still be quite involved. There's prior art for installing `dotnet new` packages and using them from E2E tests in the aspnet/templating repo.
5051	area-mvc	Re-enable MonoDevelop FilePath based tests when proper strong named dlls are available.	This is the commit that skipped the tests: https://github.com/aspnet/Razor/commit/a6d03bd4071052c535d51c783ef88cf5150c0a7b/cc @KirillOsenkov
3804	area-servers	ANCM: Inprocess: Usability: Need to write an event error about that standard log file can't be generated if IISExpress is started with console window	According to the below code, we don't support the standard log feature when IISExpress is started with console window. I think we should add an warning event when this happen so that users can figure out why the standard log file is not generated.Repro step:1. Start app with IISExpress in inprocess mode from command window with enabling stdoutLogEnabled="true"2. Send a requestEXPECTED:Log file is generated. Or, we should explain why log file is not generated.ACTUAL:No log file is generated.```            {                // The process has console, e.g., IIS Express scenario                if (_wfopen_s(&m_pStdFile, m_struLogFilePath.QueryStr(), L"w") == 0)                {                    // known issue: error info may not be capture when process crashes during buffering                    // even we disabled FILE buffering                    setvbuf(m_pStdFile, NULL, _IONBF, 0);                    _dup2(_fileno(m_pStdFile), _fileno(stdout));                    _dup2(_fileno(m_pStdFile), _fileno(stderr));                }                // These don't work for console scenario                // close and AllocConsole does not help                //_wfreopen_s(&m_pStdFile, struLogFileName.QueryStr(), L"w", stdout);                // SetStdHandle(STD_ERROR_HANDLE, m_hLogFileHandle);                // SetStdHandle(STD_OUTPUT_HANDLE, m_hLogFileHandle);                //*stdout = *m_pStdFile;                //*stderr = *m_pStdFile;            }```
5484	area-mvc	Tests for the build pipeline	It would be nice to have some tests that verify that the right build outputs are produced/updated/etc. We can probably follow whatever Razor does for RazorCompilation
5483	area-mvc	Investigate ways of making the linker faster	Linking adds 4.792s on my machine for Standalone app. We might need to find ways to make it faster if we want to enable it during builds. ## "Incremental linking".* As part of the linking process we generate a file with all the roots that we found in the linking process and the things that they reference.* When we run the linker a second time, we load this file with the old roots and with the elements that they reference.* We can shortcircuit things that haven't changed in the app.* We can shortcircuit new roots that reference parts of the application that were trimmed on a previous run.* We can improve the speed on roots that disappeared from the application as we already have collected the information that they reference.**The hypothesis here is that on normal changes what we are doing is more of the same. We just add a new view, or reference a new type inside some class, but that the majority of the code doesn't change and doesn't need to be analyzed.**## Linker serverInstead of running the linker as a process, start up a server that can hold information about previous runs and that already has all the required dlls loaded in memory, saving load time and some analysis time on later runs.
5482	area-mvc	Investigate further size reduction optimizations	Right now we run the mono linker optionally as a build step.By linking the app we reduce anything that is not used/referenced directly by the application.There are things that are left behind after this process that will likely not work. For example things related to remoting, binary serialization, etc.We should look into what we can cut while keeping the app working.Maybe we can do something similar to what we did in the prototype and instrumentalize the linked assembly to see what actually gets used in a normal app and what is being left behind just because something is referencing it.
3807	area-servers	Implement IHttpSendFile feature	For In-Proc
3816	area-servers	Indicate to IIS that a response can be kernel cached	
5285	area-signalr	Compile hub method invoke as needed	Today SignalR will compile invoke code for all methods on a hub the first time the hub is accessed, e.g. if a hub has 1000 methods on it then all 1000 will be compiled at once.MVC compiles invoke code as needed, e.g. a lightweight list of actions is calculated for a controller, and then when an action is first used the invoke code is compiled.
5481	area-mvc	Normalize MSBuild paths	Paths in our MSBuild stuff are using '/' we want to normalize them to use '\'. We didn't do it at the time due to issues with invoking the linker. We just need to investigate if it was an error in normalizing them or if the paths need to be using '/'.Filing this item to track this although is low priority given that it doesn't impact the build or the user experience in any way.
2948	area-servers	Consider using ActivatorUtilities.CreateFactory in AuthenticationHandlerProvider 	`ActivatorUtilities.CreateInstance` is 30x slower than invoking factory delegate./cc @Tratcher  @HaoK
6007	area-middleware	Consider using ActivatorUtilities.CreateFactory in CompressionProviderFactory	`ActivatorUtilities.CreateInstance` is 30x slower than invoking factory delegate.
4755	area-servers	dotnet core 2 app returning 502.3 error	### DescriptionOccasionally, we are observing our dotnet core 2 application returning 502.3 errors.The application is been served via IIS and we verified that the application process is indeed running and listening to a port. That exact port number is also been set in by environment variable ASPNETCORE_PORT for that process.When attempting to telnet to the process on that port number, we are seeing Connect failed error.### ReproduceIntermittent, unable to consistently reproduce.### EnvironmentWindows Server 2012IIS 8Dotnet Core 2
5913	area-hosting	Display package version instead of assembly version on error page	The error page we have embedded shows the assembly version of hosting. But AFAIK that's the only place we display that information. If I depend on preview1-final today and then look a the error page it shows me a build number. Which immediately confused me and made me think I had made a mistake about depending on a pre-release somewhere.Can we embed the `-final` version and use that here instead or as well as the build number?
4756	area-servers	Slow response when sending concurrent requests from the same connection	I have a web API server that implements by ASP.NET core 2.0.I have a web page that implements by Angular5. The page calls two different API concurrently. Each API response time about 300ms, but If I call API one by one, each response about 20ms. It seems like the request are locked by something?To verify this issue, I create a Web API project by using default Visual Studio 2017 template.```cs    [Route("api/[controller]")]    public class ValuesController : Controller    {        // GET api/values        [HttpGet]        public IEnumerable<string> Get()        {            return new string[] { "value1", "value2" };        }  }```And a console program that calls API by HttpClient.```cs        public static HttpClient _http = new HttpClient();        static async Task<HttpResponseMessage> HttpGet(string uri)        {            var watch = new Stopwatch();            watch.Start();            var response = await _http.GetAsync(uri);            watch.Stop();            Console.WriteLine("time = " + watch.ElapsedMilliseconds);            return response;        }        static void TestWebApi()        {            // call first time to initial the httpClient            var x = HttpGet("http://localhost:52876/api/values").Result;            Console.WriteLine("Sync....");            for (var i = 0; i < 5; i++)            {                var r = HttpGet("http://localhost:52876/api/values").Result;                var j = r.Content.ReadAsStringAsync().Result;            }            Console.WriteLine("Async....");            for (var i = 0; i < 5; i++)            {                Task.Run(() =>                {                    var id = Guid.NewGuid();                    Console.WriteLine($"[{id}] send...");                    var r = HttpGet("http://localhost:52876/api/values").Result;                    var j = r.Content.ReadAsStringAsync().Result;                    Console.WriteLine($"[{id}] got response");                });            }        }        static void Main(string[] args)        {            TestWebApi();            Console.ReadLine();        }```Output:```texttime = 314Sync....time = 38time = 16time = 97time = 16time = 16Async....[382a2624-520c-4ee2-b652-9a22f623263d] send...[41b61a01-046d-4679-b71b-86976d5ac190] send...[e2c32f5d-2e16-4e96-a337-a3d8d4dcca6e] send...[227beb1d-3732-4b73-8cfa-99ab883689a3] send...[78400e4c-841b-4c83-9936-a13d9acad8bc] send...time = 298[227beb1d-3732-4b73-8cfa-99ab883689a3] got responsetime = 334[e2c32f5d-2e16-4e96-a337-a3d8d4dcca6e] got responsetime = 358[78400e4c-841b-4c83-9936-a13d9acad8bc] got responsetime = 461[382a2624-520c-4ee2-b652-9a22f623263d] got responsetime = 488[41b61a01-046d-4679-b71b-86976d5ac190] got response```The result matches my production website. The response time of the concurrent request is slow.P.S I got the same result if I run web API on the IIS server 8.5
2939	area-servers	Line length limit 100 exceeded on multipart form request	When making the following request on my mac: -```curl -X POST \  http://localhost:8080/upload \  -H 'Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryRiOPcOCObfAkq1Aw' \  -d '------WebKitFormBoundaryRiOPcOCObfAkq1AwContent-Disposition: form-data; name="uid"1252154297730234145_18808100------WebKitFormBoundaryRiOPcOCObfAkq1AwContent-Disposition: form-data; name="label"interior------WebKitFormBoundaryRiOPcOCObfAkq1Aw--'```Against the following controller method: -```[HttpPost]public async Task<IActionResult> UploadAsync(){    if (!Request.ContentType.StartsWith("multipart/"))        return BadRequest();    var form = Request.Form;    return Ok(form.Count);}```I receive the following response: -```{"status":"Failure","errors":[{"code":"InternalServerError","exceptionMessage":"Line length limit 100 exceeded."}]}```If I wrap the Request.Form access in a try catch the following exception stack trace is throw: -```{System.IO.InvalidDataException: Line length limit 100 exceeded.   at Microsoft.AspNetCore.WebUtilities.BufferedReadStream.<ReadLineAsync>d__39.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()   at Microsoft.AspNetCore.WebUtilities.MultipartReaderStream.<ReadAsync>d__36.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()   at Microsoft.AspNetCore.WebUtilities.StreamHelperExtensions.<DrainAsync>d__3.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.GetResult()   at Microsoft.AspNetCore.WebUtilities.MultipartReader.<ReadNextSectionAsync>d__20.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()   at Microsoft.AspNetCore.Http.Features.FormFeature.<InnerReadFormAsync>d__18.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.ValidateEnd(Task task)   at System.Runtime.CompilerServices.TaskAwaiter`1.GetResult()   at Microsoft.AspNetCore.Http.Features.FormFeature.ReadForm()   at Microsoft.AspNetCore.Http.Internal.DefaultHttpRequest.get_Form()   at FileUploadTest.Controllers.UploadController.<UploadAsync>d__4.MoveNext() in /Users/richard/Source/file-upload-test/src/service/Controllers/UploadController.cs:line 50}```
5480	area-mvc	Local storage backed component state	It would be convenient to be able to have component state backed by local storage. Something Like```c#[LocalStorage]public string LocalStorageBackedProperty { get; set; }```Or maybe this?:```c#public LocalStorage<string> LocalStorageBackedProperty { get; set; }```
6006	area-middleware	Add support for PATH_INFO server variable	Hi there,Can you please provide support for the PATH_INFO server variable on IIS. I'm trying to migrate my legacy MVC website to the new one I've built ASP.Net Core. I'm trying to migrate the URL rewrite rules but they don't work as they rely on the PATH_INFO server variable.I get the following error when trying to run my application:Unrecognized parameter type: 'PATH_INFO', terminated at string index: '10'Microsoft.AspNetCore.Rewrite.Internal.IISUrlRewrite.ServerVariables.FindServerVariable(string serverVariable, ParserContext context, UriMatchPart uriMatchPart)Extract from my configure method in startup.cs which reads in an xml file:```using (StreamReader iisUrlRewriteStreamReader =    File.OpenText("IISUrlRewrite.xml"))            {                var options = new RewriteOptions()                    .AddIISUrlRewrite(iisUrlRewriteStreamReader);                app.UseRewriter(options);            }```The example content of the IISUrlRewrite,xml file is:```<rewrite>  <rules>    <rule name="Redirect /foo to foo2" stopProcessing="true">      <match url=".*" />      <conditions>        <add input="{PATH_INFO}" pattern="^/foo$" />      </conditions>      <action type="Redirect" url="http://www.foo2.co.uk" appendQueryString="false" />    </rule>  </rules></rewrite>```If I change {PATH_INFO} to {QUERY_STRING}, the application loads but this isn't the redirect I need. Can you please provide support for this ASAP please?In the meantime, is there a workaround I can use that will support {PATH_INFO} patterns on IIS?Thanks
2935	area-middleware	Stack Overflow with DistributedSession access inside custom ILogger	My custom ILogger implementation accesses the session object to retrieve and log the session ID, but the session has not been loaded yet and results in a recursion causing a StackOverflowException. The message during the recursion is 'Accessing expired session, Key:xxxx'. My custom logger uses `IHttpContextAccessor` to retrieve the HttpContext and ISession object.The ISession is a DistributedSession instance, and from the [code](https://github.com/aspnet/Session/blob/be6b099f6ce45bc1308f2135dbd1bfe295e20a98/src/Microsoft.AspNetCore.Session/DistributedSession.cs#L181), we see that logging occurs before the isLoaded variable is set to true which results in a recursion when the _isNewSessionKey flag is initialized as false.I was able to mitigate this error by using DataProtection with persisted keys.    services.AddDataProtection()        .PersistKeysToFileSystem(new DirectoryInfo("keys"));My app is `netcoreapp2.0`, but I see someone reported this same issue in [StackOverflow ](https://stackoverflow.com/questions/40133462/stackoverflowexception-in-serilog-enricher) :smile: back in 2016.Is there an alternate way to retrieve the session ID from inside the logger?
5885	area-servers	NotifyOnCompleted does not catch exceptions, may abort the response/connection	NotifyOnCompleted should catch and log its own exceptions as to not disrupt the normal request flow. It doesn't.https://github.com/aspnet/HttpSysServer/blob/336e85d19abcdf3ec3a024cb9431c768a4e5d494/src/Microsoft.AspNetCore.Server.HttpSys/MessagePump.cs#L204-L214https://github.com/aspnet/HttpSysServer/blob/336e85d19abcdf3ec3a024cb9431c768a4e5d494/src/Microsoft.AspNetCore.Server.HttpSys/FeatureContext.cs#L586-L591It also fires before the response is flushed/disposed so these exceptions may abort the response/connection.Compare to https://github.com/aspnet/KestrelHttpServer/pull/2324
4883	area-mvc	DefaultApiDescriptionProvider does not support Task-like types	If an action returns `Task<Product>`, ApiExplorer will unwrap the `Task` and report the response type as `Product`. We need to apply the same treatment to Task-like types e.g. `ValueTask<Product>`, which is supported by action invocation.
5770	area-identity	Cannot link external logins in 1.0.0/1.0.1 Individual auth templates	_From @Eilon on October 24, 2017 21:42__From @HaoK on October 27, 2016 18:41_Repro:- New Individual Auth App- Add 2 external auth providers (i.e. facebook/twitter/google)- Register a local user and password- Manage -> Add External Login -> First Facebook/twitter/google will work- Second will result in access failed.Original issue: https://github.com/aspnet/Identity/issues/1005This has been mitgated somewhat in 1.1 by https://github.com/aspnet/Security/pull/980A potential fix is to add the equivalent signout code to ManageController's LinkLogin + LinkLoginCallback(when add login was successful).  I verified that this enables things.Similar to: https://github.com/aspnet/Templates/commit/306fbc6b62c01a55c77399688ae57e11f3f6f359_Copied from original issue: aspnet/Templates#686__Copied from original issue: aspnet/templating#103_
5769	area-identity	UX issues related to Identity	_From @Eilon on October 24, 2017 21:51__From @SteveSandersonMS on May 9, 2016 16:32_It's debatable to what extent any of these are "bugs", since the template is just a starting point and not meant to be a finished, polished app. But many of them can be fixed easily.1. **Default "External Logins" UX is confusing**      It says "External logins: 0 [Manage]". When you click 'Manage', it takes you to a blank page (there's just a heading - no content). What's an end user supposed to do with this? There should at least be some instructions here for the developer, like on other pages.2. **Default 'Manage your account' layout is bad**      Screenshot:   ![screen shot 2016-05-09 at 17 20 10](https://cloud.githubusercontent.com/assets/1101362/15119713/1fffe7a0-160a-11e6-8a0d-37431e1c4c33.png)      The text "Two-Factor Authentic..." is truncated for no good reason, and its counterpart in the next column isn't correctly vertically aligned with it.3. **Change password UI is rough**      The heading "Change Password." is inconsistently capitalised (on other pages like "Log in." and "Forgot your password?" we don't capitalise the first letter of each word). The subheading, "Change Password Form", is completely pointless. Suffixing headings like "Change Password." with period characters is weird and ugly in my option, though that's just a matter of personal preference.4. **The account management page is hard to discover**      To reach it, you have to click the part of the heading that says "Hi [username]!". There's no clear indication that this is how to manage your account.5. **When using confirmation URLs, the registration flow provides no indication of what's going on**      If you set up account confirmation [as per the docs](http://docs.asp.net/en/latest/security/authentication/accconfirm.html), then when the user registers an account, they just get redirected back to the home page. They are not logged in, and there's no message to say their registration succeeded. It would be nice to display some sort of message like "Please check your email and click the link we sent to you.", otherwise the user may think their registration was rejected.6. **Login failed message is unhelpful**      When you enter the wrong username or password, it says "Login attempt failed", without indicating whether it's a bad username or password. I know from reading the code that this is deliberate, but I don't know what sort of benefit it's supposed to provide. An attacker who wants to know whether a given username is registered can easily find out (just try to register a new account with it), so why withhold genuinely useful information from legit users?7. **Account-not-confirmed error message makes little sense**      If you try to log in before confirming your account, it says "You must have a confirmed email to log in". That won't make any sense to normal users. What's a "confirmed email"? A better message would be "Please check your email and click the link we sent to you."8. **No way to resend confirmation email**      If you somehow didn't receive (or accidentally deleted, etc.) your confirmation email, then your account is dead forever, because there's no way to resend it. It's worse still if v1 of your site didn't implement confirmation emails, but v2 does, because then all existing users lose their accounts.9. **Set password page when you login with external authentication provider**   Delete this line as it looks ugly in the markup: https://github.com/aspnet/Templates/blob/dev/src/Rules/StarterWeb/IndividualAuth/Views/Manage/SetPassword.cshtml#L6_Copied from original issue: aspnet/Templates#551__Copied from original issue: aspnet/templating#115_
5768	area-identity	[Identity UI] Consider adding more id or similar attributes	These packaged UI elements are going to need to be style-able using CSS, so maybe it's worth adding more `id` or `class` or even just `data-xyz` attributes to various elements (for example, the `section`s on the Login page with the user/password and the external providers, or the individual buttons for the providers), and documenting those attributes for designers to work with.Happy to contribute this if wanted.
4882	area-mvc	Why does SelectList no longer support a constructor which takes a list of disabled items?	In Asp.Net MVC the SelectList has a constructor overload of the form:```csharppublic SelectList(    IEnumerable items,    object selectedValue,    IEnumerable disabledValues)```However, in Asp.Net Core MVC, there is no longer a constructor which takes disabled items as a parameter:```csharppublic SelectList(        IEnumerable items,        string dataValueField,        string dataTextField,        object selectedValue,        string dataGroupField)```Was this a conscious decision or would you accept a pull request to support this use case?
4880	area-mvc	Redesign the ViewEngine to be async	* `IViewEngine` could be designed to be made without relying on HTTP. This may allow for not-HTTP scenarios such as email generation in background tasks. An alternative to this would be to recommend using components for this.* Requirements for resdesign:    - Existing scenarios must work    - Have a package that does runtime compilation. Cannot be shipped with the shared fx, but can depend on it.* `IViewEngine`    - `FindView` \ `GetView` could be merged if we can flow the `ExecutingFilePath` thru. ```C#interface IViewFactory{    IViewTemplatingSystem FindViewAsync(ViewFactoryContext); // This is the combined API}public readonly ViewFactoryContext{    public ActionContext ActionContext { get; set; }    public string ExecutingFilePath { get; set; }    public string Name { get; set; }    public bool IsMainPage { get; set; }}IViewTemplatingSystem.ExecuteAsync(Options)```![20181116_224609997_ios](https://user-images.githubusercontent.com/174281/48652608-3d347300-e9b5-11e8-85dd-8e8229d22e90.jpg)
4879	area-mvc	Create an Analyzer to warn customers to not user Required attribute on top-level parameters	
5479	area-mvc	PWA template	I'm extremely excited about this project, but even more so if Blazor could be integrated with the principles behind creating "Progressive Web Apps". Of course, this would mean that interop with the Service Worker would be required (among other things).With the recent beta release of Google's Flutter, can Microsoft one-up them by using a better language with better tooling in order to create apps with an even better reach? Blazor PWA's just might be the answer...
5478	area-mvc	Online interactive tutorials	One of the cool features of both [KnockoutJS](http://learn.knockoutjs.com/) and [TypeScript](https://www.typescriptlang.org/play/index.html) (as well as many other libraries) is the online tutorial where users can learn by typing the code in a browser, have it compiled and run on the same page.It would help building Blazor tutorials (as well as help adoption) if this were possible - not sure how much work it would be to the tooling/compiler setup to have a web-assembly version of it?
5477	area-mvc	Consider changing URLs of .NET assemblies not to end with .dll	I wanted to see the demo at https://blazor-demo.github.io/ and my corporate firewall blocked `MicroApp.dll`, while other dlls downloaded successfully. Since a lot of software is paranoid about downloading/transferring windows binaries, maybe it's worth obfuscating them a bit? Or, at least, renaming?
4878	area-mvc	Error information for deserialization failures should be at the appropriate level in the model state	In 2.1 preview1 with this web api controller:```c#namespace WebApplication21.Controllers{    [ApiController]    [Route("api/[controller]")]    public class ValuesController : Controller    {        // POST api/values        [HttpPost]        public IActionResult Post([FromBody]Value value)        {            return Ok(value);        }    }    public class Value    {        public int Count { get; set; }        [Required]        public string Text { get; set; }    }}```If I send this request with invalid JSON:```POST /api/values HTTP/1.1Host: localhost:44332Content-Type: application/jsonCache-Control: no-cache{ "count": "abc" ```I get this response:```{"count":["Could not convert string to integer: abc. Path 'count', line 1, position 16.","Unexpected end when deserializing object. Path 'count', line 1, position 17."]}```Notice that the error for the deserialization failure is associated with the count property. I think in this case it should be a top level error instead.
2906	area-servers	Consider adding a version of Response.Cookies.Append that does not encode	I have run into the scenario where I'm receiving cookies properly encoded from a third party system and when calling ```Response.Cookies.Append``` it is doing a second round of encoding. Could you consider adding another property to ```CookieOptions``` to skip the encoding? Basically:```cs//inside a controllerResponse.Cookies.Append("KeyEncoded", "ValueEncoded", new CookieOptions { Raw = true });```This ```Raw``` property would mean: trust me, the key and the value are already encoded.
5884	area-servers	Should HttpSysDefaults.AuthenticationScheme be a const string?	Right now it is a `readonly` field and is disallowed to use in a `const` context. Also this is inconsistency with other authentication packages like `JwtBearer`.### Expected resultThis should compile:```cs[Authorize(AuthenticationSchemes = HttpSysDefaults.AuthenticationScheme)]public class FooController : Controller{    // ...}```### Actual resultCS0182 compilation error: _An attribute argument must be a constant expression, typeof expression or array creation expression of an attribute parameter type._
4877	area-mvc	Add support for ViewDataAttribute in Razor views	As part of https://github.com/aspnet/Mvc/issues/6525, one interesting idea was to introduce a new directive + supporting semantics to add ViewDataAttribute to Razor views.Some ideas:```@viewdata string Title@viewdata string Title "Home Page"``` A possible prereq for this might be revisit the architecture of `RazorView`. Unlike controllers and Razor Pages which have a way to control behavior and lifecycle without having to bake things in via filters, `RazorView` does not a similar mechanism. It would be worth while to see if we could bestow upon it traits similar to filters that let you manipulate execution without having to build it in.
2902	area-servers	Accept header with no q value is null not 1	When inspecting an Accept header with that has a media type with no `q` value the `Quality` value is null.*Request:*<img width="822" alt="screen shot 2018-02-24 at 20 56 02" src="https://user-images.githubusercontent.com/105126/36635289-0dd5c414-19aa-11e8-8bbc-9ee63c901e75.png">*Server:*<img width="1054" alt="screen shot 2018-02-24 at 21 01 35" src="https://user-images.githubusercontent.com/105126/36635292-1451a2d6-19aa-11e8-8e77-f870004e585a.png">In the spec it states https://tools.ietf.org/html/rfc7231#section-5.3.1 `If no "q" parameter is present, the default weight is 1.`ASP.Net Core has made the `Quality` value on `MediaTypeHeaderValue` a nullable double and if no `q` is found mark it is null.When processing a request based on an Accept header I have to execute the following code for it to be correct ie/ default it to 1 if null<img width="764" alt="screen shot 2018-02-24 at 21 17 11" src="https://user-images.githubusercontent.com/105126/36635319-86a1fffc-19aa-11e8-85cd-58b527d84bec.png">
5050	area-mvc	Tag Helper discovery ignores some case of property shadowing	referring to : https://github.com/aspnet/Razor/blob/dev/src/Microsoft.CodeAnalysis.Razor/DefaultTagHelperDescriptorFactory.cs#L387Found this by inspection while working on similar code in Blazor. When walking up the inheritance chain, we use a dictionary to track property shadowing, but we also ignore any properties that don't meet our conditions for binding - **without** creating an entry in the dictionary. This means the following wouldn't work but seems like it should.```public class A : ITagHelper{    public string Foo { get; set; }}public class B : A{    [HtmlAttributeNotBound] // Prevent callers from setting this, I will compute the value    public new string Foo { get; set; }}```We'd still allow the user to set `Foo` even though the derived class doesn't want it to be bound.The fix for this would be to create an entry in the dictionary for each property we want to see, and also track what 'kind' of property it is: *ignored*, *bindable*, *bindable+dictionary*, etc.
5476	area-mvc	Developer exception page	Currently if there are any unhandled client-side .NET exceptions, Mono logs them to the console (which is reasonable for Mono to do). But within Blazor it would be nice to display the exception details in a friendly, formatted way within the browser UI itself, perhaps looking like an ASP.NET server-side developer exception page.In the previous Blazor prototype this was implemented as a non-dismissable full-screen overlay. The way you made it go away was to change your code which (via live reloading) triggers a page refresh.As a separate work item, we should consider catching exceptions thrown by components during their known lifecycle methods (e.g., rendering). In this case we might choose not to display a full-screen error overlay, but instead display the affected component in some kind of "dead" state (e.g., exclamation mark icon). This is more suitable for production time errors where just because one component died doesn't mean you necessarily want the rest of your app to disappear.
5049	area-mvc	Add implements directive	We should add an `@implements` directive to our set of 'in the box' directives that can be reused. Blazor needs this. For now we're implementing this in Blazor, but it's just generic .NET stuff, so there's no reason why it can't live here.
5048	area-mvc	Flow BaseNamespace into Razor	Blazor needs this, and we've worked around not having it for a long time in MVC.There doesn't seem like a good reason **not** to do this 😆 
2895	area-servers	Override Span and Memory Writes for HttpResponseStreamWriter 	For netcoreapp2.1Also WriteLine and WriteLineAsync as the [default implementations on TextWriter](https://github.com/dotnet/corefx/blob/0fbb5f15e2c9b7ff51f5d194dbf06c406c14da9e/src/Common/src/CoreLib/System/IO/TextWriter.cs#L551-L580) are not great
2894	area-servers	HttpResponseStreamWriter never calls Flush on the Stream	Not when the user calls it; and not when its DisposedThe Stream is never Flushed; if its a buffered Stream this will cause issues.
4757	area-servers	Create request body pipe reader by decorating the connection pipe reader	This should be more efficient than pumping request body data into a new pipe.
5475	area-mvc	Run .NET in a worker thread	It will be a while before we get to this, but various parts of the architecture are already designed with this in mind.We should support running Blazor in two modes, auto-selecting which one is best for the current user's browser: * **On the browser's main JS thread**, which is necessary for older browsers that don't support WebWorker. The .NET/JS interop can continue using shared memory if we find it's necessary to have good perf on those older browsers (and thread safety is not difficult because it's all synchronous). * **In a web worker (background thread) on more up-to-date browsers**. The .NET/JS interop will need to work by serializing any data that is being transferred rather than passing pointers [1].This will be advantageous because then, even if your .NET code does something that locks up the CPU (such as a GC cycle), the UI will remain perfectly smooth (e.g., during animations or scrolling, or while the user is typing quickly into a textbox).The existing UI update mechanism is designed around transferring batches of minimal diffs from .NET to JS, so it shouldn't be hugely difficult to have it express those diffs as serialized data rather than pointers into the WASM memory space. We'll have to be careful around things like event handling to ensure that the asynchrony can't result in inconsistency of behaviour versus the synchronous single-threaded model. For example, we will need to force all event delivery to be async as far as the JS side is concerned, even in the non-worker-thread case.*[1] Strictly speaking, we could also do it with shared memory on even newer browsers that support SharedArrayBuffer. But if we can get satisfactory perf without this, it would be better to serialize because it would mean fewer combinations of browser scenarios, and saves us having to deal with potentially complex thread-safety concerns on the .NET side.*
5474	area-mvc	Design review: Layouts	Currently, the layouts feature uses temporary fake directives such as `@(Layout<SomeType>())`. Once we're able to put in Blazor-specific directives, we should remove this and clean up the API.We'll also review to what extent we want to make it look similar to Razor Pages layouts. It's not the same thing as Razor Pages layouts because it's a stateful component architecture rather than a one-time HTML-string generator, but we may choose to make the APIs more similar.
5473	area-mvc	Handle scenario where an event handler was specified as the wrong type	Originally reported in #135 Currently if you declare an event handler with `onsomeevent=@something`, and `@something` isn't a `UIEventHandler`, then at runtime when the event is triggered, you will get `There is no event handler with ID 0`. This is because we only assign event handler IDs when the attribute value is the type we recognize (`UIEventHandler`).Options:* Handle it at compile time. Helpers like `@onclick(...)` cover this already, because they are defined to accept a `UIEventHandler`, and the compiler will automatically create one of those for you if you try to pass a compatible `Action<UIEventArgs>` or similar. Or we could have tag helper-type infrastructure that limits what values you can give for all attributes whose names correspond to known HTML events.* Handle it better at runtime. If you try to raise an event and the corresponding handler attribute didn't have an event handler ID, report something like `Cannot trigger event handler for {eventname} because is not of the correct type. Event handlers must be of type UIEventHandler; you supplied {othertype}.`
4758	area-servers	Improve performance of Kestrel functional tests	The Kestrel functional tests (`Kestrel.Transport.Libuv.FunctionalTests` and `Kestrel.Transport.Libuv.FunctionalTests`) take about 1m20s on my machine.  The long poles are:# Test Discovery (20s)```[xUnit.net 00:00:00.0053998] xUnit.net VSTest Adapter v2.4.0-beta.1.build3945 (64-bit .NET Core 4.6.26130.05)[xUnit.net 00:00:00.6509470]   Discovering: Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.FunctionalTests[xUnit.net 00:00:21.3632566]   Discovered:  Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv.FunctionalTests```We may need to profile xUnit and/or `dotnet test` to see why discovery is taking so long.  Command to profile:```dotnet test --no-build -f netcoreapp2.1 --filter "FullyQualifiedName=foo"```# KeepAliveTimeoutTests.TestKeepAliveTimeout (60s)Measure each of the 6 tasks executed in parallel.  I know some of them take at least 30s.
5767	area-identity	Email confirmation doesn't get sent if the user registers with a social login provider	* With a social login provider enabled and email confirmation set to required, go to login.* Click on the social login provider.* After successful login with your provider, you'll be prompted to introduce your email to finish login/registration.* Introduce your email and continue.* No email got sent.* Logout.* Try to log-in with your social login provider.* You'll be prompted again to introduce your email.* If you try to introduce the same email as before we will tell you that the email is invalid.* There is no way to complete the registration as you didn't get a confirmation email.* There is no way to "forget" the association between the social login provider and your unconfirmed email account in order to retry the process.
5766	area-identity	Social login provider options don't show up in register	* With a social login provider enabled, go to register.* No social login provider is displayed.* It shows up in the login view.
5765	area-identity	Social login provider options disappear after failed login attempt	* With a social login provider enabled, go to login.* You'll see the social login provider listed.* Try to log in with user name and an incorrect password* The social login provider will disappear when the pagegets re-rendered.
4876	area-mvc	Remove RazorProject ViewEngine constructor	It's currently marked as obsolete. In the next major release we should remove it.
4875	area-mvc	Remove service registration of Legacy Razor compilation infrastructure	Today we have service registrations for non-breaking reasons for the `RazorProject`, `MvcRazorTemplateEngine` and `RazorEngine` types. Now that we've moved to `RazorProjectEngine` we can remove all of these registrations in the next major release.
2879	area-middleware	Provide an AddStaticFiles extension method on IServiceCollection	This method will configure the default configuration options for static files and allow libraries avoid having to replicate the logic to set the default options. See https://github.com/aspnet/Identity/blob/dev/src/UI/IdentityDefaultUIConfigureOptions.cs#L52-L62To be very clear, this is not about requiring a method call to services.AddStaticFiles() to use StaticFiles but to allow other libraries to call it in order to ensure that the options were initialized correctly.
5177	area-mvc	Retain custom added response headers when serving UseSpaPrerendering response	UseSpa has configuration.options.DefaultPageStaticFileOptions.OnPrepareResponseUseSpaStaticFiles has options.OnPrepareResponseUseSpaPrerendering does not have this option.Without this, I cannot add http cache headers, so any server-side rendered Angular/React pages will be re-requested by the browser on each refresh. They also cannot be server-side cached via app.UseResponseCaching(); because it is looks at the http cache headers.app.UseResponseCaching() would be ideal for server-side rendering because TimeToFirstByte can be slow for non-trivial apps. UseSpaPrerendering actually boots up a separate node instance to run your server app for every incoming request, it doesn't leave the app running in-beween requests. This can be worse if your app bootup is slower than normal (i.e. has setTimeouts, needs ajax data, parses large json files, etc). Also, if you're using extra Middleware like app.UseResponseCompression() TTFB will be even slower. One workaround is to create a custom middleware to add the headers after SpaPrerendering is done. However, it is a little tricky because you can't easily modify the response after SpaPrerendering is complete. One option used by many other middlewares is to create a "shim" to wrap the real response stream with a fake one.Example below:```  public class ShimmedResponseContext  {    public HttpContext _httpContext { get; }    private Stream _originalResponseStream { get; set; }    private MemoryStream _shimmedResponseStream { get; set; }    public ShimmedResponseContext(HttpContext httpContext)    {      _httpContext = httpContext;    }    public void ShimResponseStream()    {      _originalResponseStream = _httpContext.Response.Body;      _shimmedResponseStream = new MemoryStream();      _httpContext.Response.Body = _shimmedResponseStream;    }    public void UnshimResponseStream()    {      _shimmedResponseStream.Position = 0;      _shimmedResponseStream.CopyTo(_originalResponseStream);      _httpContext.Response.Body = _originalResponseStream;    }  }    app.Use(async (context, next) =>  {	var shimmedContext = new ShimmedResponseContext(context);	shimmedContext.ShimResponseStream();	await next();	context.Response.Headers[HeaderNames.CacheControl] = "public,max-age=" + TimeSpan.FromDays(30).TotalSeconds;	context.Response.GetTypedHeaders().CacheControl = new CacheControlHeaderValue()	{	  Public = true,	  MaxAge = TimeSpan.FromDays(30)	};	context.Response.Headers[HeaderNames.Vary] = new string[] { "Accept-Encoding" };	shimmedContext.UnshimResponseStream();  });    app.UseSpa(spa => { ...	spa.UseSpaPrerendering(options => ...```
5047	area-mvc	Automatic quote marks insertion inserts extra letters	Version 15.6 Preview 5In a Razor view/page, type:```http://microsoft.com```Put cursor at the beginning and type `<a href=`Expected: `<a href=""http://microsoft.com`Actual: `<a hhref=""http://microsoft.com`
3803	area-servers	TCP packet size too small causing poor throughput	Originally reported by @mateanticevic> I have the same problem and noticed something strange. There's a huge amount of TCP packets as they are way below the MTU size limit. I reckon this is the cause of the slow download. This happens only with IIS in front of Kestrel. With Kestrel alone it doesn't happen.AspNetCore MVC 1.1.1 ~675kB ~11500 packets ~2s download![image](https://user-images.githubusercontent.com/4734691/36193084-4d097278-1119-11e8-9e06-9b76c455648c.png)> Tested a similar call in an old app with Web forms and the difference is obvious.Web forms ~675kB ~750 packets ~200ms download![image](https://user-images.githubusercontent.com/4734691/36228140-42b193ae-1188-11e8-9932-830596d8d980.png)
3811	area-servers	Test ANCM websockets against the Autobahn Test Suite	See [this](https://github.com/aspnet/WebSockets/tree/dev/test/Microsoft.AspNetCore.WebSockets.ConformanceTest) for reference
4874	area-mvc	Proposal: expand anchor tag helper to make single-parameter changes easier	A common scenario I run into is needing to use the current query string (action parameters) and change 1 for the purposes of sorting or filtering (e.g. a search query against the current other filters). Let's take an example:```/path/page?minRuns=20&filter=someText&database=PRIZM&sort=RunsPerSecond&order=Asc```In the view, I have a table with columns with headers that are sorting links.  Let's say I have 3 columns so the headers look like this:```html<th><a href="/path/page?minRuns=20&amp;filter=someText&amp;database=PRIZM&amp;sort=Runs">Runs</a></th><th><a href="/path/page?minRuns=20&amp;filter=someText&amp;database=PRIZM&amp;sort=Duration">Duration</a></th><!-- repeat 8 times... -->```Currently, generating the query string of a thing that *differs by one* is something users have to do very manually, generally with a builder or making a collection to serialize per link in a helper. I think this could be made much cleaner as something the framework provides. You can *almost* do this today with [`asp-all-route-data` via tag helper](https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/built-in/anchor-tag-helper#asp-all-route-data), but it could be improved.Here's the most succinct way I can find to do this today (note this is just query params, but you get the idea):```html@{ var routeDict = Context.Request.Query.ToDictionary(q => q.Key, q => q.Value.ToString()); }<th><a asp-all-route-data="routeDict" asp-route-sort="@Sorts.Runs">Runs</a></th><th><a asp-all-route-data="routeDict" asp-route-sort="@Sorts.Duration">Duration</a></th>```## ProposalWhat if the anchor tag helper allowed `asp-all-route-data` without a value? The default would be the current route data. Since this already works in combination with `asp-route-{key}="value"`, the combination becomes simply:```html<th><a asp-all-route-data asp-route-sort="@Sorts.Runs">Runs</a></th><th><a asp-all-route-data asp-route-sort="@Sorts.Duration">Duration</a></th>```Perhaps there's a simpler and/or different way to achieve this (e.g. a new attribute), I was just thinking minimal changes would save code and open up use cases here. Thoughts?/cc @DamianEdwards 
5046	area-mvc	Can't use @(...) in asp-for	_From @taylorjandrew on October 31, 2017 11:12_The asp-for casting shown below used to work in core 1.0 and core 1.1 but now doesn't in core 2.0?`<input asp-for="@(Model as ServiceOperative).JobTitleClient" class="form-control" />`It now gives the following error -**InvalidOperationException: Templates can be used only with field access, property access, single-dimension array index, or single-parameter custom indexer expressions.**The following gets round the initial error, but then renders the name/id as somodel_JobTitleClient - which then will not bind to the object server-side`var somodel = (Model as ServiceOperative);``<input asp-for="@somodel.JobTitleClient" class="form-control" />`I tried a bunch of alternatives to the above but had to revert to using @Html.EditorFor for now...   =painful rework   :(_Copied from original issue: aspnet/Mvc#7008_
5176	area-mvc	aspnet-webpack: mismatch in environmentvariables	The Microsoft.AspNetCore.SpaServices 2.0.2 NuGet package sends a property named `EnvironmentVariables` for the environment variables passed to the Webpack dev middleware.The aspnet-webpack 2.0.3 NPM module expects a property `EnvParam`.The result is that a webpack configuration that exports a function expecting an environment, is passed `undefined` instead of an object.(Also; I'm not sure, but it may need to be passed the values in `process.env` and at the very least should be passed an empty object. Not `undefined`.)
5045	area-mvc	Make ITagHelperComponent.Init asynchronous	There are cases when I need to have asynchronous code in tag helper's `Init` method. Common example for `Init` usage is when I need to populate `Items` or `ViewData` for child tag helpers **before** they run. Basically, `Init` and `ProcessAsync` are just two steps of processing, which allow to order the logic parts between related tag helpers. So, its barely understandable why its not expected that `Init` can do async stuff in the same way as `ProcessAsync`. For instance, I want to use `IAuthorizationService.AuthorizeAsync` and attribute-provided policies in `Init` to do authorization and put results into ViewData to be used by (non-direct) child tag helpers. In this case I would only run that code once - on the parent tag.Since this is not possible I have to instead put policies list into ViewData and make each child tag helper call `IAuthorizationService.AuthorizeAsync` in `ProcessAsync` every time its run (actually repeating the same code with same results many times).
5044	area-mvc	Consider adding special tag directives for If and ForEach in Razor	Kindly consider adding special directives for If and ForEach in Razor directly within tags.Consider the following contrived example:`var items = new[] { "Item1", "Item2", "Item3" };``var showItems = items.Length > 0;````<div class="row">    <div class="col-md-3">        @if (showItems)        {            <div>                <h2>@items.Length Items found:</h2>                <ul>                    @foreach (var item in items)                    {                        <li>@item</li>                    }                </ul>            </div>        }            </div></div>```Using special directives within the tags, the markup could be simplified to something like this:```<div class="row">    <div class="col-md-3">        <div @if="showItems">            <h2>@items.Length Items found:</h2>            <ul>                <li @foreach="var item in items">@item</li>            </ul>        </div>    </div></div>```For simple cases like shown above this could greatly reduce the number of lines and level of identation needed within a razor file and thus makes it easier to understand the code. As a side effect, the rendered razor html would have less identation issues as it would have with the original approach using "proper" if and foreach clauses.
4759	area-servers	Log HTTPs cert info on startup	Kestrel logs endpoint when the server starts, but doesn't log which certificates were used. Now that Kestrel endpoints and certs can be configured from a file https://github.com/aspnet/KestrelHttpServer/pull/2186, it would be nice to show console info to help users identify if their config was correctly used.Some ideas:From store, show friendly name    Now listening on: https://localhost:5001    Using server certificate: "ASP.NET Core HTTPS development certificate" from cert:\CurrentUser\MyFrom store, show subject    Now listening on: https://localhost:5001    Using server certificate: CN=localhost, cert:\CurrentUser\MyFrom store, include more info like thumbprint    Now listening on: https://localhost:5001    Using server certificate: CN=localhost, cert:\CurrentUser\My, 52A477BBEDE8DFDEB699106D5FFB8FE89F9BF790From file    Now listening on: https://localhost:5001    Using server certificate: C:\dev\test\cert.pfxMultiple certs    Now listening on: https://localhost:5002    Using server certificate: C:\dev\test\cert2.pfx    Now listening on: https://localhost:5001    Using server certificate: C:\dev\test\cert1.pfx
4385	area-servers	Configure certificate by thumbprint	Would be nice if we could configure server certificates via thumbprint + store name.Example usage in appsettings.json:```json{  "Kestrel": {    "Endpoints": {      "Myendpoint2": {        "Url": "https://+:443",        "Certificate": {          "Store": "CurrentUser/My",          "Thumbprint": "52A477BBEDE8DFDEB699106D5FFB8FE89F9BF790"        }      }    }  }}```
4661	area-security	CookiePolicyOptions sets minimumsamesitelevel to lax by default and that breaks oauth providers	This happens when you plug-in the cookie policy middleware on the app and use an oauth provider for authentication.
5043	area-mvc	Linked Views not working in WebApplication	_From @reaction1989 on February 9, 2018 8:50_Hello,i am trying to share the _Layout.cshtml over multiple projects. I created links in each project, but the application won't run.I am getting this exception: ```An unhandled exception occurred while processing the request.InvalidOperationException: The layout view '_Layout' could not be located. The following locations were searched:/Views/Account/_Layout.de.cshtml/Views/Account/_Layout.cshtml/Views/Shared/_Layout.de.cshtml/Views/Shared/_Layout.cshtml```While googling i found this old entry on stackoverflowhttps://stackoverflow.com/questions/24075105/can-i-use-views-in-folders-linked-from-other-projects_Copied from original issue: dotnet/project-system#3232_
5042	area-mvc	Design time code generation is required to implement IDesignTimeDirectiveTargetExtension and maybe that shouldn't be required	A few facts:- Our default IR passes always generate a `DesignTimeDirectiveIntermediateNode` - even if there are no directives- The `DesignTimeDirectiveIntermediateNode` tries to resolve the `IDesignTimeDirectiveTargetExtension` from the code target even when it is empty - If you implement your own `CodeTarget` then you have a lot of work to do to get the set of default target extensions to show up- The extensibility provided [here](https://github.com/aspnet/Razor/blob/dev/src/Microsoft.AspNetCore.Razor.Language/DocumentClassifierPassBase.cs#L96) isn't quite good enough for some scenarios, which requires you to inherit from `CodeTraget`. The result of this is that you get a crash if you replace the code target, and you have to do a fair bit of work to "add back" default behaviorsIt seems like we have a good opportunity to improve some of these scenarios with Blazor really putting our extensibility through its paces.
2864	area-servers	307 and 308 redirects	Could there be HttpResponse.Redirect methods with 307 and 308 status codes? e.g.```C#public void Redirect(string location, bool permanent, bool preserveMethod);```
5472	area-mvc	Blazor Security/Authorization	Please consider a claim/policy based client-side authorisation framework where user claims/cookies can be evaluated with in the blazor runtime, to enable/disable application functionality/ui features based on user claims/policy evaluation. 
5471	area-mvc	Runtime Culture and Localization	Please consider browser runtime cultural and allow switching of culture with in the Blazor environment
5470	area-mvc	Caching	Please consider how Blazor could request or inject content/embedded resources into a browser cache form display rendering ie. images, fonts, etc
5469	area-mvc	Optimize mono runtime	We need to figure out what parts of mono.wasm and mono.asm.js we are using and remove everything else.The original approach is described below.1. In your wasm binary, implement a function that takes an i32 and, when called, passes it through to   JS code. On the JS side, track which numbers you receive.2. Convert the original .wasm file to .wast using 'wasm2wat' from https://github.com/WebAssembly/wabt3. Use the annotateWast function to emit an instrumented version of that .wast file. Each function   in it will be modified so that it starts by invoking function 115, passing the ID of the caller.   Change the '115' const to whatever else is the ID of your compiled function from step 1.3. Convert the instrumented .wast back to .wasm using 'wat2wasm'4. Run your application using the instrumented .wasm file. After exercising all reachable code paths,   use the browser debug console to evaluate the list of function IDs that were invoked.5. Update the 'usedFunctionIds' array above.6. Use the stripWast function to generate a stripped version of your original .wast file in which all   the uncalled functions are replaced with empty stubs.7. Convert the stripped .wast file to .wasm using wat2wasm8. Use the stripped .wasm file in your application```
4873	area-mvc	Localized views with Razor Pages	In Razor Pages, we can inject IViewLocalizer to work with localized resources - good. But sometimes, especially on content-heavy, rather static pages, it would be nice to have location specific views, i.e. `MyPage.en.cshtml` and `MyPage.de.cshtml` etc. My expection was that once I configure `AddViewLocalization(LanguageViewLocationExpanderFormat.Suffix, ...)` Razor Pages also would be resolved by their base name, but I quickly realized there might be a problem with how the corresponding PageModel should be used/resolved. I couldn't get this to work at all - is this scenario even supported with Razor Pages?In any case, I think the corresponding [docs](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/localization) should be more explicit about what's possible with Razor Pages and potential limitations.
5413	area-mvc	Use action specific call-to-action label for forgot password form	The form bears a generic 'Submit' button, while most of the others (or all) have action-specific call to user (Log In, Register, etc)![image](https://user-images.githubusercontent.com/14539/35828413-adb3a2a2-0abf-11e8-90b8-4458d84b9979.png)It could be labelled as `Reset Password` to comply with docs section:https://docs.microsoft.com/en-us/aspnet/core/security/authentication/accconfirm?tabs=aspnetcore2x%2Csql-server#test-password-resetThanks!
2849	area-servers	Consider replacing InlineStringBuilder with ValueStringBuilder	https://github.com/dotnet/corefx/blob/5d71d9ea70418c26874949b36e6434c4849fde52/src/Common/src/CoreLib/System/Text/ValueStringBuilder.cs#L11We should look at the places where we use InlineStringBuilder today and consider replacing those instances with ValueStringBuilder (of course measuring performance along the way). We can also look at places where we use a StringBuilder (like QueryString.Add/Create/Append) and see if there are other wins we can get./cc @benaadams
6005	area-middleware	app.UseForwardedHeaders() does not use X-Forwarded headers	As @ygoe mentioned in https://github.com/aspnet/Docs/issues/2384#issuecomment-360923957, the behavior of `.UseForwardedHeaders` without arguments is unexpected and counter-intuitive.  Since I was just caught by this as well, I decided to open this issue.  Would it be possible to either have `.UseForwardedHeaders` default to `ForwardedHeaders.All` or to remove the zero-argument overload of this method?Thanks,Kevin
5412	area-mvc	Some UI love to error pages	Can the error pages be redesigned?At least can the white space be added to clearly separate the content (important information to the developer) from the viewport edge? (the readability is being hurt IMO)Thanks!![20180202224338](https://user-images.githubusercontent.com/14539/35756273-eee0c78e-086a-11e8-8566-4e21ae02f017.jpg)![20180202223845](https://user-images.githubusercontent.com/14539/35756274-ef001b2a-086a-11e8-9423-9303d293e9da.jpg)
5764	area-identity	Add additional functional tests to Identity UI	This is a tracking issue for all the remaining automation we want to add.- [ ] Validation (ensure that all forms that we render validate data correctly).- [x] Login/Register with 3rd party login provider (We need to fake a provider, but that should be relatively trivial)- [x] Register with password then add social login.* Create a new account with a user name and password.* Enable link a 3rd party login.* Login with 3rd party login.* Login with user name and password.- [x] Register with social login then add password.* Create a new account with a 3rd party login.* Set a password for the account.* Login with 3rd party login.* Login with user name and password.- [x] Disable 3rd party login* Create a new account with a user name and password.* Enable link a 3rd party login.* Login with user name and password.- [x] Download personal data.* Create a new account with user name and password.* Download personal data.- [ ] Delete personal data.* Create a new account with user name and password.* Delete personal data.* Try to log in with user name and password. (fail)- [ ] Reset recovery codes.* Create a new account with user name and password.* Enable 2FA.* Reset recovery codes.* Try to log in with old recovery codes. (fail)* Login with new recovery codes. (succeed)- [x] Reset authenticator app.* Create a new account with user name and password.* Enable 2FA.* Reset authenticator.* Try to log in with old authenticator key. (fail)* Login with new authenticator key. (succeed)- [ ] Disable 2FA.* Create a new account with user name and password.* Enable 2FA.* Login with 2FA.* Disable 2FA.* Login with user name and password.
5912	area-hosting	Support port command line argument	_From @evil-shrike on October 13, 2017 20:59_`CreateDefaultBuilder(args).UseConfiguration(configuration)` works fine and allows to supply an url via cli: `dotnet run --urls http://localhost:5000`. But it'd nice to support `--port` argument as well: `dotnet run --port 5000`Usually we don't need specify IP but only port. It was suggested by many people in https://github.com/aspnet/KestrelHttpServer/issues/639. I saw this suggestion many times in many issues but all of them are closed and it's still not supported._Copied from original issue: aspnet/KestrelHttpServer#2115_
4760	area-servers	warn: Microsoft.AspNetCore.Server.Kestrel[22]       Heartbeat took longer than "00:00:01" at "01/31/2018 19:56:53 +00:00".	when i used 'dotnet app.dll' run dotnetcoremvc application on windows server,there only little traffic on this application,There is no response on website when i use browser access the second day,then i pressed enter key in console application,then show listwarn: Microsoft.AspNetCore.Server.Kestrel[22]      Heartbeat took longer than "00:00:01" at "01/24/2018 14:22:35 +00:00".warn: Microsoft.AspNetCore.Server.Kestrel[22]      Heartbeat took longer than "00:00:01" at "01/24/2018 14:22:37 +00:00".warn: Microsoft.AspNetCore.Server.Kestrel[22]      Heartbeat took longer than "00:00:01" at "01/24/2018 14:22:36 +00:00".warn: Microsoft.AspNetCore.Server.Kestrel[22]      Heartbeat took longer than "00:00:01" at "01/24/2018 14:22:39 +00:00".warn: Microsoft.AspNetCore.Server.Kestrel[22]      Heartbeat took longer than "00:00:01" at "01/24/2018 14:22:38 +00:00".warn: Microsoft.AspNetCore.Server.Kestrel[22]      Heartbeat took longer than "00:00:01" at "01/24/2018 14:22:40 +00:00".warn: Microsoft.AspNetCore.Server.Kestrel[22]      Heartbeat took longer than "00:00:01" at "01/24/2018 14:22:41 +00:00".After a while the browser get a normal response. but sometimes is badversion is dotnetcore 2.0.3
4872	area-mvc	Fix model binding testing setup to use the dependent components consistently	Example: [Here ](https://github.com/aspnet/Mvc/blob/dev/test/Microsoft.AspNetCore.Mvc.TestCommon/TestModelBinderFactory.cs#L29)we create options but this is not present in DI services as `IOptions<MvcOptions>` service.Example: In [this ](https://github.com/aspnet/Mvc/blob/dev/test/Microsoft.AspNetCore.Mvc.IntegrationTests/ArrayModelBinderIntegrationTest.cs#L16)test, we use different instances of services when [getting ](https://github.com/aspnet/Mvc/blob/dev/test/Microsoft.AspNetCore.Mvc.IntegrationTests/ArrayModelBinderIntegrationTest.cs#L19)a ParameterBinder and when [getting ](https://github.com/aspnet/Mvc/blob/dev/test/Microsoft.AspNetCore.Mvc.IntegrationTests/ArrayModelBinderIntegrationTest.cs#L26) a TestContext.Just like how an application in general starts with configuring services, and later requests are executed, we should setup the DI container with all the required services in the test and use this across. I can imagine the usage experience might become a bit undesirable but at least we would have the setup correct. cc @dougbu 
5411	area-mvc	Revisit default bundling behavior	This is in response to the resolution in #20 and #89:> No plans to include bundling in the default template at this time. We will revisit in the future.---If you currently create a new ASP.NET Core application and you are not using an SPA-template (which uses Webpack for building), then you are in the unfortunate situation that the project appears to be using the [bundling and minification feature](https://docs.microsoft.com/en-us/aspnet/core/client-side/bundling-and-minification) yet that’s not what’s actually happening.The following things are there:- A `bundleconfig.json` is in the project root that is configured to produce the `site.min.css` and the `site.min.js` files.- The `wwwroot` folder contains **pre-built** versions of those exact bundled files.- The `_Layout.cshtml` contains environment tag helpers that switch to the minified bundles on non-Development builds:    ```    <environment include="Development">        <link rel="stylesheet" href="~/css/site.css" />    </environment>    <environment exclude="Development">        <link rel="stylesheet" href="~/css/site.min.css" asp-append-version="true" />    </environment>    …    <environment include="Development">        <script src="~/js/site.js" asp-append-version="true"></script>    </environment>    <environment exclude="Development">        <script src="~/js/site.min.js" asp-append-version="true"></script>    </environment>    ```So the user is made to believe that bundles are being created and that for production builds, those minified versions will be used automatically. Since minified files are also nested in the solution explorer, users are unlikely to actually *look* inside the files to verify that they actually do contain the desired contents.Yet, the problem is that with Visual Studio 2017, Visual Studio Code, or when running `dotnet` from the command line, there is by default **nothing** that is actually consuming that `bundleconfig.json` file to generate those files. So users will end up with the default bundle files which contain mostly nothing.Instead, users are apparently expected to do one of the following three things:- Install the [Bundler & Minifier VS extension](https://marketplace.visualstudio.com/items?itemName=MadsKristensen.BundlerMinifier) to get the bundling done by Visual Studio- Add the [`BundlerMinifier.Core` NuGet package](https://www.nuget.org/packages/BundlerMinifier.Core/) to get the `dotnet bundle` command.- Add the [`BuildBundlerMinifier` NuGet package](https://www.nuget.org/packages/BuildBundlerMinifier/) to actually get a build task automatically added that will bundle the files automatically on every build.By the indications mentioned above, the user is likely to expect this to work out of the box, just like *everything* in the templates already runs out of the box. Yet, they actively need to add a bundling method without being told to do so. The *only* thing that comes close to a hint is when you happen to open the `bundleconfig.json` in Visual Studio. Then, VS suggests you to look for “helpful extensions”, without actually clearly saying that this is in any way required. Not to mention that users that are not using VS are completely left in the dark.So I would very strongly suggest that we actually do include the `BuildBundlerMinifier` package in the default templates, to make the bundling that is clearly configured and expected to work actually work. If we cannot do that since the package is not an *“official”* Microsoft package, then I would suggest to get rid of the bundling in the templates altogether.
4871	area-mvc	Provide a way to filter out value providers during the model binding process	This came out during the design discussion of **https://github.com/aspnet/Mvc/issues/5859: Consider allowing binding header values to types other than string and string collections**The proposal is to not include all value providers automatically when no binding source metadata(ex: FromQuery, FromRoute) is available. Thoughts:1. Today we include all value providers if binding source is not specified and we make this decision of 'including' [outside the context](https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/Internal/DefaultModelBindingContext.cs#L312) of a value provider. Instead of making the decision here, could we instead ask each value provider to see if they can provide data based on if the binding source is null or not? I feel this is analogous to how we ask each formatter if they can read/write.The change could be made [here](https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/ModelBinding/BindingSourceValueProvider.cs#L72), for example. If I were to add a custom value provider and want to only include it when a user explicitly specifies a binding source, then I can override this Filter method.2. Do we want to provide more context to a value provider to decide whether it wants to participate in giving the value or not. Point `1.` is about supplying `BindingSource` to a value provider, but should we provide something like ModelBindingContext to each value provider for them to take decision?cc @rynowak @dougbu @mkArtakMSFT 
4870	area-mvc	ViewModel DataAnnotation translations not found is base class	# BackgroundI did setup a simple mvc site and enable localization for both EN and FR languages.The resources are located in a folder named Resources where Views and Models ressource files are stored. *ViewLocalization* and *DataAnnotationLocalization* are both enabled. I use QueryStringRequestCultureProvider to set the current culture. HomeController has a simple Index action that is associated with a model class *HomeViewModel*. This view model inherits from a base classe *BaseViewModel*.Those classe are defined as such in their respective file: `    public class HomeViewModel: BaseViewModel    {        [Display(Name = "TITLE")]        [Required]        public string Title { get; set; }    }``       public class BaseViewModel    {        [Display(Name = "COMMON")]        [Required]        public string Common { get; set; }    }`Under *Resources/Models* folder I created 4 resource files (HomeViewModel.en.resx, HomeViewModel.fr.resx, BaseViewModel.en.resx, BaseViewModel.fr.resx). Where translations for *Title* property are defined in HomeViewModel.*.resx and translations for *Common* are defined in BaseViewModel.*.resx# Issue*HomeViewModel Title* property is properly translate depending on the current cultureHowever, *Common* is not translated and its key is displayed# Expected resultTranslation of properties with *DataAnnotation* are looked down the inheritance chain.Am I missing something?Sample repro project available here: https://github.com/aguerot/l10n-dataannotation
5763	area-identity	Consider adding optional cancellationToken to manager APIs	See: https://github.com/aspnet/SignalR/issues/1345#issuecomment-360663449If we do this in 3.0, we could probably also get rid of the automatic HttpRequest.Aborted hookup, which would let us get rid of the derived AspNetUserManager entirely.
4662	area-security	xplat Integrated Windows Authentication (ntlm/Kerberos)	_From @evil-shrike on January 25, 2018 12:41_I haven't found any ticket for tracking the xplat Windows-auth support in aspnet/dotnet core. I understand that currently we have only out-of-the-box Windows auth support in IIS/IISExpress and http.sys and only on Windows.There's a decent article in docs https://docs.microsoft.com/en-us/aspnet/core/security/authentication/windowsauth?branch=pr-en-us-3622&tabs=aspnetcore2x on how to configure Windows auth. But it says nothing about non-Windows use-cases. There're many issues here on Github and questions around on sites like SO on "how to implement Windows authentication in aspnet core on Linux". But all issues are closed with reasoning like "Kestrel doesn't implement Windows auth currenly, use IIS or https.sys". This is understandable but it's unclear what to do if we need to host an app on Linux and support integrated Windows auth (in intranet networks).So there are several points which need to be addressed:* what options do exist currently (at the time of 2.0/2.1) for getting integrated Windows authentication on Linux and other *nix OSes?* what are plans (if any) for improving/adding such functionality?I understand that strictly speaking this issue is related to Kestrel project probably, but it's more easily to find it here though. Moreover it's implementation details where Windows-auth support should live. Anyway it should be some source of information describing what to do with aspnet core apps on Linux for adding Windows auth.Some additional info:* middleware for ntlm support - https://github.com/OneBitSoftware/Microsoft.AspNetCore.Authentication.ActiveDirectory (ntlm only, Windows only - "Achieving server-side NTLM handshaking depends the Windows platform due to interop, dependency on domain-joined machines and secur32.dll")* it's possible to authenticate via Kerberos on Linux - https://technet.microsoft.com/en-us/library/2008.12.linux.aspx* there's Application Proxy with Kerberos Constrained Delegation in Windows Server and Azure AD which seems to solve such problems - https://blogs.technet.microsoft.com/applicationproxyblog/2015/09/21/all-you-want-to-know-about-kerberos-constrained-delegation-kcd/ but it's complex* there're modules for Nginx (http://nginx.org/en/docs/http/ngx_http_upstream_module.html#ntlm) (requires commercial license) and Apache httpd (http://adldap.sourceforge.net/wiki/doku.php?id=mod_auth_ntlm_winbind) (it's unclear how stable it is) to add ntlm support* It seems that Java has Kerberos support out-of-the-box - https://docs.oracle.com/javase/8/docs/technotes/guides/security/jgss/single-signon.html* Java implementation for app servers - http://spnego.sourceforge.net/  (not sure how it relates to the previous point)_Copied from original issue: aspnet/Home#2824_
2825	area-servers	Consider allowing middleware to implement IDisposable	Any middleware that subscribes itself to ```DiagnosticListener``` events can potentially leak because there is no clear way to unsubscribe from event notification when the server is disposed. In practice this can happen when using things like ```TestServer``` because it is common to create and dispose many instances of the server when testing. One solution may be to allow middleware to implement ```IDisposable``` and have the server call ```Dispose``` during shutdown.
5468	area-mvc	Scaffolding	
5467	area-mvc	State management	
5466	area-mvc	AoT compilation	Compile everything to WebAssembly
5465	area-mvc	Lazy loading of application areas	
5464	area-mvc	Prerendering	Also known as Server-Side Rendering (SSR)
5462	area-mvc	CDN	Make Blazor DLLs available from a CDN
5461	area-mvc	Web analytics and diagnostics	- [ ] Integration with web analytics systems (ex Azure Application Insights, Google Analytics)
5460	area-mvc	Forms and validation	
5459	area-mvc	Building static resources	
5458	area-mvc	Testing	- [ ] Unit test helper for instantiating components and trying out events, etc.- [ ] End-to-end
5457	area-mvc	Enable browser automation in aspnetci test runs	
5456	area-mvc	Live reload	- [ ] Via `dotnet watch`- [ ] Development middleware (websocket connection to receive updates)
5455	area-mvc	Component model	
5175	area-mvc	404 when publicPath is set to "/"	The bug appears to be related to this this line:https://github.com/aspnet/JavaScriptServices/blob/5f6f288056b3263a61a55631257db14314a02795/src/Microsoft.AspNetCore.SpaServices/Webpack/WebpackDevMiddleware.cs#L114My webpack config has the following output:```#js        "output": {            "filename": "js/[name].js",            "path": OutputPath,            "publicPath": "/"        },```If I set the and the WebpackDevMiddleware like such:```C#                    .UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions                    {                        HotModuleReplacement = true                    });```Then the hmrEndpoint defaults to "/__webpack_hmr" and the SpaProxy url ends up as "//__webpack_url". Every request to `[xxx].hot-update.json` (e.g.: `http://localhost:5000/7d73bb05e2e2c47519ea.hot-update.json`) fails with a 404.However, if I set up my webpack config like this:```#js        "output": {            "filename": "js/[name].js",            "path": OutputPath,            "publicPath": "/dist/"        },```Then the SpaProxy url is set to "/dist//__webpack_url" and any request to find the hot-update config (e.g.: `http://localhost:5000/dist/7d73bb05e2e2c47519ea.hot-update.json`) works.FWIW: overriding the HmrEndpoint to "__webpack_hmr" does not seem to get around the problem:```C#                    .UseWebpackDevMiddleware(new WebpackDevMiddlewareOptions                    {                        HotModuleReplacement = true,                        HotModuleReplacementEndpoint = "__webpack_hmr"                    });```Also, leaving the `publicPath` blank ("") results in an error.EDIT: if this is the expected behavior (that `publicPath` is required to be set to "/dist/") then the documentation should reflect this. Otherwise, this is a bug likely due to oversimplification of the logic that builds the proxy server URLs.
5911	area-hosting	Error - The specified CGI application encountered an error and the server terminated the process.	Hi All I am facing issue "The specified CGI application encountered an error and the server terminated the process." after hosting it on Azure Web Sites. On Local it works fine. I have developed application on asp.net core 1.0 and deployed on Azure.Is there any timeout issue or any thing missing when deployed code on azure ?Please help me out regarding this issue.
4869	area-mvc	Support multiple [FromRoute], [FromHeader], [FromBody], etc in a single object	I'm trying to create an object with all the relevant data from a request bound.Imagine an action like this```csharp[HttpPost({id})]public virtual async Task<IActionResult> Post(PostRequest model)```And the model could be like this```csharppublic class PostRequest{    [FromRoute]    public int Id { get; set; }    [FromHeader]    public string SomeHeader { get; set; }    [FromBody]    public int Foo { get; set; }    [FromBody]    public string Bar { get; set; }    [FromBody]    public string Baz { get; set; }}```Unfortunately multiple `[FromBody]` isn't allowed.If it was allowed and worked as expected I could implement a generic CRUD controller like so```csharp[HttpPost({id})]public virtual async Task<IActionResult> Post(PostRequest model){    var command = _mapper.Map<TCommand>(model); // AutoMapper    await _mediator.Send(command); // MediatR    // omitted for brevity    return Created();}```Obviously it wouldn't look exactly like that.The idea is to remove all logic from the controller that isn't API/MVC related. So all the controller does is - validate the model- extract the wanted data from the request- send the relevant data of to a handler- return an appropriate http responseNow I can have one implementation for all my CRUD controller needs - and there was much rejoicing!It doesn't need to be `[FromBody]` it could be another attribute. Like `[FromBodyPart]`, `[BindFromBody]` or something completely different.Would that be feasible?
6004	area-middleware	URL rewrite module - REQUEST_URI does not contain querystring	Using server variable REQUEST_URI does not seem to work when working with query strings.This does not work:```xml<rewrite>  <rules>   <rule name="rulename" stopProcessing="true">      <match url=".*" />      <conditions logicalGrouping="MatchAll">        <add input="{Map_Name:{REQUEST_URI}}" pattern="(.+)" />      </conditions>      <action type="Redirect" url="{C:1}" appendQueryString="false" redirectType="Permanent"  />    </rule>  </rules>  <rewriteMaps>    <rewriteMap name="Map_Name" defaultValue="">      <add key="/url/with/querystring.html?a=b" value="/other/url.html" />    </rewriteMap>  </rewriteMaps></rewrite>```As a workaround, I appended the QUERY_STRING variable to the condition. But this does not seem to be in line with the [IIS documentation](https://docs.microsoft.com/en-us/iis/extensions/url-rewrite-module/url-rewrite-module-configuration-reference#accessing-url-parts-from-a-rewrite-rule) I foundThis is the workaround:```xml<rewrite>  <rules>   <rule name="rulename" stopProcessing="true">      <match url=".*" />      <conditions logicalGrouping="MatchAll">        <add input="{Map_Name:{REQUEST_URI}?{QUERY_STRING}}" pattern="(.+)" />      </conditions>      <action type="Redirect" url="{C:1}" appendQueryString="false" redirectType="Permanent"  />    </rule>  </rules>  <rewriteMaps>    <rewriteMap name="Map_Name" defaultValue="">      <add key="/url/with/querystring.html?a=b" value="/other/url.html" />    </rewriteMap>  </rewriteMaps></rewrite>```I'm using version 2.0.1 of the Microsoft.AspNetCore.Rewrite package
3828	area-servers	Supress windows auth token when forwardWindowsAuthToken is set to false	1. Enable NTLM authentication for an aspnetcore app which is running in inprocess2. Send a request to the aspnetcore appEXPECTED:The request headers should contain the following headers:MS-ASPNETCORE-TOKENMS-ASPNETCORE-WINAUTHTOKENACTUAL:The request headers does not have the expected request headers.
5762	area-identity	IdentityUserToken table PK and expiration date	For IdentityUserToken table is there a plan to add an Id as PK and some sort of expiration date for the tokens?  Also where could I find a sample that uses this table?  Thanks.
5910	area-hosting	Not consistant logging across Hosting	Following files and methods contains `Console.Write` or `Console.WriteLine` instead of using ILogger interface. That information, though informational might be useful in debugging process on remote host where we do not read console directly.Following files should have replaced those `Console.Write` with `_logger.LogInformation(...)`:`src/Microsoft.Extensions.Hosting/Internal/ConsoleLifetime.cs:35-37``src/Microsoft.AspNetCore.Hosting/WebHostExtensions.cs:100,101,109`Following files should have replaced those `Console.Write` with `_logger.LogError(...)`:`src/Microsoft.AspNetCore.Hosting/WebHostBuilder.cs:163,168``src/Microsoft.AspNetCore.Hosting/Internal/WebHost.cs:226`Following files and lines were provided from commit: `9f4c7c172f4876db77cc3b4e1eef50e61608ac60`
4761	area-servers	Add HTTP/2 pseudo-headers as known headers	https://github.com/aspnet/KestrelHttpServer/blob/526dfdb332b30fd6042d8ef8d1a2ba99cc654010/src/Kestrel.Core/Internal/Http2/Http2Stream.cs#L55-L66It looks like these are being treated as unknown headers. Consider adding them to KnownHeaders. Note we'll have to special case them in the generator as the colon does not translate into a valid C# member name.https://github.com/aspnet/KestrelHttpServer/blob/526dfdb332b30fd6042d8ef8d1a2ba99cc654010/tools/CodeGenerator/KnownHeaders.cs
5284	area-signalr	TCP support in SignalR	ASP.NET Core 2.0 SignalR supports different middle ware options like TCP,AMQP etc.Can anyone give details about it like a sample where TCP is used as signalr middle ware.Any good explanation of this concept and illustration with samples are appreciated.Please consider this as a request for updating
5761	area-identity	Improve test ability of TOTP	IMHO TOTP needs to use ISystemClock to allow for testing to skew clock outside TOTP TimeStep, also at present the TimeStep is fixed at 3 mins which result in a window of 9 mins either side of the time the code was issued, this should be configurable with a note that a larger worn is less secure and a smaller windows is more prone to expire.ie. when using an authenticator application a small windows of 2 mins is suffice     while using email/phone TOTP systems a larger window is required due to delays in communication of the code to the user
5760	area-identity	RFC6238 Pin Length	IMHO the service should allow for a configurable PIN length 6/8 and be public; the GenerateCode/ValidateCode should also return/accept a string; the length of the pin is importantis current controlled by the RFC6238 as a const, service which may result in a number that requires padding with 0s and a consumer of the service many not realise resulting in the wrong length code getting passed up the call stack.public static int GenerateCode(byte[] securityToken, string modifier = null)public static bool ValidateCode(byte[] securityToken, int code, string modifier = null)see: https://tools.ietf.org/html/rfc6238 for referencestring generateTOTP..while (result.length() < codeDigits) {             result = "0" + result;         } return result;
2760	area-platform	Determine what to do with pdbs for the shared runtime 	As a follow up to https://github.com/aspnet/Universe/issues/131, we need to figure out what to do with the pdbs for the AspNetCore shared runtimes. Pdbs for the managed pdbs do not work with pdbs for the x-gened shared runtime binaries. This means we would need a way to distribute x-gened pdbs
4868	area-mvc	Issue with multipart/form-data post and json.net deserializtion (using interfaces)	We use the aspnetcore 2.We have configured JsonOptions in startup like this.```csharpservices.AddMvc().AddJsonOptions(options =>            {                options.SerializerSettings.ContractResolver = new DefaultContractResolver();                options.SerializerSettings.Converters = new List<JsonConverter> {                    new JsonDocumentConverter(),                    new JsonDocumentMetaConverter(),                    //new Bll.FileRecords.JsonDocumentMetaListConverter(),                };            });public class JsonDocumentConverter : CustomCreationConverter<IDocument>    {        public override IDocument Create(Type objectType)        {            return new LocalDocument();        }    }public class JsonDocumentMetaConverter : CustomCreationConverter<IDocumentMeta>    {        public override IDocumentMeta Create(Type objectType)        {            return new LocalDocumentMeta();        }    }```In our controller we have 2 methods1. The first one is called PostUrlencoded in which we make a http post request with content-type : application/x-www-form-urlencoded.```csharp[HttpPost("PostUrlencoded")]public async Task<IActionResult> PostUrlencoded([FromBody]IDocument document){ /*...*/ }```2.. The second one is called PostΜultipart in which we make a http post request with content-type : multipart/form-data.```csharp[HttpPost("PostΜultipart")]public async Task<IActionResult> PostΜultipart([FromForm]IDocument document){ /*...*/ }```The first method works fine, and the deserialization works fine. In the second method deserialization fails. The error is: `Model bound complex types must not be abstract or value types and must have a parameterless constructor.`That's because the JsonOptions isn't applied. When we remove the jsonOptions from the startup.cs, we get the same error in both cases.   
4762	area-servers	Query Does Kestrel support OCSP Stapling	_From @rsrinivasanhome on January 5, 2018 13:28_Does Kestrel Support OCSP Stapling ?  I am not able to find any links on google._Copied from original issue: aspnet/AspNetCoreModule#283_
3849	area-servers	startMode="AlwaysRunning" for inProcess ANCM	There was an earlier issue asking for this (https://github.com/aspnet/AspNetCoreModule/issues/29) which we declined to do when ANCM was only out of process.At the minimum, we need to ensure ANCM doesn't break with AlwaysRunning for 2,1. I suspect it might **just work**, but @jkotalik and @pan-wang know better.
5410	area-mvc	Feature request: email confirmation  resend	related issue: Poor user and dev experience in Identity email confirmation #124We have lots of customer complaints at the end [Account confirmation and password recovery in ASP.NET Core](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/accconfirm?tabs=aspnetcore2x%2Csql-server)>  I found it odd that, when requiring email confirmation, if for whatever reason the user misses the original email with the confirmation link, the login view reminds you but there is no way to get the app to resend the confirmation.  > I understand in some cases users miss to confirm their email account, and they should be able to see the option of "Resend Email Confirmation Link" when they try to login. Unfortunately I could not find any documentation to solve this problem, but what I did. I created a controller with Read, Delete action methods that can be used to delete unconfirmed email accounts from admin panel of my application. And then any unverified email can be used again to register in our application. I think that there is a better way to send confirmation link again through the application which I don't know.  
2734	area-servers	Publish the spec behind the Micrsoft Querystring Parsing and Serialization rules	_From @nathanaeljones on Friday, May 30, 2014 11:56:39 AM_Could we get some light shed on the whys/hows of [querystring handling logic in vNext](https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.AspNet.PipelineCore/Infrastructure/ParsingHelpers.cs#L558)? Previous [versions](http://referencesource.microsoft.com/#System.Web/xsp/system/Web/HttpValueCollection.cs#159) have been inconsistent at best, and this seems like a great chance to fix things.An all-encompassing parsing strategy may be possible, but inadvisable, as the logic could not be clearly communicated to developers. I would suggest instead that parsing/serialization formats be named specifically for their appropriate use. For example, requests with content-type `application/x-www-form-urlencoded` must follow the [WHATWG parsing/serialization spec](http://url.spec.whatwg.org/#application/x-www-form-urlencoded-0) &mdash; which differs from php, ruby, node, python, classic asp, and each implementation in asp.net vNow, most of which have differing rules on one or more points:1. Handling of duplicate keys. (error, replace, concatenate, or build list)?2. Hash serialization. `key[a]=1&key[b]=2` produces `key = {a=1, b=2}` in some implementations3. [Array serialization](http://stackoverflow.com/questions/6243051/how-to-pass-an-array-within-a-query-string). `a=1&a=2`, `a=1,2`, `a[]=1&a[]=2`, `a[1]=1`, a[2]=2` are all valid ways to represent an array value on different platforms. 4. Handling of invalid characters (error, or pretend they were URL encoded)?5. Encoding of reserved characters (Most frameworks fail to url encode reserved characters correctly)6. Order preservation - some developers (inadvisably) rely on the order of querystring pairs. A recent instance of this is in the latest version of Umbraco. 7. Case preservation and case sensitivity. 8. URL decoding pass count (AFAIK, only ASP.NET WebForms messes this up). Ideally,  `+`, `%20` -> ` ` should be the only lossy operation. Once we know the team's opinions on querystrings (and paths - and PathInfos), I think there are a lot of developers that would be happy to pitch in with unit tests and compatibility profiles. I imagine that [Javascript/Node](https://github.com/joyent/node/blob/f7ede33f09187cd9b1874982e813380cd292ef17/lib/querystring.js#L142) and [php](https://github.com/php/php-src/blob/419d98b291b4dd36e63f34d72445bd954f3ce3e2/ext/standard/string.c#L4445) compatibility would be the highest priority. Of course, this is easiest if we can ensure that we do not lose any data between the network packet and the developer. I'm looking at you, IIS._Copied from original issue: aspnet/HttpAbstractions#67_
2733	area-servers	Review and update form parsing logic	_From @Tratcher on Tuesday, August 26, 2014 12:32:12 PM_src/Microsoft.AspNet.WebUtilities/ParsingHelpers.cs has at least one place where it calls char.IsWhiteSpace, but this allows many strange Unicode characters. Review this parsing code and update it to be more accurate._Copied from original issue: aspnet/HttpAbstractions#119_
2732	area-servers	Logging: Tracking state changes for http context	_From @yishaigalatzer on Tuesday, December 2, 2014 2:53:52 PM_Moved from aspnet/MVC#1630.The general design idea is to add logging to HttpContext when certain things happen.### When the following things change log in verbose#### HttpContextAuthenticateAbortDisposeSetFeatureAcceptWebSocket ?#### HttpResponseStatus code changedHeader replaced (which is also added)OnSendingHeaders firing - Should probably be in the server.OnSendingHeaders registrationsBody replacedSignInSignOutChallenge_Copied from original issue: aspnet/HttpAbstractions#153_
2731	area-servers	Need to document which OWIN keys are supported in the translation layer	_From @Eilon on Friday, December 12, 2014 9:34:08 AM_Something like this table:http://katanaproject.codeplex.com/wikipage?title=OWIN%20Keys&referringTitle=Documentation@Tratcher FYI from our discussion._Copied from original issue: aspnet/HttpAbstractions#156_
2730	area-servers	Strongly typed Request/ResponseHeader properties should return readonly collections	_From @Tratcher on Thursday, January 15, 2015 10:49:04 AM_Users may write the following code:`httpRequest.GetTypedHeaders().SetCookie.Add(myCookie);`However, this will fail silently because SetCookie.get returns a collection of parsed values that is disconnected from the underlying response headers collection.The correct code is:`httpRequest.Headers.Append(HeaderNames.SetCookie, myCookie);`or`httpRequest.GetTypedHeaders().SetCookie = myCookies;`To make sure users do not experience hard to debug silent failures have the IList returned by these properties be read only. We could also switch to IEnumerable.Alternative: It might be possible to return an IList implementation that was actually bound to the underlying header collection and did live modifications, but that would be significantly more complicated. We can make that work later if there is a strong desire for it._Copied from original issue: aspnet/HttpAbstractions#169_
2729	area-servers	Add missing Request.IsAjaxRequest	_From @danroth27 on Thursday, April 2, 2015 3:18:15 PM_Copied from aspnet/mvc#2291.In order to do something like this, you need the IsAjaxRequest method, which doesn't seem to exist in ASP.NET 5.Note: I think it's `Context.Request` now, and not just  Request .@glen-84_Copied from original issue: aspnet/HttpAbstractions#245_
2728	area-servers	Adding a querystring to a pathstring can end up with a pathstring.	_From @blowdart on Tuesday, July 7, 2015 1:10:47 PM_Consider the following```PathString example = new PathString("/Home/").Add(new QueryString("?yousuck=true"));```This works because of the implicit string conversions, but you end up with something that is no longer a true PathString, but a path with a querystring embedded in it._Copied from original issue: aspnet/HttpAbstractions#342_
2727	area-servers	Add Api for HTTP/2 PushPromise	_From @benaadams on Saturday, August 15, 2015 1:33:50 PM_Implement the PushPromise api as virtual NoOp in the abstract class HttpResponse. ## BackgroundThis API is to support applications sending push promises to HTTP 2.0 clients.[Current .NET v4.6 Api](https://msdn.microsoft.com/en-us/library/dn823340%28v=vs.110%29.aspx)``` csharppublic void PushPromise( string path )public void PushPromise(    string path,    string method,    NameValueCollection headers)```**Parameters**_path_ Type: System.StringThe URL of the push request. It should be the virtual path of the relative resource that the server wants to push to the client._method_ Type: System.StringHttp request method that would be used by the push request._headers_ Type: System.Collections.Specialized.NameValueCollectionHttp request header that would be used by the push request.Suggested addition to [Microsoft.AspNet.Http.Abstractions/HttpResponse.cs](https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.AspNet.Http.Abstractions/HttpResponse.cs)**Remarks**PushPromise is non-deterministic and applications shouldn't have logic that depends on it. Its only purpose is performance advantage in some cases. There are many conditions (protocol and implementation) that may cause to ignore the push requests completely. The expectation is based on fire-and-forget.## RationaleIts _out-of-band_ data like `headers` and `cookies` and is part of the response so should live at the `HttpResponse` level.It is a core feature of http/2 rather than a extended addition that might be `HttpContext` related.Its now standardised and implemented in all browsers - so is something I assume will be implemented in ASP.NET 5.It already comes with two huge caveats: - _applications shouldn't have logic that depends on it_- _There are many conditions (protocol and implementation) that may cause to ignore the push requests completely._Which means it doesn't actually have to do anything at this time.## Suggested Api``` csharppublic virtual void PushPromise(string path);public virtual void PushPromise(string path, string method, IHeaderDictionary headers);```_Copied from original issue: aspnet/HttpAbstractions#371_
2726	area-servers	Should StringValues implement Equals?	_From @Tratcher on Wednesday, September 2, 2015 10:27:00 AM_StringValues does not currently implement Equals (or GetHashCode).  MVC implements their own wrapper that has Equals. If so, what should be considered equal?"string" == new[] { "string" }?string.Empty == null?null == new[] { null }?"value1,value2" == new[] { "value1", "value2" }?Ordinal?_Copied from original issue: aspnet/HttpAbstractions#384_
2725	area-servers	Make OwinFeatureCollection mutable	_From @Tratcher on Wednesday, October 7, 2015 9:24:33 AM_OwinFeatureCollection does not currently allow you to replace features, so to use it in the pipeline you have to wrap it in a FeatureCollection. Make it mutable instead._Copied from original issue: aspnet/HttpAbstractions#431_
2724	area-servers	Investigate the performance of OwinFeatureCollection	_From @davidfowl on Saturday, October 10, 2015 8:10:35 PM_OwinFeatureCollection is functional but we should understand the performance characteristics of using it within the ASP.NET 5 pipeline._Copied from original issue: aspnet/HttpAbstractions#436_
2723	area-servers	FormFeature.ReadForm is Sync over Async	_From @benaadams on Friday, October 30, 2015 3:11:44 AM_ Avoid Sync-over-Async http://blogs.msdn.com/b/pfxteam/archive/2012/04/13/10293638.aspx_Copied from original issue: aspnet/HttpAbstractions#456_
2722	area-servers	Excessively large number of StringBuilder objects allocated in FormReader for big input data	_From @yuwaMSFT on Friday, March 11, 2016 10:54:07 AM_In one stress run on Linux we hit OOM. During investigation, we saw excessive StringBuilder objects allocated in FormReader. The implementation will keep reading the stream until reaching a separator. In the test, we were posting faked large data ( > 16MB), which could cause the allocation of 2000 StringBuilder objects (8K chunk for each). If keep them all in memory we could only support very small number of clients. We probably can either reject big form or save data to temp cache file. ```_### _OS Thread Id: 0xf462 (1)        Child SP               IP Call Site00007F27E6A441F0 00007F2862257CC9 [PrestubMethodFrame: 00007f27e6a441f0] System.Threading.Tasks.AwaitTaskContinuation.ThrowAsyncIfNecessary(System.Exception)00007F27E6A448D0 00007F27E877FD9A System.Threading.Tasks.AwaitTaskContinuation.RunOrScheduleAction(System.Action, Boolean, System.Threading.Tasks.Task ByRef)00007F27E6A46688 00007F286185E1CD [HelperMethodFrame: 00007f27e6a46688]00007F27E6A46D40 00007F27E7DF7792 System.Text.StringBuilder.ExpandByABlock(Int32)00007F27E6A46D80 00007F27E82BB29E System.Text.StringBuilder.Append(Char, Int32)00007F27E6A46DB0 00007F27E7BF044B System.Text.StringBuilder.Append(Char)00007F27E6A46DD0 00007F27E97AD3F9 Microsoft.AspNetCore.WebUtilities.FormReader+<ReadWordAsync>d__10.MoveNext()00007F27E6A46E10 00007F27E7DFCB9A System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)00007F27E6A46E60 00007F27E877FF42 System.Runtime.CompilerServices.AsyncMethodBuilderCore+MoveNextRunner.Run()00007F27E6A46EA0 00007F27E877FD65 System.Threading.Tasks.AwaitTaskContinuation.RunOrScheduleAction(System.Action, Boolean, System.Threading.Tasks.Task ByRef)00007F27E6A46ED0 00007F27E82B42D1 System.Threading.Tasks.Task.FinishContinuations()00007F27E6A46F50 00007F27E878018F System.Threading.Tasks.Task`1[[System.Threading.Tasks.VoidTaskResult, mscorlib]].TrySetResult(System.Threading.Tasks.VoidTaskResult)00007F27E6A46F70 00007F27E87800AE System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, mscorlib]].SetResult(System.Threading.Tasks.VoidTaskResult)00007F27E6A46FB0 00007F27E82C7D09 System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Threading.Tasks.VoidTaskResult, mscorlib]].SetResult(System.Threading.Tasks.Task`1<System.Threading.Tasks.VoidTaskResult>)00007F27E6A46FD0 00007F27E97AD7C6 Microsoft.AspNetCore.WebUtilities.FormReader+<BufferAsync>d__13.MoveNext()00007F27E6A47000 00007F27E7DFCB9A System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)00007F27E6A47050 00007F27E877FF42 System.Runtime.CompilerServices.AsyncMethodBuilderCore+MoveNextRunner.Run()00007F27E6A47090 00007F27E877FD65 System.Threading.Tasks.AwaitTaskContinuation.RunOrScheduleAction(System.Action, Boolean, System.Threading.Tasks.Task ByRef)00007F27E6A470C0 00007F27E82B42D1 System.Threading.Tasks.Task.FinishContinuations()00007F27E6A47140 00007F27E82B6E3C System.Threading.Tasks.Task`1[[System.Int32, mscorlib]].TrySetResult(Int32)00007F27E6A47160 00007F27E877DAA6 System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Int32, mscorlib]].SetResult(Int32)00007F27E6A47190 00007F27E877CF35 System.IO.StreamReader+<ReadAsyncInternal>d__69.MoveNext()00007F27E6A47230 00007F27E7DFCB9A System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)00007F27E6A47280 00007F27E877FF42 System.Runtime.CompilerServices.AsyncMethodBuilderCore+MoveNextRunner.Run()00007F27E6A472C0 00007F27E877FD65 System.Threading.Tasks.AwaitTaskContinuation.RunOrScheduleAction(System.Action, Boolean, System.Threading.Tasks.Task ByRef)00007F27E6A472F0 00007F27E82B42D1 System.Threading.Tasks.Task.FinishContinuations()00007F27E6A47370 00007F27E82B6E3C System.Threading.Tasks.Task`1[[System.Int32, mscorlib]].TrySetResult(Int32)00007F27E6A47390 00007F27E877DAA6 System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Int32, mscorlib]].SetResult(Int32)00007F27E6A473C0 00007F27E877D724 System.IO.StreamReader+<ReadBufferAsync>d__102.MoveNext()00007F27E6A47450 00007F27E7DFCB9A System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)00007F27E6A474A0 00007F27E877FF42 System.Runtime.CompilerServices.AsyncMethodBuilderCore+MoveNextRunner.Run()00007F27E6A474E0 00007F27E877FD65 System.Threading.Tasks.AwaitTaskContinuation.RunOrScheduleAction(System.Action, Boolean, System.Threading.Tasks.Task ByRef)00007F27E6A47510 00007F27E82B42D1 System.Threading.Tasks.Task.FinishContinuations()00007F27E6A47590 00007F27E82B6E3C System.Threading.Tasks.Task`1[[System.Int32, mscorlib]].TrySetResult(Int32)00007F27E6A475B0 00007F27E877DAA6 System.Runtime.CompilerServices.AsyncTaskMethodBuilder`1[[System.Int32, mscorlib]].SetResult(Int32)00007F27E6A475E0 00007F27E97ADF19 Microsoft.AspNetCore.WebUtilities.FileBufferingReadStream+<ReadAsync>d__24.MoveNext()00007F27E6A47650 00007F27E7DFCB9A System.Threading.ExecutionContext.Run(System.Threading.ExecutionContext, System.Threading.ContextCallback, System.Object)00007F27E6A476A0 00007F27E877FF42 System.Runtime.CompilerServices.AsyncMethodBuilderCore+MoveNextRunner.Run()00007F27E6A476E0 00007F27E877FD65 System.Threading.Tasks.AwaitTaskContinuation.RunOrScheduleAction(System.Action, Boolean, System.Threading.Tasks.Task ByRef)00007F27E6A47710 00007F27E82B42D1 System.Threading.Tasks.Task.FinishContinuations()00007F27E6A47790 00007F27E82B34A8 System.Threading.Tasks.Task.Finish(Boolean)00007F27E6A477D0 00007F27E7DFE091 System.Threading.Tasks.Task.ExecuteWithThreadLocal(System.Threading.Tasks.Task ByRef)00007F27E6A47890 00007F27E7DFD873 System.Threading.Tasks.Task.ExecuteEntry(Boolean)00007F27E6A478B0 00007F27E7E0F215 System.Threading.ThreadPoolWorkQueue.Dispatch()00007F27E6A47C40 00007F286186EFA7 [DebuggerU2MCatchHandlerFrame: 00007f27e6a47c40](lldb) sos DumpObj 00007f27c361e368Name:        System.Text.StringBuilderMethodTable: 00007f27e7c4e480EEClass:     00007f27e7c3d1b8Size:        48(0x30) bytesFile:        /mnt/test/StarterMvc/bin/debug/dnxcore50/ubuntu.14.04-x64/mscorlib.dllFields:              MT    Field   Offset                 Type VT     Attr            Value Name00007f27e7c29a08  4001616        8        System.Char[]  0 instance 00007f27cb23b8c0 m_ChunkChars00007f27e7c4e480  4001617       10 ...ext.StringBuilder  0 instance 00007f27cb23f7c0 m_ChunkPrevious00007f27e7c216a0  4001618       18         System.Int32  1 instance                0 m_ChunkLength00007f27e7c216a0  4001619       1c         System.Int32  1 instance          4928192 m_ChunkOffset00007f27e7c216a0  400161a       20         System.Int32  1 instance       2147483647 m_MaxCapacity__Totally we had more than 10000 StringBuilder objects. _Statistics:              MT    Count    TotalSize Class Name00007f27e7c4e480    10539       505872 System.Text.StringBuilder_Statistics:              MT    Count    TotalSize Class Name00007f27e7c29a08    10690    166336624 System.Char[]```_Copied from original issue: aspnet/HttpAbstractions#583_
2720	area-servers	LOH fragmentation when user post form with section content more than 85KB	_From @yuwaMSFT on Friday, March 25, 2016 3:24:48 PM_Post a multipart form with content more than 85KB in each section would cause heavy LOH fragmentation in MVC app.Post a multipart form with 100 sections, each containing random sized content with an average of 120KB.After the first request:```_         segment             begin         allocated              size0000021c56c50000  0000021c56c51000  0000021c582fa2a0  0x16a92a0(23761568)Total Size:              Size: 0x1f0bcb8 (32554168) bytes.Statistics:              MT    Count    TotalSize Class Name0000021c46a5d8e0      **107         3204      **Free00007ffbbe854418        9       146136 System.Object[]00007ffbbe84e210       16      2097536 System.Byte[]00007ffbbe862498      ** 81     21514154 **System.String_```After the 2nd request:```_Large object heap starts at 0x0000021c56c51000         segment             begin         allocated              size0000021c56c50000  0000021c56c51000  0000021c5983f700  0x2bee700(46065408)Statistics:              MT    Count    TotalSize Class Name0000021c46a5d8e0      **194         5814      **Free00007ffbbe854418        9       146136 System.Object[]00007ffbbe84e210       22      2884112 System.Byte[]00007ffbbe862498      **162     43028308 **System.String_```After the 3rd request:```_Large object heap starts at 0x0000021c56c51000         segment             begin         allocated              size0000021c56c50000  0000021c56c51000  0000021c5983f700  0x2bee700(46065408)Total Size:              Size: 0x362f488 (56816776) bytes.Statistics:              MT    Count    TotalSize Class Name0000021c46a5d8e0     ** 276         8274      **Free00007ffbbe854418        9       146136 System.Object[]00007ffbbe84e210       23      3015208 System.Byte[]00007ffbbe862498     ** 243     64542462 **System.String_```So for each request we are adding the large string in LOH for each section (field) of the form. Also, look at the "Free" type. They are mostly 30 bytes in LOH accompany each large string. It may be some string interning.For the string object, basically we are reading each section (field) into a string:``` C#_                        else if (HasFormDataContentDisposition(contentDisposition))                        {                            // Content-Disposition: form-data; name="key"                            //                            // value                            var key = HeaderUtilities.RemoveQuotes(contentDisposition.Name);                            MediaTypeHeaderValue mediaType;                            MediaTypeHeaderValue.TryParse(section.ContentType, out mediaType);                            var encoding = FilterEncoding(mediaType?.Encoding);                            using (var reader = new StreamReader(section.Body, encoding, detectEncodingFromByteOrderMarks: true, bufferSize: 1024, leaveOpen: true))                            {                                **var value = await reader.ReadToEndAsync**();                                formAccumulator.Append(key, value);                            }                        }_```This can be easily explored to cause the server to run OOM. Security concern as well._Copied from original issue: aspnet/HttpAbstractions#597_
2719	area-servers	Merge QueryString & Query Properties	_From @niemyjski on Monday, May 30, 2016 8:05:48 AM_Currently the request object has a `Host` property that has `Host.Host` and `Host.Port` and it makes it easier to get that info. There is one place to look.  But when it comes to the query string there are inconsistencies and it's not as discoverable. At first I saw the QueryString property and looked in intellisense for QuerySring but didn't even think to look for Query after working with Host and some of the other complex property types. There is a `Query` property that gives you a parsed query string and then a `QueryString` property that builds up the Query into a single string. It would be nice if the `IQueryCollection` had a ToString() implementation to display the query string, but at the same time it should be separated out and not responsible for building it. Which is why I see there are two properties. With this said I guess the question is, should these be merged into a complex type that has both QueryString and Query or just an Extension Method that builds the query string from IQueryCollection?_Copied from original issue: aspnet/HttpAbstractions#644_
2718	area-servers	UriHelper.GetDisplayUrl() throws NullReferenceException if request is lacking host header	_From @mikeharder on Tuesday, July 12, 2016 4:42:47 PM_If a client makes a valid HTTP 1.0 request without a host header, UriHelper.GetDisplayUrl() throws NullReferenceException.# Server Code``` csharppublic class Program{    public static void Main(string[] args)    {        new WebHostBuilder()            .UseKestrel(options =>            {                options.UseConnectionLogging();            })            .UseStartup<Program>()            .Build()            .Run();    }    public void Configure(IApplicationBuilder app, ILoggerFactory loggerFactory)    {        loggerFactory.AddConsole(LogLevel.Trace);        var logger = loggerFactory.CreateLogger("Default");        app.Run(async context =>        {            await context.Response.WriteAsync(context.Request.GetDisplayUrl());        });    }}```# Client Commands```> curl --http1.0 http://localhost:5000http://localhost:5000/> curl -v -H "Host:" --http1.0 http://localhost:5000HTTP/1.1 500 Internal Server Error```# Server Log```System.NullReferenceException: Object reference not set to an instance of an object.   at Microsoft.AspNetCore.Http.Extensions.UriHelper.GetDisplayUrl(HttpRequest request)```_Copied from original issue: aspnet/HttpAbstractions#671_
2717	area-servers	Make RequestHeaders a struct	_From @Yves57 on Sunday, September 4, 2016 1:51:14 AM_`RequestHeaders` are generally allocated one time per request (see the [Response Caching Context](https://github.com/aspnet/ResponseCaching/blob/dev/src/Microsoft.AspNetCore.ResponseCaching/ResponseCachingContext.cs#L36) or my PR about compression in `BasicMiddleware` for example), and it is a small object.So I suppose it would be be better for the GC to make it `struct` instead of `class`._Copied from original issue: aspnet/HttpAbstractions#700_
2716	area-servers	Reduce FormReader allocations	_From @davidfowl on Wednesday, September 7, 2016 10:50:26 PM_1000 requests (I ran a console app in a loop) yields the following.``` C#while (true){    Console.WriteLine("Press any key to run");    Console.ReadLine();    for (int i = 0; i < 1000; i++)    {        var formReader = new FormReader("name=David&Age=12&Developer=Chris");        var form = formReader.ReadForm();    }}```![image](https://cloud.githubusercontent.com/assets/95136/18338415/713cdeaa-754d-11e6-8094-eec70572c9c1.png)_Copied from original issue: aspnet/HttpAbstractions#707_
2715	area-servers	WebSockets does not have support for extensions	_From @vanillajonathan on Monday, September 19, 2016 2:26:50 PM_The `WebSocket` class does not have support for extensions. Which is part of the rfc6455 standard:https://tools.ietf.org/html/rfc6455#section-9It should read the `Sec-WebSocket-Extensions` HTTP header from the client.The `WebSocket` class does not expose a `Extensions` property._Copied from original issue: aspnet/HttpAbstractions#711_
2714	area-servers	Add support for various charsets to application/x-www-form-urlencoded.	_From @aetos382 on Wednesday, October 5, 2016 1:26:32 AM_The [FormReader](https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.AspNetCore.WebUtilities/FormReader.cs) is only supporting UTF-8 because Encoding isn't used when [decoding the  percent-encoded string](https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.AspNetCore.WebUtilities/FormReader.cs#L236).Please handle charset right to support charsets except UTF-8.And add support for [_charset_ field](https://url.spec.whatwg.org/#urlencoded-parsing)._Copied from original issue: aspnet/HttpAbstractions#720_
2713	area-servers	Usability: PathString.StartsWithSegments() with a trailing slash is not intuitive behavior	_From @NickCraver on Sunday, January 15, 2017 7:34:28 AM_I was trying to do effectively this yesterday:```C#new PathString("/profiler/test").StartsWithSegments(new Path("/profiler/");```This was, to me, unexpectedly false. And I spent over an hour being an idiot. Once I was in source, I finally realized that a starts-with check of `"/profiler"` works, while including a trailing slash of `"/profiler/"` does not. Is this intended behavior? [The `PathString` tests](https://github.com/aspnet/HttpAbstractions/blob/622d112372ed11075af160b1fb5a11a7637ff516/test/Microsoft.AspNetCore.Http.Abstractions.Tests/PathStringTests.cs) don't actually include a case testing it either way.**Current** behavior examples:```c#	new PathString("/a/b").StartsWithSegments(new PathString("/a/"));  // false	new PathString("/a/b").StartsWithSegments(new PathString("/a"));   // true	new PathString("/a//b").StartsWithSegments(new PathString("/a/")); // true```Currently the check of `value1[value2.Length] == '/'` means whatever's checked against must match or have a trailing slash *after* it, unless it matches exactly. It seems to be that a `/path/` should work here. Is there any objection to this working?The check could change from:```c#value1.Length == value2.Length || value1[value2.Length] == '/'```to:```c#value1.Length == value2.Length || value1[value2.Length] == '/' || value2[value2.Length-1] == '/'```and in the remainder methods, it'd be slightly different with an additional `if` instead:```c#if (value2[value2.Length - 1] == '/'){    remaining = new PathString(value1.Substring(value2.Length - 1));    return true;}```Thoughts? Is there a reason it doesn't behave like this already, or just an ambiguous case? I'd be happy to submit a PR if it's a welcomed change._Copied from original issue: aspnet/HttpAbstractions#756_
2712	area-servers	Cache-Control Immutable HTTP Header	_From @Eilon on Monday, January 30, 2017 10:05:13 AM__From @RehanSaeed on January 27, 2017 9:3_There is a new `immutable` extension to the `Cache-Control` HTTP header which has been adopted into the IETF on the Standards Track. It's currently implemented in Firefox 49. The documentation states:> Indicates that the response body will not change over time. The resource, if unexpired, is unchanged on the server and therefore the client should not send a conditional revalidation for it (e.g. If-None-Match or If-Modified-Since) to check for updates. Clients that aren't aware of this extension must ignore them as per the HTTP specification. In Firefox, immutable is only honored on https:// transactions.Read More here:- [IETF Draft Spec](https://tools.ietf.org/html/draft-mcmanus-immutable-00)- [Using Immutable Caching To Speed Up The Web](https://hacks.mozilla.org/2017/01/using-immutable-caching-to-speed-up-the-web/)- [Cache-Control](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control)- [Cache-Control: immutable](https://bitsup.blogspot.co.uk/2016/05/cache-control-immutable.html)- [This browser tweak saved 60% of requests to Facebook](https://code.facebook.com/posts/557147474482256)Facebook and the BBC have implemented this extension with significant performance wins. Since this is a draft spec, ASP.NET Core should probably not implement it just yet but raising this issue to put it on the radar. If another browser should implement this feature, perhaps it should be considered even as a draft._Copied from original issue: aspnet/Mvc#5723__Copied from original issue: aspnet/HttpAbstractions#763_
2711	area-servers	Unable to upload file greater than 2GB in size	_From @kagoyal on Wednesday, February 1, 2017 3:11:34 PM_I am trying to upload file greater than 2GB using multipart formdata. The issue I am observing is after 2GB upload, read of input stream gets stuck and process hangs.Microsoft.AspNetCore.Server.Kestrel version we are using is "1.1.0".HTTP request’s response never come back and timesout after one hour (execution time we have set).I have modified IIS post limits for upto 4GB, also in ConfigureServices –                services.Configure<FormOptions>(x =>                {                    x.MultipartBodyLengthLimit = 4294967296;                 });I am following the sample here - https://github.com/aspnet/Docs/tree/master/aspnetcore/mvc/models/file-uploads/sample/FileUploadSample to read multipart data.Please let me know if any more information is required to debug this, or if this is expected behavior._Copied from original issue: aspnet/HttpAbstractions#766_
2710	area-servers	More granular tests for `TryParseQualityDouble`	_From @JunTaoLuo on Monday, March 6, 2017 3:12:56 PM_The utility method `TryParseQualityDouble` was added in https://github.com/aspnet/HttpAbstractions/commit/7440d5d29c3814d94c83cdbbea04ee8179e03e64 and was tested transitively in `StringWithQualityHeaderValueTest.cs`. We should add more granular tests in `HeaderUtilitiesTests` that includes checking for the length output._Copied from original issue: aspnet/HttpAbstractions#784_
2709	area-servers	MediaTypeHeaderValue constructor throws if given a media type with params	_From @SteveSandersonMS on Thursday, March 30, 2017 5:15:43 AM_Currently, `new MediaTypeHeaderValue("application/vnd.entity; v=2")` throws, giving the error *The format of value 'application/vnd.entity; v=2' is invalid*. Is this by design? It seems like it should be valid for an incoming `Content-Type` header to specify params.Extra strange: `MediaTypeHeaderValue.TryParse("application/vnd.entity; v=2", out _)` returns `true`, implying that the same string is valid.(Somewhat related to #718, in that it's also about extending the range of media types we parse)_Copied from original issue: aspnet/HttpAbstractions#805_
2708	area-servers	ITlsConnectionFeature should include client certificate chain elements	_From @alextolp on Sunday, April 2, 2017 8:24:37 PM_It should be possible to access the client certificate and any chain elements that were presented by the client when the TLS connection was established. Currently the feature only exposes the client certificate, without any intermediate certificates, making it very difficult to work with the chain elements in the mvc layer._Copied from original issue: aspnet/HttpAbstractions#808_
2707	area-servers	Add Microbenchmarks for Microsoft.AspNetCore.WebUtilities	_From @davidfowl on Sunday, April 9, 2017 6:04:34 PM_- Multipart stream reading- Header parsing and formatting- Form parsing via FormReader- Base64UrlTextEncoder_Copied from original issue: aspnet/HttpAbstractions#812_
2706	area-servers	Rename the types in Microsoft.Net.Http.Headers	_From @davidfowl on Monday, April 10, 2017 12:19:36 AM_When using this library in a project that has `HttpClient` there are type conflicts everywhere._Copied from original issue: aspnet/HttpAbstractions#813_
2704	area-servers	How to handle multi value cookies in ASP.NET Core?	_From @304NotModified on Friday, May 5, 2017 9:03:14 AM_In the full .NET framework we have support for multi value cookies. e.g. a cookie could have multiple values:```c#HttpCookie aCookie = new HttpCookie("userInfo");aCookie.Values["userName"] = "patrick";aCookie.Values["lastVisit"] = DateTime.Now.ToString();```See also [the docs about `HttpCookie.Values` on MSDN](https://msdn.microsoft.com/en-us/library/system.web.httpcookie.values%28v=vs.110%29.aspx?f=255&MSPPError=-2147217396) and [ASP.NET Cookies Overview on MSDN](https://msdn.microsoft.com/en-us/library/ms178194.aspx?f=255&MSPPError=-2147217396).With ASP.NET Core, the multi value cookie seems to be gone. There is no `HttpCookie.Values` and [`HttpRequest.Cookies`](https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.http.httprequest#Microsoft_AspNetCore_Http_HttpRequest_Cookies) returns a [`IRequestCookieCollection`](https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.http.irequestcookiecollection#Microsoft_AspNetCore_Http_IRequestCookieCollection) which like a  `dictionary` from `string` to `string`How should I now create and read multi value cookies in ASP.NET Core? How could I read the multi value cookies created in Full ASP.NET and read them in ASP.NET Core? _Copied from original issue: aspnet/HttpAbstractions#831_
2702	area-servers	Move IFeatureCollection and friends to Microsoft.Extensions.Primitives	_From @davidfowl on Saturday, May 20, 2017 12:46:19 AM_The `IFeatureCollection` isn't tied to HTTP and we'd like to use it for non http things. Ideally it would be part of the primitives package and `Microsoft.AspNetCore.Http.Features` would contain http specific features._Copied from original issue: aspnet/HttpAbstractions#845_
2699	area-servers	Don't allocate the FormFeature eagerly per request	_From @davidfowl on Thursday, June 29, 2017 8:01:27 AM_Today, in order to pass the form options to the `FormFeature`, we eagerly allocate it here https://github.com/aspnet/HttpAbstractions/blob/163836fe1f31dd1d2b288659c2dcaf1d827da3c4/src/Microsoft.AspNetCore.Http/HttpContextFactory.cs#L49. We should find a creative way to avoid doing this so eagerly in the common cases. Here are some options:- Invent a new way to pass things to features lazily (hard, we tried this and ended up with crazy things)- Only new up the `FormOptions` if they were overridden. We'd need a way to detect if the `FormOptions` were actually set. This is doable but could get ugly as there's no way to detect if options were configured. /cc @HaoK - Only set the `FormFeature` if the request is a POST and `HasFormContentType`. Gross, but would be more pay for play than what we have today./cc @vancem @Tratcher _Copied from original issue: aspnet/HttpAbstractions#880_
2696	area-servers	PathString.FromUriComponent encoding forward slash makes no difference	_From @Tratcher on Wednesday, August 2, 2017 7:08:13 AM__From @PawelTroka on August 2, 2017 10:17_It was already shortly discussed in https://github.com/aspnet/Mvc/issues/2826 where @davidfowl suggested that the issue I am encountering is only happening on TestHost. And yes, he is right - it works correctly when hosted and invoked through web browser or any web client for that matter. It is failing however in my integration tests where I am using Microsoft.AspNetCore.TestHost v1.1.2 and Microsoft.AspNetCore.WebUtilities v1.1.2. Please notice that my WebApi and WebApi.IntegrationTests are AspNetCore 1.1 but are targeting net461 (due to some of my libraries not yet ported).Repro:Unit test:https://github.com/PawelTroka/Computator.NET/blob/master/Computator.NET.WebApi.IntegrationTests/CalculateApiTests.cs#L49Should go through route:real/{equation}/{x} from method:https://github.com/PawelTroka/Computator.NET/blob/master/Computator.NET.WebApi/Controllers/CalculateController.cs#L32But because encoding forward slash makes no difference it is going through different route:real/{equation}/{x}/{customFunctionsCode} from the same methodIn images:When run through browser everything is ok:![image](https://user-images.githubusercontent.com/11928766/28869021-a7dc70ac-777b-11e7-914a-cda7eddf54f4.png)![image](https://user-images.githubusercontent.com/11928766/28868995-934b15a8-777b-11e7-9b47-5edbfea9680a.png)But when run on TestHost, encoding forward slash really makes no difference:![image](https://user-images.githubusercontent.com/11928766/28869103-f6594174-777b-11e7-857d-61a99ac2d914.png)_Copied from original issue: aspnet/Hosting#1155__Copied from original issue: aspnet/HttpAbstractions#912_
2695	area-servers	MediaTypeHeaderValue accepts a list of strings instead of a list of StringSegments	_From @jkotalik on Monday, August 21, 2017 6:09:48 PM_With our efforts to remove usages of strings in favor of string segments, it seems incomplete that [MediaTypeHeaderValue.ParseList](https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.Net.Http.Headers/MediaTypeHeaderValue.cs#L377-L395) only accepts a list of strings rather than a list of StringSegment. We should consider adding an overload to accept a list of StringSegment too. _Copied from original issue: aspnet/HttpAbstractions#920_
2694	area-servers	HttpRuleParser GetExpressionLength allows invalid characters.	_From @jkotalik on Tuesday, August 22, 2017 4:19:40 PM_@Tratcher and I discovered that [GetExpressionLength in HttpRuleParser](https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.Net.Http.Headers/HttpRuleParser.cs#L257) allows invalid characters (including control characters in expressions. GetExpressionLength mentions [that we don't really care about the content of a quoted string](https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.Net.Http.Headers/HttpRuleParser.cs#L250-L251), however it seems appropriate that if a quoted string has an invalid character, it should throw on parsing here, not in Kestrel (or whatever server). This would be a breaking change, as it would introduce a new place where an exception is thrown, however it is probably the right behavior. _Copied from original issue: aspnet/HttpAbstractions#923_
2693	area-servers	FeatureCache is over-checked and over-reset	_From @benaadams on Wednesday, August 23, 2017 6:59:06 PM_A simple plantext middleware as below, will check the `Frame` `IFeatureCollection` 7 times and initialize/reset the Context, Resquest and Responses feature caches twice each.```csharppublic static Task WriteResponse(HttpResponse response){    var payloadLength = _helloWorldPayload.Length;    response.StatusCode = 200;    response.ContentType = "text/plain";    response.ContentLength = payloadLength;    return response.Body.WriteAsync(_helloWorldPayload, 0, payloadLength);}```![](https://aoa.blob.core.windows.net/aspnet/feature-cache.png)The extra reset and checks are from initalization; then reinitialization after `RequestServicesFeature` is added to the collection by the host, increasing the `IFeatureCollection`'s version count._Copied from original issue: aspnet/HttpAbstractions#924_
2690	area-servers	Implement UriTemplate spec 	_From @davidfowl on Sunday, September 3, 2017 6:21:50 PM_https://tools.ietf.org/html/rfc6570Need a design for the API shape, strawman here https://docs.spring.io/spring/docs/current/javadoc-api/org/springframework/web/util/UriTemplate.html.FWIW WCF has this type in .NET Framework https://msdn.microsoft.com/en-us/library/system.uritemplate(v=vs.110).aspx but I'm not sure it implements the spec nor do I know if it's relevant.Today we have [RouteTemplate](https://github.com/aspnet/Routing/blob/6b2ccdead8e6d2968a1520ef8232d8f6daa70000/src/Microsoft.AspNetCore.Routing/Template/RouteTemplate.cs), [TemplateParser](https://github.com/aspnet/Routing/blob/6b2ccdead8e6d2968a1520ef8232d8f6daa70000/src/Microsoft.AspNetCore.Routing/Template/TemplateParser.cs) and [TemplateMatcher](https://github.com/aspnet/Routing/blob/6b2ccdead8e6d2968a1520ef8232d8f6daa70000/src/Microsoft.AspNetCore.Routing/Template/TemplateMatcher.cs). This doesn't implement the RFC but @rynowak tells me it can be converted to a proper URITemplate./cc @rynowak @danroth27 _Copied from original issue: aspnet/HttpAbstractions#934_
2688	area-servers	RFC 8187 - Character Encoding for Headers	_From @benaadams on Thursday, September 14, 2017 10:47:59 PM_From https://github.com/aspnet/KestrelHttpServer/issues/2063Hot off the presses (September 2017) https://tools.ietf.org/html/rfc8187Indicating Character Encoding and Language for HTTP Header Field Parameters> @Tratcher  Hmm, interesting choices. It only applies to key value pairs within headers, and is ASCII compatible, so I don't foresee making any changes to Kestrel. Microsoft.Net.Http.Headers in HttpAbstractions looks like the most obvious consumer/producer of such values. ContentDispositionHeaderValue already supports this because it was designed for use in multipart MIME bodies: https://github.com/aspnet/HttpAbstractions/blob/5128efe0e88eaa176d4231ff62d754de59bb0edd/src/Microsoft.Net.Http.Headers/ContentDispositionHeaderValue.cs#L347>> Move to HttpAbstractions?_Copied from original issue: aspnet/HttpAbstractions#940_
2686	area-servers	PathString.FromUriComponent(string) should not decode %2F to forward slash	_From @Tratcher on Monday, November 6, 2017 4:03:42 PM_%2F, an escaped `/` is one of the only characters that should not be un-escaped by FromUriComponent. All other characters can correctly be round tripped by ToUriComponent, but %2F creates ambiguity if unescaped.https://github.com/aspnet/HttpAbstractions/blob/c0f937239a0a099b73c67c96ab9e1c875952f67f/src/Microsoft.AspNetCore.Http.Abstractions/PathString.cs#L175_Copied from original issue: aspnet/HttpAbstractions#959_
2675	area-servers	Response cookies Append inconsistently applies SameSite default	_From @Tratcher on Wednesday, December 27, 2017 9:11:02 AM_The two Append overloads have inconsistent behavior for the samesite property that was added in 2.0.```                context.Response.Cookies.Append("Name1", "Value1");                context.Response.Cookies.Append("Name2", "Value2", new CookieOptions());``````Set-Cookie:Name1=Value1; path=/Set-Cookie:Name2=Value2; path=/; samesite=lax```The two overloads should have the same defaults.I noticed because we're making changes to CookiePolicy for http://github.com/aspnet/Security/issues/1561 and adding it to the templates. This will have the side-effect of causing the Append API to consistently use the second overload's behavior. _Copied from original issue: aspnet/HttpAbstractions#982_
2672	area-mvc	Need more log info when requests matching conventional routing match actions with attribute routes	_From @kichalla on Tuesday, June 14, 2016 2:04:34 PM_For the following controller``` c#public class LinksController : Controller{    [Route("api/links")]    public string Index()    {        return "Links.Index";    }}```and Startup.cs configured like below``` c#app.UseMvc(rb =>{    rb.MapRoute("default", "{controller}/{action}");});```A request like `links/index` results in 404. This is expected but the logs do not provide much info here. Should we give more detail? ```info: Microsoft.AspNetCore.Hosting.Internal.WebHost[1]      Request starting HTTP/1.1 GET http://localhost:5000/links/indexdbug: Microsoft.AspNetCore.Routing.RouteBase[1]      Request successfully matched the route with name 'default' and template '{controller}/{action}'.dbug: Microsoft.AspNetCore.Mvc.Internal.MvcRouteHandler[3]      No actions matched the current requestdbug: Microsoft.AspNetCore.Builder.RouterMiddleware[1]      Request did not match any routes.info: Microsoft.AspNetCore.Hosting.Internal.WebHost[2]      Request finished in 29.8027ms 404```_Copied from original issue: aspnet/Routing#325_
2665	area-mvc	LowercaseUrls = true in RouteOptions doesn't affect URLs with non-Roman characters	_From @DevelAx on Sunday, September 3, 2017 12:17:16 PM_In ASP.NET MVC CORE 2.0```public void ConfigureServices(IServiceCollection services){    services.Configure<RouteOptions>(options => options.LowercaseUrls = true);    services.AddMvc();}````<a asp-action="New-Post">New post</a>`works fine giving URL like http://domain/controller/new-postBut this one`<a asp-action="Новая-Публикация">Новая публикация</a>`produces URL like http://domain/controller/Новая-Публикация**Seems like RouteCollection uses ToLowerInvariant() to lower-case the URL:** https://github.com/aspnet/Routing/blob/032bcf43b2cefe641fc6ee9ef3ab0769024a182c/src/Microsoft.AspNetCore.Routing/RouteCollection.cs#L155_Copied from original issue: aspnet/Routing#435_
2664	area-mvc	URL generation should be able to be keyed off of non-string elements	_From @Eilon on Tuesday, September 5, 2017 1:25:50 PM_Today's routing system is based entirely off of string dictionaries. We should have a way to have other data types, such as `Type` (e.g. of an MVC controller) act as inputs into locating a route for URL generation._Copied from original issue: aspnet/Routing#436_
2659	area-mvc	Consider adding a configuration experience tailored towards localization	_From @rynowak on Thursday, October 12, 2017 11:16:38 AM_We might want the ability to configure something like a *global* prefix for routes that includes a locale. This would be super simple to use with the localization middleware_Copied from original issue: aspnet/Routing#468_
2653	area-mvc	Pluralization	_From @hishamco on Saturday, May 16, 2015 3:42:30 PM_Pluralization is a complex problem, as different languages have a variety of complex rules for pluralization. You may easily manage this in your language files using many techniques such as `Notification => You have [one message | many messages] in your inbox``Notification => You have one message in your inbox | You have many messages  in your inbox`this can be done by introducing an optional parameter isPlural in `GetString` method, to get the pluralized text from the actual value_Copied from original issue: aspnet/Localization#17_
2652	area-mvc	Localization & Output Caching	_From @hishamco on Wednesday, June 24, 2015 11:31:06 AM_I'm wondering if the **Output Caching** will block the localization APIs from retrieving the right values for the current culture, or shall we need sort of `VaryByCustom` to update the correct values based on the current culture/cc @DamianEdwards _Copied from original issue: aspnet/Localization#40_
2649	area-mvc	Supporting custom cultures that are not pre-defined in options.SupportedCultures	_From @chaim770 on Wednesday, April 13, 2016 2:18:44 AM_Following this StackOverflow question:http://stackoverflow.com/questions/36590969/enabling-client-based-culture-in-asp-net-coreIt's currently impossible to let the `CultureInfo` be determined automatically from what the client specify in the `Accept-Language` header (as it used to be using `<system.web.globalization enableClientBasedCulture>` in `Web.config`).The way it is now, I have to pre-register all the cultures I'm planning to support, which renders  `AcceptLanguageHeaderRequestCultureProvider` quite useless.The following is the culprit:https://github.com/aspnet/Localization/blob/b52e33caa7927093dc3ec540fd3282f4f69ae169/src/Microsoft.Extensions.Globalization.CultureInfoCache/CultureInfoCache.cs#L34_Copied from original issue: aspnet/Localization#237_
2647	area-mvc	Must use `Type.FullName` for resource files found using default `IStringLocalizer<T>`	_From @dougbu on Wednesday, October 19, 2016 7:46:53 PM_Behind our default `IStringLocalizer<T>`, `ResourceManagerStringLocalizerFactory` removes a prefix matching `IHostingEnvironment.ApplicationName` or `AssemblyName.Name` (in some cases) from `T`'s `FullName` before a search of the containing assembly for requested resources. This does not help users who happen to have a different root namespace from the containing assembly / application name. They must use `T`'s entire `FullName` e.g.![capture](https://cloud.githubusercontent.com/assets/6431421/19544468/fb930ece-9633-11e6-86ba-3ccd1e37bd08.png)One important case occurs when Visual Studio creates a new project from a template and the user chooses a name that's invalid as a C# identifier. The "safe project name" used as the root namespace is created using a simple algorithm but will not match the application / assembly name.While redoing the "safe project name" algorithm in our code may be an ugly hack, we could e.g. extend `[ResourceLocation]` to also specify the namespace prefix to remove when searching for resources in the containing assembly based on a `Type`.---Found while working with sample application at [dougbu/Localized.1.1-preview](https://github.com/dougbu/Localized.1.1-preview). Screenshot above comes from VS with that solution open. (Took longer than it should for me to find the workaround.)_Copied from original issue: aspnet/Localization#296_
2644	area-mvc	Reconsider resource naming rules	_From @ryanbrandenburg on Wednesday, March 15, 2017 11:19:44 AM_Right now if your full class name starts with the name of the assembly it will be trimmed. So for a project with assembly `Project.Name.dll` the class `Project.Name.Startup` would have the resource `Startup.resx`.This seems to cause a lot of confusion and trouble (#318, #314 and many more). Previously the documentation in this area was incorrect, which likely lead to a lot of this confusion, but problems still persist and this is the most common type of issues filed on Localization.We've already added `SearchedLocation` to `LocalizerString` to help with this, but people still seem to be having trouble so here are some of the options I've come up with.1. Create a "mode" on `ResourceManagerStringLocalizer` which will throw an exception (with a detailed error message about where it looked) when a resource isn't found instead of returning the key as a result. The idea here is that it makes it clearer when a resource isn't found rather than "hiding" that behind "the key as default".2. Don't do any trimming of class names. So the resource for `Project.Name.Startup` would always be `Project.Name.Startup.resx` no matter what the AssemblyName is. We could roll this out slowly by allowing fallback to the "trimmed" name for some time (or forever). The idea here is to reduce the complexity of figuring out what to name resource to the simplest possible thing, even if it means having longer resource names (or more deeply nested resource folders)._Copied from original issue: aspnet/Localization#343_
2641	area-mvc	Create Localization template for 'dotnet new'	_From @Eilon on Tuesday, March 21, 2017 2:21:47 PM_With the new `dotnet new` extensibility, it would be nice to have an ASP.NET Core template that is fully localizable._Copied from original issue: aspnet/Localization#347_
2633	area-mvc	Custom SQL IStringLocalizerFactory overrides IViewLocalizer in application	_From @asadsahi on Wednesday, November 15, 2017 3:12:10 AM_I have custom EF String localizer as demonstrated in [this](https://github.com/aspnet/Entropy/tree/dev/samples/Localization.EntityFramework) EF sample.`            services.AddSingleton<IStringLocalizerFactory, EFStringLocalizerFactory>();`With above custom EF sql localizer, no other localizer works i.e IViewLocalizer . If I take out this registration:`            services.AddSingleton<IStringLocalizerFactory, EFStringLocalizerFactory>();`IViewLocalizer returns culture specific strings as normal. Am I missing anything or this is by design?Issue could be reproduced using [this](https://github.com/asadsahi/AspNetCoreSpa/tree/localisation) sample repo._Copied from original issue: aspnet/Localization#425_
2628	area-middleware	Responses to POST can be cached for future GET methods	_From @darrelmiller on Tuesday, June 9, 2015 5:59:22 PM_https://github.com/aspnet/ResponseCaching/blob/chrross/initial/src/Microsoft.AspNet.ResponseCaching/CachingContext.cs#L39This is a weird one that requires using GET as the cache key instead of using the original request method._Copied from original issue: aspnet/ResponseCaching#4_
2627	area-middleware	Create feature interface for opting in/out of server side caching.	_From @Tratcher on Friday, June 12, 2015 10:08:31 AM_Needs design_Copied from original issue: aspnet/ResponseCaching#5_
2626	area-middleware	Option for disk-backed cache	_From @benaadams on Saturday, July 2, 2016 8:31:47 PM_So when items are evicted due to memory pressure or over recycles they can be resurrected if needed without regeneration if within cache period.Similar to [Using Static Content Generation in ASP.NET Core](http://blog.decayingcode.com/post/using-static-content-generation-in-asp.net-core/) by @MaximRouiller_Copied from original issue: aspnet/ResponseCaching#8_
2625	area-middleware	Option for WeakReference caching 	_From @benaadams on Saturday, July 2, 2016 8:37:10 PM_So cached items can be evicted on GC rather than having infrequently accessed items remaining cached in memory until expiry (utilizing [sample for caching weak references](https://github.com/aspnet/Caching/commit/a197fe623325e67f5a9a33f759499bcd4828d235) by @Tratcher)Related #8 "Option for disk-backed cache"_Copied from original issue: aspnet/ResponseCaching#9_
2624	area-middleware	Partial responses and range requests	_From @JunTaoLuo on Thursday, September 15, 2016 2:09:20 PM_Currently we don't cache partial responses with status code 206. These responses are cacheable but right now the user will need to override our cache policy providers to cache them. Also there is no current mechanism to coalesce overlapping partial responses and no way to serve a portion of the response given range requests._Copied from original issue: aspnet/ResponseCaching#36_
2623	area-middleware	Gated incoming requests	_From @JunTaoLuo on Thursday, September 15, 2016 2:13:40 PM_In Orchard CMS, there was a feature where multiple incoming requests will block until the response for the first one is generated and is used to satisfy all waiting requests. Will need to investigate how this can be supported, either within the middleware or by the user given the available extensibility points.cc @sebastienros _Copied from original issue: aspnet/ResponseCaching#37_
2622	area-middleware	Cache invalidation	_From @JunTaoLuo on Thursday, September 15, 2016 2:15:48 PM_Currently we only set the absolute timeouts for cache entries. There is no mechanism to explicitly invalidate a cache entry before expiry. Also, how would applications/users interact with this feature?Note that invalidation is required by the RFC for unsafe methods, e.g. a successful PUT should invalidate any previous cached resources at the same URI._Copied from original issue: aspnet/ResponseCaching#38_
2621	area-middleware	Revalidation	_From @JunTaoLuo on Thursday, September 15, 2016 2:25:34 PM_No current mechanism exist for revalidating a stale entry in the response cache. We may want to support the cache-control extensions listed in https://tools.ietf.org/html/rfc5861, in particular the `stale-while-revalidate` directive._Copied from original issue: aspnet/ResponseCaching#39_
2620	area-middleware	No-cache fields	_From @JunTaoLuo on Thursday, September 15, 2016 2:45:33 PM_Some directive such as `no-cache` may contain fields which can be stripped from the response after which the response can be deemed cacheable. _Copied from original issue: aspnet/ResponseCaching#40_
2619	area-middleware	Cache related warning headers	_From @JunTaoLuo on Thursday, September 15, 2016 2:50:04 PM_Need to revisit this to see what warnings we may want to send along with cached responses. For example, if no original expiry information is explicitly stated, we currently use a default expiration of 10s. In this case, we should send the warning 113 - "Heuristic expiration"_Copied from original issue: aspnet/ResponseCaching#41_
2618	area-middleware	Extensibility for user operations of cached responses	_From @JunTaoLuo on Wednesday, September 21, 2016 11:13:28 AM_We may want to expose an extensibility point for users to modify the cached response. There are two instances where this can occur and we can add the extensibility to one or both. First is when the middleware first receives the response and is about to store it in cache. Second is when the middleware has retrieved the item from cache and is about to use it to serve a request. A scenario that may require this is for stripping out a few headers in an otherwise cacheable response. _Copied from original issue: aspnet/ResponseCaching#52_
2617	area-middleware	Redis response cache store	_From @JunTaoLuo on Wednesday, September 21, 2016 11:51:04 AM_Currently Redis will be exposed through the DistributedResponseCacheStore but the API of IDistributed cache could be a limiting factor. We may bypass that abstraction and design a RedisResponseCacheStore to take advantage of more features of redis._Copied from original issue: aspnet/ResponseCaching#53_
2616	area-middleware	KeyBuilder and hashed keys	_From @JunTaoLuo on Wednesday, September 21, 2016 11:56:48 AM_Currently keys are strings. We may want to consider creating an abstraction of KeyBuilder that only creates a string for IDistributedCache based stores and use an object as the key for IMemoryCache based stores. We may also want to consider adding support for hashing the keys to a constant length_Copied from original issue: aspnet/ResponseCaching#54_
2615	area-middleware	Review logged messages	_From @JunTaoLuo on Wednesday, October 5, 2016 6:06:13 PM_Review the messages that are logged added in https://github.com/aspnet/ResponseCaching/pull/65. Also make sure the messages are at the correct level._Copied from original issue: aspnet/ResponseCaching#68_
2614	area-middleware	Adding Diagnostics Source events/insight	_From @JunTaoLuo on Tuesday, January 10, 2017 10:58:05 AM_Need to work out what data should be tracked._Copied from original issue: aspnet/ResponseCaching#90_
2613	area-middleware	Investigate request `no-cache` behaviour	_From @JunTaoLuo on Tuesday, January 24, 2017 12:23:08 PM_In the current implementation, for requests with a `no-cache` directive, cache lookup is skipped but response capture and cache store still occurs. The RFC only specifies that the cache cannot use a stored response to satisfy the request without validation but explicitly says nothing regarding the response.This means that for requests with `no-cache`, writes to the cache will still occur and will overwrite any existing cached entries for the same resource. This can lead to a large amount of potentially wasted writes and we should determine if this behaviour is common in other implementation of HTTP caching.Note that this can be resolved with user provided implementations of the `IResponseCachingPolicyProvider` but that is not currently exposed publicly. Regardless, we should investigate whether the current implementation should be the default behaviour._Copied from original issue: aspnet/ResponseCaching#95_
2612	area-middleware	Expose policy provider to allow override for default response caching behaviour	_From @JunTaoLuo on Tuesday, January 24, 2017 12:25:21 PM_Currently https://github.com/aspnet/ResponseCaching/blob/dev/src/Microsoft.AspNetCore.ResponseCaching/Internal/Interfaces/IResponseCachingPolicyProvider.cs is not exposed publicly. This type will need some work but exposing it will allow user overrides for checks on what is deemed cacheable, when response caching should apply, and expiry checks for cache entries. _Copied from original issue: aspnet/ResponseCaching#96_
2611	area-middleware	[feature request] Cache-control: Immutable	_From @tinchou on Sunday, January 29, 2017 12:17:57 PM_This is a very recent feature, but one that could improve many sites performance. If there already exists a way to achieve this, it would be great to have it on the Docs.Info: https://code.facebook.com/posts/557147474482256, https://hacks.mozilla.org/2017/01/using-immutable-caching-to-speed-up-the-web/Thanks!_Copied from original issue: aspnet/ResponseCaching#97_
2610	area-middleware	SegmentReadStream should override CopyTo when available	_From @JunTaoLuo on Tuesday, February 7, 2017 4:42:26 PM_In https://github.com/dotnet/corefx/issues/11342 `CopyTo` was made virtual. We should override this with the same logic as `CopyToAsync` to avoid the unnecessary calls to `Read` in the `SegmentReadStream`._Copied from original issue: aspnet/ResponseCaching#105_
2609	area-middleware	Add options for cookie handling	_From @gpeipman on Wednesday, March 8, 2017 2:56:24 AM_It would be nice if there are options for cookies handling. Two things I can propose:1. Option to ignore all cookies (they are often used for client-side stuff only in public sites)2. Option to give names of cookies to ignoreSecond option is specially important as currently it is not possible to use Application Insights with response caching as AI uses cookies when browser-side diagnostics are enabled. I think in this case request cookies must be just copied to response to not delete them._Copied from original issue: aspnet/ResponseCaching#113_
2608	area-middleware	Unable to set a default cache policy for requests without ResponseCache attribute?	_From @Plasma on Monday, May 1, 2017 2:50:14 PM_Hello,By default it seems .NET Core omits any Cache-Control headers.However, I want an explicit Cache-Control: private by default, unless overridden.Is there a way to do this? It does not look like it.Thank you_Copied from original issue: aspnet/ResponseCaching#120_
2607	area-middleware	Make request cacheable when it has "no-cache" header	_From @beltoev on Wednesday, June 7, 2017 1:48:39 PM_Why do we trust the client?For example, "no-cache" header can be used for the ddos attacks. Besides OutputCacheAttribute (ASP.NET MVC 5) doesn't pay attention to this header.Can we change the behavior of the attribute or add it to the settings?_Copied from original issue: aspnet/ResponseCaching#125_
2606	area-middleware	Caching response with Authorization header	_From @bohdyone on Friday, June 30, 2017 6:03:10 PM_Looks like caching not supported if Authorization header is present. This is different to the spec, in that Public responses may still be cached even with this header. This use case is useful if you have a static app token in the Authorization header and set the Vary header to vary based on Authorization._Copied from original issue: aspnet/ResponseCaching#128_
2605	area-middleware	Updating cached vary by rules need to set the correct expiration	_From @JunTaoLuo on Monday, July 10, 2017 3:32:32 PM_Currently it uses the expiration information from the newer entry but this is incorrect since the entry being replaced may have a longer expiration. This could potentially lead to the situation where a valid cached response remains in the cache but the vary by rule entry that is used to retrieve it is expired and removed from the cache._Copied from original issue: aspnet/ResponseCaching#133_
2604	area-middleware	Conditional GET requests (304) not workingin Chrome and Firefox	_From @madskristensen on Friday, August 18, 2017 12:08:25 PM_Chrome and Firefox sends `Cache-Control: no-cache` when user hits F5. When the response has either an ETag or Last-Modified header and the browser sends a matching If-None-Match and/or If-Modified-Since request header, then a 304 response would be expected. However, due to the cache-control header also being present it doesn't send a successful 304 response. The user doesn't control what headers Chrome and Firefox should send on F5_Copied from original issue: aspnet/ResponseCaching#135_
2603	area-middleware	Support for IDistributedCache	_From @mgroves on Wednesday, September 6, 2017 6:26:09 AM_It doesn't appear that `ResponseCache` works with `IDistributedCache` ([see this issue](https://github.com/brantburnett/Couchbase.Extensions/issues/8) over at Couchbase.Extensions. Please correct me if I'm wrong.Will you be adding support for `IDistributedCache` in the future?_Copied from original issue: aspnet/ResponseCaching#137_
2602	area-middleware	VaryByCustom	_From @AdnanCukur on Wednesday, October 25, 2017 12:21:13 AM_I have a Claim in my ClaimsPrincipal object, it contains a boolean, and I need the response cache to vary by this boolean. In MVC 5 I could easily do this with a VaryByCustom string, but I can't figure out how to solve this issue in .NET Core, is this feature missing ?_Copied from original issue: aspnet/ResponseCaching#140_
2601	area-middleware	Add EventSource/EventCounter tracing and metrics for ResponseCaching	_From @anurse on Wednesday, November 1, 2017 3:15:24 PM_Some events listed below. The goal is to find issues that will help users solve problems so if these aren't going to do that job, feel free to suggest/discuss others!* `Microsoft-AspNetCore-ResponseCaching` EventSource    * `CacheSets` - Counts the number of created items    * `CacheRemoves` - Counts the number of explicitly removed items    * `CacheHits` - Counts the number of successful cache lookups    * `CacheMisses` - Counts the number of failed cache lookups    * Eviction? Where does it happen and can it be tracked here? See https://gist.github.com/anurse/af1859663ac91c6cf69c820cebe92303 for some guidance on adding EventSources and EventCounters to ASP.NET projects._Copied from original issue: aspnet/ResponseCaching#141_
2596	area-mvc	Error page should suppress Task stack frames	_From @Tratcher on Monday, August 4, 2014 12:44:07 PM_With an async/await pipeline it's very common for there to be lots of Task based stack frames. Consider the following example:Stack trace:```Microsoft.AspNet.PipelineCore.DefaultHttpResponse.SignIn(IEnumerable`1 identities, AuthenticationProperties properties)Microsoft.AspNet.Http.HttpResponse.SignIn(ClaimsIdentity identity, AuthenticationProperties properties)Microsoft.AspNet.Identity.Authentication.HttpAuthenticationManager.SignIn(ClaimsIdentity identity, Boolean isPersistent) in HttpAuthenticationManager.cs            Context.Response.SignIn(identity, new AuthenticationProperties { IsPersistent = isPersistent });Microsoft.AspNet.Identity.SignInManager`1.<SignInAsync>d__1.MoveNext() in SignInManager.cs            AuthenticationManager.SignIn(userIdentity, isPersistent);--- End of stack trace from previous location where exception was thrown ---System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)System.Runtime.CompilerServices.TaskAwaiter.GetResult()Microsoft.AspNet.Identity.Authentication.SecurityStampValidator.<>c__DisplayClass1`1.<<OnValidateIdentity>b__3>d__0.MoveNext() in SecurityStampValidator.cs                        await manager.SignInAsync(user, isPersistent);--- End of stack trace from previous location where exception was thrown ---System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)Microsoft.AspNet.Security.Cookies.CookieAuthenticationHandler.<AuthenticateCoreAsync>d__1.MoveNext()--- End of stack trace from previous location where exception was thrown ---System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)Microsoft.AspNet.Security.Infrastructure.AuthenticationHandler.<BaseInitializeAsync>d__1.MoveNext()--- End of stack trace from previous location where exception was thrown ---System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)Microsoft.AspNet.Security.Infrastructure.AuthenticationMiddleware`1.<Invoke>d__1.MoveNext()--- End of stack trace from previous location where exception was thrown ---System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)Microsoft.AspNet.Diagnostics.ErrorPageMiddleware.<Invoke>d__1.MoveNext()```Too much of this is noise. Can we suppress / de-emphasize some of these frames?```Microsoft.AspNet.PipelineCore.DefaultHttpResponse.SignIn(IEnumerable`1 identities, AuthenticationProperties properties)Microsoft.AspNet.Http.HttpResponse.SignIn(ClaimsIdentity identity, AuthenticationProperties properties)Microsoft.AspNet.Identity.Authentication.HttpAuthenticationManager.SignIn(ClaimsIdentity identity, Boolean isPersistent) in HttpAuthenticationManager.cs            Context.Response.SignIn(identity, new AuthenticationProperties { IsPersistent = isPersistent });Microsoft.AspNet.Identity.SignInManager`1.<SignInAsync>d__1.MoveNext() in SignInManager.cs            AuthenticationManager.SignIn(userIdentity, isPersistent);...Microsoft.AspNet.Identity.Authentication.SecurityStampValidator.<>c__DisplayClass1`1.<<OnValidateIdentity>b__3>d__0.MoveNext() in SecurityStampValidator.cs                        await manager.SignInAsync(user, isPersistent);...Microsoft.AspNet.Security.Cookies.CookieAuthenticationHandler.<AuthenticateCoreAsync>d__1.MoveNext()...Microsoft.AspNet.Security.Infrastructure.AuthenticationHandler.<BaseInitializeAsync>d__1.MoveNext()...Microsoft.AspNet.Security.Infrastructure.AuthenticationMiddleware`1.<Invoke>d__1.MoveNext()...Microsoft.AspNet.Diagnostics.ErrorPageMiddleware.<Invoke>d__1.MoveNext()```_Copied from original issue: aspnet/Diagnostics#30_
2595	area-mvc	Poor diagnostics when UseErrorHandler points to a non-existing URL (IIS/IIS Express)	_From @Eilon on Monday, August 31, 2015 12:17:01 PM_My project has the usual `app.UseErrorHandler("/Home/Error");` call in it, but I forgot that I deleted the `/Home/Error` action from my app. I'm using IIS Express locally, and IIS on Azure Web Sites.When I run locally, I get the following IIS error:```HTTP Error 403.14 - ForbiddenThe Web server is configured to not list the contents of this directory.```And on Azure it behaves as if my web app never started, showing a "how to upload your site to Azure" default help page.It would be nice if there was some way to detect this incorrect configuration of my app and show a more meaningful and actionable error. It took me, @muratg, and @anurse quite a while to figure out what was going on._Copied from original issue: aspnet/Diagnostics#174_
2594	area-mvc	Preserving the original exception with multiple exception handlers	_From @gustafsonk on Monday, February 15, 2016 12:25:19 PM_There's already a comment in the code for this feature, but I didn't see an issue created for it so I decided to make this one.https://github.com/aspnet/Diagnostics/blob/a03b2dc6b4b540391be189cea2a5a8f75c890b29/src/Microsoft.AspNetCore.Diagnostics/ExceptionHandler/ExceptionHandlerMiddleware.cs#L79My use case is that I want to have different behaviors for exceptions depending on context like the URL, such as returning a JSON response for a failed API request while returning an HTML response for a failed user page request. I also want to use errorHandlingPath behavior on one of the exception handlers so I can have the HTML scenario handled by an MVC controller. Here's what my code relatively looks like:```// these are effectively try-catches so define them in reverse orderapp.UseExceptionHandler("/Home/Error");app.UseExceptionHandler(handler =>{    handler.Run(async context =>    {        var exception = context.Features.Get<IExceptionHandlerFeature>().Error;        if (context.Request.Path.StartsWithSegments("/api"))        {            context.Response.ContentType = "application/json";            var response = new            {                Error = exception.Message            };            await context.Response.WriteAsync(JsonConvert.SerializeObject(response));        }        else        {            // lose the stack trace, otherwise you could rewrap it in another exception            throw exception;        }    });});```The current solution I can come up with involves either throwing the exception stored in the Error property and losing the stack trace of the original exception, or wrapping the exception into another one and making sure that's handled properly across the other exception handlers.It would be nice to be able to say in an exception handler that the exception was not handled and to keep going up the chain until it is handled. Alternatively I would be happy with a way of combining the 2 handlers in my example into 1 handler if it's simple enough._Copied from original issue: aspnet/Diagnostics#248_
2591	area-mvc	Passing more than Status Code to the Error action	_From @Ciantic on Thursday, July 14, 2016 4:19:35 AM_Currently there is a problem with the way JSON error results are handled e.g.: https://github.com/aspnet/Security/issues/872 and https://github.com/aspnet/Security/issues/699 there is no easy way to pass more than status code to your Error action that shows the error page or JSON result.Sometimes it would be nice to have a reason in the result e.g. "Insufficient rights, because you are not an employee" or in JSON `{ "error" : "FORBIDDEN", "requires" : ["EmployeeOnly"] }` to show a dialog why you are forbidden to see the page. But since only thing the error handler gets is the status code it can't determine the extra requirement, claim in this case.Imagine the situation that you have this:``` C#services.AddAuthorization(opts => {    // ...    opts.AddPolicy("EmployeeOnly", policy => {        policy.AddAuthenticationSchemes(JwtBearerDefaults.AuthenticationScheme);        policy.RequireClaim("EmployeeNumber");    });});```Then this as a Error handler for status code pages:``` C#[HttpGet("/Error"), HttpPost("/Error")]public IActionResult Error([FromQuery] int status = 400){    if (HttpContext.Request.Headers.ContainsKey("Accept") &&         HttpContext.Request.Headers["Accept"].Contains("application/json"))    {         if (status == 403) {             // PROBLEM: There is no way to get the failing reason (e.g. claim "EmployeeOnly") here?             return new JsonResult(new { error = "FORBIDDEN" });        }        else        {            return new JsonResult(new { error = "UNDEFINED_ERROR" });        }    }    // HTML Version if you wish ...}```_Copied from original issue: aspnet/Diagnostics#316_
2590	area-mvc	DeveloperExceptionPageMiddleware always returns HTML, sometimes JSON would be better	_From @tjrobinson on Friday, February 3, 2017 3:54:20 AM_We're using the DeveloperExceptionPageMiddleware and it would be really useful if it could be changed/configured so that AJAX requests to APIs, e.g. from an Angular application were given a JSON response back instead of HTML. This would make the response much more readable when using F12 tools or testing the API through other non-browser tools like Postman.I hope that's enough information to make sense, let me know if not.There's a similar problem discussed here: http://stackoverflow.com/questions/35245893/mvc-6-webapi-returning-html-error-page-instead-of-json-version-of-exception-objeThanks!_Copied from original issue: aspnet/Diagnostics#346_
2589	area-mvc	Define handlers for status codes with UseStatusCodePages	_From @jchannon on Wednesday, April 12, 2017 4:17:48 AM_In Nancy you can implement a `IStatusCodeHandler` which has CanHandle and a Handle methods. CanHandle returns a boolean that says for this statuscode I can handle it and then in the Handle it writes a response.In UseStatusCodePages it seems to be a global filter for status codes. How do I say only execute `x` when the statuscode is `y`. Only examples I have seen is to write a Controller method that has a switch statement on the statuscode and that is very ugly. Is there a cleaner way of doing it? If not could we make it cleaner?_Copied from original issue: aspnet/Diagnostics#357_
2586	area-mvc	DeveloperExceptionPage should include routing details	_From @miloush on Sunday, August 6, 2017 12:05:38 PM_If applicable, the exception page should have a tab with current route name, controller, action and routing values._Copied from original issue: aspnet/Diagnostics#403_
2577	area-mvc	Consider adding timeout on HealthCheck	_From @ycrumeyrolle on Friday, October 27, 2017 2:05:58 PM_Adding a timeout on each healthcheck will avoid a non-responding external resource to cause some problems._Copied from original issue: aspnet/Diagnostics#418_
2573	area-mvc	Provide in-the-box handling for page vs. API errors	_From @breyed on Saturday, December 23, 2017 8:47:37 AM_Currently, a fair amount of configuration is required to report errors in a native format for pages vs. web API. It would be nice to have the following features:* A way to tell MVC what routes go to pages vs. APIs.* Automatic response of HTML error pages for page routes, and empty-or-JSON bodies for API routes.* Inclusion of status codes from exceptions in API responses (avoids the need to always use IActionResult, which minimizes friction in unit testing web API methods).* Automatic suppression of authentication redirects for API routes.Currently, I provide these features [like this](https://stackoverflow.com/a/47953833/145173) (and [like this](https://stackoverflow.com/a/42030138/145173) for redirects, but it seems like something that would be quite useful to have baked in from the start._Copied from original issue: aspnet/Diagnostics#427_
2458	area-middleware	Support serving of pre-GZIP encoded files	_From @DamianEdwards on Friday, July 25, 2014 11:42:51 AM_Pre-GZIPping files is seemingly becoming more popular. This involves running a tool ahead of deployment that creates GZIPped copies of suitable files in the site, e.g. site.js => site.js.gzip. Then the file serving aspect of the web server will serve the GZIPped file when appropriate._Copied from original issue: aspnet/StaticFiles#7_
2457	area-middleware	Need a way to handle authorization for static files	_From @danroth27 on Thursday, September 24, 2015 11:18:42 AM_In ASP.NET 4.6 you can use the Authorization module to handle authorization for static file requests. We need some what to handle authorization for static files in ASP.NET 5.@blowdart_Copied from original issue: aspnet/StaticFiles#70_
2456	area-middleware	Add event for customizing file selection	_From @Tratcher on Tuesday, February 16, 2016 9:01:28 AM_Add an event at the beginning of the static file middleware when the request first arrives that would let you map any path to any file, and pick the content-type. Then the middleware could process that file normally (e-tags, if-modified-since, range, etc..)._Copied from original issue: aspnet/StaticFiles#111_
2455	area-middleware	Option to look for default files at the root of wwwroot path only, not at subpath	_From @NickAb on Sunday, February 28, 2016 6:26:46 AM_`DefaultFiles` middleware allows routing to default files at request subpath if no file was found, but for angular or other single page apps we would need to always route to `/wwwroot/index.html` for any subpath, i.e.:- `http://localhost:5000/` -> `wwwroot/index.html`- `http://localhost:5000/some-sub-path` -> `wwwroot/index.html`Currently we have to write custom middleware to handle this case (see [stackoverflow](http://stackoverflow.com/questions/34628536/asp-net-5-angular-2-routing-template-page-not-reloading/34643314) for example). But it seems that adding option to `DefaultFiles` to route to `wwwroot` will be a good solution for such a common case.https://github.com/aspnet/StaticFiles/blob/dev/src/Microsoft.AspNetCore.StaticFiles/DefaultFilesMiddleware.cs#L67_Copied from original issue: aspnet/StaticFiles#115_
2454	area-middleware	Review FileExtensionContentTypeProvider and document the criteria for being included	_From @Tratcher on Wednesday, April 27, 2016 11:44:38 AM_`FileExtensionContentTypeProvider` contains the file extension to content-type mappings used by the `StaticFilesMiddleware`. Only extensions listed will be served by default. The original list was copied from IIS but we've made some additions.- [ ] Review the APIs and make sure it's easy enough for people to add and remove entries.- [ ] Document the criteria for including an entry in the default list.- [ ] Review the current entries to make sure they meet the criteria.@DamianEdwards _Copied from original issue: aspnet/StaticFiles#129_
2453	area-middleware	Remove etags from StaticFiles	_From @muratg on Tuesday, September 27, 2016 4:27:07 PM__Copied from original issue: aspnet/StaticFiles#159_
2449	area-middleware	Add option to disable appending trailing slashes	_From @shravan2x on Wednesday, April 12, 2017 5:59:59 PM_As per the title, I propose a new `AppendTrailingSlash` option.The docs at https://docs.microsoft.com/en-us/aspnet/core/fundamentals/static-files currently state that `UseDefaultFiles and UseDirectoryBrowser will take the url http://<app>/StaticFiles without the trailing slash and cause a client side redirect to http://<app>/StaticFiles/ (adding the trailing slash). Without the trailing slash relative URLs within the documents would be incorrect.`However, this is not always true. For example, consider a file that has all its links as absolute. In this case, the file would work correctly even without a trailing slash.Many sites like https://stackoverflow.com and https://github.com make trailing slashes optional. In a similar interest, `StaticFiles` should allow users to do this. Disabling trailing slashes for MVC and being forced to use them by `StaticFiles` only causes confusion as to which links send 301s for this.Users who wish to make trailing slashes optional across their entire website could potentially use this option in conjunction with some other `AbsoluteLinkConverterMiddleware`._Copied from original issue: aspnet/StaticFiles#187_
2448	area-middleware	Headers configuration file	_From @sebastienros on Tuesday, April 25, 2017 6:09:52 PM_Like it was done in System.Web I'd like to be able to set default headers like `max-age` per folder.The first thing I want to do when serving static file is define this header.An implementation could look for a specific file in the folder the file is served, using the same `FileProvider` as the options. This can already be done using code by altering the `Response` but configuration is better in this case IMO._Copied from original issue: aspnet/StaticFiles#188_
2446	area-middleware	After updating ( 1.1 to 2.0 )  the StaticFiles can't be found in the root path.	_From @Eilon on Wednesday, August 16, 2017 9:37:05 AM__From @NMSLanX on August 16, 2017 7:59_## Question:1、            project:    webapi core1.1         nuget:     Microsoft.AspNetCore.StaticFiles         file:          wwwroot/Index.html         ok:          "http://xxxxx/Index.html" return "hello world"        operation: **right-click "Controller Folder" --> "Add(D)" --> "controller(T)" --> select any and "Add".**        error:       "http://xxxxx/Index.html" return "http://xxxxx/Index.html/".2、           project:   webapi core 1.1         nuget:     Microsoft.AspNetCore.StaticFiles         file:          wwwroot/Index.html         ok:          "http://xxxxx/Index.html" return "hello world"          operation: **update to core2.0**         error:       "http://xxxxx/Index.html" return "http://xxxxx/Index.html/"._Copied from original issue: aspnet/Mvc#6665__Copied from original issue: aspnet/StaticFiles#210_
2445	area-middleware	Make Etag generation replaceable	_From @Tratcher on Tuesday, August 22, 2017 9:35:44 PM_https://github.com/aspnet/AspNetKatana/pull/71_Copied from original issue: aspnet/StaticFiles#212_
2444	area-middleware	How to use pregzipped js files in angular	_From @akashshelke22 on Thursday, October 5, 2017 5:35:17 AM_I have an angular application. I am using webpack and commonjs. i have minified all js files. Now i have **vendor.js**(angular lib file) of size 888 kb and **vendor.js.gz** 195 kb. But i don't know how to use this **vendor.js.gz** file. I also tried to enable compression from iis but no luck. It shows me 'transferred- encoding': chunked in response header instead of 'content-encoding': gzip.So, please help me if anyone knows gzip implementation_Copied from original issue: aspnet/StaticFiles#216_
2442	area-middleware	Add support for .webmanifest file extension	_From @madskristensen on Friday, October 27, 2017 3:57:16 PM_This is used in Progressive Web Apps (PWAs) for the manifest JSON file. The content type should be `application/manifest+json`_Copied from original issue: aspnet/StaticFiles#219_
2439	area-middleware	StaticFileContext.SendAsync doesn't catch TaskCanceledException.	_From @SergeySomkov on Saturday, November 11, 2017 3:05:57 AM_After client aborts http request, StreamCopyOperation.CopyToAsync throws TaskCanceledException.```System.Threading.Tasks.TaskCanceledException: A task was canceled.   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.Http.Extensions.StreamCopyOperation.<CopyToAsync>d__2.MoveNext()--- End of stack trace from previous location where exception was thrown ---   at System.Runtime.ExceptionServices.ExceptionDispatchInfo.Throw()   at System.Runtime.CompilerServices.TaskAwaiter.ThrowForNonSuccess(Task task)   at System.Runtime.CompilerServices.TaskAwaiter.HandleNonSuccessAndDebuggerNotification(Task task)   at Microsoft.AspNetCore.StaticFiles.StaticFileContext.<SendAsync>d__46.MoveNext()```The exception is not handled inside StaticFileContext.SendAsync. It is handled by Kestrel and it logs the following event:- Connection id "{ConnectionId}": An unhandled exception was thrown by the application.- LogLevel: Error- Category: Microsoft.AspNetCore.Server.Kestrel- EventId: 13I'm wondering how is it even possible since StaticFileContext.SendAsync contains the following code:```try{  using (var readStream = _fileInfo.CreateReadStream())  {    // Larger StreamCopyBufferSize is required because in case of FileStream readStream isn't going to be buffering    await StreamCopyOperation.CopyToAsync(readStream, _response.Body, _length, StreamCopyBufferSize, _context.RequestAborted);  }}catch (OperationCanceledException ex){  _logger.LogWriteCancelled(ex);  // Don't throw this exception, it's most likely caused by the client disconnecting.  // However, if it was cancelled for any other reason we need to prevent empty responses.  _context.Abort();}```_Copied from original issue: aspnet/StaticFiles#222_
2438	area-middleware	Extensionless files are not served by default	_From @sebastienros on Tuesday, November 14, 2017 6:16:05 PM_Because it's missing an entry in the default `IContentTypeProvider`Some files like `acme-challenge` (used by Let's Encrypt) or Apple application ids, don't use extensions.I'd like to know if it could be reconsidered. _Copied from original issue: aspnet/StaticFiles#223_
2437	area-mvc	Security model for JsonPatch support	_From @rynowak on Monday, September 21, 2015 11:28:16 AM__From @danroth27 on March 19, 2015 17:13_Do we need to have a way to specify different security policy for different JsonPatch actions? _Copied from original issue: aspnet/Mvc#2206__Copied from original issue: aspnet/JsonPatch#2_
2436	area-mvc	Support for  Json Merge Patch - RFC7396	_From @adnan-kamili on Wednesday, January 4, 2017 10:22:13 PM_Hi,Are their any plans to support the Json Merge Patchhttps://tools.ietf.org/html/rfc7396_Copied from original issue: aspnet/JsonPatch#52_
2429	area-mvc	ExpandoObjectAdapter doesn't play well with JObjects	_From @NicolaasVB on Thursday, September 21, 2017 4:59:13 AM_Consider following code snippet (unit test)```C#            var list = new List<string>();            list.Add("[{ 'op': 'add', 'path': '/foo', 'value': {'bar': 'baz'}}]");            list.Add("[{ 'op': 'add', 'path': '/foo/bar', 'value': 'bazz' }]");            dynamic obj = new ExpandoObject(); //JObject.Parse("{}"); ???            foreach (var item in list)            {                var patchDocument = JsonConvert.DeserializeObject<JsonPatchDocument>(item);                patchDocument.ApplyTo(obj);                // without the 2 lines below, the second apply will fail, because in the first patch                // the value on the ExpandoObject is set to a JObject representing {"bar": "baz"}                // and ExpandoObjectAdapter can't handle that. It fails when attempting to cast target to IDictionary<string, object>                JObject intermediate = JObject.FromObject(obj);                // basically we convert the expandoObject to JObject and back, so that all the JObject values are converted to an ExpandoObject                obj = intermediate.ToObject<ExpandoObject>();            }            Assert.Equal("bazz", obj.foo.bar);```Unless we apply the 2 hacky lines (converting to JObject and back to ExpandoObject), this snippet will fail (crash even...). The reason for that is explained in comments in the snippet.Now, for my question... How I can solve my use case without the use of those 2 hacky lines of code? (we're implementing our take on event sourcing with json patch diffsets, and our replay mechanism applies the json patch documents one by one)Also on a sidenote, why doesn't a JObjectAdapter exist? I mean we're applying JSON patch documents... It would only seem logical that you can apply them to a JObject :-)_Copied from original issue: aspnet/JsonPatch#109_
2427	area-mvc	Patching of readonly collections fails	_From @MovGP0 on Wednesday, October 25, 2017 2:38:39 AM_Given I have an Entity with an readonly collection like this: ```csharppublic sealed class MyEntity {    public MyEntity()    {    }    [JsonConstructor]    public MyEntity(IEnumerable<string> tags)    {        Tags = tags?.ToList() ?? new List<string>();    }    [JsonProperty("tags")]    public ICollection<string> Tags { get; } = new List<string>();}```Than it is not possible to patch it, besides the property beeing potentially writeable and also serializeable. _Copied from original issue: aspnet/JsonPatch#118_
2421	area-mvc	Add optional token expiry	_From @blowdart on Thursday, January 21, 2016 12:30:27 PM_Office would like this. You can do it by using a time limited data protection payload.https://docs.asp.net/en/latest/security/data-protection/consumer-apis/limited-lifetime-payloads.html_Copied from original issue: aspnet/Antiforgery#36_
2420	area-mvc	Should AntiForgery use ITlsTokenBindingFeature for DataProtection?	_From @Tratcher on Monday, April 11, 2016 2:56:45 PM_See https://github.com/aspnet/Security/issues/773https://github.com/aspnet/Antiforgery/blob/0c81df859145801d2846ccbdc9af5830fa791f63/src/Microsoft.AspNetCore.Antiforgery/Internal/DefaultAntiforgeryTokenSerializer.cs#L55Only apply it if AntiforgeryOptions.RequreSsl is true._Copied from original issue: aspnet/Antiforgery#76_
2418	area-mvc	Remove obsolete options APIs	_From @natemcmaster on Monday, July 3, 2017 11:56:58 AM_Follow-up to https://github.com/aspnet/Antiforgery/pull/148Remove the following obsoleted APIs```AntiforgeryOptions  .CookieName  .CookieDomain   .CookiePath   .RequireSsl```_Copied from original issue: aspnet/Antiforgery#149_
2407	area-middleware	Support generic version of Get[Type] & Set[Type] in ISessionCollection	_From @hishamco on Saturday, February 28, 2015 1:34:41 PM_There are many cases the require using more than Int & String, It will be nice if there's a generic version of getting and setting Session objects. I hope to see something like```context.Session.Get<bool>("isLoggedIn") ```_Copied from original issue: aspnet/Session#3_
2406	area-middleware	Bind the cookie to ITlsTokenBindingFeature	_From @Tratcher on Friday, April 29, 2016 1:19:33 PM_If the cookie is marked as Secure (https://github.com/aspnet/Session/issues/106), bind it to the TLS token (https://github.com/aspnet/Security/issues/773, https://github.com/aspnet/IISIntegration/issues/31)_Copied from original issue: aspnet/Session#110_
2405	area-middleware	SessionSample improvements	_From @Rick-Anderson on Monday, October 10, 2016 11:55:15 PM_[samples/SessionSample/Startup.cs](https://github.com/aspnet/Session/blob/dev/samples/SessionSample/Startup.cs#L24)- [x] Consider removing the SQL connection string. We want to avoid copy/paste and this encourages checking in secrets. At least change the name from `ASPNET5SessionState` to something like `SessionStateCache`- [ ] add a comment with a fwlink to https://docs.asp.net/en/latest/performance/caching/distributed.html_Copied from original issue: aspnet/Session#130_
2404	area-middleware	Spurious log messages	_From @mguinness on Thursday, April 13, 2017 10:10:16 AM_I'm using session storage in my app primarily for TempData, but I'm noticing several "Accessing expired session" warnings in my logs which is being generated in [LoggingExtensions](https://github.com/aspnet/Session/blob/dev/src/Microsoft.AspNetCore.Session/LoggingExtensions.cs#L26-L27).It seems that the message is somewhat misleading.  Would something like "Expired session unavailable" be better than "Accessing expired session"?  The latter seems contradictory.  Also, why would this be a warning and not a debug message?  It seems that this would increase noise to signal for logs filtered to warning._Copied from original issue: aspnet/Session#160_
2402	area-middleware	Replace UseSession(SessionOptions) with UseSession(Action<SessionOptions>)	_From @HaoK on Thursday, June 29, 2017 6:47:53 PM_Since the session middleware is using IOptions, we should mirror how we normally configure options...  It should instead always use IOptions and apply the action to it afterwards (basically a PostPostConfigureOptions)We should revisit any other middleware that are using this pattern and using IOptions`UseSession(new SessionOptions())` => `UseSession(o => { })`_Copied from original issue: aspnet/Session#174_
2400	area-middleware	Add logging scope for session	_From @davidfowl on Wednesday, July 12, 2017 11:23:57 AM_The session middleware should create a scope with the session id so that it's possible correlate session across multiple requests for logs._Copied from original issue: aspnet/Session#181_
2398	area-middleware	Any plans for maximum session size property?	_From @wysisoft on Tuesday, August 22, 2017 9:44:08 PM_Are there any plans for a property that sets a maximum size for total user session, and throws an exception if its exceeded? Any recommendations on how I can simply accomplish this? (currently using redis distributed cache)_Copied from original issue: aspnet/Session#185_
2396	area-middleware	Add EventSource/EventCounter tracing and metrics for Session	_From @anurse on Wednesday, November 1, 2017 3:22:31 PM_Some events listed below. The goal is to add events that will help users solve problems so if these aren't going to do that job, feel free to suggest/discuss others!* `Microsoft-AspNetCore-Session` EventSource    * `SessionsCreated` - Counts sessions created    * `SessionsLoaded` - Counts the number of times a session is loaded from the provider (this happens on each request for a session)    * `SessionsCommitted` - Counts the number of times a session is commited to the provider (again, happens on each request)    * We can't track abandoned or timed-out sessions any more as they are handled by caching now and we don't provide a way to explicitly abandon a session. We could detect "empty" sessions (with no data) but such a session could always be added to again later.See https://gist.github.com/anurse/af1859663ac91c6cf69c820cebe92303 for some guidance on adding EventSources and EventCounters to ASP.NET projects._Copied from original issue: aspnet/Session#200_
2395	area-middleware	Session does not work with Redis when the client has HTTP keep-alives disabled	_From @tcuk on Thursday, November 30, 2017 8:11:17 AM_Session state does not persist in Redis when the client has HTTP keep-alives *disabled* (i.e. rather than specifying HTTP header *connection: keep-alive*, the client specifies *connection: close*).OS: Ubuntu 16.04 LTSASP.NET Core version: 2.0.3Startup used to configure session:```using System;using System.Net;using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.Extensions.DependencyInjection;using Microsoft.Extensions.Configuration;namespace Woo.Website{	public class Startup	{		public Startup(IHostingEnvironment env)		{			string hostname = Dns.GetHostName();			var builder = new ConfigurationBuilder()				.SetBasePath(env.ContentRootPath)				.AddJsonFile("appsettings.json")				.AddEnvironmentVariables();			Configuration = builder.Build();			HostingEnvironment = env;		}		public IConfigurationRoot Configuration { get; set; }		public IHostingEnvironment HostingEnvironment { get; set; }		public void ConfigureServices(IServiceCollection services)		{			services.AddMvc();			services.AddDistributedRedisCache(options =>			{				options.Configuration = Configuration["redis:server"] + ":" + Configuration["redis:port"];				options.InstanceName = Configuration["redis:instance"];			});						services.AddSession();		}		public void Configure(IApplicationBuilder app, IHostingEnvironment env)		{			app.UseDeveloperExceptionPage();			app.UseForwardedHeaders();			app.UseSession();			app.UseMvc();		}	}}```I discovered this when using nginx as a reverse proxy to Kestral. Using nginx as a reverse proxy it is easy to enable/disable HTTP keep-alives to reproduce the problem. My proxy config for nginx is:server {	listen 80;		gzip on;	gzip_proxied	no-cache no-store private expired auth;	gzip_types		text/plain		text/css		text/js		text/xml		text/javascript		application/javascript		application/x-javascript		application/json		application/xml		application/rss+xml		image/svg+xml;	gzip_disable "MSIE [1-6]\.";	gzip_vary on;	location / {		proxy_pass			http://aspnet_server;		proxy_redirect		off;		proxy_http_version	1.1;		proxy_buffering		off;		proxy_cache_bypass	$http_upgrade;		proxy_set_header	Upgrade $http_upgrade;		proxy_set_header	Connection keep-alive;		proxy_set_header	Upgrade $http_upgrade;		proxy_set_header	Host $host;		proxy_set_header	X-Real-IP $remote_addr;		proxy_set_header	X-Forwarded-For $proxy_add_x_forwarded_for;		proxy_set_header	X-Forwarded-Host $server_name;		proxy_set_header	X-Forwarded-Proto $scheme;	}	location ~ /.well-known {		alias /etc/letsencrypt/html/.well-known/$1;		allow all;	}	rewrite ^/(.*)/$ /$1 permanent;}Changing the line *proxy_set_header Connection keep-alive* to *proxy_set_header Connection close* disables keep-alives and session state stops working.I was using the latest nginx package for Ubuntu 16.04 LTS and ASP.NET Core 2.0.3 on Ubuntu 16.04 LTS. These instances were run as containers within docker._Copied from original issue: aspnet/Session#201_
2394	area-middleware	Session cannot be re-loaded	_From @bobuhito on Tuesday, December 5, 2017 11:55:42 PM_When I have two concurrent requests to my site from the same session, the session keys/valuesare not updated until the server responses are fully sent.  One request therefore can not use theother request's session key/value updates in a timely manner.  In my case, I usually have to reloadthe site.Is there any reason you don't update the session keys/values in real-time (so the second connectioncould see them right away, even though the first connection is still getting service)?  I'm guessingthis is a remnant of locking and might give the second connection more stability if it tries to reada session value just as the first connection is writing it.  Anyway, it would be nice to have an optionto allow faster communication between requests from the same session._Copied from original issue: aspnet/Session#203_
2357	area-mvc	[Feature request] Make it able to pass custom ClaimsPrincipal when using TestServer	_From @kasparkallas on Thursday, May 18, 2017 3:26:49 AM__[Use case]_ In my application, I want to test the combination of authorization policies against concrete endpoints with specific users and domain state.To my knowledge, when using authorization attributes, the "best" way to currently test is to check for existence of attributes through reflection and unit-test the components separately. With `HttpContext` and all sorts of other contexts, base classes etc the unit-tests are not that clear to follow and not easy to write. I would much rather fire up a `TestServer`, create a dummy `ClaimsPrincipal `with a claim or two, and see if I get forbidden result or not against protected resources.Opinions?_Copied from original issue: aspnet/Testing#276_
2356	area-mvc	Create infrastructure for testing with docker	_From @natemcmaster on Tuesday, June 6, 2017 10:18:11 AM_Requirements: - I should be able to write a functional test that runs .NET Core inside a Docker container - I should not have to manually manage the image tag or versions to ensure .NET Core runtime inside the container aligns with current KoreBuild versions - I should be able to assert the output of code executed from within a container, either via logs or exit code - I should be able to docker options, such as exposed ports, data volumes, etc.Example: I need a way to verify the behavior added in aspnet/DataProtection#244_Copied from original issue: aspnet/Testing#277_
2324	area-servers	Move various parsers/formatters into HttpAbstractions	_From @davidfowl on Saturday, August 19, 2017 2:37:24 PM_In our continued effort to provide generally useful abstractions for the greater ecosystem, we should move the low level parsers and formatters into Microsoft.AspNetCore.WebUtilities.HTTP Parser from Kestrel - https://github.com/aspnet/KestrelHttpServer/blob/59b77bb357f50946ecea310feb8db53473e0e165/src/Kestrel.Core/Internal/Http/HttpParser.csThe chunked encoding parser from Kestrel - https://github.com/aspnet/KestrelHttpServer/blob/59b77bb357f50946ecea310feb8db53473e0e165/src/Kestrel.Core/Internal/Http/MessageBody.cs#L475HPackEncoder and HpackDecoder - https://github.com/aspnet/KestrelHttpServer/blob/59b77bb357f50946ecea310feb8db53473e0e165/src/Kestrel.Core/Internal/Http2/HPack/HPackDecoder.cshttps://github.com/aspnet/KestrelHttpServer/blob/59b77bb357f50946ecea310feb8db53473e0e165/src/Kestrel.Core/Internal/Http2/HPack/HPackEncoder.cs_Copied from original issue: aspnet/HttpAbstractions#916_
5759	area-identity	Changing the primary key of IdentityUserClaim<> and IdentityRoleClaim<>	Well, I have updated everything necessary to change all the Identity tables' primary keys to be `Guid`s, but I couldn't find any way to change the primary keys' types for `IdentityUserClaim<>` and `IdentityRoleClaim<>` tables. I have added this line in `ApplicationUser.cs`    public virtual ICollection<IdentityUserClaim<Guid>> Claims { get; } = new List<IdentityUserClaim<Guid>>();There should be some way to change the default primary keys (`int`s) for `IdentityUserClaim<>` and `IdentityRoleClaim<>`?. Or am I missing something?Perhaps something like `IdentityUserClaim<TKey, TUserKey>` instead of `IdentityUserClaim<TKey>` (the name **TKey** is misleading as well unless one looks at the summary, IMHO)?
4763	area-servers	Add functional tests for http2	There are not currently any functional test for the Http2 features. We accidentally disabled the entire feature when merging the https and core packages due to a missing TFM and didn't notice. https://github.com/aspnet/KestrelHttpServer/pull/2224The big blocker here is the lack of consistent client support. However, even if there's one client on one of the OS's then that would be a good start.
4867	area-mvc	RemoteAttribute and multiple submit buttons don't work together	I have a ViewModel with a Property which uses a RemoteAttribute```public class MyViewModel{  ...  [Remote(action: "MyValidationAction", controller: "MyController")]  public string MyProperty{ get; set; } }```My form in the View have beside MyProperty multiple submit buttons.```<form asp-action="DefaultAction" >  <input asp-for="MyProperty"  />  <input type="submit" value="DoDefault" />  <input type="submit" value="DoSomethingElse" asp-action="OtherAction" /></form>```When I click on the DoSomethingElse-Button the path goes to the DefaultAction instead the OtherAction.The RemoteProperty itself works fine. The DoSomethingElse-Button works fine if I remove the RemoteAttribute from the myProperty.
5041	area-mvc	seal the RestrictChildrenAttribute attribute	This results in a lot of non-supported scenario requests, so we should close the gap by marking the class as sealed.
5040	area-mvc	Add API to RazorSourceLineCollection to enable better understanding of lines in a RazorSourceDocument	Today the `RazorSourceLineCollection` has too minimal of an API to get enough information about a source document. For instance, you can't go from line Index => line content; this is primarily driven by not being able to get the start position of a given line index.Tried using this API to improve on our indentation facts service but it didn't have enough information.
4865	area-mvc	Supporting open generic models in Views	**The story:**The idea came to my mind when summarizing multiple views using partials. I thought it would be great if we could define partial views with open generic models.I thought at first to post the idea in ASP.NET uservoice website. When I searched there, I noticed the same idea was suggested a few years ago [https://aspnet.uservoice.com/forums/41201-asp-net-mvc/suggestions/2706166-support-for-generics-in-razor-view](https://aspnet.uservoice.com/forums/41201-asp-net-mvc/suggestions/2706166-support-for-generics-in-razor-view).There, @danroth27 had directed users to a new track ( #727 ) in ASP.NET github and asked users to comment practical examples/use cases of the suggestion.After visiting the issue, I noticed that it was closed, because nobody had given any comment. I didn't know if someone was still allowed to comment on a closed issue or not, but I dared to try it.I was happy to see @Eilon's quick reply some hours later still welcoming use cases for this idea.As the scenario I wanted to mention was a little long, he recommended me to post it as new issue.So, here am I.The scenario involves multiple pieces of code fragments (C#, Razor views), but I do my best to make it short and only mention the meat.
4764	area-servers	Allow Unix Sockets on Windows	😮 https://blogs.msdn.microsoft.com/commandline/2017/12/19/af_unix-comes-to-windows/
6003	area-middleware	Regex Timeout are too short, not consistent, and not configurable in RewriteMiddleware	Regex timeouts that are used across [UrlRewrite](https://github.com/aspnet/BasicMiddleware/blob/dev/src/Microsoft.AspNetCore.Rewrite/Internal/IISUrlRewrite/UrlRewriteRuleBuilder.cs#L13), ApacheModRewrite, and [code rules](https://github.com/aspnet/BasicMiddleware/blob/03b63e2c2a5ec27deef4be692ff2119188b67d73/src/Microsoft.AspNetCore.Rewrite/Internal/RewriteRule.cs) are not consistent. The are set at 1 second or 1 millisecond in different places. Secondly, 1 millisecond is too short for a regex expression; it should be 1 second as the timeout is mostly for making sure your server isn't locked. Also if the expression timeouts, it returns a 500 server error as the exception is unhandled. Thirdly, the timeout should be configurable in RewriteOptions. Plan of action:- Timeouts should be increased to 1 second across the board.- For 2.1, we should make Regex timeouts configurable a- The timeouts should be backported to 2.0 and 1.1@Eilon @muratg this is a patch candidate. Workarounds are very difficult. 
4864	area-mvc	LocalRedirectExecutor should redirect to a well known endpoint instead of throwing when the URL is not local	Right now LocalRedirectResult throws when the URL given to it is not local. This is not ideal as it ends up becoming a 500 and its not useful for many applications.It would be better if instead, it redirected the user to a well known local endpoint (like ~/) by convention or by giving the user the ability to specify it on a per result basis or globally.
4863	area-mvc	Partial views path is incorectly resolved in ViewComponent	_From @PavelBansky on November 19, 2017 23:13_I have a ViewComponent called PagerViewComponent with corresponding View(s) stored in the `Views/Shared/Components/Pager`The content of the directory is this:```/Views  /Shared    /Components      /Pager        _Pager.cshtml        Default.cshtml        Search.cshtml```Content of `Default.cshtml` is this```csharp@model MyApp.ViewModel.PagedResultBase@Html.Partial("_Pager", Model)```It all ends with runtime exception:```An unhandled exception occurred while processing the request.InvalidOperationException: The partial view '_Pager' was not found. The following locations were searched:/Views/Blog/_Pager.cshtml/Views/Shared/_Pager.cshtmlMicrosoft.AspNetCore.Mvc.ViewFeatures.HtmlHelper+<RenderPartialCoreAsync>d__60.MoveNext()```**Razor would not look to resolve the partial view inside the ViewComponent directory** `Views/Shared/Components/Pager`When I move the `_Pager.cshtml` into `Views/Shared` directory it all works..OS: Windows 10 x64.Net Core: 2.0Microsoft.AspNetCore.All Version="2.0.0" Microsoft.VisualStudio.Web.CodeGeneration.Tools Version="2.0.0" _Copied from original issue: aspnet/Razor#1779_
4663	area-security	Add support for X509 client certificate "authentication"	It's important for a number of enterprise and financial API / OAuth scenarios.@blowdart already has 85% of it done - please include that in ASP.NET itself.
4862	area-mvc	Rewrite AuthorizeFilter in 3.0	This class has accumulated some battle scars from some of the implementation choices that have been made and changed. When we're able to do breaking changes we should start fresh and implement this in a clean way.
5039	area-mvc	Re-think some of the core concept of the RazorSyntaxTree	Points of concern here are:- [ ] Removing chunk generators. Today they're only used as markers to generate IR.- [ ] Re-think how edit handlers work.- [ ] Change provisional parsing to be represented in the SyntaxTree. Instead of changing the meaning of provisional items in the SyntaxTree we should represent those items as having dual states (markup or code depending on the interaction).
5038	area-mvc	Change BackgroundParser to not be stateful and not spin up threads.	I imagine this being a way for a user to await a parse. Aka `await FooBGParser.DoAParseOrSomething()`
5037	area-mvc	Re-discover TagHelpers when dependent project builds	In Tooling if you have the following structure:```WebApp- Index.cshtmlTestLib- TestTagHelper.cs```And `WebApp` depends on `TestLib`. When you build TestLib after changing `TestTagHelper` the available TagHelpers in `Index.cshtml` aren't refreshed.In order to get refreshed TagHelpers you must build `WebApp` directly.
4765	area-servers	Read additional KestrelServerOptions from config	The new configuration APIs will read endpoints with their certificates and the default certificate. https://github.com/aspnet/KestrelHttpServer/pull/2186Here are other KestrelServerOptions to consider reading from config (Unsorted):- bool AddServerHeader- SchedulingMode ApplicationSchedulingMode - KestrelServerLimits Limits   - long? MaxResponseBufferSize  - long? MaxRequestBufferSize  - int MaxRequestLineSize  - int MaxRequestHeadersTotalSize  - int MaxRequestHeaderCount  - long? MaxRequestBodySize  - TimeSpan KeepAliveTimeout  - TimeSpan RequestHeadersTimeout  - long? MaxConcurrentConnections  - long? MaxConcurrentUpgradedConnections  - MinDataRate MinRequestBodyDataRate  - MinDataRate MinResponseDataRate- Per Endpoint ListenOptions   - bool NoDelay  - ~~HttpProtocols Protocols~~ https://github.com/aspnet/AspNetCore/commit/f38f60f8cefe45bd4078b25773becc105b8c7bbc- Per Https Endpoint HttpsConnectionAdapterOptions  - ClientCertificateMode ClientCertificateMode  - SslProtocols SslProtocols  - bool CheckCertificateRevocation  - TimeSpan HandshakeTimeoutToday these must all be set in code in parallel to the configuration.
5036	area-mvc	Local functions break parsing if followed by html tags	I'm using VS 15.5.1**Steps to reproduce**:1. Create default ASP.NET MVC project using VS2. Change C# language version in web.config to 73. Modify about.cshtml to the following:```@{  ViewBag.Title = "About";  void Local() { WriteLiteral("<strong>Foo</strong>"); }  <strong>Bar</strong>  Local();}<h2>@ViewBag.Title.</h2><h3>@ViewBag.Message</h3><p>Use this area to provide additional information.</p>```4. Run the project. You'll get the following error:```Compilation ErrorDescription: An error occurred during the compilation of a resource required to service this request. Please review the following specific error details and modify your source code appropriately.Compiler Error Message: CS1525: Invalid expression term '<'Source Error:Line 2:    ViewBag.Title = "About";Line 3:  Line 4:    void Local() { WriteLiteral("<strong>Foo</strong>"); }Line 5:    <strong>Bar</strong>Line 6:    Local();Source File: ..\Views\Home\About.cshtml    Line: 4 ```5. Note that local functions which are not directly followed by html tags are parsed correctly and work as expected as you can check by moving the html tag below the local function invocation. I.e. the following code does not have any compilation errors:```@{  ViewBag.Title = "About";  void Local() { WriteLiteral("<strong>Foo</strong>"); }  Local();  <strong>Bar</strong>}<h2>@ViewBag.Title.</h2><h3>@ViewBag.Message</h3><p>Use this area to provide additional information.</p>```
4861	area-mvc	Add missing `IOrderedFilter` implementations	Be explicit about the execution order of our in-box filters. For example, `AuthorizeFilter` does not provide an `Order` but most others do (or their associated `IFilterFactory` implementation has an `Order`).Suggest giving most `IOrderedFilter.Order` properties a setter. Users shouldn't need to subclass the filter or its factory just to control execution order.Where the filter is not `sealed`, confirm adding the `Order` does not cause breaking changes. Might be worth implementing the interface explicitly (after confirming a subclass may implement the same interface explicitly without warnings).
5909	area-hosting	Provide a default Host header when it's missing/empty	RE: https://github.com/Microsoft/ApplicationInsights-aspnetcore/issues/278HTTP/1.0 requests do not provide Host headers, and HTTP/1.1 requests are required to provide it but it may be empty. This causes failures for components like loggers that want to describe the request with a Uri, or middleware that create absolute links like redirect-to-https. This is a protocol level problem that applies to supported servers.Proposal: Hosting can provide a default host setting (from config) and apply it whenever the host header is missing or empty. This would happen right when the request is received and before any diagnostics take place:https://github.com/aspnet/Hosting/blob/9f1e6607dd1b3d15bc6c42146629677c6b455fd0/src/Microsoft.AspNetCore.Hosting/Internal/HostingApplication.cs#L35-L37*Updated proposal*In the absence of config, inspect IServerAddresses for a url that matches the request scheme and port. The new Https redirect middleware does something similar:https://github.com/aspnet/BasicMiddleware/blob/dd038387285bf9fa8dc52910ef762b9843ff22e4/src/Microsoft.AspNetCore.HttpsPolicy/HttpsRedirectionMiddleware.cs#L122-L139Workarounds:- The same logic could be applied via middleware but it wouldn't help these early diagnostic code paths.- All consumers would need to be aware of the possibility of a missing host and provide some fallback logic. For loggers this isn't too bad, they could leave it out or substitute "unspecified", but redirect-to-https would have no default recourse.
4860	area-mvc	Storing Empty list in TempData cookies results in a Jarray object when read	I have code that may store an empty list object in the tempdata property of the controller.When using the default tempdata provider (cookies) after I redirect to the MVC action that consumes the data it will be read as a Jarray instead of the intended type List<String> 
4766	area-servers	.NET Core 2.0 Azure Web App. The specified CGI application encountered an error and the server terminated the process	My app works well locally but I've got an error when I deployed it on Azure Web App:`The specified CGI application encountered an error and the server terminated the process.`My app is a .NET Core 2.0 Web API with no wwwroot folder. It creates instance of X509Certificate2 from byte array, I am pretty sure it fails here. I need to dynamically manage X509Certificates - uploading certificate to Web App is not an option.I found this in [Microsoft Docs](https://docs.microsoft.com/en-us/azure/app-service/app-service-web-availability-performance-application-issues-faq):> A known issue with an earlier Kestrel version might cause an ASP.NET Core 1.0 app that's hosted in App Service to intermittently stop responding. You also might see this message: "The specified CGI Application encountered an error and the server terminated the process."> > This issue is fixed in Kestrel version 1.0.2. This version is included in the ASP.NET Core 1.0.3 update. To resolve this issue, make sure you update your app dependencies to use Kestrel 1.0.2. Alternatively, you can use one of two workarounds that are described in the blog post ASP.NET Core 1.0 slow perf issues in App Service web apps.I believe I use latest version of Kestrel dependencies from nuget package:`<PackageReference Include="Microsoft.AspNetCore.All" Version="2.0.0" />`I also tried to re-create Web App to make sure there is no junk left and I use everything latest. How can I fix it? Any ideas?[Stackoverflow question here](https://stackoverflow.com/questions/47621285/net-core-2-0-azure-web-app-the-specified-cgi-application-encountered-an-error)
4767	area-servers	RequestAborted should not be fired for disconnects after the request and response have completed	_From @tcuk on November 30, 2017 16:11_Session state does not persist in Redis when the client has HTTP keep-alives *disabled* (i.e. rather than specifying HTTP header *connection: keep-alive*, the client specifies *connection: close*).OS: Ubuntu 16.04 LTSASP.NET Core version: 2.0.3Startup used to configure session:```using System;using System.Net;using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.Extensions.DependencyInjection;using Microsoft.Extensions.Configuration;namespace Woo.Website{	public class Startup	{		public Startup(IHostingEnvironment env)		{			string hostname = Dns.GetHostName();			var builder = new ConfigurationBuilder()				.SetBasePath(env.ContentRootPath)				.AddJsonFile("appsettings.json")				.AddEnvironmentVariables();			Configuration = builder.Build();			HostingEnvironment = env;		}		public IConfigurationRoot Configuration { get; set; }		public IHostingEnvironment HostingEnvironment { get; set; }		public void ConfigureServices(IServiceCollection services)		{			services.AddMvc();			services.AddDistributedRedisCache(options =>			{				options.Configuration = Configuration["redis:server"] + ":" + Configuration["redis:port"];				options.InstanceName = Configuration["redis:instance"];			});						services.AddSession();		}		public void Configure(IApplicationBuilder app, IHostingEnvironment env)		{			app.UseDeveloperExceptionPage();			app.UseForwardedHeaders();			app.UseSession();			app.UseMvc();		}	}}```I discovered this when using nginx as a reverse proxy to Kestral. Using nginx as a reverse proxy it is easy to enable/disable HTTP keep-alives to reproduce the problem. My proxy config for nginx is:server {	listen 80;		gzip on;	gzip_proxied	no-cache no-store private expired auth;	gzip_types		text/plain		text/css		text/js		text/xml		text/javascript		application/javascript		application/x-javascript		application/json		application/xml		application/rss+xml		image/svg+xml;	gzip_disable "MSIE [1-6]\.";	gzip_vary on;	location / {		proxy_pass			http://aspnet_server;		proxy_redirect		off;		proxy_http_version	1.1;		proxy_buffering		off;		proxy_cache_bypass	$http_upgrade;		proxy_set_header	Upgrade $http_upgrade;		proxy_set_header	Connection keep-alive;		proxy_set_header	Upgrade $http_upgrade;		proxy_set_header	Host $host;		proxy_set_header	X-Real-IP $remote_addr;		proxy_set_header	X-Forwarded-For $proxy_add_x_forwarded_for;		proxy_set_header	X-Forwarded-Host $server_name;		proxy_set_header	X-Forwarded-Proto $scheme;	}	location ~ /.well-known {		alias /etc/letsencrypt/html/.well-known/$1;		allow all;	}	rewrite ^/(.*)/$ /$1 permanent;}Changing the line *proxy_set_header Connection keep-alive* to *proxy_set_header Connection close* disables keep-alives and session state stops working.I was using the latest nginx package for Ubuntu 16.04 LTS and ASP.NET Core 2.0.3 on Ubuntu 16.04 LTS. These instances were run as containers within docker._Copied from original issue: aspnet/Session#201_
4664	area-security	Revisit how authentication is registered/composed in Startup	Consolodated review of tentitive plans around startup changesRelated PRs: https://github.com/aspnet/Security/pull/1550https://github.com/aspnet/Identity/pull/1442```C#// Identity (use defaults cookies)services.AddIdentityCore<User>()   .AddEntityFrameworkStores<DbContext>();// use identity authentication defaultsservices.AddAuthentication(IdentityConstants.IdentityPolicy)    // adds sign in manager and adds the identity cookies   .AddIdentitySignIn<User>(); // Generic needed if not chained from AddIdentity``````C#// Using a single social auth provider (Open question where would this live?  Or add cookie dep to each?)// policy setting forward default to Cookieservices.AddAuthentication(CookieAuthenticationDefaults.AuthenticationScheme)      // Adds a google and cookie (if one doesn't exist), and sets challenge to google     .AddGoogleSignIn();      // One per auth scheme (Facebook, OAuth, OpenIdConnect, Twitter, MSA)```Thoughts? @Tratcher @davidfowl @DamianEdwards @ajcvickers     
5283	area-signalr	Terminate SignalR connections when the corresponding token expires	Originally asked in: https://github.com/aspnet/SignalR/issues/1155#issuecomment-347287019 
5758	area-identity	Enhancement: Provide more information in the result from the UserManager.Verify*TokenAsync() methods	Hi there,As an enhancement, I'd like to see more information returned from the Verify*Token methods on UserManager, such that richer information on failures can be recorded in metrics, or the flow updated to ease user interactions. Rather than returning a boolean true/false from UserManager.verifyUserToken(), I'd be interested in a richer object that's a pair of true/false + some sort of status string / error code / something to provide more details.I think there'll only be one token provider for any given call, so it shouldn't need to have multiple status strings returned (eg, if multiple providers needed to say 'no' in different ways)The sort of failure information we could see passed back would allow:- Being able to find out if the TOTP code is ahead/behind but nearly valid (user may need to be pushed to a flow to obtain multiple codes to handle authentication token resync)- An one-use token was valid but already been used (please ask for another or contact an admin to investigate if you didn't use it)- A time-limited token was valid but has timed out (ask for another token)And additionally we would start storing metrics on the above, so we can see if the time delay on tokens is too short; if there's something confusing in the flows, or if some odd spike of failures is indicating an attacker trying it on.For those providing public signups, exposing the exact details of the failure to the users may have a security impact, so I wouldn't make displaying information part of any templates.In a corporate environment, re-sending a expired code to a phone automatically (rather than require the user to re-start the password reset flow) could reduce the support load of these sorts of security features.Hopefully that makes sense,Michael
5174	area-mvc	IE11 works at the beginning with polyfills, but making an exception right after 45 seconds.	My enviroment simply, - VS2017 - core 2.0 - using spa template which VS supplies - dubuging mode (after deploying it to iis, it dosen't make an exception error.)I still have a problem with IE11, even though I followed the guidline as below link.I did install core-js 2.5.1, and import all the polyfills in this article.(https://github.com/aspnet/JavaScriptServices/wiki/Supporting-Internet-Explorer-11-(or-older))That sample program runs with the treat, however after 45 secs without any touching the web browser, it emit exceptions as below.![image](https://user-images.githubusercontent.com/23288784/33217175-3c2c4f9a-d17a-11e7-970e-e9bbc7d45027.png)Is there anyone who had same problem with me?I can't use any other ever-green browsers because of some policy.Thanks in advance.
4768	area-servers	Consider supporting unix domain sockets with SocketTransport	Seems like it's possible. https://github.com/dotnet/corefx/blob/958511d023231f120109967484fb63ae1837e6b8/src/System.IO.Pipes/src/System/Net/Sockets/UnixDomainSocketEndPoint.cshttps://github.com/dotnet/corefx/blob/b5d0c3277dc384a23fee2e57a0b5c232c99dbd88/src/System.IO.Pipes/src/System/IO/Pipes/NamedPipeServerStream.Unix.cs#L290-L301It would be cleaner if we kept using the socket APIs and could just copy that end point logic over to kestrel. Ideally we wouldn't have to use the pipe API to support this.'This might be the only problem https://github.com/dotnet/corefx/blob/958511d023231f120109967484fb63ae1837e6b8/src/System.IO.Pipes/src/System/Net/Sockets/UnixDomainSocketEndPoint.cs#L25/cc @stephentoub 
5908	area-hosting	Consider adding tests for Microsoft.AspNetCore.Server.IntegrationTesting package	Many issues like #1262 could be caught if we add unit/functional tests for the IISExpress deployer. This can be applied to all deployers too. 
5757	area-identity	multiple nvarchar(450) fields unsuitable for clustered indexes	The worst offender is dbo.AspNetUserLogins, with three (3) nvarchar(450) fields making up the primary key. SQL Server balks at this and it's a design flaw that contents that can legally fit in these fields could (together) make the record unsavable, due to a violation of the 900-byte maximum length for clustered indexes.I can imagine this is all rather baked into the system at this point, but it's a design flaw in two ways:1) it can lead to legal record data-wise not being saved due to index violations, and2) For larger sets of data, it's horribly inefficientAll that having been said, I suppose in practice "this will never be a problem" with regard to (1), since the fields in practice are populated with relatively small guids, and "this will never be a problem" with regard to (2) because most systems don't have more than a few thousand logins, and often fewer than 100, I suppose.The other two tables affected by this (as in, SQL Server throws a fit when you try to create the index) are:dbo.AspNetUserRoles (requesting 1,800 bytes in index space per record)dbo.AspNetUserTokens (requesting 1,800 bytes in index space per record)My recommended solution is that fields be reduced to more ordinary sizes, going forward, and primary keys be defaulted to integers.
5907	area-hosting	Consider publishing Microsoft.AspNetCore.Hosting.WebHostBuilderFactory.Sources to NuGet.org	Based on discussion with @Eilon and @javiercn - the package contains important implementation details for the discovery and execution of AspNetCore specific startup code that's useful in other tools. We should consider publishing the Sources package to NuGet.org so other tool authors don't have to replicate this code.
4859	area-mvc	Add EventSource/EventCounter tracing and metrics for Model Binding	Separated from https://github.com/aspnet/Mvc/issues/7018 after discussionsWe should look at where we can provide tracing and metrics in Model Binding to make it easier to diagnose why model binding isn't doing what the customer wants. We should also expand logging while we're doing this (in many cases, there should be log messages matching EventSource events).
5035	area-mvc	Add EventSource/EventCounter tracing and metrics for Razor	Some events listed below. The goal is to add events that will help users solve problems so if these aren't going to do that job, feel free to suggest/discuss others!* `Microsoft-AspNetCore-Razor` EventSource    * `ParseStart` event - Triggered when Razor parsing begins    * `ParseStop` event - Triggered when Razor parsing ends    * `ParseFailure` event - Triggered when an error in parsing occurs.    * `ParseDuration` counter - Measures duration of Razor parsing    * Would it be worth having separate "Parse" and "CodeGen" events or just one all-up "Parse&CodeGen" event?See https://gist.github.com/anurse/af1859663ac91c6cf69c820cebe92303 for some guidance on adding EventSources and EventCounters to ASP.NET projects.
4858	area-mvc	Add EventSource/EventCounter tracing and metrics for MVC	Some events listed below. The goal is to add events that will help users solve problems so if these aren't going to do that job, feel free to suggest/discuss others!* `Microsoft-AspNetCore-Mvc` EventSource (does not exist)    * For each `x` in `Action`, `ActionResult`, `ViewExecution`, `ViewCompilation`, `ModelBinding`        * `xStart` event - Triggered when invocation of an Action begins.        * `xStop` event - Triggered when invocation of an Action completes.        * `xFailure` event and counter - Triggered when an exception escapes from invoking an Action.        * `xDuration` counter - Measures the duration of action invocation    * ~~There are probably more things to do in Model Binding around specific value providers and binding individual values.~~ Split off to #7021 See https://gist.github.com/anurse/af1859663ac91c6cf69c820cebe92303 for some guidance on adding EventSources and EventCounters to ASP.NET projects.
3802	area-servers	Add EventSource/EventCounter tracing and metrics for ANCM In-Proc	Some of the events/counters to add (some may already exist, others may be valuable too, discuss below):* Requests - These should probably be emitted by default, when the source is enabled (Information Level).  * `RequestStart` event & counter - Triggered when a request is started  * `RequestStop` event & counter - Triggered when a request is completed (includes response status code)  * `RequestAbort` event & counter - Triggered when a request is terminated abnormally  * `RequestTimeOut` event & counter - Triggered when a request is times out  * `RequestFailure` event & counter - Triggered when an exception escapes from the middleware pipeline.  * `RequestsSucceeded` counter - Counts the number of requests that ended with 2xx-class status codes  * `RequestsRedirected` counter - Counts the number of requests that ended with 3xx-class status codes (this does include 304 Not Modified, but the 3xx class is called "Redirection" in the spec, and isn't a 304 just a redirection to the cache? :P)  * `RequestsRejected` counter - Counts the number of requests that ended with 4xx-class status codes   * `RequestsFailed` counter - Counts the number of requests that ended with 5xx-class status codes  * `RequestsUpgraded` counter - Counts the number of requests that ended with the 101 Switching Protocols status code.  * `RequestDuration` counter - Measures the length of time a request takes to process. (May need to be measured in Kestrel and servers because of flushing)* Network Details - These should definitely be behind a Keyword or Verbose trace level.  * `RequestBytesRead` counter - Counts the number of bytes read for HTTP requests.  * `ResponseBytesWritten` counter - Counts the number of bytes written for HTTP responses.These are mostly copied from Kestrel's companion issue (https://github.com/aspnet/KestrelHttpServer/issues/2145). Some of these may not be applicable to ANCM in-proc or may need to be adjusted (for example, the bytes read/written ones may only be able to apply to the Body).It might be worth coordinating across HttpSysServer and KestrelHttpServer to share code.See https://gist.github.com/anurse/af1859663ac91c6cf69c820cebe92303 for some guidance on adding EventSources and EventCounters to ASP.NET projects.
4769	area-servers	Add EventSource/EventCounter tracing and metrics for Kestrel	Some of the events/counters to add (some may already exist, others may be valuable too, discuss below):* Connections - These should probably be emitted by default, when the source is enabled (`Informational` level).  * `ConnectionStart` event & counter - Triggered on a new connection.  * `ConnectionStop` event & counter - Triggered on graceful termination of a connection.  * `ConnectionAbort` event & counter- Triggered when a connection is terminated abnormally.  * `ConnectionReject` event & counter - Triggered when a connection is terminated because a limit was exhausted.  * `ConnectionTimeOut` event & counter- Triggered when a connection is terminated by the server because it timed out.  * `ConnectionDuration` counter - Measures the length of time a connection is established for  * `ConcurrentConnections` counter - Measures the number of concurrent connections (recorded each time a connection is established/terminated).* Requests - These should probably be emitted by default, when the source is enabled (Information Level).  * `RequestStart` event & counter - Triggered when a request is started  * `RequestStop` event & counter - Triggered when a request is completed (includes response status code)  * `RequestAbort` event & counter - Triggered when a request is terminated abnormally  * `RequestTimeOut` event & counter - Triggered when a request is times out  * `RequestFailure` event & counter - Triggered when an exception escapes from the middleware pipeline.  * `RequestsSucceeded` counter - Counts the number of requests that ended with 2xx-class status codes  * `RequestsRedirected` counter - Counts the number of requests that ended with 3xx-class status codes (this does include 304 Not Modified, but the 3xx class is called "Redirection" in the spec, and isn't a 304 just a redirection to the cache? :P)  * `RequestsRejected` counter - Counts the number of requests that ended with 4xx-class status codes   * `RequestsFailed` counter - Counts the number of requests that ended with 5xx-class status codes  * `RequestsUpgraded` counter - Counts the number of requests that ended with the 101 Switching Protocols status code.  * `RequestDuration` counter - Measures the length of time a request takes to process. (May need to be measured in Kestrel and servers because of flushing)* Network Details - These should definitely be behind a Keyword or Verbose trace level.  * `RequestBytesRead` counter - Counts the number of bytes read for HTTP requests.  * `ResponseBytesWritten` counter - Counts the number of bytes written for HTTP responses.It might be worth coordinating across HttpSysServer and IISIntegration to share code. Also, benchmarking the impact of disabled EventSources will be important. Obviously, avoiding regression of benchmarking scenarios is an extremely high priority, we may need to have some tricks ready for that.See https://gist.github.com/anurse/af1859663ac91c6cf69c820cebe92303 for some guidance on adding EventSources and EventCounters to ASP.NET projects.
5173	area-mvc	Please update ReadMe documentation	Hello,I've set up a new .Net Core 2.0 project using the Angular SPA template provided by the JavaScript Services library. This template uses Angular 4 but I noticed that the documentation seems to be outdated.Could you please update the documentation/ read me file to reflect the updates to Angular 4 and Webpack 3?I'm trying to understand how the webpack configuration works with the latest version of the Angular SPA template. Having the documentation outdated is just making things more confusing.Many thanks!
4665	area-security	Add EventSource/EventCounter tracing and metrics for Authentication	This is part of the larger EventCounter/EventSource effort across the platform. Specific events and counters are suggested below. Let the discussions begin! :)`Start`/`Stop`/`Failure` events will all have `Duration` event counters associated with them that will time the duration between `Start` and `Stop`. `Stop` events occur even in the case of failure (think `finally` blocks).* `Microsoft-AspNetCore-Authentication` Event Source  * `RemoteAuthenticationFailure` traces calls to `RemoteAuthenticationEvents.RemoteFailure`  * `TicketReceived` traces calls to `RemoteAuthenticationEvents.TicketReceived`  * `HandleRequestStart`/`Stop`/`Failure` traces `IAuthenticationRequestHandler.HandleRequestAsync` but only starts **after** `ShouldHandleRequestAsync` succeeds. Thus not tracing requests that are not handled by the handler.* `Microsoft-AspNetCore-Authentication-Cookies` Event Source  * `CookieRefreshed` traces when `CookieAuthenticationHandler.RequestRefresh` is called. Payload includes issue time, the old expiration and the new expiration?  * `CookieExpired` traces when an expired cookie token is received. Obviously this can't catch expiry of tokens until the expired token is actually presented to the server.* `Microsoft-AspNetCore-Authentication-JwtBearer` Event Source  * `TokenValidationFailed` traces tokens that fail to validate  * `InvalidTokensReceived` counter incremented when token validation fails* `Microsoft-AspNetCore-Authentication-OAuth` Event Source (shared by OAuth providers)  * `CorrelationFailed` traces occasions where the correlation ID cannot be verified.  * `CorrelationFailures` counter incremented when token validation fails  * `ExchangeCodeStart`/`Stop`/`Failure` traces the backchannel request to exchange the code for a token* `Microsoft-AspNetCore-Authentication-OpenIDConnect` Event Source (shared by OIDC providers)  * `RedeemAuthorizationCodeStart`/`Stop`/`Failure` traces the backchannel request to redeem an authorization code  * `TokenValidationFailed` traces tokens that fail to validate  * `InvalidTokensReceived` counter incremented when token validation fails  * `GetUserInformationStart`/`Stop`/`Failure` traces the backchannel request to get user informationI want to avoid the whole "the perfect is the enemy of the good" issue and focus on a relatively simple set of initial events. So I focused on tracing external dependencies and possible malicious actions (invalid tokens). Once in, it should be easy to iterate and add more events.Also, there's a broad category of AuthN-related events which will live in `HttpAbstractions` with `AuthorizationService`See https://gist.github.com/anurse/af1859663ac91c6cf69c820cebe92303 for some guidance on adding `EventSource`s and `EventCounter`s to ASP.NET projects./cc @PinpointTownes @Tratcher @davidfowl 
5172	area-mvc	Webpack 3 compatibility	Please consider making the `aspnet-webpack` package (and others such as `aspnet-webpack-react`) compatible with webpack 3. Currently yarn issues the following warnings:```warning "aspnet-webpack@2.0.1" has incorrect peer dependency "webpack@^1.13.2 || ^2.1.0-beta".warning "aspnet-webpack-react@3.0.0" has incorrect peer dependency "webpack@^2.2.0".```However, despite these warnings, the packages seem to be working fine (although I have not tested them extensively).
5171	area-mvc	Invalid/Old documentation for nodejs debugging	The documentation [here](https://github.com/aspnet/JavaScriptServices/tree/dev/src/Microsoft.AspNetCore.SpaServices#debugging-your-javascripttypescript-code-when-it-runs-on-the-server) states:```warn: Microsoft.AspNetCore.NodeServices[0]      Debugger listening on port 9229.warn: Microsoft.AspNetCore.NodeServices[0]      Warning: This is an experimental feature and could change at any time.warn: Microsoft.AspNetCore.NodeServices[0]      To start debugging, open the following URL in Chrome:warn: Microsoft.AspNetCore.NodeServices[0]          chrome-devtools://devtools/bundled/inspector.html?experiments=true&v8only=true&ws=127.0.0.1:9229/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx```However, I do not see any of those messages:```warn: Microsoft.AspNetCore.NodeServices[0]Debugger listening on ws://127.0.0.1:50251/3d85c7fc-39bc-44c2-a3c4-e38dbb2c80e1warn: Microsoft.AspNetCore.NodeServices[0] For help see https://nodejs.org/en/docs/inspector```And the nodejs help is useless.If I go to (manually, of course): `chrome-devtools://devtools/bundled/inspector.html?experiments=true&v8only=true&ws=127.0.0.1:50251/`I get:> Debugging connection was closed. Reason: Websocket disconnectedFurther info:```node -v => 8.2.1Microsoft.AspNetCore.All => 2.0.0Windows 10```
5282	area-signalr	Disconnect / Reconnect	Hi guys,Are there javascript events available yet for Disconnect and Reconnect as was available in SignalR 2?Thanks
5034	area-mvc	Investigate Pre-Loading Roslyn	Measuring process cold startup for an MVC starter site, we've found that tag helpers and Roslyn JITting take a really significant amount of time. We're wondering if queueing up a Tag Helper discovery or 'empty' compilation to parallelize the startup cost will make a difference.
5409	area-mvc	Poor user and dev experience in Identity email confirmation	_From @natelaff on December 30, 2015 19:42_There are two issues using the default template for identity when using email confirmation.Following the guide here: http://docs.asp.net/en/latest/security/authentication/accconfirm.htmlPoor user experience: When you click "Register" it sends the email off, but just redirects the user to the Home controller. Redirecting to something else to indicate they have to confirm their account would be a better example. Perhaps the default template should have such a view OOTB.Poor dev experience: When logging in with an external account (lets say Facebook) if the account doesn't exist you get thrown into AccountController.ExternalLoginConfirmation, great. This screen requires an email, so you complete the registration then you're logged in but never shoots off the email confirmation link here. Perhaps a commented out section in this action to deal with this would improve the dev experience here._Copied from original issue: aspnet/Templates#365_
5408	area-mvc	Review web templates for more accessible and context aware markup	_From @peterblazejewicz on October 22, 2015 20:23_As asked here: https://github.com/aspnet/Templates/pull/246#issuecomment-150343164> @peterblazejewicz Can you open a separate issue to investigate whether there is anywhere else we should be using .sr-only? We'll take this PR as is for this specific instance.The templates are to be reviewed to consists of clear, readable markup, for example - in case where Bootstrap 3._/4._, review where '.sr-only' class should be used  to support screen readers (look for carousel prominent component indicators markup as example). These also means 'fieldset', `label` elements in forms, [optional] `legend` in form, correct type for some markup elements (like 'submit' or 'cancel' for buttons, etc). After this the markup should be clean and just enjoyable to read :)Thanks!_Copied from original issue: aspnet/Templates#249_
5407	area-mvc	Authentication on SPA apps	_From @Dave3of5 on August 23, 2017 7:54_There seems to be no template for authentication on the SPA templates.I've been looking up various blog post and third party articles on how to add Jwt Authentication but they are scattered and most are for dotnet core 1.1. It would be nice if there was a template that showed the "correct" way to do this in dotnet core 2.0._Copied from original issue: aspnet/Templates#864_
5906	area-hosting	IStartupConfigureServicesFilter is not executed when Configure is used	https://github.com/aspnet/Hosting/blob/872fc80d567892096f6cd6925600285570d866fe/test/Microsoft.AspNetCore.Hosting.Tests/StartupManagerTests.cs#L141-L166There no reason why we can't do it except internal implementation details./cc @Tratcher @javiercn 
5033	area-mvc	DocumentTrackers need to be refreshed when their impacted document is moved.	The documents configuration, project, basically everything needs to be recomputed when a cshtml file is moved.
5032	area-mvc	Bug with wrapping in div inside code block	Original posted at https://github.com/aspnet/Razor/issues/1628#issuecomment-336562669 by @tomeks666 ---------------------------------I do not know if this is related to Razor Tooling or something else. I noticed that Wrap in Div (Alt-Shift-W) appears to have a bug. The opening div tag has 2 additional spaces`< div > <input/> </div>`This does not happen always. It happens when the wrapping is attempted in a code block following @using e.g.`@using(Html.BeginForm("Action", "Home") { < div > <Input /> </div> }`Could somebody try to reproduce it? Just put an input tag in a using block select it and press Alt-Shift-W
5406	area-mvc	Localization?	Any plans to bring localization to the templates?Using `@Localizer` as show [here](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/localization) seems a good option IMO. Particularly for templates like _Web Application with Authentication_ which have a nice set of pages and code ready to use. But only if your target audience understands English 😉.
4857	area-mvc	Consistency across binding attributes	## SummaryMVC has a few different flavours of binding attributes and they each do different things, largely for legacy reasons - but they also overlap in some ways which leads a lot of confusion. We've tried to keep them orthogonal in the past, but they didn't start that way, so maybe we should stop trying?Could we think about making them consistent and maybe deprecating some? Time horizon for this is long-term. I want to come up with a plan for the zoo of current stuff.## Existing StuffWe have the following attributes:```[Modelbinder][Bind][BindProperty][FromBody]/[FromHeader]/[FromServices]/[FromRoute]/[FromQuery]/[FromForm][BindRequired]/[BindNever]/[BindingBehavior] // these are hidden away  in the .ModelBinding namespace for some reason```We also have the following *policies* that these attributes can configure (see [BindingInfo](https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Abstractions/ModelBinding/BindingInfo.cs)): - Binding Source (where do we look for data) `IBindingSourceMetadata` - Model Name (what's the key-space) `IModelNameProvider` - Binder Type (specifies a model binder to use by-type) `IBinderTypeProviderMetadata` - Property Filters (Include) `IPropertyFilterProvider` - Request Predicate (filter by request type) `IRequestPredicateProvider` - Binding Behavior (never, required) - this is actually part of model metadata which is wierd - `BindingBehaviorAttribute`Here's a handy table:|  	| Targets 	| Binding Source 	| Model Name 	| Binder Type 	| Property Filter 	| Request Filter 	| Binding Behavior 	||----------------	|---------------------	|----------------	|------------	|-------------	|-----------------	|----------------	|------------------	|| [ModelBinder] 	| All 	| X 	| X 	| X 	|  	|  	|  	|| [Bind] 	| Type, Parameter 	|  	| X 	|  	| X 	|  	|  	|| [BindProperty] 	| Property 	| X 	| X 	| X 	|  	| X 	|  	|| [FromRoute] 	| Parameter, Property 	| X 	| X 	|  	|  	|  	|  	|| [BindRequired] 	| All 	|  	|  	|  	|  	|  	| X 	|## Some random thoughts`[ModelBinder]`, `[Bind]` and the `[BindRequired]` family all have their root in our legacy systems, but only  `[ModelBinder]` is truly compatible with MVC5. We cut `exclude` support from `[Bind]` and the `[BindRequired]` attribute used to be called `[HttpBindRequired]`. This makes me sad because it represents a missed opportunity 👎 The `[FromXyz]` is new as of ASP.NET Core and is mostly intended to for APIs. `[BindProperty]` is a new feature that was added for Razor Pages. It's special trick is that it doesn't bind on GET requests by default `IRequestPredicateProvider``[BindRequired]` and friends don't support any real customization of the model binding system. They are kinda separate.
4153	area-platform	Remove all HostingStartup packages from metapackage	
5031	area-mvc	Tie into ICompletionBroker.Dismissed event to determine provisional reparses.	
4856	area-mvc	Figure out the relationship between our security story and API Explorer	The OpenAPI/Swagger spec can provider authorization information that can be used in SwaggerUI (and other clients) to authorize against the API.Furthermore, individual endpoints can expose claims/scope information for permissions.We need to figure out how to expose this information.Related: https://github.com/aspnet/Mvc/issues/6877
5405	area-mvc	QR Codes should be supported in templates 	[Enabling QR Code generation for authenticator apps](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity-enable-qrcodes)That should be supported in the templates like [SMS 2FA](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/2fa) used to be. requested by customer in [Enabling QR Code generation for authenticator apps](https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity-enable-qrcodes) comments
3820	area-servers	Verify response content length in IISHttpContextOfT	Code is currently commented out. Based on https://github.com/aspnet/KestrelHttpServer/blob/a31d1e024ca86a4a9053e0be105fde17c5ccae10/src/Kestrel.Core/Internal/Http/HttpProtocol.cs#L454. 
4770	area-servers	Default values in HttpProtocol.FeatureCollection should be on set and not get	For example, [the Scheme](https://github.com/aspnet/KestrelHttpServer/blob/dev/src/Kestrel.Core/Internal/Http/HttpProtocol.FeatureCollection.cs#L85-L89) and [the PathBase](https://github.com/aspnet/KestrelHttpServer/blob/dev/src/Kestrel.Core/Internal/Http/HttpProtocol.FeatureCollection.cs#L97-L101) both provide default on get rather than on set, even though they are always set to non-null in the constructor. Also, why are there no default for Path, Query, etc? Seems inconsistent. 
5905	area-hosting	Remove environment fallback keys.	We should remove these fallbacks at some point since they have been obsolete for a long time. https://github.com/aspnet/Hosting/blob/dev/src/Microsoft.AspNetCore.Hosting/WebHostBuilder.cs#L49-L60Possibly for 3.0?
5281	area-signalr	Investigate using SignalR itself as a backplane	We can start with a basic implementation that is a standalone application that needs to be hosted in order to function, no fancy clustering just yet. Everyone connects to the SignalR backplane service and we treat it like a remote cache.One downside of doing it this way is that the backplane service would need to be scaled out as well...
4108	area-tooling	Support running arbitrary command from dotnet-watch	At the moment "dotnet" is implied. We should provide a way to suppress that.One idea:```dotnet watch -x|--exec [[--] [<ARGS...>]]Example:dotnet watch -x ./build.sh```
5030	area-mvc	Feature request: mandatory tag helper properties	Is there a way to mark tag helper properties as "required", i.e., mandatory? Optimally, the user would run into a compile-time problem when omitting required properties. An alternative would be to run into a view compilation problem at runtime.
5756	area-identity	UserManager.Logger is virtual and set in the constructor	Pretty much as the title says.This is considered bad practice, as ctor order is the most base class to the most derived class, so if the property is overridden in a subclass it may not be properly initialized.Static Analysis even has a rule against this: https://docs.microsoft.com/en-us/visualstudio/code-quality/ca2214-do-not-call-overridable-methods-in-constructors (note that properties are effectively just a pair of methods, so the rule does in fact apply).Here's a hypothetical example of something that could go wrong:```public class ApplicationUserManager : UserManager<ApplicationUser>{    private IObserver observer;    public ApplicationUserManager(IObserver observer)        : base(/* ... omitted for brevity ... */)    {        this.observer = observer;    }    public override ILogger Logger    {        get        {            this.observer.RecordPropertyGet(nameof(Logger));            return base.Logger;        }        set        {            this.observer.RecordPropertySet(nameof(Logger), value);            base.Logger = value;        }    }}```In that example, the base class will set the `Logger` property, which will be the derived classes's impl, which uses `this.observer`, but oops it's null at that point in time since `ApplicationUserManager`'s ctor hasn't actually executed yet.I am curious btw why this prop is virtual to begin with. It's a bit odd to see a virtual autoprop.
4855	area-mvc	Remove [Obsolete] action result code	We have obsolete overrides of `ActionResult.ExecuteResult(...)` that are unused by any of our other code and should be removed in a major release. This isn't an API breaking change, but users might have called these methods, which will now no-op.```RedirectResultLocalRedirectResultRedirectToActionResultRedirectToPageResultRedirectToRouteResult```
4854	area-mvc	Improvements to Swagger generation	This is a laundry list of gaps we have between the current swagger experience and the ideal experience. Basically what are all of the things you have to configure or provide manually.## Things we need to provide### P0### P1- [ ] Security - `securityDefinintions` element - information about auth schemes and URLs. We should surface this when we have it.- [ ] in operation - security/scopes - see above- [ ] in operation - consumes and produces are not realistic - how does this affect clients? We can move this down if it's not used in client.### P2## Things a swagger provider should provide### P0- [ ] in parameter - look at collections and enums as parameters/return types - we want to make sure that idiomatic .NET code works well with swagger + generated clients### P1- [ ] Host/Base-Path/Schemes - We don't know what value this would provide or how to get it right. This would look like the framework exposing settings. This could be important for the generated client.- [ ] In operation  - summary, operationid, description- [ ] in parameter - description- [ ] in operation response - description. This is marked as a `required` field in the OpenAPI specs - https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#response-object### P2- [ ] Description/Title/Version - everything in `info` element- [ ] Tags - `tags` element. Tags are used to provide grouping and descriptions of groups of related operations. - [ ] in operation - tags - see above- [ ] Docs- `externalDocs` element - this is an informational link to developer documentation
5404	area-mvc	Suggestion: Use SQL Server security for connection strings on Linux	_From @livarcocc on July 16, 2017 18:20__From @badersur on July 13, 2017 21:3_## Steps to reproduce1. `dotnet new mvc -au Individual -uld true`2. `dotnet restore`3. `ASPNETCORE_ENVIRONMENT=Development dotnet run`4. visit http://localhost:5000/Account/Register, enter data & press register## Expected  behaviorThe site should register the user & work without any issue## Actual behaviorAn error occurred with these messages:```An unhandled exception occurred while processing the request.NotSupportedException: The keyword 'integrated security' is not supported on this platform.System.Data.SqlClient.SqlConnectionString..ctor(string connectionString)....```Solved by changing the connection string to use SQL Server Security:```"DefaultConnection": "Server=localhost;Database=aspnet-MVCAuthSQL;Trusted_Connection=False;MultipleActiveResultSets=true;User Id=SA;Password=my-secret-password;"```I suggest changing the templates to use SQL Server Security on Linux distributions, or adding another connection string (and suggesting to use it in `Startup.cs`) or at least link to https://msdn.microsoft.com/en-us/library/jj653752(v=vs.110).aspx#sqlserver in `Startup.cs`...I spent many hours to find the solution (from 4 PM - 11 PM with some breaks!) and I think templates should work by default. Also, the default string seems to applicable for Windows so I believe it should be changed on other platforms.## Environment data`dotnet --info` output:```.NET Command Line Tools (1.1.0-preview1-005051)Product Information: Version:            1.1.0-preview1-005051 Commit SHA-1 hash:  5e88564e56Runtime Environment: OS Name:     ubuntu OS Version:  17.04 OS Platform: Linux RID:         ubuntu.16.10-x64 Base Path:   /usr/share/dotnet/sdk/1.1.0-preview1-005051```_Copied from original issue: dotnet/cli#7156__Copied from original issue: dotnet/templating#1097_
4853	area-mvc	DataAnnotationLocalizerProvider not called for EnumDataType and own ValidationAttribute implementations	For `EnumDataType` and all of our self-implemented `ValidationAttribute`s it looks like the `DataAnnotationLocalizerProvider` is not called when generating the error message. Insteaed it just outputs the `ErrorMessage` as is.Is this a bug? Do I have to specifically configure additional validation attributes somewhere?
5280	area-signalr	Support returning values from client invocations	Support server to clients acks so that reliable messaging can be implemented more easily. This would only be when using `Clients.Client()`. I think we should go back to the SendAsync (fire and forget) InvokeAsync (wait for ack) naming pattern. That's the one sticking point.EDIT by @anurse: For clarity, this issue is tracking all work related to allowing values to be returned from client invocations. It **also** covers allowing the server to wait for a `void`-returning (or `Task`-returning) client side method to complete.
5904	area-hosting	Use names in EventIds for logging	In https://github.com/aspnet/Hosting/blob/e4350945c56d69523fe36bf33c58b955db3d8985/src/Microsoft.AspNetCore.Hosting/Internal/LoggerEventIds.cs we use `int`s for event ID values, but the `EventId` type that is used can actually also support holding a name. Names are easier to query and inspect in structured log storage.We should change the fields in this type to `EventId`s and give them names.(Event ID names don't need a prefix because `EventId` is only unique within a Logger, so there's no need to prefix it).
4852	area-mvc	Textarea tagHelper is not rendering the contents of the element correctly. 	The `<textarea>` tag helper is not rendering the content of the element correctly for a Razor Page.If a Model property called `Messages` is modified in the OnPost, this update is visible in the view by using the razor  directive `@Model.Messages`, but the `<textarea>` element does not display the correct innerHtml content.This issue has been previously raised and closed because it could not be replicated.https://github.com/aspnet/Mvc/issues/3964This  example reproduces the issue:https://github.com/colhountech/TextAreaDemoHere is my attempt that fixes the scenario. I have not looked at regression so don't know yet if it affects any other tests.https://github.com/colhountech/Mvc/pull/1/filesbasically it comes down to the following code segment in the  ```            ModelStateEntry entry;            viewContext.ViewData.ModelState.TryGetValue(fullName, out entry);            var value = string.Empty;            if (entry != null && entry.AttemptedValue != null)            {                value = entry.AttemptedValue;            }            else if (modelExplorer.Model != null)            {                value = modelExplorer.Model.ToString();            }```The issue seems to be related to both the `ViewData` and the `modelExplorer` returning a valid value, however the `modelExplorer` has the correct value, and this condition is never satisfied because the preceding condition is always true.My fix for this issue is to remove the else, and allow the `Model` to take precedence over the `ViewData` ( I'm not sure if this effects regression), as follows:```             ModelStateEntry entry;            viewContext.ViewData.ModelState.TryGetValue(fullName, out entry);            var value = string.Empty;            if (entry != null && entry.AttemptedValue != null)            {                value = entry.AttemptedValue;            }            // should the convention be that the Model override an ViewData for Razor Pages?            if (modelExplorer.Model != null)            {                value = modelExplorer.Model.ToString();            }```Hope this is an accurate understanding of the issue, if not please feel free to close.
4851	area-mvc	Create `<display/>` and `<editor>` (i.e. template-based) tag helpers	See the [Tag Helper Pack](https://github.com/DamianEdwards/TagHelperPack) and #6512.General wish is to make it easier to use `ModelExplorer` more generally.
5029	area-mvc	Add helpers to deal with `IHtmlContent`	We have a fair amount of code that deals with `IHtmlContent` and related interfaces. To centralize that and ease things for all, add methods like `IsLiteral()`, `IsMixedContent()`, `GetRaw()` and `GetAsItWillBeRendered(HtmlEncoder encoder)`.Goal: As a tag helper author, I have an easy way to get the value of an attribute.
4771	area-servers	Put request trailers in a separate collection	Right now we merge them with request headers. They should go into their own collection. There should also be some way (likely a `Task`) to allow an application to wait until trailers have been received.
4667	area-security	[2.0] SignIn for cookies should honor AuthenticationProperties.RedirectUri	When calling `SignInAsync` for the cookie handler, if an `AuthenticationProperties` with a `RedirectUri` set is passed it's not honored unless the current path is the same as the `LoginPath`. If an explicit `AuthenticationProperties` is passed with a `RedirectUri` set, then I'd expect it to be honored.
6002	area-middleware	IISUrlRewrite "URL" parameter	We missed implementing the URL parameter in IIS Url Rewrite rules. The URL parameter will just return the original request url. Ex:```xml<rule name="LowerCaseRule1" enabled="true" stopProcessing="true">    <match url="[A-Z]" ignoreCase="false" />    <action type="Redirect" url="{ToLower:{URL}}" /></rule>```the ToLower:{URL} would return the lower cased request url. 
5877	area-servers	Consider an options to not automatically set HttpContext.User	Much like the IIS server integration with `IISOptions.AutomaticAuthentication`.
4850	area-mvc	Test changing MediaType as a wrapper around MediaTypeHeaderValue	To verify that changing MediaType to MediaTypeHeaderValue, we would like to see:- Performance difference- Test impact (how many tests fail)- Number of modificationsFirst, we will alter MediaType to wrap MediaTypeHeaderValue. This is probably the easiest way to check if MediaTypeHeaderValue needs extra features, as a lot of the methods are similar, but may not be exactly the same. See #5416 and aspnet/HttpAbstractions/issues/825
6001	area-middleware	Add support for content security policy	This is a placeholder issue.Similar to the support that we have for CORS in APIs, we should have support for Content Security Policy to make sites safer by default.Support for CSP would be policy based, similar to the one we offer for CORS.# Usage from middleware```C#ConfigureServices(IServiceCollection services){    ...    services.AddCsp();    ...}``````C#Configure(IApplicationBuilder app){    ...    app.UseCsp();    ...}```# Usage from MVC```C#ConfigureServices(IServiceCollection services){    ...    services.AddMvc(); // Add MVC will call AddCsp similar to what we do for CORS today.    ...}``````C#[EnableCsp]public IActionResult Index(){    return View();}```We will provide a default policy that limits content to your domain, defines best practices for HTTPS and will be set to report-only. This behavior can be switched per endpoint so that you can progressively enforce the policy one endpoint at a time.# Referenceshttps://en.wikipedia.org/wiki/Content_Security_Policyhttps://developer.mozilla.org/en-US/docs/Web/HTTP/CSPhttps://www.w3.org/TR/CSP2/http://caniuse.com/#search=content%20security%20policy
5028	area-mvc	Make directive completions snippet-complete.	After completing a directive you are placed at the end of the directive name. We should extract token information and translate that into a snippet-based completion. For example, if you were to auto-complete `@model` it'd write out `@model <type>` and then have `<type>` highlighted to be replaced.
5027	area-mvc	Add token information to directive completions	With #291 we'll get completions that look like:![image](https://user-images.githubusercontent.com/2008729/29832484-41087c9a-8c9d-11e7-80ac-dde0d8db41ea.png)We should extract token information from each directive and conditionally provide information on the directives format. For `@model` this might look like:```Specify the model or page handler for the current document.@model <type>```
4849	area-mvc	Make-method-async code fix breaks ASP.NET MVC action routing after 'Async' suffix is appended to method name	_From @jeremymeng on August 28, 2017 18:31_**Version Used**: **Steps to Reproduce**:1. create a ASP.NET Core project2. select MVC template, create the project, and F5 to make sure the home page is shown3. open HomeController.cs4. changing return type of `Index()` to `Task<IActionResult>`5. Add `await Task.Delay(1);` inside `Index()`6. Invoke code fix to make the method asyncNow the method looks like ```csharp        public async Task<IActionResult> IndexAsync()        {            await Task.Delay(300);            return View();        }```7. F5**Actual Behavior**:HTTP 404if rename the method back to `Index()` F5 works again._Copied from original issue: dotnet/roslyn#21770_
4668	area-security	IClaimsTransformation "runs on AuthorizeAsync success"	The current action of IClaimsTransformation provides non-deterministic identity types on IPrincipal. For example, in the simple scenario where cookies are enabled, IClaimsTransformation does not get run if no cookies are present. In previous versions this transform could be relied upon to permit casting identity to a custom type. In Core 2.0 code breaks, and distributing null checks throughout code is necessary again, defeating the purpose of the transformation.I'd just like to point out that this is an issue commonly seen on and off in various previous versions of Microsoft's identity, and from my perspective at this point seems to be a serious regression.
4623	area-servers	Convert TLS connection adapter to connection middleware	As part of bedrock, connection adapters are going away and we should port the tls connection adapter to middleware. We don't want to break the public API of the existing extension method on ListenOptions so that will remain. The true TLS implementation should be in Microsoft.AspNetCore.Protocols.Tls and Kestrel.Tls should delegate to it in the implementation.Edit: Also convert Logging connection adapter to middleware.
5903	area-hosting	Consider adding a IWebHostBuilder.Configure overload that takes a WebHostBuilderContext	Would be nice/consistent to have this additional overload as it also exists for `ConfigureAppConfiguration` and `ConfigureServices`. It would allow us to access the configuration and environment info without having to resolve it ourselves from DI.
5170	area-mvc	Formatting issues (dots replaced by underscores) in namespaces generated by the SPA templates.	When creating a new solution and say a project with name like `SolutionName.ProjectName` using one of the SPA templates, the generation of the `*.cs` files (and maybe some others?) ends up with an underscore instead of the original dot in the namespaces, e.g. `SolutionName_ProjectName`. Is there anything that can be done in that regard?
5026	area-mvc	Move TagHelper directive parsing to make use of Razors Parser/Tokenizer concepts.	Today TagHelper directives (`@addTagHelper`, `@removeTagHelper`, `@tagHelperPrefix`) utilize string manipulation in order to validate the format of a directive. As a follow up to https://github.com/aspnet/Razor/issues/945 we should move the string manipulation approach to one that is consistent with how all other directives are parsed in order to mitigate future errors.
4848	area-mvc	Ability to translate all DataAnnotations without having to specify ErrorMessage	Currently, [ValidationAttributeAdapterOfTAttribute.GetErrorMessage](https://github.com/aspnet/Mvc/blob/900a5c7c4c789e71bf18e8e90bf9b28b4e51013f/src/Microsoft.AspNetCore.Mvc.DataAnnotations/ValidationAttributeAdapterOfTAttribute.cs#L67) uses IStringLocalizer only when ErrorMessage is set:```csharpprotected virtual string GetErrorMessage(ModelMetadata modelMetadata, params object[] arguments){    if (modelMetadata == null)    {        throw new ArgumentNullException(nameof(modelMetadata));    }    if (_stringLocalizer != null &&        !string.IsNullOrEmpty(Attribute.ErrorMessage) &&        string.IsNullOrEmpty(Attribute.ErrorMessageResourceName) &&        Attribute.ErrorMessageResourceType == null)    {        return _stringLocalizer[Attribute.ErrorMessage, arguments];    }    return Attribute.FormatErrorMessage(modelMetadata.GetDisplayName());}```The consequence is that you have to set the ErrorMessage property each time you want to translate an error message.Suppose you just want to translate the default RequiredAttribute ErrorMessageString, which is `The {0} field is required.` for all your Model classes.1) You must override the default DataAnnotationLocalizerProvider to return a shared resource.2) You add a generic entry named, for example, "DataAnnotations_Required" with the translated value format: `Le champ {0} doit être renseigné.`3) You must replace all the `[Required]` attributes with `[Required(ErrorMessage = "DataAnnotations_Required")]`More generally, there is no way to just adapt the generic DataAnnotation validation messages to your language. (the ones in [System.ComponentModel.Annotations.SR.resources](https://github.com/dotnet/corefx/blob/master/src/System.ComponentModel.Annotations/src/Resources/Strings.resx)) without having to replace all your data annotations.The [documentation](https://docs.microsoft.com/en-us/aspnet/core/fundamentals/localization#dataannotations-localization) only provide a sample where the messages are customized for each property (despite the fact that only the property name change).There is no easy workaround either:- You can't inherit from RequiredAttribute to fix the ErrorMessage property, since the framework uses strict type comparison- Replacing the default ValidationAttributeAdapterProvider is not trivial, because you have to replace all adapters with custom ones to override the GetErrorMessage method.Is there a better way to achieve localization for all default data annotation error messages ?Or room for improvement in asp.net core mvc to reduce the burden of writing all this custom code ?
5755	area-identity	Consider updating AddIdentity() to avoid overriding default schemes when they were previously set	> Identity is indeed a bit greedy and if you try to register your default scheme before calling `AddIdentity()`, it will be ignored.> @HaoK would that be worth considering updating services.AddIdentity() to avoid overriding the default schemes when they are not null (i.e when already set by the developer?).https://github.com/aspnet/Identity/blob/f3e251167212f18825506de9099a06e35350269c/src/Microsoft.AspNetCore.Identity/IdentityServiceCollectionExtensions.cs#L66-L71
5169	area-mvc	Cannot find module 'aspnet-webpack'	Exception thrown when starting the app created by using Service Fabric Asp.Net Core 2.0 Angular template. Running on Service Fabric 5.7.198."Webpack dev middleware failed because of an error while loading 'aspnet-webpack'. Error was: Error: Cannot find module 'aspnet-webpack'\n    at Function.Module._resolveFilename (module.js:485:15)\n    at Function.Module._load (module.js:437:25)\n    at Module.require (module.js:513:17)\n    at require (internal/module.js:11:18)\n    at Object.<anonymous> (C:\\SfDevCluster\\Data\\_App\\_Node_2\\Application4Type_App59\\temp\\nlcuhlos.kzt:83:19)\n    at __webpack_require__ (C:\\SfDevCluster\\Data\\_App\\_Node_2\\Application4Type_App59\\temp\\nlcuhlos.kzt:20:30)\n    at createWebpackDevServer (C:\\SfDevCluster\\Data\\_App\\_Node_2\\Application4Type_App59\\temp\\nlcuhlos.kzt:62:26)\n    at C:\\SfDevCluster\\Data\\_App\\_Node_2\\Application4Type_App59\\temp\\vyr4pqpo.yvi:114:19\n    at IncomingMessage.<anonymous> (C:\\SfDevCluster\\Data\\_App\\_Node_2\\Application4Type_App59\\temp\\vyr4pqpo.yvi:133:38)\n    at emitNone (events.js:105:13)\nCurrent directory is: C:\\SfDevCluster\\Data\\_App\\_Node_2\\Application4Type_App59\\Web1Pkg.Code.1.0.0\r\n"
4847	area-mvc	Add a way to access reason of a Mvc filter failure (ex: AntiforgeryTokenAuthorizationFilter.cs)	When `AntiforgeryValidation` fails, there is no way to track back the reason of the failure from `UseStatusCodePages` Handlers. This would be useful, to take the right action from client side.From : ValidateAntiforgeryTokenAuthorizationFilter.cs```public async Task OnAuthorizationAsync(AuthorizationFilterContext context)        {            if (context == null)            {                throw new ArgumentNullException(nameof(context));            }            if (IsClosestAntiforgeryPolicy(context.Filters) && ShouldValidate(context))            {                try                {                    await _antiforgery.ValidateRequestAsync(context.HttpContext);                }                catch (AntiforgeryValidationException exception)                {                    _logger.AntiforgeryTokenInvalid(exception.Message, exception);                    context.Result = new BadRequestResult();                }            }        }```
4846	area-mvc	Returning HTML using Produces("text/html") causes 406 response	After upgrading to ASP.NET Core 2.0, `[Produces("text/html")]` doesn't seem to work anymore. I am returning a string in my action using `Ok(str)` with that attribute specified.
5025	area-mvc	Transform @model DirectiveIntermediateNode into a custom directive node type.	Today our GetModel resolution code assumes that the `DirectiveIntermediateNode` will be in the document. This isn't a safe assumption since we have a directive removal pass that nukes the existence of that node.Today this works but it's very fragile.
4845	area-mvc	Don't support async void as page handlers in razor pages	And an exception should be thrown. So says @DamianEdwards.
4670	area-security	Future AuthZ improvements list	This issue will track all the various Authorization improvements we are looking at for 2.1.Some initial thoughts:----From @davidfowl We've had a bunch of feedback about our authz system with respect to flowing context from the authorize attribute to the authorization handler: - https://github.com/aspnet/Security/issues/670- https://github.com/aspnet/Mvc/issues/5607- https://github.com/aspnet/Security/issues/917- https://github.com/aspnet/Security/issues/1352Today the Authorize attribute supports has enough metadata to describe the policy but it doesn't let you specify the resource (via IAuthorizeData). I think if we solve that, it might solve a bulk of the issues since people will be able to write custom attributes that flow the relevant context to the authorization handler.  Today that's only possible when doing imperative authz. I was thinking something like: ```public interface IAuthorizeResource{    object Resource { get; }}``` If the attribute implemented this, we would flow that as the resource to the handler. This way you implement permissions of whatever you please via resources. ----From @rynowak Look into providing overriding semantics in MVC, maybe a marker interface: `IAuthorizeMetadata`. Any attributes that implement that interface on the endpoint could be flowed. Then it’s up to developers to build whatever they want.  (Also look into flowing single objects vs many objects + requirements VS resources)We will also look into making it possible to specify requirements via Attributes similar to imperative AuthZ so you don't have to preconstruct policies for attributes.Misc other improvements:----- Consider supporting OR logic for policies: https://github.com/aspnet/Security/issues/1356- Consider enabling policies to be defined in configuration- Make it easier to be able to display authZ failure reasons in an error page etc https://github.com/aspnet/Security/issues/1530- Make it easier to pass parameters to policies, i.e. https://github.com/aspnet/Security/issues/1689
4844	area-mvc	Detect AntiforgeryValidationException without throwing	Seems like a first chance exception here. Can we avoid it by adding a new API to the `IAntiforgery` interface (or another interface)?https://github.com/aspnet/Mvc/blob/760c8f38678118734399c58c2dac981ea6e47046/src/Microsoft.AspNetCore.Mvc.ViewFeatures/Internal/ValidateAntiforgeryTokenAuthorizationFilter.cs#L43
5754	area-identity	Issue creating tokens using a certificate in full framework	Tracking issue for: https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/issues/667
4772	area-servers	 Project Bedrock	## Project BedrockProject bedrock is about further decoupling the components of Kestrel so that we can use it as the foundation for our non-http networking stack. We want to build on the primitives, patterns and cross cutting concerns that exist today in ASP.NET Core applications. The goal is to enable higher level frameworks (like SignalR or WCF and even ASP.NET Core itself) to build on top of abstractions that don't tie them to a specific connection implementation (OWIN for Connections). As an example, it allows SignalR to run both on top of TCP or Websockets without having to understand what the underlying transport is. We also want to enable building raw low level protocol servers to handle things like MQTT for IOT scenarios.There are 3 main actors in this server side programming model:- **Applications/Middleware/Frameworks** - The application code that handles connections and implement protocol parsing logic or other logic that modifies the stream of data (http, TLS as an example)- **Transports** - Transports provide an implementation of an `IFeatureCollection` that implements the underlying connection semantics. In short, transports provide a concrete implementation of the `ConnectionContext` that flows through the dispatcher to the application. - **Dispatchers** - The dispatcher is the component that brings the transport layer and application layer together. Its job is to manage the lifetime of the transport connection and application running on top. The dispatcher will expose the `IConnectionBuilder` for a particular binding relevant to the transport. For example, the http dispatcher will expose the `IConnectionBuilder` based on a particular route, while the TCP dispatcher will expose an `IConnectionBuilder` based on an ip address and port.## Applications/Middleware/FrameworksAt the center of this work is a new set of primitives that represent an underlying connection:```C#public abstract class ConnectionContext{    public abstract string ConnectionId { get; set; }    public abstract IFeatureCollection Features { get; }        public abstract IDuplexPipe Transport { get; set; }    public abstract IDictionary<object, object> Items { get; set; }}``````C#public interface IConnectionIdFeature{    string ConnectionId { get; set; }}``````C#public interface IConnectionTransportFeature{    IDuplexPipe Transport { get; set; }}``````C#public interface IConnectionItemsFeature{    IDictionary<object, object> Items { get; set; }}```The `ConnectionContext` is the "HttpContext" of the connection universe. It's an abstraction that represents a persistent connection of some form. This couldbe a TCP connection, a websocket connection or something more hybrid (like a connection implemented over a non duplex protocol like server sent events + http posts). The feature collectionis there for the same reason it's there on the `HttpContext`, the server or various pieces of "middleware" can add, augment or remove featuresfrom the connection which can enrich the underlying abstraction. The 2 required features are the `IConnectionTransportFeature` and the `IConnectionIdFeature`.Next, we introduce the abstraction for executing a connection.```C#public delegate Task ConnectionDelegate(ConnectionContext connection);```The `ConnectionDelegate` represents a function that executes some logic per connection. That `Task` return represents theconnection lifetime. When it completes, the application is finished with the connection and the server is free to close it.In order to build up a pipeline, we need a builder abstraction and a pipeline. The `IConnectionBuilder` (similar to the `IApplicationBuilder`) representsa sockets pipeline. The middleware signature is `Func<ConnectionDelegate, ConnectionDelegate>` so callers can decorate the next `ConnectionDelegate`in the chain similar to http middleware in ASP.NET Core.```C#public interface IConnectionBuilder{    IServiceProvider ApplicationServices { get; }    IConnectionBuilder Use(Func<ConnectionDelegate, ConnectionDelegate> middleware);    ConnectionDelegate Build();}```These are the fundamental building blocks for building connection oriented applications. This will live in the **Microsoft.AspNetCore.Connections.Abstractions** package.This refactoring will enable a few things:- Kestrel's ASP.NET Core implementation will be re-platted on top of this new infrastructure which means it will be fully decoupled from Kestrel.- Kestrel's connection adapter pipeline will be changed to use the `IConnectionBuilder` instead. This means that things like TLS , windows auth and connection logging can be separate middleware components.- SignalR will be built on top of this making it possible to run SignalR on *any* connection based infrastructure. ## TransportsTransports are responsible for providing the initial `IFeatureCollection` implementation for the connection and providing a stream of bytes to the application. ### Libuv and System.Net.SocketsToday we have 2 transport implementations that reside in Kestrel, a System.Net.Sockets and libuv implementation. We plan to keep these 2 because they both offer different sets of features. Libuv can listen on file handles, named pipes, unix domain sockets, and tcp sockets while System.Net.Sockets just has a tcp socket implementation (and unix domain sockets)### WebSocketsWe want to enable people to build websocket based frameworks without dealing with low level details like connection management and buffering. As such, we will provide a web socket transport that exposes these connection primitives. This currently lives in the **Microsoft.AspNetCore.Http.Connectons** package.### Other HTTP transportsSignalR in the past has provided multiple transport implementations historically for browsers that didn't support websockets. These are not full duplex transports but are implemented as such by round tripping a connection id over http requests. We will also provide implementations transports for long polling and server sent events. These implementations will require a special client library that understands the underlying non-duplex protocol. These currently lives in the **Microsoft.AspNetCore.Http.Connectons** and **Microsoft.AspNetCore.Http.Connectons.Client** packages.### QUIC[QUIC](https://en.wikipedia.org/wiki/QUIC) is a quickly emerging standard that is looking to improve perceived performance of connection-oriented web applications that are currently using TCP. When QUIC comes around we'll want to be able to support it with the same abstraction.## Dispatchers### ASP.NET CoreASP.NET Core will serve as the basis for our HTTP dispatcher. There will be a `RequestDelegate` implementation that serves as the dispatcher built on top of routing.```C#using Microsoft.AspNetCore.Builder;using Microsoft.AspNetCore.Hosting;using Microsoft.Extensions.DependencyInjection;using SocketsSample.EndPoints;using SocketsSample.Hubs;namespace SocketsSample{    public class Startup    {        public void ConfigureServices(IServiceCollection services)        {            services.AddConnections();        }        public void Configure(IApplicationBuilder app, IHostingEnvironment env)        {            if (env.IsDevelopment())            {                app.UseDeveloperExceptionPage();            }            app.UseConnections(routes =>            {                // Handle mqtt connections over websockets on the /mqtt path                routes.MapWebSocket("mqtt", connectionBuilder =>                {                    connectionBuilder.UseMQTT<MQTTHandler>();                });                // Handle SignalR chat connections on the /chat path (multiple transports)                routes.MapConnections("chat", connectionBuilder =>                {                    connectionBuilder.UseSignalR<Chat>();                });            });        }    }}```### KestrelKestrel was originally built as an http server for ASP.NET Core. Since then it's evolved to into a bunch of separate components but has still been hyper focused on http scenarios. As part of this work, there are further refactorings that will happen and kestrel will serve as the generic sockets server that will support multiple protocols.  We want to end up with layers that look something like this:- **Microsoft.AspNetCore.Server.Kestrel.Core** - Dispatcher implementation- **Microsoft.AspNetCore.Server.Kestrel.Https** - Deprecate this package in favor of (**Microsoft.AspNetCore.Protocols.Tls**)- **Microsoft.AspNetCore.Server.Kestrel.Transport.Abstractions** - Abstractions for plugging different transports into kestrel- **Microsoft.AspNetCore.Server.Kestrel.Transport.Libuv** - Libuv transport (tcp, pipes, unix sockets)- **Microsoft.AspNetCore.Server.Kestrel.Transport.Sockets** - System.Net.Sockets transport- **Microsoft.AspNetCore.Server.Kestrel** - Meta package for ASP.NET Core to avoid breaking changesWe should introduce the following packages:- **Microsoft.AspNetCore.Protocols.Http** - Http `ConnectionDelegate` middleware- **Microsoft.AspNetCore.Protocols.Http2** - Http2 `ConnectionDelegate` middleware (do we merge Http and Http2?)- **Microsoft.AspNetCore.Protocols.Tls** - TLS `ConnectionDelegate` middlewareHere's what the Kestrel for TCP could look like wired up to the generic host:```C#var host = new HostBuilder()            .ConfigureServer(options =>            {                // Listen on (*, 5001), then get access to the ISocketBuilder for this binding                options.Listen(IPAddress.Any, 5001, connectionBuilder =>                {                   // This is the SignalR middleware running directly on top of TCP                   connectionBuilder.UseHub<Chat>();                });                                // Listen on (localhost, 8001), then get access to the ISocketBuilder for this binding                options.Listen("localhost", 8001, connectionBuilder =>                {                   // Accept connections from an IOT device using the MQTT protocol                   connectionBuilder.UseMQTT<MQTTHandler>();                });                                options.Listen("localhost", 5000, connectionBuilder =>                 {                    // TLS required for this end point (this piece of middleware isn't terminal)                    connectionBuilder.UseTls("testCert.pfx", "testPassword");                                        // ASP.NET Core HTTP running inside of a Connections based server                    connectionBuilder.UseHttpServer(async context =>                    {                        await context.Response.WriteAsync("Hello World");                    });                });            })            .Build();host.Run();```
4843	area-mvc	Add support to create HtmlHelper instances for testing purposes	We are writing our own tag helpers which make use of `HtmlHelper` internally (e.g., to render an Editor). This seems to be the recommended behavior, see also https://docs.microsoft.com/en-us/aspnet/core/mvc/views/tag-helpers/intro#tag-helpers-compared-to-html-helpersFor unit testing purposes we could "rather easily" instantiate an HtmlHelper in ASP.NET MVC 5 (e.g., see https://stackoverflow.com/questions/25206507/unit-testing-htmlhelper-extension-method-fails/25216750#25216750). This is no longer the case in ASP.NET Core. Is there a utility or some other easy way to instantiate an HtmlHelper for a unit test?
5753	area-identity	Formalize interfaces for 2fa providers	Mail providers, text providers etc.
5024	area-mvc	SetNamespace does not work when Razor is extended by Mvc	Today the `builder.SetNamespace(...)` method does not work when registering MVC pieces on `RazorEngine` due to how it attempts to mutate the namespace. Today it tries to add a new document classifier to modify the namespace.For those watching this you can work around this issue by creating a new IR pass that changes the namespace. Example:```C#public class ChangeNamespacePass : IntermediateNodePassBase, IRazorDocumentClassifierPass{    public override int Order => 1100;    protected override void ExecuteCore(RazorCodeDocument codeDocument, DocumentIntermediateNode documentNode)    {        var @namespace = documentNode.FindPrimaryNamespace();        @namespace.Content = "TheNamespaceYouWant";    }}```
5752	area-identity	Revisit and tidy up TOTP flow	Must- [x] Ability to back out of rolling keys- [x] Forget this machine- [x] Link "remember this machine" to security stamp that gets bounced when key is regenerated- [x] Add ability to logout everywhere when key is regeneratedNice to Have- [ ] Ability to turn off individual 2fa providers- [ ] Support for multiple tokens (Yubikey etc)
5902	area-hosting	If one hosting startup class fails to execute, subsequent hosting startup classes defined in the assembly won't be executed.	This should probably have a low priority, because I don't know of any real assemblies that define multiple hosting startup classes.However, the order of attributes returned by `Assembly.GetCustomAttributes<HostingStartupAttribute>()` can affect whether or not a hosting startup class gets executed or not. It should also be trivial to fix.
5901	area-hosting	Unit tests fail if ASPNETCORE_ENVIRONMENT environment variable is set	I have a global `ASPNETCORE_ENVIRONMENT` environment variable on my PC set to "Development". With this, the unit tests no longer work.### Steps to reproduce```powershell$env:ASPNETCORE_ENVIRONMENT = "Development"cd .\test\Microsoft.AspNetCore.Hosting.Tests\dotnet test```One example test failure:```Fehler Microsoft.AspNetCore.Hosting.WebHostBuilderTests.DoNotCaptureStartupErrorsByDefaultFehlermeldung: Assert.Equal() Failure                                  (pos 32)Expected: ···hod named 'ConfigureProduction' or 'Configure' could not be f···Actual:   ···hod named 'ConfigureDevelopment' or 'Configure' could not be ···                                  (pos 32)Stapelverfolgung:   bei Xunit.Assert.Equal(String expected, String actual, Boolean ignoreCase, Boolean ignoreLineEndingDifferences, Boolean ignoreWhiteSpaceDifferences)   bei Xunit.Assert.Equal(String expected, String actual)   bei Microsoft.AspNetCore.Hosting.WebHostBuilderTests.DoNotCaptureStartupErrorsByDefault() in C:\src\github\aspnet\Hosting\test\Microsoft.AspNetCore.Hosting.Tests\WebHostBuilderTests.cs:Zeile 339.````A possible solution might be to clear any possible value in environment-specific tests with `Environment.SetEnvironmentVariable`?!Workaround: Clear/delete the environment variable manually (e.g. in the powershell window)Priority of this issue: very, very, very low :smile:
4773	area-servers	Kestrel error messages should include body size information with "Request body too large" exception	In HttpsSys, when the request body size was too large, it throws an exception with information about the size limits ex: `"System.IO.IOException: The request's Content-Length 15 is larger than the request body size limit 10."`while Kestrel's message is simply:`Microsoft.AspNetCore.Server.Kestrel.Core.BadHttpRequestException: Request body too large.`Kestrel should probably include this information. 
5900	area-hosting	Don't swallow IHostedService.StartAsync exceptions	As discussed briefly in https://github.com/aspnet/Hosting/issues/1085#issuecomment-305717425 I propose that the [HostedServiceExecutor](https://github.com/aspnet/Hosting/blob/dev/src/Microsoft.AspNetCore.Hosting/Internal/HostedServiceExecutor.cs#L24) should not catch exceptions in StartAsync.By swallowing exceptions, the hosting-layer forces all services to be optional which is undesired IMO. By not swallowing exceptions we give services the option to decide this on its own. If a service is truly optional, it can swallow exceptions in its own StartAsync code.I also think that StartAsync-exceptions should not be combined into an AggregateException. Instead it should just stop on the first exception.One thing to consider is that right now this code is executed AFTER the server has been started. Not sure what effects this has when exceptions are no longer caught?!I still hold the opinion that hosted services should be started before the server is started (a service could always decide to kick off another task in its StartAsync if it wants to be delayed) but this has also been discussed briefly in #1085 and declined.
4842	area-mvc	Add support for backing properties on activated types with cookies via a [CookieData] attribute	Equivalent to #6525 but using cookies as the backing store instead of `ViewData`. The data would remain set until the property value is null, at which point the cookie would be deleted.
4841	area-mvc	Add support for backing properties on activated types with Session via a [SessionData] attribute	Equivalent to #6525 but using Session as the backing store instead of `ViewData`
5023	area-mvc	Intellisense for CSS is lost when intermingling razor code in a style tag	When I try to write some CSS inline intermingling razor```            <style type="text/css">                .zone-@i {                }            </style>```Intellisense for the CSS rules is not being shown.
5279	area-signalr	Should SignalR pass a resource into IPolicyEvaluator?	MVC passes in the AuthorizationFilterContext.  SignalR should decide what resource is appropriate (if any)
5022	area-mvc	Consider allowing the debugger to stop on the closing curly brace of a block of code.	When I'm debugging a razor page and I have a block of code like this```Razor@{  ...  var variable = someExpresion;}```I would like to be able to stop the debugger at the closing curly brace in order to inspect the variable. A possible solution for this would be to insert a ';' statement at the end of each block of code and to map that statement to the corresponding closing curly brace;
4840	area-mvc	Improve validation for non-interactive consumption	Please improve validation to support consumption by code.This would in my opinion* allow supporting error codes or error tokens instead of just strings meant for human interpretation to communicate the type of error, * allow custom formatting of the resulting errors,* maintain and make available validation metadata (e.g. min/max, list of valid values or reference to a resource that allows obtaining them, etc)* make available the offending (property) values* would make it possible to build property paths of properties that offended validation and to parse them and use them in meaningful ways at the consumer end,* make it easier to replace the default infrastructure with something else, short of not using model binding or writing validation without using the built in support for itToday, the validation infrastructure that is for example used with model binding is based around string messages. Essentially, the [ModelError class](https://docs.microsoft.com/en-us/aspnet/core/api/microsoft.aspnetcore.mvc.modelbinding.modelerror) carries the error information and in the case where the model comes from a validation attribute, only the `ErrorMessage` property is set and it might contain a resource string in any language. This means that validation results aren't suitable for consumption other than to be presented as-is interactively.One case for this is Web API where the consumer is not a website or an app, but another service. And even if the consumer is a website or app and the errors are for interactive use, the client may still be able to handle or prevent a number of issues based on the codes or tokens and other metadata. Improving this story may also make client side validation easier, especially where it isn't being done by existing JavaScript.A very good case can also be made for services that are used by different consumers. The consumer can be made to decide what language is used by adding its own or overriding the service provided error messages, using the succinct type of error and any metadata and property values that might be carried.It also simplifies writing tests.#6549
5021	area-mvc	Consider moving some Razor functionality into a library independent from MVC	_From @tuespetre on May 1, 2016 3:55_I am currently working on a library that extends Razor by adding certain directives, removing others, and so forth. It will follow a pattern similar to MVC as far as:- Loading template files by following a default convention while allowing this convention to be altered or replaced- Compiling the template to an executable class with ExecuteAsync and whatnot- Utilizing some caching mechanism for performanceOverall I am extremely pleased with how easy it is to extend Razor now without taking on MVC as a  dependency. I just feel that the functionality outlined above that is currently implemented within MVC could be split into its own generic library independent of MVC to help facilitate the extension of Razor by other developers. **Edit:** The view file location expansion and caching mechanisms may be small and particular enough to exclude from this scope, but I feel that the compilation mechanism is complex enough to warrant separating it out; it does not appear to have any direct ties to MVC-related concepts, either._Copied from original issue: aspnet/Mvc#4569_
5020	area-mvc	Default injected chunks \ all @inject chunks need a way to be able to specify documentation	_From @pranavkm on August 27, 2015 22:28_For the few properties we inject by default the lack of documentation along with the mangled page name that appears in the property tooltip makes it appear less polished:#### MVC5![untitled](https://cloud.githubusercontent.com/assets/174281/9534640/ce4797aa-4cce-11e5-8350-de0ab95620ec.png)#### MVC6![untitled](https://cloud.githubusercontent.com/assets/174281/9534658/eddb4f30-4cce-11e5-9d4b-620afd8c896d.png)This would also be a problem for user injected properties, but less so._Copied from original issue: aspnet/Mvc#3050_
4839	area-mvc	Future Investments: Model Binding	This is a place for tracking feedback and related bugs for scoping future investments in Model Binding.### Related Issues#6109 Question: call ModelBinding manually?#4437 Using validation without model state and controller#6014 Using DI as a factory and **then** model binding the object#4718 Add a secure binding option to model binders#1786 Support binding immutable types by binding to the constructor
5019	area-mvc	Investigate owning editor projections and updates	Today the editor owns projections and its one of the most expensive aspects of the editor. We should see how much we can own.
4110	area-tooling	Support watching multiple projects from command-line	Make it possible to watch multiple csproj files that may not be connected in the P2P graph without having to create a "watch.proj" file.Usage: add `-p|--project` that takes multiple files.```dotnet watch -p Web/web.csproj -p Test/test.csproj```
4838	area-mvc	Add ability to use HTML generation features exclusive to expression-based helpers from within Tag Helpers	From within a Tag Helper with a `ModelExpression` property, it isn't possible to use the existing HTML generation features on `IHtmlHelper` etc. that accept `Expression<T>` due to the fact that the `ModelExpression` has no way of exposing the original `Expression<T>` given the Tag Helpers themselves cannot be generic. Instead. the `ModelExpression` provides access to a string-based representation of the expression (via `ModelExpression.Name`) and the generated `ModelExplorer`.Internally, MVC HTML generation methods now all ultimately use a `ModelExplorer` instance to determine the required info about the model and original expression, but these methods are either `protected` on `HtmlHelper`, or "pubternal". As a result, to use them from a Tag Helper, you need to do something like this: https://github.com/DamianEdwards/TagHelperPack/blob/56320336debf02f48b7aa96c8276d26b043fb844/src/TagHelperPack/HtmlHelperExtensions.cs#L22We should look at ways we can expose the full functionality of MVC's existing HTML generation features to Tag Helper authors, perhaps via new extension methods on `IHtmlHelper`, or something else. I specifically **do not** want to force Tag Helpers to be generic in order to achieve this, as we may want to enable generic Tag Helpers for other reasons later.@NTaylorMullen @dougbu @rynowak 
4671	area-security	Clarify behavior of CookieAuthenticationOptions.Cookie.Expiration	https://github.com/aspnet/Security/pull/1285 added `CookieAuthenticationOptions.Cookie.Expiration`, a nullable `TimeSpan`, but we still have `CookieAuthenticationOptions.ExpireTimeSpan`. Cookie.Expiration is ignored. We should clarify what Cookie.Expiration is meant to do and how it interacts with ExpireTimeSpan
5018	area-mvc	Make Razor Codegen warning safe	We weren't checking for warnings in the Razor tests that do compilation, which allows some warnings to slip through and break the build. We need to do some work to make sure we're clean.Currently known issues:- [x] test:_ViewImports_Runtime- [x] test:_ViewImports_DesignTime- [ ] find a way to run with actual compilation in more of our tests so we can find more
5899	area-hosting	Identify and fix tests that do synchronous request and response IO	In preparation for [defaulting AllowSynchronousIO to false](https://github.com/aspnet/KestrelHttpServer/issues/1928) we should identify and fix tests that call synchronous request and response Stream APIs.Most Universe functional tests use Hosting's TestHost which doesn't need to change to disallow synchronous IO, but doing so allows us to potentially identify use cases (such as [using DeflateStream](https://github.com/aspnet/BasicMiddleware/issues/247)) that make it difficult to avoid using synchronous IO.Below are the test project that I saw fail when I [modified TestHost](https://github.com/aspnet/Hosting/compare/halter73/no-sync) not to allow sync request and response stream operations (excluding Flush). [Here's the output showing each failed test](https://gist.github.com/halter73/76e719b92884af65299e3aac96595f91).```[xUnit.net 00:00:04.0099135]   Finished:    Microsoft.AspNetCore.TestHost.TestsTotal tests: 51. Passed: 47. Failed: 4. Skipped: 0.[xUnit.net 00:00:01.8295296]   Finished:    Microsoft.AspNetCore.Buffering.TestsTotal tests: 8. Passed: 7. Failed: 1. Skipped: 0.[xUnit.net 00:00:03.3003836]   Finished:    Microsoft.AspNetCore.ResponseCaching.TestsTotal tests: 269. Passed: 231. Failed: 38. Skipped: 0.[xUnit.net 00:03:20.8983023]   Finished:    ServerComparison.FunctionalTestsTotal tests: 57. Passed: 34. Failed: 5. Skipped: 18.[xUnit.net 00:00:03.9879504]   Finished:    Microsoft.AspNetCore.Diagnostics.TestsTotal tests: 75. Passed: 63. Failed: 12. Skipped: 0.[xUnit.net 00:00:05.7808313]   Finished:    Microsoft.AspNetCore.Authentication.TestTotal tests: 224. Passed: 198. Failed: 24. Skipped: 2.[xUnit.net 00:00:40.4557444]   Finished:    Microsoft.AspNetCore.Mvc.FunctionalTestsTotal tests: 1015. Passed: 701. Failed: 314. Skipped: 0.[xUnit.net 00:00:03.8723760]   Finished:    Microsoft.AspNetCore.Identity.InMemory.TestTotal tests: 190. Passed: 186. Failed: 4. Skipped: 0.[xUnit.net 00:03:16.7483553]   Finished:    Entropy.FunctionalTestsTotal tests: 270. Passed: 135. Failed: 25. Skipped: 110.```
5874	area-servers	Disable AllowSynchronousIO by default	In https://github.com/aspnet/HttpSysServer/issues/366 we introduced AllowSynchronousIO, but found it was too breaking to enable by default. Reconsider in the next major release.
4774	area-servers	Change KestrelServerOptions.AllowSynchronousIO default to false	KestrelServerOptions.AllowSynchronousIO is going to default to true for 2.0.0. Hopefully we can change this to false in our next major release.https://github.com/aspnet/Announcements/issues/252#issuecomment-312058065@muratg @Tratcher  We'll probably want to file a similar issue for HttpSysServer.
5898	area-hosting	Add support for specifying the PathBase for all requests	As a follow up from https://github.com/aspnet/Hosting/issues/815, we want to allow specifying the path base as a host setting. Hosting should use this to call `UsePathBase` as the first middleware in the pipeline. IISIntegration does something similar with the `APPL_PATH ` env variable : https://github.com/aspnet/IISIntegration/blob/51554566532237ef76cb105ec5b3f7a5050b9ba4/src/Microsoft.AspNetCore.Server.IISIntegration/WebHostBuilderIISExtensions.cs#L19.
4837	area-mvc	Add a PreLoadSession Attribute/Filter with a timeout parameter	Session is assumed to be stored as a distributed resource so loading it should be done asynchronously. ISession has a LoadAsync API but nobody calls it today. If you access the values then it loads synchronously inline.Proposal: Add a PreLoadSession Attribute/Filter with an optional timeout, and perhaps an option to continue or fail if session is unavailable. This could be applied per action, controller, or globally. When run this filter would call ISession.LoadAsync.RE: https://github.com/aspnet/Session/issues/158
5751	area-identity	Revisit RequireConfirmedEmail behavior/design	Related: https://github.com/aspnet/Templates/issues/832#issuecomment-311758344We also should rationalize if we need a concept of AccountConfirmation which a more generic class what EmailConfirmation is today.- Should this flag affect external login providers, or only password flows?- Do we need a AccountDisabled flag that replaces this for use in ExternalSignIns?Do we need to do anything here for 2.0 or can this wait til 2.1?  @ajcvickers @blowdart 
5017	area-mvc	Having breakpoints in cshtml files that are not open in the editor breaks debugging	Steps to reproduce:- Create a new Web application- Add a breakpoint in `Index.cshtml`![image](https://user-images.githubusercontent.com/1579269/27502798-9c4785d4-582b-11e7-969b-2aa2f4bcf016.png)- Close the file in the editor- Press F5 to run the app- Press F5 again when the breakpoint is hit![image](https://user-images.githubusercontent.com/1579269/27502830-e852308c-582b-11e7-8fc7-220c70d9c12e.png)I think this is probably a tooling issue but I am not sure.VS version: 26621.2.d15rel
5016	area-mvc	Expose a way to have a sanitized class name when writing your own document classifier	When attempting to create a document classifier you typically want to re-use Razor's class name sanitization logic. The problem is that [API is internal]((https://github.com/aspnet/Razor/blob/d2469e078a649bb10b423e73427ede1a4606a4d0/src/Microsoft.AspNetCore.Mvc.Razor.Extensions/CSharpIdentifier.cs)) and we hardcode the behavior in our Mvc view and page classifier passes.I suggest we do one of the following:- By default create a class name off of the current file path.- Expose `CSharpIdnetifier` as public instead of internal.
6000	area-middleware	Batch support	_From @rosieks on January 8, 2015 17:19_ASP.NET WebAPI 2 introduced support for batching. There was issue for batch implementation in Mvc but it was closed: https://github.com/aspnet/Mvc/issues/508Despite that it would be great to have this usefull feature._Copied from original issue: aspnet/Home#262_
5015	area-mvc	Misaligned breakpoint highlighting	I spoke to @NTaylorMullen about this. Even though there are certain situations where it's not possible to align the breakpoint highlighting, this apparently isn't one of them.The following would look correct to me if the highlighting was shifted two columns to the right but I'm not sure if the `<p>` tags are meant to be highlighted.![image](https://user-images.githubusercontent.com/54385/27247611-23fea1ce-52af-11e7-83ad-138ab4d1df57.png)
4092	area-tooling	Add a manual trigger to dotnet watch to restart?	Could we add some key code that we type in to the terminal to force `dotnet watch` to restart the app. I'm thinking along the lines of SIGHUP to trigger dotnet watch to restart. This way if I edit a file not being watched I don't have to Ctrl+C and then run watch again. One use case: when I edit config files like appsettings.json it would be nice to restart without adding a custom rule for this. 
4107	area-tooling	Consider setting background color when writing output	If you set the foreground color it would be a good idea to also set the background color to prevent users console color settings from making the output invisible.![temp](https://user-images.githubusercontent.com/7574801/27236158-9f05e5ee-5278-11e7-8e52-d743747adc29.PNG)![temp](https://user-images.githubusercontent.com/7574801/27236245-0a8bb028-5279-11e7-9c74-6547e489846c.PNG)For example in the console logger we do https://github.com/aspnet/Logging/blob/dev/src/Microsoft.Extensions.Logging.Console/ConsoleLogger.cs#L224-L237
5750	area-identity	Improvement for external provider flow when user already has local account	Hi:I am testing the case where a user creates a local account (e.g., test@gmail.com) and comes back to the site a time after and does not remember if it created a local account or used a external provider (e.g., Google), so it decides to attempt to login with its Google account; or simply, a user that does not remember its password and he hates the password recovery process so it decides to attempt to login with its Google account.In such scenario, when the user attempts to login with Google, it gets to /Account/ExternalLoginCallback , which shows "Register", "Associate your Google account", "You've successfully authenticated with Google".When the user clicks Register button, without changing its email test@gmail.com, it gets the error message "User name 'test@gmail.com' is already taken", and the message "You've successfully authenticated with" [which LACKS the provider name Google ]. (to solve this small issue, instead of persisting the LoginProvider in ViewData I included it in ExternalLoginConfirmationViewModel and used a input/hiiden in the form)I believe this flow is not appropriate for this case because obviosly this user does not want to Register, so I think that when a user coming from an external provider attemps to login for the first time (that it seems to be registering to the service), the system should verify if the email account is already taken because in such case there is a high probability that the user is not attempting to create another account in the system but to login to its account. So, if taken, there should be a different flow that helps the user link the external provider to its account, or at least give options :Do you want to create a new account OR link your "Google" account to the existing account for test@gmail.com?Hope this helps improve the system.Thanks
5014	area-mvc	Introduce [OutputAttributeHint] to allow attributes to function as known HTML attributes when used in the editor	_From @stap123 on June 12, 2017 9:13_When using the <a> tag helper and a target attribute simultaneously VS2017 gives a warning saying "Attribute is allowed only when 'href' is present".  I guess it's pretty obvious why it's happening as it tells us but not sure it's the desired behaviour.Example of tag:```<a class="list-group-item" asp-controller="Home" asp-action="CPDRedirect" asp-route-id="2" target="_blank">View all activities</a>```This is obviously not stopping anything working but thought you might like to know (and it's a little annoying to have warnings when there isn't anything wrong).If this isn't the correct repo, can you let me know the correct one and I will raise there._Copied from original issue: aspnet/Mvc#6391_
5749	area-identity	Consider splitting SignInResult.NotAllowed into SignInResult.EmailConfirmationRequired and SignInResult.PhoneNumberConfirmationRequired	`SignInResult.NotAllowed` is used in one place herehttps://github.com/aspnet/Identity/blob/dev/src/Microsoft.AspNetCore.Identity/SignInManager.cs#L748 .It does not distinguish between `IsEmailConfirmedAsync ` and `IsPhoneNumberConfirmedAsync`.Distinguishing will make the code cleaner as it becomes more precise in returning signin results to the dev and then the end UI user (see discussion here https://github.com/aspnet/Identity/issues/1265).We could remove `SignInResult.NotAllowed` and do instead`SignInResult.EmailConfirmationRequired`and `SignInResult.PhoneNumberConfirmationRequired`together with the correct Boolean flags to be caught in e.g. a Login Action.I am aware that redefining the return type will propagate through methods, but it should not be too difficult. `PreSignInCheck` will become cleaner and we could profit from this to make `PasswordSigninAsync` cleaner as per the discussion in the referenced thread above. I can attempt a PR if you wish and even update the ASP.NET Identity Template. Let me know, otherwise I will stop proposing changes as I do not really need it for my own. Cheers
5748	area-identity	still get ArgumentException: Options.ClientId must be provided Parameter name: ClientId with latest Template 	Template ASPNET Core MVC Authentication Individual with latest version of VS2017 enterprise Version 15.3.0 Preview 2. The same error happens each time I simple press F5 or Ctrl+F5:> ArgumentException: Options.ClientId must be provided Parameter name: ClientIdThe appsettings.json contains the clientId, so I don't get it`"Authentication": { "IdentityService": { "ClientId": "D67625E3-714E-4A2E-9E1E-365AB5744B05", "TokenRedirectUrn": "urn:self:aspnet:identity:integrated" }````<ItemGroup>    <PackageReference Include="Microsoft.AspNetCore.All" Version="2.0.0-preview2-25149" />    <PackageReference Include="Microsoft.EntityFrameworkCore.Tools" Version="2.0.0-preview2-25149" PrivateAssets="All" />    <PackageReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Design" Version="2.0.0-preview2-25149" PrivateAssets="All" />  </ItemGroup>  <ItemGroup>    <DotNetCliToolReference Include="Microsoft.EntityFrameworkCore.Tools.DotNet" Version="2.0.0-preview2-25149" />    <DotNetCliToolReference Include="Microsoft.Extensions.SecretManager.Tools" Version="2.0.0-preview2-25149" />    <DotNetCliToolReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Tools" Version="2.0.0-preview2-25149" />  </ItemGroup>``````Product Information: Version:            2.0.0-preview2-006215 Commit SHA-1 hash:  e67962b0deRuntime Environment: OS Name:     Windows OS Version:  10.0.16199 OS Platform: Windows RID:         win10-x64 Base Path:   C:\Users\vrith\.dotnet\x64\sdk\2.0.0-preview2-006215\Microsoft .NET Core Shared Framework Host  Version  : 2.0.0-preview2-25319-02  Build    : 7983b575ebcbdc3a825eea4b141ff7fb69d25f9d```ps:Guys, I know this is a preview, but it could be cool to get a working template when we try to learn stuff.  ;-)Thanks
4775	area-servers	Finalization throw error on UvHandle.ReleaseHandle kill process	Just got (using 1.1.2) we just got this error.I know that there was an issue of this being thrown during dispose, but this is raised from the finalizer.```Unhandled Exception: System.ObjectDisposedException: Safe handle has been closed   at System.Runtime.InteropServices.SafeHandle.DangerousAddRef(Boolean& success)   at System.StubHelpers.StubHelpers.SafeHandleAddRef(SafeHandle pHandle, Boolean& success)   at Microsoft.AspNetCore.Server.Kestrel.Internal.Networking.Libuv.NativeMethods.uv_async_send(UvAsyncHandle handle)   at Microsoft.AspNetCore.Server.Kestrel.Internal.Networking.Libuv.async_send(UvAsyncHandle handle)   at Microsoft.AspNetCore.Server.Kestrel.Internal.KestrelThread.PostCloseHandle(Action`1 callback, IntPtr handle)   at Microsoft.AspNetCore.Server.Kestrel.Internal.Networking.UvHandle.ReleaseHandle()   at Microsoft.AspNetCore.Server.Kestrel.Internal.Networking.UvStreamHandle.ReleaseHandle()   at System.Runtime.InteropServices.SafeHandle.InternalFinalize()   at System.Runtime.InteropServices.SafeHandle.Finalize()```
4157	area-platform	Add a check to the targets file to ensure the ASP.NET Package Graph is consistent	We want to ensure that users aren't "hoisted" out of the supported package graph accidentally. For example, consider the following package graph:* `App`  * `Microsoft.AspNetCore.All 2.0.0`    * `Microsoft.AspNetCore.Mvc 2.0.0`      * `Microsoft.AspNetCore.Hosting.Abstractions 2.0.0`  * `SomeCoolLibrary`    * `Microsoft.AspNetCore.Hosting.Abstractions 2.1.0`In this scenario, `Microsoft.AspNetCore.Hosting.Abstractions 2.1.0` will be selected, but `Microsoft.AspNetCore.Mvc` will remain at `2.0.0`, thus putting the user into an unsupported configuration.To fix this, we should add targets to our MSBuild files in `Microsoft.AspNetCore.All` to traverse the final resolved list of package references and make sure they are consistent. The algorithm for this is simple1. Find `Microsoft.AspNetCore.All` in the final resolved package list (i.e. assets file, or whatever MSBuild representation exists) and identify the version number of that package2. For each ASP.NET package (known by the metapackage, since it was built from this list, so we can hard-code it), ensure that the version number matches that value.3. If any package in the ASP.NET set does not match the version number of `Microsoft.AspNetCore.All`, emit a warning (which could be elevated to an Error via `WarningsAsErrors` or suppress using `NoWarn` globally)Also, we could consider reading the `%(NoWarn)` metadata item on `PackageReference` items, like NuGet is doing for it's downgrade warnings, to allow a user to override this warning for specific packages.
5747	area-identity	Illogical flow for PasswordSignInAsync through PreSignInCheck when RequireConfirmedEmail = true	App Requirement: require confirmed email before user can login.When you require a confirmed email in `Startup.cs`, checking whether the email is confirmed or not makes little sense until the POST username and pwd match what is in the DB. The current flow for login violates this because `PasswordSignInAsync` calls `PreSignInCheck` prior to `CheckPasswordAsync`, an order which makes sense only for checking `LockOut ` but not for email confirmation. `PreSignInCheck` will return ` SignInResult.NotAllowed` for an unconfirmed email.This flow makes it unnatural to fulfil the following likely scenario:-User registers and an email is sent to him. He never receives this email or forgets to confirm it.-He tries nevertheless to login, and enters the **correct credentials** . -Since he entered the correct credentials, we can reveal to him that he should first confirm his email before we persist the cookie and we could propose him to resend a confirmation email. This flow will be safer than the one in the docs because the user entered the correct credentials (hence confirming his identity)I tried to override `PasswordSignInAsync `but I hit `SignInOrTwoFactorAsync`, which is private.The more natural way to avoid unnecessary code checks would be something around the following for `CheckPasswordSignInAsync````user IsLockedOut?       Yes-->NotAllowed       No-->ContinueUserName and Password Match?       Yes -->EmailConfirmed?                   -->Yes-->Success                   -->No-->result="EmailNotConfirmedYet"       No--> LockoutIncrement```PhoneNumber confirmation not mentioned. Unfortunatly the `SignInResult ` may need to be extended to become more granular such that `NotAllowed ` becomes split into```--UnconfirmedEmail--UnconfirmedPhone```
5999	area-middleware	app.UseForwardedHeaders gives different result when run in container	_From @singlewind on June 5, 2017 1:24_We use SSL termination on Load balancer, so we use the following code to handle proper redirection of https and url generation.```app.UseForwardedHeaders(new ForwardedHeadersOptions            {                ForwardedHeaders = ForwardedHeaders.XForwardedFor | ForwardedHeaders.XForwardedProto            });```When debug in windows, it behaves as expected. Even the protocol from LB is http, it will displays https.![windows](https://cloud.githubusercontent.com/assets/7637/26767182/bd168fe8-49e0-11e7-9cd1-af4a30623e28.PNG)However, when it hosts inside a container based on image microsoft/aspnetcore:1.1 it fails.![linux-container](https://cloud.githubusercontent.com/assets/7637/26767197/fd91d622-49e0-11e7-9258-6254250919e3.PNG)I reckon it can be a deep issue of Kestrel._Copied from original issue: aspnet/Mvc#6360_
5745	area-identity	Add extension method overloads that take a specific config section to bind to 	By default the identity service has a default config schema, but you should be able to specify a specific config section to bind to.
5744	area-identity	Consider renaming Identity.EntityFrameworkCore from AspNet => Extensions	If we move IdentityBuilder to Core, nothing in the EF store implementation depends on AspNet, so we should consider making that clear in the package (and maybe namespace?).
5743	area-identity	IdentityServiceApplication Generic Type Parameter Issue	The "IdentityServiceApplication" class has a generic constraint of  "where TUserKey : IEquatable<TUserKey>". This constraint prevents you from defining TUserKey as System.Nullable&lsaquo;Guid&rsaquo; The override IdentityServiceDbContext.OnModelCreating" has the foreign key defined as optional, and EF requires the TUserKey column to be nullable. 
5742	area-identity	Consider updating IdentityUserClaim to store the claim value type	> Be aware that ASP.NET Identity doesn’t store claim value types, so even in cases where the claim is always an integer (as in this example), it will be stored and returned as a string. Later in this post, I explain how non-string claims can be included in JWT tokens.https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/
4672	area-security	Support for token revocation on SignOut in OAuthMiddleware	To invalidate refresh tokens when the user signs out, it would be great if the OAuthMiddleware could support OAuth 2.0 Token Revocation ([RFC 7005](https://tools.ietf.org/html/rfc7009)).Related to #1236, I'm interested to consider a PR to add this support.
4673	area-security	Improve support for bearer token authentication	The current JwtBearer middleware is pretty limited.We need support for scenarios where an API can accept different token formats - e.g. JWT and reference token (both would use the bearer scheme on the authorization header).What we need is * general purpose "bearer token authentication middleware"   * retrieves tokens from the rfc6750 specified locations   * all the necessary validation etc   * proper eventing model to retrieve tokens from other locations etc* extensible token validation infrastructure   * they probably need to come from DI because they need support for other dependencies like caching etc   * they need access to the "top level" options - e.g. the discovery document
4776	area-servers	Support cipher suite configuration	As I understand, Kestrel 2 will be considered "safe" for edge deployments with HTTPS. Currently, there is no way to easily configure many desirable parameters of HTTPS. Mainly, the cipher suites that are supported, the algorithm and key size of the key exchange, etc.For Windows, the functionality is configured the same as it was with IIS - with the registry / group policy. For Linux, I'm not exactly sure how to change the configuration, or if it can be done at all. I suspect it will just use OpenSSL's default in the distribution. If that is not the case, then I would be keen in knowing how to do it.The Windows configuration by registry for SChannel leaves a lot to be desired. Changing SChannel's default configuration is not just for IIS or Kestrel - it affects anything that uses SChannel (remote desktop for example).For edge deployments, it is naturally desirable to want to configure the cipher suites. There is a lot of pressure and mandate to start turning off old versions of TLS and strengthening cipher suite configuration, ensuring poor symmetric cipher are disabled, like 3DES, etc. Setting a preferred order is also important. Most web servers will prioritize AES128 over AES256 for performance, while some customers may wish to trade off the performance for security.Even for internal traffic use, this is still very useful. Internal TLS is important, and because the traffic is internal to my infrastructure, I can mandate it to be whatever I want, such as TLS 1.2 only and ECDHE-AES-GCM-128 and not have to worry about client compatibility.
4777	area-servers	Graceful handling of connection limits	When maximum connection limits are reached, Kestrel closes the connection without a response. When attempting upgrade, Kestrel throws. We could make this behavior more graceful in the following waysIdeas: - try to kill idle connections before rejecting or throwing (TBD: what counts as idle?) - send a HTTP 503 response when connection limits reached (TBD: what about TLS connections? Do we wait for a potentially expensive handshake? Is there a TLS equivalent to 503?) - allow connection adapters to participate in the 503 rejection (i.e. for logging or other reasons)
4778	area-servers	Typed event ids	Logging events are manually defined right now. We could make it easier work with by putting them in a type. Plus, it helps us avoid unintentionally creating conflicting ids.The vision:```c#public static class Microsoft.AspNetCore.Server.Kestrel.Diagnostics.CoreEventIds{    public static readonly EventId ConnectionStart;    public static readonly EventId ConnectionStop;    //... etc}```[See this example](https://github.com/aspnet/EntityFramework/blob/5b894d9edf8aecd240629a4ee6149470353a65f1/src/EFCore/Diagnostics/CoreEventId.cs) from EF
5897	area-hosting	Add IAsyncStartup and IAsyncStartupFilter to support async startup classes and filters	We should introduce a new set of interfaces: `IAsyncStartup` and `IAsyncStartupFilter` with the following API surface:```csharp    public interface IAsyncStartup    {        IServiceProvider ConfigureServices(IServiceCollection services);        Task ConfigureAsync(IApplicationBuilder app);    }    public interface IAsyncStartupFilter    {        Func<IApplicationBuilder, Task> Configure(Func<IApplicationBuilder, Task> next);    }```Startup classes will now support a `Task ConfigureAsync(IApplicationBuilder app)` method, which is **mutually exclusive** with `void Configure(IApplicationBuilder app)`. It shall be an error to have both methods on a startup class.`IAsyncStartup` and `IAsyncStartupFilter` will be the primitives used by the entire Hosting pipeline. Adapters will exist in Hosting to allow the continued use of `IStartup` and `IStartupFilter` in the public API surface (to reduce breaking changes).
5741	area-identity	Updating Default DbContext and models in MVC Individual Accounts auth template - ASP.NET Core 2.0 preview 1	I created default MVC app with auth for individual accounts. I added some models in IdentityServiceDbContext and tried to add the migration.Running`dotnet ef migrations add Initial`produces the following error:> System.InvalidOperationException: Cannot resolve scoped service 'MvcAuth.Identity.Data.IdentityServiceDbContext' from root provider.>    at Microsoft.Extensions.DependencyInjection.ServiceLookup.CallSiteValidator.ValidateResolution(Type serviceType, ServiceProvider serviceProvider)>    at Microsoft.Extensions.DependencyInjection.ServiceProvider.GetService(Type serviceType)>    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService(IServiceProvider provider, Type serviceType)>    at Microsoft.Extensions.DependencyInjection.ServiceProviderServiceExtensions.GetRequiredService[T](IServiceProvider provider)>    at MvcAuth.Identity.Data.IdentityServiceDbContextFactory.Create(String[] args) in C:\Users\coder\Documents\Visual Studio 2017\Projects\MvcAuth\MvcAuth\Areas\IdentityService\Data\IdentityServiceDbContextFactory.cs:line 13>    at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.<>c__DisplayClass10_0.<FindContextTypes>b__3()>    at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(Func`1 factory)>    at Microsoft.EntityFrameworkCore.Design.Internal.DbContextOperations.CreateContext(String contextType)>    at Microsoft.EntityFrameworkCore.Design.Internal.MigrationsOperations.AddMigration(String name, String outputDir, String contextType)>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigrationImpl(String name, String outputDir, String contextType)>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.AddMigration.<>c__DisplayClass0_1.<.ctor>b__0()>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.<>c__DisplayClass3_0`1.<Execute>b__0()>    at Microsoft.EntityFrameworkCore.Design.OperationExecutor.OperationBase.Execute(Action action)> Cannot resolve scoped service 'MvcAuth.Identity.Data.IdentityServiceDbContext' from root provider.How do I run migrations once I update dbcontext and models?
5013	area-mvc	Support quick action in razor for adding using statements	_From @danroth27 on May 22, 2017 22:19_It would be nice if you could use a quick action (ctrl-. or whatever) to add a using statement for a type in Razor. _Copied from original issue: aspnet/Mvc#6309_
5740	area-identity	Provide Sign-in & Sign-up UI that works with MSAL in native clients	Looks like the browser used by MSAL for native clients (like WPF) is a bit of an antique (IE7 or something similar). We will need to make sure our sign-in & sign-up UI works in this scenario.
5739	area-identity	Consider enriching client validation interfaces	These interfaces essentially return booleans. We should consider returning result types instead so that we can be more descriptive about why a specific validation failed or to provide extra information based on the validation.
5738	area-identity	Use Async suffix for async methods	IAuthorizationResponseParameterProvider.AddParametersITokenResponseParameterProvider.AddParameters
5737	area-identity	Fix JsonTextWriter usage if necessary	MVC had the following issue filed:aspnet/Mvc#5413Json.Net 10.0.1 has a property on JsonTextWriter which fixes thishttp://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonWriter_AutoCompleteOnClose.htmIdentityService currently uses text writer in a few places. Check if these locations need to be fixed too.
5278	area-signalr	Client side hubs: Create a binder where you can pass a type and it will register methods as callbacks	The idea is to allow implementing a class that handles callbacks on the client side. ### Server```C#public interface IStockTicker{    Task SendPrice(string symbol, decimal price);}public class TickerHub : Hub<IStockTicker>{     public Task UpdatePrice(string symbol, decimal price) => Clients.All.SendPrice(symbol, price);}```### ClientTraditional```C#public void Main(){      var hubConnection = new HubConnection();      hubConnection.On<string, decimal>("SendPrice", (symbol, price) =>      {          Console.WriteLine($"Symbol: {symbol}, Price: {price}");      });     // Do the needful }```New ```C#public class StockTicker : IStockTicker{   public  async Task SendPrice(string symbol, decimal price)   {        await Console.Out.WriteLineAsync($"Symbol: {symbol}, Price: {price}");   }}public void Main(){      var hubConnection = new HubConnection<StockTicker>();     // Do the needful }```Forked from #311 Open questions:- The API to wire up callbacks needs work.- Do we support dependency injection? - How do you handle running on the sync context etc?
4836	area-mvc	Razor views cannot declare a custom base type and a model	Based on https://github.com/aspnet/Mvc/issues/5397Currently, the way to specify a custom base type for a view and a model involves specifying the `@inherits` keyword in a `_ViewImports.cshtml`:`@inherits MyBaseType<TModel>`and specifying the model in the page:`@model MyModel`Specifying the two in the same page results in a parse error: `The 'inherits' keyword is not allowed when a 'model' keyword is used.`. Using `_ViewImports` is limiting here,a. It does not allow specifying more than one base type per directoryb. not being able to contain all the definition information in a single view file makes it less portable when using our modular framework (e.g. we can have views defined in plugin assemblies)
5012	area-mvc	Parser options should have the ability to parse all leading directives	Currently we parse just the first leading directive, we should parse all *simple* directives before the first markup or code block.
5736	area-identity	Find a place for everything in the identity area Extensions folder	Basically all this stuff in the templates needs to move into this package:https://github.com/dotnet/templating/tree/rel/vs2017/3-Preview2/template_feed/Microsoft.DotNet.Web.ProjectTemplates.2.0/content/StarterWeb-CSharp/Areas/IdentityService/Extensions
5735	area-identity	Find a place for the ClientInfoProvider	
5734	area-identity	Simplify setup of ambient claims by providing defaults	
5733	area-identity	Consider renaming the Identity.Service packages	Rename to avoid confusion with IdentityServerAlso make clearer the alignment with Azure AD B2C (without implying a dependency on it)
5732	area-identity	Add the ability for getting users having a type of claim	The UserManager exposes the method GetUsersForClaimAsync(Claim claim).This method takes a claim and returns a list of users with that claim.Sometimes it is needed to find all users by a specific claim type, ignoring the value.A method like GetUsersForClaimTypeAsync(string claimType) would be great.It would need to be added to the IUserClaimStore<TUser> interface, and thus the UserStore(s) too.Doing this by inheritance is a pain since the UserClaims property is private.Otherwise a slightly modified query as from the GetUsersForClaimAsync is all that is needed, where claimType is a string.`            var query = from userclaims in UserClaims                        join user in Users on userclaims.UserId equals user.Id                        where userclaims.ClaimType == claimType                        select user;`
4835	area-mvc	CSS link helper tag with fallback class not working with subclasses	The [bootstrap-dialog.css](https://cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.35.4/css/bootstrap-dialog.css) stylesheet does not have any classes that are single non subclasses. The below taghelper is not working.```html<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/bootstrap3-dialog/1.35.4/css/bootstrap-dialog.min.css"      asp-fallback-href="~/lib/bootstrap3-dialog/dist/css/bootstrap-dialog.min.css"      asp-fallback-test-class="bootstrap-dialog modal-header"      asp-fallback-test-property="border-top-left-radius"      asp-fallback-test-value="4px" />```
4834	area-mvc	[Discussion] Microsoft Security Advisory 4021279: Vulnerabilities in .NET Core, ASP.NET Core Could Allow Elevation of Privilege 	# Microsoft Security Advisory 4021279: Vulnerabilities in .NET Core, ASP.NET Core Could Allow Elevation of Privilege## Executive SummaryMicrosoft is releasing this security advisory to provide information about vulnerabilities in public .NET Core and ASP.NET Core. This advisory also provides guidance on what developers can do to update their applications correctly..NET Core & ASP.NET Core are the next generation of .NET that provide a familiar and modern framework for web and cloud scenarios. These products are actively developed by the .NET and ASP.NET team in collaboration with a community of open source developers, running on Windows, Mac OS X and Linux. When .NET Core was released, the version number was reset to 1.0.0 to reflect the fact that it is a separate product from its predecessor -.NET.## DiscussionTo discuss the ASP.NET Core issues please see https://github.com/aspnet/Mvc/issues/6246To discuss the CoreFX Core issues please see https://github.com/dotnet/corefx/issues/19535## Issue CVEs and DescriptionCVE	| Description----|-------------[CVE-2017-0248](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0248) | Security Feature Bypass[CVE-2017-0247](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0247) | Denial of Service[CVE-2017-0249](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0249) | Elevation of Privilege [CVE-2017-0256](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0256) | Spoofing## Affected SoftwareThe vulnerabilities affect any Microsoft .NET Core project if it uses the following affected package versions.Package name | Package versions | Fixed package versions---------------- | ------------------- | -------------------------System.Text.Encodings.Web | 4.0.0<br />4.3.0  | 4.0.1<br />4.3.1System.Net.Http | 4.1.1<br />4.3.1  | 4.1.2<br />4.3.2|System.Net.Http.WinHttpHandler | 4.0.1<br />4.3.0 |  4.0.2<br />4.3.1System.Net.Security | 4.0.0<br />4.3.0 |  4.0.1<br />4.3.1System.Net.WebSockets.Client | 4.0.0<br />4.3.0 |  4.0.1<br />4.3.1Microsoft.AspNetCore.Mvc | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Core | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Abstractions | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.ApiExplorer | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Cors | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.DataAnnotations | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Formatters.Json | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Formatters.Xml | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Localization | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Razor.Host | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.Razor | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.TagHelpers | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.ViewFeatures | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3Microsoft.AspNetCore.Mvc.WebApiCompatShim | 1.0.0, 1.0.1, 1.0.2, 1.0.3<br />1.1.0, 1.1.1, 1.1.2 |  1.0.4<br />1.1.3## Advisory FAQ### How do I know if I am affected? .NET Core and ASP.NET Core have two types of dependencies: direct and transitive. If your project has a direct or transitive dependency on any of the packages and versions listed above, you are affected.Note: As part of patching ASP.NET Core MVC we update every Microsoft.AspNetCore.Mvc.* package. If, for example, you have a dependency on `Microsoft.AspNetCore.Mvc` you should update to the appropriate version first (1.0.x should be updated to 1.0.4, 1.1.x should be updated to 1.1.3), and it will also update any other vulnerable ` Microsoft.AspNetCore.Mvc` dependency.### NET Core Project formats.NET Core has two different project file formats, depending on what software created the project. 1. `project.json` is the format used in .NET Core 1.0 and Microsoft Visual Studio 2015.2. `csproj` is the format used in .NET Core 1.1 and Microsoft Visual Studio 2017.  	You must ensure you follow the correct update instructions for your project type.### Direct DependenciesDirect dependencies are dependencies where you specifically add a package to your project. For example, if you add the `Microsoft.AspNetCore.Mvc` package to your project then you have taken a direct dependency on` Microsoft.AspNetCore.Mvc`.Direct dependencies are discoverable by reviewing your `project.json` or `csproj` file.### Transitive DependenciesTransitive dependencies occur when you add a package to your project that in turn relies on another package. For example, if you add the `Microsoft.AspNetCore.Mvc` package to your project it depends on the `Microsoft.AspNetCore.Mvc.Core` package (among others). Your project has a direct dependency on `Microsoft.AspNetCore.Mvc` and a transitive dependency on the `Microsoft.AspNetCore.Mvc.Core` package.Transitive dependencies are reviewable in the Visual Studio Solution Explorer window, which supports searching, or by reviewing the `project.lock.json` file contained in the root directory of your project for `project.json` projects or the `project.assets.json` file contained in the obj directory of your project for `csproj` projects. These files are the authoritative list of all packages used by your project, containing both direct and transitive dependencies.## How do I fix my affected application?You will need to fix both direct dependencies and review and fix any transitive dependencies. The affected packages and versions in the previous “Affected Software” section include each vulnerable package, the vulnerable versions, and the patched versions---**Note**: If you are using ASP.NET Core MVC in your projects you should first update the `Microsoft.AspNetCore.Mvc` version according to the affected versions table above. If you are currently using version 1.0.0, 1.0.1, 1.0.2 or 1.0.3 you should update your package version to 1.0.4. If you are using version 1.1.0, 1.1.1 or 1.1.2 you should update your package version to 1.1.3. This will update every MVC package to the fixed versions.---### Fixing Direct Dependencies – project.json/VS2015Open your `project.json` file in your editor. Look for the dependencies section. Below is an example dependencies section:``` json    "dependencies": {      "Microsoft.NETCore.App": {        "version": "1.0.1",        "type": "platform"      },     "Microsoft.AspNetCore.Server.Kestrel": "1.0.1",     "Microsoft.AspNetCore.Mvc ": "1.0.1",    }```This example has three direct dependencies: `Microsoft.NETCore.App`, `Microsoft.AspNetCore.Server.Kestrel` and `Microsoft.AspNetCore.Mvc`. `Microsoft.NetCore.App` is the platform the application targets, you should ignore this. The other packages expose their version to the right of the package name. In our example, our non-platform packages are version 1.0.1.Review your direct dependencies for any instance of the packages and versions listed above. In the example above, there is a direct dependency on one of the vulnerable packages, `Microsoft.AspNetCore.Mvc` version 1.0.1.To update to the fixed package, change the version number to be the appropriate package for your release. In the example, this would be updating `Microsoft.AspNetCore.Mvc` to 1.0.4.After updating the vulnerable package versions, save your `project.json` file.The dependencies section in our example `project.json` would now look as follows:```json  "dependencies": {    "Microsoft.NETCore.App": {      "version": "1.0.1",      "type": "platform"    },    "Microsoft.AspNetCore.Server.Kestrel": "1.0.1",    "Microsoft.AspNetCore.Mvc": "1.0.4",       }```If you are using Visual Studio and save your updated `project.json` file, Visual Studio will restore the new package version. You can see the restore results by opening the Output Window (Ctrl+Alt+O) and changing the Show output from drop-down list to Package Manager.If you are not using Visual Studio, open a command line and change to your project directory. Execute the `dotnet restore` command to restore your new dependency.After you have addressed all of your direct dependencies, you must also review your transitive dependencies.### Fixing Direct Dependencies – csproj/VS2017Open your `projectname.csproj` file in your editor, or right click the project in Visual Studio 2017 and choose `Edit projectname.csproj` from the content menu, where projectname is the name of your project. Look for `PackageReference` nodes. The following shows an example project file:``` XML<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp1.1</TargetFramework>  </PropertyGroup>  <PropertyGroup>    <PackageTargetFallback>$(PackageTargetFallback);portable-net45+win8+wp8+wpa81;</PackageTargetFallback>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore" Version="1.1.1" />    <PackageReference Include="Microsoft.AspNetCore.Mvc" Version="1.1.2" />  </ItemGroup>  <ItemGroup>    <DotNetCliToolReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Tools" Version="1.0.0 " />  </ItemGroup></Project>```The example has two direct package dependencies, as seen by the two `PackageReference` elements. The name of the package is in the Include attribute, and the package version number is in the Version attribute that is exposed to the right of the package name. The example shows two packages `Microsoft.AspNetCore` version 1.1.1, and `Microsoft.AspNetCore.Mvc.Core` version 1.1.2.Review your `PackageReference` elements for any instance of the packages and versions listed above. In the example above, there is a direct dependency on one of the vulnerable packages, `Microsoft.AspNetCore.Mvc` version 1.1.2.To update to the fixed package, change the version number to the appropriate package for your release. In the example, this would be updating `Microsoft.AspNetCore.Mvc` to 1.1.3.After updating the vulnerable package version, save your `csproj` file. The example `csproj` would now look as follows:``` XML<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp1.1</TargetFramework>  </PropertyGroup>  <PropertyGroup>    <PackageTargetFallback>$(PackageTargetFallback);portable-net45+win8+wp8+wpa81;</PackageTargetFallback>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore" Version="1.1.1" />    <PackageReference Include="Microsoft.AspNetCore.Mvc.Core" Version="1.1.3" />  </ItemGroup>  <ItemGroup>    <DotNetCliToolReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Tools" Version="1.0.0 " />  </ItemGroup></Project>```If you are using Visual Studio and save your updated `csproj` file, Visual Studio will restore the new package version. You can see the restore results by opening the Output Window (Ctrl+Alt+O) and changing the Show output from drop-down list to Package Manager.If you are not using Visual Studio open a command line and change to your project directory. Execute the `dotnet restore` command to restore your new dependency.### After updating your direct dependenciesRecompile your application.If after recompilation you see a Dependency conflict warning, you must update your other direct dependencies to the appropriate version. For example if your project refers to `Microsoft.AspNetCore.Routing` with a version number of 1.0.1 when you update your `Microsoft.AspNetCore.Mvc` package to 1.0.4, compilation will throw:`NU1012      Dependency conflict. Microsoft.AspNetCore.Mvc.Core 1.0.4 expected Microsoft.AspNetCore.Routing >= 1.0.4 but received 1.0.1`To fix this, edit the version for the expected package to be the version expected by updating your `csproj` or `project.json` in the same way that you used to update the vulnerable package versions.After you have addressed all of your direct dependencies, you must also review your transitive dependencies.### Reviewing Transitive Dependencies There are two ways to view transitive dependencies. You can either use Visual Studio’s Solution Explorer, or you can review your `project.lock.json` (project.json/VS2015) or `project.assets.json` (csproj/VS2017) file.#### Using Visual Studio Solution Explorer (VS2015)If you want to use Visual Studio 2015, open your project in Visual Studio 2015 and then press Ctrl+; to activate the search in Solution Explorer. Search for each of the vulnerable package names and make a note of the version numbers of any results you find.For example, searching for `Microsoft.AspNetCore.Mvc.Core` in an example project that contains a reference to `Microsoft.AspNetCore.Mvc` shows the following results in Visual Studio 2015.![vs2015](https://cloud.githubusercontent.com/assets/796298/25858059/a1ae6624-348f-11e7-9ce9-ff2d25a3fc5b.png)The search results appear as a tree. In these results, you can see we have found references to `Microsoft.AspNetCore.Mvc`, version 1.0.1, ` vulnerable version. The first entry under the References heading refers to the target framework your application is using. This will be `.NETCoreApp`, `.NETStandard` or `.NET-Framework-vX.Y.Z` (where X.Y.Z is an actual version number) depending on how you configured your application. Under your target framework will be the list of packages you have directly taken a dependency on. In this example, the application takes a dependency on `Microsoft.AspNetCore.Mvc`. `Microsoft.AspNetCore.Mvc` in turn has leaf nodes that list its dependencies and their versions. In this case the `Microsoft.AspNetCore.Mvc` package takes a dependency on a vulnerable version of `Microsoft.AspNetCore.Mvc.Core` and numerous other packages.#### Manually reviewing project.lock.json (project.json/VS2015)Open the `project.lock.json` file in your editor. We suggest you use an editor that understands json and allows you to collapse and expand nodes to review this file; both Visual Studio and Visual Studio Code provide this functionality.If you are using Visual Studio the `project.lock.json` file is “under” the `project.json` file. Click the right pointing triangle, ▷, to the left of the `project.json` file to expand the solution tree to expose the `project.lock.json` file. The following image shows a project with the `project.json` file expanded to show the `project.lock.json` file.![project lock json](https://cloud.githubusercontent.com/assets/796298/25858179/f6e01200-348f-11e7-8a77-7176d8dd3f03.png)Search the `project.lock.json` file for each of the vulnerable packages, using the format `AssemblyName/`. If you find any vulnerable assembly name in your search examine the line on which they are found, the version number is after the `/` and compare to the vulnerable versions table above. For example a search result that shows `Microsoft.AspNetCore.Mvc.Core/1.0.1` is a reference to v1.0.1 of `Microsoft.AspNetCore.Mvc.Core`.   If your `project.lock.json` file includes references to any of the vulnerable packages shown above then you will need to fix the transitive dependencies.#### Fixing transitive dependencies (project.json/VS2015)If you have not found any reference to any vulnerable packages this means none of your direct dependencies depend on any vulnerable packages or you have already fixed the problem by updating the direct dependencies.If your transitive dependency review found references to any of the vulnerable packages you must add a direct dependency to the updated package to your `project.json` file to override the transitive dependency. Open your `project.json` and find the dependencies section. For example:``` json  "dependencies": {    "Microsoft.NETCore.App": {      "version": "1.0.1",      "type": "platform"    },    "Microsoft.AspNetCore.Server.Kestrel": "1.1.0",    "Microsoft.AspNetCore.Mvc": "1.1.0"  }```For each of the vulnerable packages your search returned you must add a direct dependency to the updated version by adding it to the `project.json` file. You do this by adding a new line to the dependencies section, referring the fixed version. For example, if your search showed a transitive reference to the vulnerable `System.Net.Security` version 4.0.0 you would add a reference to the appropriate fixed version, 4.0.1. Edit the `project.json` file as follows:``` json  "dependencies": {    "Microsoft.NETCore.App": {      "version": "1.0.1",      "type": "platform"    },    "System.Net.Security": "4.0.1",    "Microsoft.AspNetCore.Server.Kestrel": "1.1.0",    "Microsoft.AspNetCore.Mvc": "1.1.1"  }```After you have added direct dependencies to the fixed packages, save your `project.json` file.If you are using Visual Studio save your updated `project.json` file and Visual Studio will restore the new package versions. You can see the restore results by opening the Output Window (Ctrl+Alt+O) and changing the Show output from drop-down list to Package Manager.If you are not using Visual Studio open a command line and change to your project directory. Execute the `dotnet restore` command to restore your new dependencies.#### Using Visual Studio Solution Explorer (VS2017)If you want to use Solution Explorer, open your project in Visual Studio 2017, and then press Ctrl+; to activate the search in Solution Explorer. Search for each of the vulnerable package names and make a note of the version numbers of any results you find.For example, searching for `Microsoft.AspNetCore.Mvc.Core` in an example project that contains a package that takes a dependency on `Microsoft.AspNetCore.Mvc` shows the following results in Visual Studio 2017.![vs2017](https://cloud.githubusercontent.com/assets/796298/25858816/8ecdc2b4-3491-11e7-9363-746804bb9832.png)The search results appear as a tree. In these results, you can see we have found references to `Microsoft.AspNetCore.Mvc.Core` version 1.1.2.Under the Dependencies node will be a NuGet node. Under the NuGet node will be the list of packages you have directly taken a dependency on and their versions. In this example, the application takes a direct dependency on `Microsoft.AspNetCore.Mvc`. `Microsoft.AspNetCore.Mvc` in turn has leaf nodes that list its dependencies and their versions. In the example the `Microsoft.AspNetCore.Mvc` package takes a dependency on a version of `Microsoft.AspNetCore.Mvc.ApiExplorer` which in turn takes a dependency on a vulnerable version of `Microsoft.AspNetCore.Mvc.Core`.#### Manually reviewing project.assets.json (VS2017)Open the `project.assets.json` file from your project’s obj directory in your editor. We suggest you use an editor that understands json and allows you to collapse and expand nodes to review this file; both Visual Studio and Visual Studio Code provide this functionality.Search the `project.assets.json` file for each of the vulnerable packages, using the format `AssemblyName/`. If you find any vulnerable assembly name in your search examine the line on which they are found, the version number is after the `/` and compare to the vulnerable versions table above. For example a search result that shows `Microsoft.AspNetCore.Mvc.Core/1.1.0` is a reference to v1.1.0 of `Microsoft.AspNetCore.Mvc.Core`.   If your `project.assets.json` file includes references to any of the vulnerable packages shown above then you will need to fix the transitive dependencies.If you have not found any reference to any vulnerable packages this means none of your direct dependencies depend on any vulnerable packages or you have already fixed the problem by updating the direct dependencies.If your transitive dependency review found references to any of the vulnerable packages you must add a direct dependency to the updated package to your `csproj` file to override the transitive dependency. Open your `projectname.csproj` file in your editor, or right click on the project in Visual Studio 2017 and choose Edit `projectname.csproj` from the content menu, where `projectname` is the name of your project. Look for `PackageReference` nodes, for example:``` xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp1.1</TargetFramework>  </PropertyGroup>  <PropertyGroup>    <PackageTargetFallback>$(PackageTargetFallback);portable-net45+win8+wp8+wpa81;</PackageTargetFallback>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="Microsoft.AspNetCore" Version="1.1.1" />    <PackageReference Include="Microsoft.AspNetCore.Mvc" Version="1.1.3" />  </ItemGroup>  <ItemGroup>    <DotNetCliToolReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Tools" Version="1.0.0" />  </ItemGroup></Project>```For each of the vulnerable packages your search returned you must add a direct dependency to the updated version by adding it to the `csproj` file. You do this by adding a new line to the dependencies section, referring the fixed version. For example, if your search showed a transitive reference to the vulnerable `System.Net.Security` version 4.3.0 you would add a reference to the appropriate fixed version, 4.3.1.``` xml<Project Sdk="Microsoft.NET.Sdk.Web">  <PropertyGroup>    <TargetFramework>netcoreapp1.1</TargetFramework>  </PropertyGroup>  <PropertyGroup>    <PackageTargetFallback>$(PackageTargetFallback);portable-net45+win8+wp8+wpa81;</PackageTargetFallback>  </PropertyGroup>  <ItemGroup>    <PackageReference Include="System.Net.Security" Version="4.3.1" />    <PackageReference Include="Microsoft.AspNetCore" Version="1.1.1" />    <PackageReference Include="Microsoft.AspNetCore.Mvc" Version="1.1.3" />  </ItemGroup>  <ItemGroup>    <DotNetCliToolReference Include="Microsoft.VisualStudio.Web.CodeGeneration.Tools" Version="1.0.0" />  </ItemGroup>```After you have added the direct dependency reference, save your `csproj` file.If you are using Visual Studio, save your updated `csproj` file and Visual Studio will restore the new package versions. You can see the restore results by opening the Output Window (Ctrl+Alt+O) and changing the Show output from drop-down list to Package Manager.If you are not using Visual Studio, open a command line and change to your project directory. Execute the `dotnet restore` command to restore your new dependencies.### Rebuilding your applicationFinally rebuild your application, test as you would do normally and redeploy using your favored deployment mechanism.## Other Information### Reporting Security IssuesIf you have found a potential security issue in .NET Core, please email details to secure@microsoft.com. Reports may qualify for the .NET Core Bug Bounty. Details of the .NET Core Bug Bounty including Terms and Conditions are at [https://aka.ms/corebounty](https://aka.ms/corebounty).### SupportYou can ask questions about this issue on GitHub in the .NET Core or ASP.NET Core organizations. These are located at https://github.com/dotnet/ and https://github.com/aspnet/. The Announcements repo for each product (https://github.com/dotnet/Announcements and https://github.com/aspnet/Announcements) will contain this bulletin as an issue and will include a link to a discussion issue where you can ask questions.	### DisclaimerThe information provided in this advisory is provided "as is" without warranty of any kind. Microsoft disclaims all warranties, either express or implied, including the warranties of merchantability and fitness for a particular purpose. In no event shall Microsoft Corporation or its suppliers be liable for any damages whatsoever including direct, indirect, incidental, consequential, loss of business profits or special damages, even if Microsoft Corporation or its suppliers have been advised of the possibility of such damages. Some states do not allow the exclusion or limitation of liability for consequential or incidental damages so the foregoing limitation may not apply.### AcknowledgmentsMicrosoft [thanks](https://go.microsoft.com/fwlink/?LinkId=21127) the following for working with us to help protect customers:- David Fernandez of [Sidertia Solutions](https://www.sidertia.com/Home) for reporting the ASP.NET Core Denial of Service Vulnerability (CVE-2017-0247)- Joonwoo Yu, Hyoung-Kee Choi of [Sungkyunkwan University](http://hit.skku.edu/~hkchoi/) for reporting the .NET Security Feature Bypass (CVE-2017-0248)- [Mikhail Shcherbakov](https://www.linkedin.com/in/mikhailshcherbakov) for reporting the ASP.NET Core Spoofing Vulnerability (CVE-2017-0256)### Revisions- V1.0 (May 9, 2017): Advisory published.- V1.1 (May 10, 2017): Advisory revised to include a table of issue CVEs and their descriptions. This is an informational change only.
4674	area-security	Certify OIDC middleware?	Wouldn't that be useful??https://openid.net/certification/
4833	area-mvc	Add Streaming API support to MVC	Streaming APIs are a thing and it would be great for MVC to support something out of the box that allowed streaming results back to the client. Web API had a `PushStreamContent` which was a bit lower level than most want (but we could still offer it as a building block). It should be possible to return an `IObservable<T>` or `IEnumerable<T>` (an eventually `IAsyncEnumerable<T>`) from a controller action and have those results be pushed back to the client as they are realized instead of being treated as a single response. High level areas to think about:- Formatting and conneg *could* also come into play here (but I'm not sure how useful it is). A client could request that they wanted JSON streaming or XML streaming (does anyone do that?). - Do we want to only allow streaming results or do we want to handle streaming input as well (chunked transfer encoding both ways).- Do we want to support framing and deframing the data on the wire so users don't have to? For example, lets say I wanted to use multipart mime as my framing format per T that was received or sent. Another example is server sent events, if I return an `IObservable<Person>` can that be framed in different ways based on what the client asked for (related to conneg?)- `IObservable<T>` doesn't do back pressure so at some point threads would get blocked. Do we try to push for `IAsyncEnumerable<T>` as the model? What about `Channel<T>` (that supports back pressure)? (corefxlab)/cc @rynowak @anurse 
5896	area-hosting	Allow custom IServiceCollection in build method	Is that possible to pass a custom IServiceCollection instead of using the internal IServiceCollection created in Build method?My case is that the WebHostBuilder is just part of a bigger application (which contains part of code running as a service, for example)Because the services are registered by an external IServiceCollection, it would be impossible to utilize the existing IServiceProvider without duplicating registrations (or delegating them to existing IServiceProvider).
5011	area-mvc	ViewComponentTagHelper: Allow optional parameters	Say we have a ViewComponent class```C#class MyViewComponent{    IViewComponentResult Invoke( bool showSomething = false ) { ... }}```It would be great to just only write `<vc:my />` in Razor if one don't want to show that something. Currently you have to write `<vc:my show-something="false" />`.
5895	area-hosting	WebHostOptions can't be set from HostingStartup activated assemblies	WebHostBuilder.Build->BuildCommonServices first creates a new WebHostOptions and reads all of the settings from config. Then it processes HostingStartup assemblies. Because config has already been read, the HostingStartup actions cannot modify any WebHostOptions options like CaptureStartupErrors. Configuring IWebHostBuilder from a HostingStartup assembly will not be equivalent to configuring it in Program.Main if these options cannot be set.PreferHostingUrls had a similar problem when trying to run in ConfigureServices, so we removed it from WebHostOptions: https://github.com/aspnet/Hosting/commit/a64940a1f737e8b3717e36df25a6f0ed1dcec2c4We've enabled IISIntegration to be auto-injected as a HostingStartup assembly, but it needs to set CaptureStartupErrors.
5168	area-mvc	Recursive fetch doesn't work on server-side	I tried to run such code on server-side but for some reason it doesn't work. `fetch` function is imported from `domain-task`    return fetch('https://jsonplaceholder.typicode.com/posts/1')        .then(response => response.json())        .then(response => {            return fetch('https://jsonplaceholder.typicode.com/posts/2')                .then(response2 => response2.json())        });I receive the following error:    Exception: Call to Node module failed with error: Error:     When running outside the browser (e.g., in Node.js), you must specify a base URL    before invoking domain-task's 'fetch' wrapper.    Example:    import { baseUrl } from 'domain-task/fetch';    baseUrl('http://example.com'); // Relative URLs will be resolved against this
5010	area-mvc	RazorPage WriteLiteral could more compact/fast-path types	_From @benaadams on April 27, 2017 10:2_Currently it uses `string` which means each time a page is rendered it needs to convert from UTF16 to the output encoding (likely utf8)```  IL_0019:  ldstr      "\r\nDuis sollicitudin mauris nec molestie molestie. "    + "Etiam ipsum quam, tincidunt quis egestas non, euismod id lacus. Nulla n"    + "isi magna, auctor vitae turpis ut, congue interdum lectus. Nulla vehicu"    + "la, dui id venenatis tincidunt, magna lacus tristique enim, ut sodales "    + "nulla neque quis ligula. Vivamus volutpat laoreet molestie. Pellentesqu"    + "e elementum porta volutpat. Curabitur dui sapien, imperdiet nec velit i"    + "nterdum, venenatis pulvinar neque. Vivamus venenatis hendrerit nunc, ve"    + "l mattis justo tristique nec. Mauris ullamcorper posuere tellus, eget c"    + "ongue ipsum sagittis eget. Integer ultrices sit amet nisl at venenatis."    + " Sed vel venenatis urna, ac scelerisque augue."IL_001e:  callvirt   instance void [Microsoft.AspNetCore.Mvc.Razor]    Microsoft.AspNetCore.Mvc.Razor.RazorPage::WriteLiteral(object)```Instead they could be stored as an new type `asciiBytes` and if non-ascii chars were encountered in the compilation `utf8Bytes` in class readonly static which would be shims on `byte[]`.This would mean they would use on average half the memory; and could if output encoding was compatible just be put directly on the wire without re-encoding. (Hence ascii/utf8 split as more encodings are compatible with ascii); then only re-encode if it needs to switch.`string` could still be used for shorter literals (< *n* chars) e.g. tag names to make use of string interning; if a custom interning scheme wasn't to be devised.This would allow larger chunks of html in pages to be stored and output more efficiently._Copied from original issue: aspnet/Mvc#6216_
5009	area-mvc	Namespace names are always grayed out in _ViewImports.cshtml	Consider the following in a project's `_ViewImports.cshtml` file:``` html@using RazorPagesWebApplication@using RazorPagesWebApplication.Data@using Microsoft.AspNetCore.Identity```The actual namespaces are all grayed out by the editor suggesting they aren't needed.
5008	area-mvc	TagHelper directives don't record incomplete quote errors correctly.	Today our quote completion logic is slightly flawed when dealing with a single quote and error reporting. Due to [these lines](https://github.com/aspnet/Razor/blob/f31b45d84a23f52fc564b4892327e5e3e981d66a/src/Microsoft.AspNetCore.Razor.Language/Legacy/CSharpCodeParser.cs#L1869-L1871) when there's a single quote we think the content of a TagHelper directive starts and ends with quotes when in reality it does not.
4832	area-mvc	Consider some convenience changes for MVC options	It would be really nice to be able to write:```c#services.AddMvc(options => options.ModelBinderProviders.RemoveByType(typeof(ByteArrayModelBinderProvider));```or ```c#services.AddMvc().RemoveModelBinderProvider(typeof(ByteArrayModelBinder));```Instead of:```c#services.AddMvc(options => options.ModelBinderProviders.Remove(options.ModelBinderProviders.OfType<ByteArrayModelBinderProvider>().Single()));```See https://github.com/aspnet/Mvc/issues/6160#issuecomment-295296083---- The first option would be expose a custom collection type, the second would be to just add more stuff to the `IMvcBuilder`. Either one of these could work for this scenario, but I think the builder approach could be to basically anything we want to make into a one liner.
5007	area-mvc	Generated class for Razor Pages shows up in VS Solution Explorer when the CSHTML file is open in the editor	_From @DamianEdwards on March 13, 2017 20:28_![image](https://cloud.githubusercontent.com/assets/249088/23873906/f624e348-07f0-11e7-8a02-a712a8b76692.png)_Copied from original issue: aspnet/Mvc#5957_
4624	area-servers	Need to pass state about rejected requests for W3C logging in Hosting	https://github.com/aspnet/Hosting/issues/1013 will implement W3C logging on the hosting layer.  For most requests, this is fine, though for rejected/failed requests, Kestrel will need to pass the data.Simple implementation would be just passing a string with the log value, or we can consider passing list of key/value pairs if we want to do the formatting at the Hosting layer.cc @Tratcher @davidfowl 
4831	area-mvc	ValidationSummary doesn't display property errors if ModelState and ModelMetadata meets the specific conditions	### TitleValidationSummary doesn't display property errors if ModelState and ModelMetadata meets the specific conditions### Functional impactIf user submits a form, he doesn't see validation messages in the validation summary### Minimal repro steps1. Create a model, that implements `IEnumerable` and has `ID` property```    public class FormMetadata : IEnumerable<FieldMetadata> {        private List<FieldMetadata> _fields = new List<FieldMetadata>();        public int ID { get; set; }        public IEnumerator<FieldMetadata> GetEnumerator() {            return _fields.GetEnumerator();        }        IEnumerator IEnumerable.GetEnumerator() {            return _fields.GetEnumerator();        }    }    public class FieldMetadata {    }```2. Create an action in a controller, that has `id` parameter3. In the action add validation error to the property that isn't part of the model```[HttpPost, ActionName("Index")]public IActionResult IndexPOST(int id) {    var model = new FormMetadata();    ModelState.AddModelError("MyForm.MyField", "Something went wrong.");    return View(model);}```4. Run project and send the formSee example project. To reproduce the error just submit the form[validation-summary-issue.zip](https://github.com/aspnet/Mvc/files/924488/validation-summary-issue.zip)### Expected resultI expect all validation errors to appear in the validation summary.### Actual resultThe empty validation summary is generated.```<div class="validation-summary-errors" data-valmsg-summary="true">    <ul>        <li style="display:none"></li>    </ul></div>```### Further technical detailsMy use case for this scenario: Model contains metadata for a dynamically created form. In controller I add validation errors for dynamically created fields.I tracked the issue down to the `GetModelStateList` method in the `ValidationHelpers` class. `ModelStateEntry` is created for `FormMetadata.ID`, another one is created for `id` parameter from the controller and because of `if (entries.Count < modelStateDictionary.Count)` check the error message for `MyForm.MyField` isn't created.
5006	area-mvc	Consider moving @section off of extensible directives	Today `@section` expects 1 identifier. We accomplished this by creating an extensible directive that accepts 1 member token. This isn't entirely correct though; it ends up looking like:![image](https://cloud.githubusercontent.com/assets/2008729/25053925/3e56ea3a-210f-11e7-9ef0-680d3a5bc211.png)And if you hover over the member you get:![image](https://cloud.githubusercontent.com/assets/2008729/25053945/5305aa3e-210f-11e7-83c6-e42e890db145.png)We may want to move section off of the extensible directive infrastructure and have it just be a built-in directive
5005	area-mvc	Implicit Expressions do not work for complex doubles	Trying to use an implicit expression `@AnImplicitExpression` does not work when you specify douples with dots, underscores etc.The following does **not** work (never has):- `@1.234`- `@1.234e23`- `@1.234_567_890`- `@1.234_567_890e23`
5004	area-mvc	Razor Language Service sign off activities.	- [ ] TagHelpers highlight in pre-opened files.- [ ] TagHelpers from primary application refresh on change.- [x] TagHelpers from packages highlight without build.- [x] TagHelpers from primary application highlight without build.- [x] TagHelpers from referenced libraries highlight.- [x] TagHelpers from referenced libraries refresh on change.- [x] TagHelpers highlight when restore completes.- [x] TagHelpers get auto-complete entries when typing elements.- [x] TagHelpers get auto-complete entries when typing attributes.- [x] `@addTagHelper` can turn on TagHelpers for an entire assembly- [x] `@addTagHelper` can turn on a single TagHelper- [x] `@addTagHelper` can be used in _ViewImports.cshtml- [x] `@addTagHelper` can be used directly on a view- [x] `@removeTagHelper` can turn off TagHelpers for an entire assembly- [x] `@removeTagHelper` can turn off a single TagHelper- [x] `@removeTagHelper` can be used in _ViewImports.cshtml- [x] `@removeTagHelper` can be used directly on a view- [x] `@tagHelperPrefix` works as expected.- [x] `@tagHelperPrefix` can be used in _ViewImports.cshtml- [x] `@tagHelperPrefix` can be used directly on a view- [x] The extension has an icon.- [x] ViewComponents do not cause errors in views.- [x] The extension can be upgraded.- [x] Breakpoints can be hit in cshtml files.
5003	area-mvc	Need to optimize HtmlContentIRNode code generation	From https://github.com/aspnet/Razor/pull/1198#discussion_r110717465 and https://github.com/aspnet/Razor/pull/1198#discussion_r110743500
4779	area-servers	Smarter output buffering 	In order to improve application performance, we might be able to do some clever buffering that won't affect most applications. The theory is that we can buffer all output until there's no more input in the pipe. Even though there's no correlation between input and output, this shouldn't introduce bad buffering behavior in most cases and will improve pipelined requests dramatically. We can still respect the `IHttpBufferingFeature ` feature interface if there are cases where the application isn't reading the body and is writing to the output (this is bound to break *somebody*).We can bury this behind a flag and only enable it in the benchmark if we saw issues with it. Also respecting the `IHttpBufferingFeature` gives applications a way to the immediate write behavior.
5894	area-hosting	Support access logging with Common Log Format/Extended Log Format	_From @cesarbs on February 3, 2017 18:6_Every web server does this:http://httpd.apache.org/docs/current/logs.html#accessloghttp://redmine.lighttpd.net/projects/1/wiki/Docs_ModAccessLoghttp://nginx.org/en/docs/http/ngx_http_log_module.html#access_loghttps://www.iis.net/configreference/system.applicationhost/log/centralw3clogfileThere are tools that analyze logs using those formats.For reference:https://en.wikipedia.org/wiki/Common_Log_Formathttps://www.w3.org/TR/WD-logfile.html_Copied from original issue: aspnet/KestrelHttpServer#1339_
5731	area-identity	Is there an option for prefetching Claims with UserManager find functions?	Wondering if there is a way (via an option in startup or something) to prefetch claims when you retrieve a user via the UserManager.FindUserByXXXAsync methods?  We have a scenario where when we fetch a user we always want to get their claims back as well.  I read in another post that the User.Claims navigation property can't be trusted to consistently be populated and I think I understand that it is done automatically for the currently logged in principal but what options are available to get the claims for a user when they are looked up via a one of the UserManager find functions?  I know I can make a second call to UserManager.GetClaimsAsync(user) to get an `IList<Claim> ` but there doesn't seem to be an obvious way to then associate those with the ApplicationUser b/c the type of the claims collection on ApplicationUser is `Microsoft.AspNet.Identity.EntityFrameworkCore.IdentityUserClaim<string>` but the` IList<Claim>` returned by GetClaimsAsync is System.Security.Claims.Claim.  It seems like there should be a way to do this cleanly and maybe there is and we are just missing it?I will add that we have noticed that immediately after calling UserManager.AddClaimAsync(user, claim) that the corresponding user object does then have the newly added claim in User.Claims and it is persisted to the db store.  But that doesn't appear to get re-fetched when the user is looked up later via UserManager find functions...
4830	area-mvc	Inconsistent HTML Encoding of Validation Message	### Functional impactWhen using data annotations to configure validation, the message does not get HTML encoded when it is rendered client side for unobtrusive validation, but it does get HTML encoded when rendered in response to server side validation.  As a result, any error message that contains characters that need to be HTML encoded cannot be reliably used for both client and server side validation.### Minimal repro steps1. Use the attached sample application with JavaScript enabled in the browser [ValidationEncodingTest.zip](https://github.com/aspnet/Mvc/files/900195/ValidationEncodingTest.zip)2. Enter a string with three or more characters in the input box3. Click Submit3. Note that client side validation fails (expected, as the validation rule has been violated)4. Note that the message is displayed in bold ![validation-clientside](https://cloud.githubusercontent.com/assets/2591590/24717397/5145e4b8-1a00-11e7-92cb-d6ce7c05bbca.PNG)5. Load the page from the sample application again6. Disable JavaScript in the browser7. Enter a string with three or more characters in the input box8. Click Submit9. Note that client side validation is skipped (expected) and server side validation fails (expected, as the validation rule has been violated)10. Note that the error message is not bold and the literal `<b>` content is displayed![validation-serverside](https://cloud.githubusercontent.com/assets/2591590/24717437/77c1a960-1a00-11e7-8117-fdd19c665283.PNG)### Expected resultI don't have a strong opinion about whether the messages should be automatically HTML encoded or not, but I would expect that the messages from step 4 and step 10 would be the same.  Whether the user has enabled JavaScript or not should have no impact on whether the message is HTML encoded or not.From a security standpoint, it would probably be safer to ensure that the contents are HTML encoded in all scenarios.### Actual resultThe messages from steps 4 and 10 are different.### Further technical detailsIn the `onErrors` method in `jquery.validate.unobtrusive.js` we can see that unobtrusive expects that the message has already been HTML encoded because it uses `$("<li />").html(this.message).appendTo(list);` but we can see from the HTML that is generated is only attribute encoded ( `data-val-length="Property1: &lt;b> Length must be 2 or less"`) so when it is added to the validation summary control, the HTML is parsed.By comparison, when the validation summary control renders error messages server side, it HTML encodes all of its contents. I'm not familiar with the internal architecture of the relationship between MVC and unobtrusive, but there seem to be two obvious ways to address this problem:1. Change unobtrusive to use `.text(this.message)` rather than `.html(this.message)`2. Change MVC to automatically HTML encode the attributes when they are written out to the clientUnfortunately, both of these options would be breaking changes for any applications that expect to be able to write HTML into error messages.I don't know of any workarounds for this problem, but one would be appreciated. Tested with the following configuration:- ASP.Net 4.6.2- MVC 5.2.3- Razor 3.2.3- Unobtrusive Validation 3.2.3
4675	area-security	Add metadata which says whether or not the type of authentication was persistent	For **Antiforgery by default** in MVC - we need a way to know that the type of authentication used was a persistent auth.This should be implemented such that the non-persistent auth schemes (bearer) make a declaration that they **are not persistent**. The antiforgery infrastructure in MVC will look for confirmation that the scheme is **not persistent**.
4780	area-servers	Write Windows RIO transport	
4781	area-servers	Share KestrelThreads (LibuvThreads) between endpoints	
5002	area-mvc	Figure out line pragma generation behavior for CSharpStatementIRNode	The current behavior is that we generate line pragma for the entire node and not for each of it's children. This is fine as long as the statement is single line or contiguous. But when they are separated by some thing else like an ExtensionIRNode, we might need to generate line pragmas separately. We need to think about what line pragma generation behavior we want for this case.@NTaylorMullen @rynowak 
5277	area-signalr	sql server backplane for signalr core	When will signalR sql server backplane be released for dotnet core?Is there a roadmap of signalR core?
4829	area-mvc	Remove unnecessary dependencies in Microsoft.AspNetCore.Mvc.Localization	This is proposal related on how Microsoft.AspNetCore.Mvc.Localization package is structured.Microsoft.Extensions.Localization.Abstractions contains all abstractions that are related to string localization, without any concrete implementation.If you want to use resource files as resource persistence store, then you state dependency on Microsoft.Extensions.Localization, call AddLocalization extension method on IServiceCollection implementation and you are good to go which is nice and convenient (even though method itself does not indicate usage of resource files).Otherwise, if you don't want to use resource files, you don't have to reference Microsoft.Extension.Localization package, but instead just Microsoft.Extension.Localization.Abstractions and then you can create your own resource persistence logic.And that is really nicely done.Now when it comes to localization in MVC, all of this falls apart because as soon as you add reference to Microsoft.AspNetCore.Mvc.Localization, every single package that has anything to do with the word "localization" is pulled in, including Microsoft.AspNetCore.Localization which is in no way related to the code in Microsoft.AspNetCore.Mvc.Localization as it plays completely different role in localization process (I didn't see any references to request culture providers). To test the above statement, comment out Microsoft.AspNetCore.Localization in project.json - Microsoft.AspNetCore.Mvc.Localization will still build without any issues.So first proposal is to:**Remove completely the dependency on Microsoft.AspNetCore.Localization as it's not used at all in the code and you still have to enable request localization manually.**Other part of this issue relates to continuous calls to AddLocalization method in both Microsoft.AspNetCore.Mvc.Localization and Microsoft.AspNetCore.Mvc.DataAnnotations packages.Previously mentioned separation between Microsoft.Extensions.Localization.Abstractions and Microsoft.Extension.Localization becomes irrelevant when it comes to MVC, since two above mentioned packages reference the latter always, and therefore pull in resource files related logic and register ResourceManagerStringLocalizerFactory as IStringLocalizerFactory by default.Reason why I am raising this as an issue is because this is not consistent behavior for a developer. At certain times you have to explicitely opt in for something, which I believe is the right approach, as other stacks follow the same rule of thumb.In other situations however, things are pulled in for you and registered behind the scenes and you have to dig through the source code to figure out where and how - just to be able to break existing dependencies and register your own implementations. Even though that can be fun at the times, I am not sure if that was part of your plan.I understand that removing internal calls to AddLocalization method when view localization / data annotations localization services are registered with IoC container would cause major backwards compatibility issues, but please just consider that as an option.**EDIT (one more remark):**Class MvcLocalizationServices contains the following method:```public static void AddMvcLocalizationServices(            IServiceCollection services,            LanguageViewLocationExpanderFormat format,            Action<LocalizationOptions> setupAction)        {            services.Configure<RazorViewEngineOptions>(                options =>                {                    options.ViewLocationExpanders.Add(new LanguageViewLocationExpander(format));                });            services.TryAdd(ServiceDescriptor.Singleton<IHtmlLocalizerFactory, HtmlLocalizerFactory>());            services.TryAdd(ServiceDescriptor.Transient(typeof(IHtmlLocalizer<>), typeof(HtmlLocalizer<>)));            services.TryAdd(ServiceDescriptor.Transient<IViewLocalizer, ViewLocalizer>());        }```This method takes in **setupAction** parameter as an input but does not use it for anything.
4828	area-mvc	Streamline caching of IActionConstraint, IModelValidator, and filters	We have a few pieces of code like this: https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/Internal/ActionConstraintCache.csThey all pretty much implement the same protocol, and deal with how we cache filters, validators, and action constraints. I'm going to use action constraints as an examplar for this dicussion, the others are conceptually very similar and could benefit from the same simplification.This code is complicated, and the performance isn't great because... it's just a lot of code to run do what's usually very simple. Additionally, the design of this leads to a big, global, cache of *all the filters*. It would be nice to have a per-action cache to reduce the number of cache lookups we do. We currently have 5-6 of these 'big' caches and I'm trying to get that number down to 3 👍 -------------------The set of action constraints that apply to an action can be programmed in four ways:1. Attributes on the action/controller - determined at build time2. Application model - run code at startup to determine set of constraints3. `IActionConstraintFactory` - can choose per-request what action constraint to return4. `IActionConstraintProvider` - can choose per-request what set of action constraints to return1 & 2 don't add much complexity to the design - everything is 'baked' at startup.3 `IActionConstraintFactory` has a good tradeoff of complexity to functionality. For each *metadata* (`IActionConstraintFactory`) there's zero or one *runtime* `IActionConstraint`.4 `IActionConstraintProvider` on the other hand allows **full control** over everything. It can completely invalidate all of the caching that we do, and requires running all providers every request to implement the protocol correctly.------------------My proposal is that we limit the kinds of things you can do in 4 `IActionConstraintProvider`. We should run the `IActionConstraintProvider`s once per action when that action is first initialized. If you want to implement dynamic behavior, you should insert a *metadata* `IActionConstraintFactory` for each constraint that has selective behavior.This retains the ability of `IActionConstraintProvider` to provide full dynamic control, but only once at startup. You need to describe the *shape* of things. This will really cut down the amount of code we need to run at runtime, which will improve perf. Then since there's not a lot of code to run, we can break up some of these big central caches, which should improve perf even more.
5001	area-mvc	Non-string taghelper attribute value containing @@ is not recognized as code	_From @ajaybhargavb on August 26, 2016 23:12_Related issue - https://github.com/aspnet/Razor/issues/819For non-string tag helper attributes, I'd expect the `@@DateTime.Now` to be recognized as code![image](https://cloud.githubusercontent.com/assets/1579269/18022829/1c6a0db2-6ba7-11e6-9d33-c5b63058872b.png)It works as expected for other cases like,![image](https://cloud.githubusercontent.com/assets/1579269/18022856/7b2a92b8-6ba7-11e6-8dd5-2400c94c1bf2.png)![image](https://cloud.githubusercontent.com/assets/1579269/18022862/8d0dbde8-6ba7-11e6-9386-cf3f594d0d7d.png)To reproduce this issue, you'll need the changes I made locally [here](https://github.com/aspnet/Razor/commit/8142b37d88faca6482113669d7dc5585c1c3c04f) to fix the referenced Razor issue.@ToddGrun @NTaylorMullen _Copied from original issue: aspnet/RazorTooling#95_
4827	area-mvc	We should add a method to stringify a TagHelperAttribute's value.	With the addition of `TagHelperComponent`s you don't get property binding of attribute values so you're forced to introspect on `context.AllAttributes`/`output.Attributes`. If you want to look at an attributes value you then have to write a boat load of complex code to accurately retrieve the value. We should add a method somewhere to enable you to retrieve the string format of a `TagHelperAttribute`.Could be an extension method on `TagHelperAttribute` (`GetStringValue()`), could be a protected method on the `TagHelperComponent` base type, could be a static method somewhere. Any of those i'd be fine with./cc @Eilon @DamianEdwards 
5998	area-middleware	Facebook crawler rewrite doesn't work - issue with query string rewrite	I wanted to add the following rules so I won't need to write separate code for IIS and apache:```var rewriteOptions = new RewriteOptions()   .AddRewrite(".*_escaped_fragment_=%2F%3Fs%3(.*)", "api/opengraph/$1", skipRemainingRules: false);```This should redirect Facebook crawler to my opengraph controller with the relevant info I need in order to return the correct metadata for this page.The full url that needs to be redirected is:```http://wwwmysite.com/?_escaped_fragment_=%2F%3Fs%3DWIwdS4IoWM```The problem is that the code does not take the query parameters as a part of the regexp match just the path.Here:https://github.com/aspnet/BasicMiddleware/blob/dev/src/Microsoft.AspNetCore.Rewrite/Internal/RewriteRule.cs```public virtual void ApplyRule(RewriteContext context)        {            var path = context.HttpContext.Request.Path;```it should probably be something like:```var fullPath = context.HttpContext.Request.Path + context.HttpContext.Request.QueryString```Am I missing something?
4999	area-mvc	Refactor our TagHelperDescriptor tests to test diagnostics separately	From https://github.com/aspnet/Razor/pull/1100#discussion_r107298336Since we validate as part of Build(), the diagnostics are same for both the expected and actual descriptors which makes the tests pass even when we introduce new diagnostics errors. This make our tests less effective.We could have a switch in our builders to turn off validation as part of build.
4998	area-mvc	Refactor RequiredAttributeParser and decouple it from the builder	From https://github.com/aspnet/Razor/pull/1054#discussion_r106078442@rynowak @NTaylorMullen 
4997	area-mvc	Indentation problems with code blocks	I wasn't sure if this should go to VS or if it belongs here (especially with the Evolution work going on.)In Visual Studio, when auto-formatting a Razor document, a code block nested inside of an `if` block will cause the indentation of any code following the `if` block to be increased to match the indentation of the code inside of the code block.This is driving me 🔩 🔩 ! ![bloody-razor](https://cloud.githubusercontent.com/assets/4853540/23904725/e9295060-0896-11e7-902f-91e7edf126ff.png)Moving the code out of the code block to be just inside the `if` block seems to clear it up:![bloody-razor-2](https://cloud.githubusercontent.com/assets/4853540/23904887/675caa2c-0897-11e7-8657-9b14ddcd8fc7.png)
5276	area-signalr	Client proxy on the server for JavaScript/C#/Swift clients	* Generate proxies using MSBuild targets in separate packages for each language:   - C#   - TypeScript   -  Javascript   - Swift* Proxies are output to a default location, configurable with MSBuild properties* No runtime generation of proxies (i.e. `/signalr/hubs`) for now.
5275	area-signalr	Implement a native iOS client	Swift seems like a good candidate.
5730	area-identity	Include an auth_time claim on the set of generated tokens	We need Identity to provide time at which the user was signed in so that it can be included as an auth_time claim.
5729	area-identity	Documentation	Before the ASP.Net Core docs were migrated away from RTD, I seem to recall there being some pretty in-depth content on how to implement Identity. Now I'm looking again and the Identity docs contain mostly point-and-click, integration-oriented material. I'm trying to do a custom implementation for Oracle. Is there anything out there for people like me?
4996	area-mvc	Tag Helper Enum shorthand syntax doesn't work for nullable enums	> Moved from https://github.com/aspnet/Mvc/issues/5881:I'm working on a project with a nullable enum property in the tag helper, like this:```c#[HtmlTargetElement("mini-profiler", TagStructure = TagStructure.WithoutEndTag)]public class MiniProfilerScriptTagHelper : TagHelper{    [HtmlAttributeName("position")]    public RenderPosition? Position { get; set; }}```Relevant enum: ```c#public enum RenderPosition{    Left = 0,    Right = 1,    BottomLeft = 2,    BottomRight = 3}```You can pull [the full repo here (specific commit link)](https://github.com/MiniProfiler/dotnet/tree/5c7950d58855e691432c1fa92904248e739f51fc)I would expect the shorthand syntax to work in razor, like this:```xml<mini-profiler position="Right" />```However, that only works if `Position` is `RenderPosition` (not-nullable). When it's a nullable (`RenderPosition?`), you get an error:> The name 'Right' does not exist in the current context.Instead, you have to use the full version:```xml<mini-profiler position="@RenderPosition.Right" />```Can we please make this work with nullable enums too?cc @DamianEdwards @khellang 
4826	area-mvc	Add EventCounters	We should reasonable parity with the perf counters we had in ASP.NET: https://msdn.microsoft.com/en-us/library/fxk122b4.aspxPotential MVC counters:- View compilations (similar to Compilations Total in ASP.NET)- ...
4825	area-mvc	We need a solution for API Explorer + Custom ModelBinder	see: https://github.com/aspnet/Mvc/issues/5673#issuecomment-281738074 and https://github.com/domaindrivendev/Swashbuckle.AspNetCore/issues/309The complaint here is that we 'expand' a parameter in the API definition that's being bound by a custom model binder. API explorer has no interaction with model binders/providers, and so no way to know that this isn't being handled by the default binder.In this case we already have a metadata feature that would give the desired API explorer output, `ModelMetadata.IsComplexType == false`. However we don't allow user code to configure this value.We should either make this configurable, or probe the model binders for information about types that have custom handling. 
5997	area-middleware	Using AddRedirectToHttpsPermanent on localhost	Hi,`AddRedirectToHttpsPermanent ` works ok on Azure, but locally it does not. When I use ISS express I can reach`https://localhost:44388/`but the unsecure url`http://localhost:44388/`keeps hanging for a while until the browser throws 404 after 2 minutes (!).Is that expected, and if so why or how can I circumvent this?My code is simple```            app.UseRewriter(new RewriteOptions().AddRedirectToHttpsPermanent());            app.UseStaticFiles();            app.UseMvc();            app.Run(async (context) =>            {                var request = context.Request;                await context.Response.WriteAsync($"{request.Protocol} --- " +                    $"{request.Method} --- " +                    $"{request.Scheme} --- " +                    $"{request.Host} --- " +                    $"{request.Path} --- " +                    $"{request.QueryString} --- " +                    $"{request.IsHttps}");            });```and I have enabled SSL in VS 2017 RC4launchSettings.json```{  "iisSettings": {    "windowsAuthentication": false,    "anonymousAuthentication": true,    "iisExpress": {      "applicationUrl": "https://localhost:44388/",      "sslPort": 44388    }  },  "profiles": {    "IIS Express": {      "commandName": "IISExpress",      "launchBrowser": true,      "environmentVariables": {        "ASPNETCORE_ENVIRONMENT": "Development"      }    },    "WebBase": {      "commandName": "Project",      "launchBrowser": true,      "environmentVariables": {        "ASPNETCORE_ENVIRONMENT": "Development"      },      "applicationUrl": "http://localhost:51783"    }  }}```Thanks for any hint on how to proceed.
5996	area-middleware	No support for X-Forwarded-Port	X-Forwarded-Port header is not supported, only ports in X-Forwarded-Host
4220	area-mvc	Consider adding a way to use strict comparison for routes matching	_From @PinpointTownes on February 6, 2017 4:3_http://stackoverflow.com/questions/42048770/asp-net-core-openiddict-throws-an-openid-connect-response-cannot-be-returned-frConsider this action:```csharp[HttpPost("~/path")]public IActionResult Test() => Empty();```Oddly, either the routing stack or MVC seems to consider `/path/` requests as valid candidates for this route/action, which is incorrect as `/path` and `/path/` are two different addresses.Is there any particular reason for this (abusive) normalization?/cc @Eilon @rynowak _Copied from original issue: aspnet/Mvc#5757_
4824	area-mvc	TextAreaTagHelper ignores default value within textarea tags	### TitleWhen using `asp-for` on a `textarea` tag, all contents between the opening and closing `textarea` tags are discarded### Functional impactPrevents setting a default value for `textarea` when the view is rendered.### Minimal repro steps1. Create a new ASP.NET Core Web Application (.NET Framework) Web Application project2. Create a new model with a single string property3. Add this model to a new view, or edit one of the pre-existing Views such as Home>Index.cshtml4. Add a `form` with a single `<textarea asp-for="<model string property>">Inner Value</textarea>`5. Run6. Browse to view### Expected resultThe page should display a textarea on the page with the content of "Inner Value", with it's `id` and `name` attributes from the model### Actual resultAttributes are correctly set, default value is blank### Possible CauseWithin Microsoft.AspNetCore.Mvc.TagHelpers/TextAreaTagHelper.cs, the value of `output.Content` is set to the value of `tagBuilder.InnerHtml`. This value appearsto default to `\r\n` which is then reduced to nothing as TagHelperOutput checks `IsEmptyOrWhiteSpace` on this and sets it to true, resulting in an empty `textarea` tag being rendered.### WorkaroundChanging `output.Content.SetHtmlContent(tagBuilder.InnerHtml);` on line 77 to `output.Content.SetHtmlContent(output.GetChildContentAsync().Result.GetContent());` correctly retrieves the given content of the `textarea`, but seems unlikely to be the correct fix.### packages.jsonDefault from package creation, persists on package update.```  "dependencies": {    "Microsoft.AspNetCore.Diagnostics": "1.0.0",    "Microsoft.AspNetCore.Mvc": "1.0.1",    "Microsoft.AspNetCore.Razor.Tools": {      "version": "1.0.0-preview2-final",      "type": "build"    },    "Microsoft.AspNetCore.Routing": "1.0.1",    "Microsoft.AspNetCore.Server.IISIntegration": "1.0.0",    "Microsoft.AspNetCore.Server.Kestrel": "1.0.1",    "Microsoft.AspNetCore.StaticFiles": "1.0.0",    "Microsoft.Extensions.Configuration.EnvironmentVariables": "1.0.0",    "Microsoft.Extensions.Configuration.Json": "1.0.0",    "Microsoft.Extensions.Logging": "1.0.0",    "Microsoft.Extensions.Logging.Console": "1.0.0",    "Microsoft.Extensions.Logging.Debug": "1.0.0",    "Microsoft.Extensions.Options.ConfigurationExtensions": "1.0.0",    "Microsoft.VisualStudio.Web.BrowserLink.Loader": "14.0.0"  }```
5728	area-identity	You can easily get into a mess with social logins	Social logins doesn't seem very well supported. I've enabled the facebook logins and its working ok but the way it works feels like it's going to confuse a lot of customers.  1. The register page doesn't show the active external services.  1. The log in page automatically registers a new account if you "log in" with a new external service. There is no way to prevent this.  1. The is no way to merge accounts once you have accidentally ended up with two accounts because of this.  1. Once that external service has a made that new account going to your real local account and trying to add the social login shows a forbidden page.  1. There is no way to delete your accounts.Ideally I would like to be able to use the facebook login button and if the returned account matches an existing local account I should be given the opportunity to merge the social login onto the local login account. Or alternatively some way to stop the mess from happening. So a setting that means you can only log in with social accounts not register a new account.
4995	area-mvc	Verify that localized document for tag helpers works in the IDE	We now rely on Roslyn to fetch TagHelper documentation to provide at DesignTime. Due to this we need to build dummy packages or something equivalent to mock our existing localized documentation tests.
4106	area-tooling	dotnet-inspect	A tool to inspect detailed information about the current setup. Here is a list of information that might be useful for support engineers, our team, and devs in general.- optimized package cache. Available? In use? Cache misses? etc.- Show graph of dependencies  - what is lifting/downgrading specific package version  - show sources of package conflicts- list available shared runtimes (peek inside dotnet/sdk)- List all resolved MSBuild properties, including implicit/inferred properties from Microsoft.NET.SdkIt's like `dotnet --info` on steroids.
4994	area-mvc	Fix TagHelperBlockRewriterTest add location comparison to SymbolBase	Right now we don't compare the locations of Symbols, we had to remove this during a parser refactor because it breaks a lot of tests.The only blocker to bringing this back is the tests in `TagHelperBlockRewriterTest`. Right now every phase before taghelper rewriting works fine. We need to figure out what's going on with these tests and then add this verification back.
5167	area-mvc	Example for authentication	Hi, I want to ask if there is any example for authentication for angular 2? I'm very new to this so I have no idea about this, it would be good if we can have a working example for authentication!
5995	area-middleware	Design Question on URL Rewriting Middleware	`.AddRedirect()` and `.AddRewrite()` match their regex on the path/resource (not including the scheme, host, port, and query).Works ...```.AddRedirect(@"^rule1/(.*)", "https://www.google.com/?query=$1").AddRedirect(@"^rule2/(.*)", "rule2/?query=$1")```Doesn't work ...```.AddRedirect(@"^http://localhost:5002/rule3/(.*)", "https://www.google.com/?query=$1")```Might be because "this is always the way it has always been done," but why is the design such that matching isn't performed on the absolute Url? ... or that there isn't an option to instruct the middleware to match on the absolute Url ... for maximum flexibility.
5727	area-identity	Expose a public CanSignInAsync() method	It would be good to use PreSignInCheck separately. I have external logic that requires whole precess except real ASP.NET sign in, so check if user can be successfully signed in. For UserName and Password I can n use CheckPasswordSignInAsync but for external login I don't have such possibility.So either make PreSignInCheck public or add new CheckExternalSignInAsync method which will behave in the same way.
5726	area-identity	something about phone number when identify 	why there is some method about email like **FindByEmailAsync** **GenerateEmailConfirmationTokenAsync**  but non the same method about phonenumber 
4993	area-mvc	Wrong parsing/colorization of comments in Razor files when inline on a tag	_From @javiercn on December 7, 2016 0:6_Repro steps:Create a Razor file and paste the following contents.The first comment will be colorized in green, the second one in red and blue.@*style="list-style:none;list-style-type:none"*@<ul class="list-inline list-unstyled" @*style="list-style:none;list-style-type:none"*@>_Copied from original issue: aspnet/Tooling#891_
5994	area-middleware	Compression: Add threshold for compression 	There are instances where compression is a detriment by comparison to the benefit. Where the time to compress and gzip payload is higher than the original payload.**ngnix** defaults to all content with the `gzip_min_length` setting used to set the minimum length of a response to that will be gzipped. **expressjs** compression module is 1k by default, uses `threshold` option to set globally.
5993	area-middleware	Custom request/response headers in IIS via server variables	https://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-20-configuration-reference#Note_about_request_headers_
5992	area-middleware	Add more GZIP compressable MIME types	I raised the following PR https://github.com/aspnet/BasicMiddleware/pull/181#issuecomment-264494906. This is a justifications for each MIME type to be added:- `application/rss+xml`, `application/atom+xml` and `image/svg+xml` These are all just special dialects of XML, they are all web related and are fairly common (especially SVG).- `application/vnd.ms-fontobject`, `application/x-font-ttf`, `font/otf` - TrueType fonts (ttf) and OpenType fonts (otf) can be safely be compressed for smaller size. The answer is unclear when it comes to Embedded OpenType (eot) fonts. It’s possible to compress EOT font files as part of the file creation process, in which case gzipping them is unnecessary. However, to generate compressed EOT font files requires a special tool and an extra step, so it’s likely that most of them are not pre-compressed. However, [Google](https://developers.google.com/web/fundamentals/performance/optimizing-content-efficiency/webfont-optimization#reducing_font_size_with_compression) recommends compressing EOT fonts.- `image/x-icon` - Finding references for this is more difficult and I can only provide my own anecdotal evidence and the fact that the [HTML 5 Boilerplate Server Configs](https://github.com/h5bp/server-configs/) project also includes it for NGINX and IIS.I only added the most used MIME types, this list could double in size if you wanted to support all web formats.
4992	area-mvc	Optimize string allocations in parsing	I have seen that many strings are allocated in the `Microsoft.AspNetCore.Razor.Tokenizer.Tokenizer.EndSymbol()` method.But some strings are in fact often the same. So I modified the end of the method like that:```.....string tokenContent;if (Buffer.Length != 1){   tokenContent = Buffer.ToString();}else{   if (!_oneCharTokenCache.TryGetValue(Buffer[0], out tokenContent))   {      tokenContent = Buffer.ToString();      _oneCharTokenCache.Add(Buffer[0], tokenContent);   }}sym = CreateSymbol(start, tokenContent, type, errors);```I have made a test with an extrem case ([LargePageMvc page](https://github.com/aspnet/Performance/blob/dev/testapp/LargePageMvc/Views/Home/Index.cshtml)).Before the modification, 215643 strings where allocated. After the optimization, 131577 strings allocations where saved (more than half). And the `_oneCharTokenCache` dictionary had only 17 items inside: some symbols like <, !, >, =, and all digits.Two additional remarks:- As a bonus, it improves performances from 587ms to call `MarkupParser.ParseDocument()` down to 510ms on my (old!) computer. It can improve a little bit F5 startup scenarios with large pages...- Of course, we can extend the concept to any `string` lengths, but there is less redundancy, and it will be probably less performant.If you think that it is interesting, I can propose a PR...
4823	area-mvc	[ResponseCachingAttribute] Over-caching on proxies when using `VaryByQueryKeys`	Currently, if the response caching middleware is added, the ResponseCacheAttribute can use the `VaryByQueryKeys` of the ResponseCachingFeature. However, this is only used by the middleware on the server and can lead to over-caching in the cache on proxies and the client since they won't vary by query keys.In ASP.NET this was handled by using separate cache locations `Server`, `ServerAndNoCache` and `ServerAndPrivate` which sends either `no-cache` or `private` cache directives to prevent caching on the client and intermediate proxies but enables caching on the server. We may need to do something similar here.
5866	area-servers	Support attaching to an existing request queue	Http.Sys has an API where you can attach to an existing request queue by name rather than creating a new one. In this mode you'd assume the queue was already configured so most settings would be ignored (e.g. prefixes, timeouts, auth, etc.).This can be used in conjunction with the HttpWaitForDemandStart API where a central dispatcher sets up the queue, listens for requests, and then activates the site when the first request arrives.Complications:- [ ] Prefixes / PathBase / HotAdd&Remove- [ ] Auth / Challenge- [ ] Ignored Options (Timeouts, queue length limit, etc.)
5991	area-middleware	Add more code-first rewrite rules	What if I want case insensitive matching? What if I want to match https requests so I can redirect them to http? What if I want to redirect www to non-www (or vice-versa)?Do I really have to implement my own `IRule` for these simple use cases? The `RedirectRule` class and `AddRedirect` extension seem way too basic for me.
5893	area-hosting	Add test support for 32bit IIS Express	All of our IIS express integration tests use 64bit, but VS runs the 32bit version. Add support for the host bittness in the IISExpressDeployer. Also make sure to reference the 32bit ANCM. 
4991	area-mvc	VS: Implement out of process support for codegen + extensibility	This would enable users to modify the Razor parser in ways they haven't been able to before. Being out of process will also enable us to run user code.
4104	area-tooling	dotnet-watch for MSBuild does not restart process when new file is added	**Repro:**watch an MSBuild project that uses globs.Add a new file that would match one of the globs.**Expected**dotnet-watch should restart process.**Actual**new file is ignored**Remarks**We should revisit the testing as the tests supposedly test this scenario and are passing, but this does not actually work.
5725	area-identity	Return more detail in UserManager.GetValidTwoFactorProvidersAsync()	I would like to see UserManager.GetValidTwoFactorProvidersAsync return more detail about the providers so that in the select list we can easily show an obfuscated version of where the message will be delivered.I.e. Email (txxxxxt@outlook.com)Text (xxx-xxx-5555)EDIT: GitHub formatted my asterisk, but you get the idea.
4189	area-servers	Add Http/2 tests	OS: Win10+Servers: IIS, IIS Express, WebListenerClient: .NET Core HttpClient (WinHttp)?This will require SSL/ALPN. IIS Express has pre-registered SSL ports we can depend on. IIS and WebListener do not have pre-registered ports. IIS requries admin to run tests at all, so it could dynamically register certs. WebListener tests do not require admin, so we could write some tests that light up either if the test is run as admin and dynamically registers the port, or if the test detects that the port is already registered.Secondary problem: How do you verify that HTTP/2 was actually used? That information is not surfaced to the server or client APIs.https://github.com/aspnet/WebListener/issues/106https://github.com/aspnet/IISIntegration/issues/160
5990	area-middleware	Consider caching rule results	Some rewrite rules could be cachable. We should investigate possible perf improvements by caching the result of a cachable rule instead of needing expensive regex pattern matching for every request.
4822	area-mvc	Improve the implementation on MediaType.cs	In general, consumers of this type should use methods provided by the type like "IsSubsetOf" and these methods should be able to correctly handle incorrect input. Having an instance of MediaType doesn't mean you have a valid MediaType, it can be default(MediaType) or it might be a media type with valid type but invalid subtype, valid type and subtype and invalid parameter.Go through the algorithms in this type (GetParameter, IsSubsetOf, etc) and make sure they return the appropriate result against invalid input (null and false for the previous cases). (For that, we need to iterate to the end of the parameter set or consider "recovery strategies" for relaxed parsing rules of our header (given the amount of invalid clients out there)We should add more tests to cover scenarios with invalid media types and we should make sure that the q parameter is handled appropriately.Finally, we should consider adding an IsValid computed property on MediaType that checks that Type != default(StringSegment), SubType != default(StringSegment) and that iterates through all the parameters and makes sure that they don't fail.The goal of this type is to not allocate when possible and to be as lazy as possible as it's on a performance critical path. If we need to add more fields to this struct, (for example to cache the validity of a media type) we should measure the performance impact on the type.The motivation for this bug is that we've seen some bugs in this area and inspection of the code has revealed some inconsistencies in different method implementations for the criteria specified above (some methods handle only correct input and have an "undefined/variable" behavior when it comes to incorrect input. (Usually considering the MediaType valid as long as the input is good "so far")
5724	area-identity	Create default `IdentityErrorDescriber` for some languages	Hi, I know that we have the ability to extend `IdentityErrorDescriber` and create our custom messages but shouldn't be better if we have already some default `IdentityErrorDescriber` for the most used languages? (I don't know right now the most used languages)This is just an issue I would like to comment because I'm translating it right now, but for sure another person is doing the same in his code. So everybody need to create a custom in each new project?Well, if someone falls into this issue searching how to do it, follow this steps:- Create a class with the name `CustomIdentityErrorDescriber`, copy the code below:``` csharpusing Microsoft.AspNetCore.Identity;namespace YourNamespace{    public class CustomIdentityErrorDescriber : IdentityErrorDescriber    {        public override IdentityError DefaultError() { return new IdentityError { Code = nameof(DefaultError), Description = $"Um erro desconhecido ocorreu." }; }        public override IdentityError ConcurrencyFailure() { return new IdentityError { Code = nameof(ConcurrencyFailure), Description = "Falha de concorrência otimista, o objeto foi modificado." }; }        public override IdentityError PasswordMismatch() { return new IdentityError { Code = nameof(PasswordMismatch), Description = "Senha incorreta." }; }        public override IdentityError InvalidToken() { return new IdentityError { Code = nameof(InvalidToken), Description = "Token inválido." }; }        public override IdentityError LoginAlreadyAssociated() { return new IdentityError { Code = nameof(LoginAlreadyAssociated), Description = "Já existe um usuário com este login." }; }        public override IdentityError InvalidUserName(string userName) { return new IdentityError { Code = nameof(InvalidUserName), Description = $"Login '{userName}' é inválido, pode conter apenas letras ou dígitos." }; }        public override IdentityError InvalidEmail(string email) { return new IdentityError { Code = nameof(InvalidEmail), Description = $"Email '{email}' é inválido." }; }        public override IdentityError DuplicateUserName(string userName) { return new IdentityError { Code = nameof(DuplicateUserName), Description = $"Login '{userName}' já está sendo utilizado." }; }        public override IdentityError DuplicateEmail(string email) { return new IdentityError { Code = nameof(DuplicateEmail), Description = $"Email '{email}' já está sendo utilizado." }; }        public override IdentityError InvalidRoleName(string role) { return new IdentityError { Code = nameof(InvalidRoleName), Description = $"A permissão '{role}' é inválida." }; }        public override IdentityError DuplicateRoleName(string role) { return new IdentityError { Code = nameof(DuplicateRoleName), Description = $"A permissão '{role}' já está sendo utilizada." }; }        public override IdentityError UserAlreadyHasPassword() { return new IdentityError { Code = nameof(UserAlreadyHasPassword), Description = "Usuário já possui uma senha definida." }; }        public override IdentityError UserLockoutNotEnabled() { return new IdentityError { Code = nameof(UserLockoutNotEnabled), Description = "Lockout não está habilitado para este usuário." }; }        public override IdentityError UserAlreadyInRole(string role) { return new IdentityError { Code = nameof(UserAlreadyInRole), Description = $"Usuário já possui a permissão '{role}'." }; }        public override IdentityError UserNotInRole(string role) { return new IdentityError { Code = nameof(UserNotInRole), Description = $"Usuário não tem a permissão '{role}'." }; }        public override IdentityError PasswordTooShort(int length) { return new IdentityError { Code = nameof(PasswordTooShort), Description = $"Senhas devem conter ao menos {length} caracteres." }; }        public override IdentityError PasswordRequiresNonAlphanumeric() { return new IdentityError { Code = nameof(PasswordRequiresNonAlphanumeric), Description = "Senhas devem conter ao menos um caracter não alfanumérico." }; }        public override IdentityError PasswordRequiresDigit() { return new IdentityError { Code = nameof(PasswordRequiresDigit), Description = "Senhas devem conter ao menos um digito ('0'-'9')." }; }        public override IdentityError PasswordRequiresLower() { return new IdentityError { Code = nameof(PasswordRequiresLower), Description = "Senhas devem conter ao menos um caracter em caixa baixa ('a'-'z')." }; }        public override IdentityError PasswordRequiresUpper() { return new IdentityError { Code = nameof(PasswordRequiresUpper), Description = "Senhas devem conter ao menos um caracter em caixa alta ('A'-'Z')." }; }    }}```- Go into your `Startup.cs` and when configuring the `services.AddIdentity` part, add the following code:``` csharpservices.AddIdentity<User, IdentityRole>()        .AddErrorDescriber<CustomIdentityErrorDescriber>();```In this example, the code was translated to `pt-BR`.Would be nice if we have all those translations ready in the Identity package. The custom implementation is really nice but I don't know if it's just me felling that I will have to copy and paste this custom class into each project that I need to use.
5989	area-middleware	Figure out pass-through compression for nginx	When a request is proxied behind nginx the Accept-Encoding header is removed. This prevents the back-end from being able to compress the response.Nginx supports compression on the front end, and compression between the back end and the front end, but it does not seem to allow the back-end compression to pass-through. See the integration tests in the ServerTests repo.
5988	area-middleware	Consider re-adding .AddRewrite API with default skip flag	In #105 we remove an API from rewrite middleware because we worried it might hide potential perf problems for users. This removal requires users to explicitly declare "skipProcessingRules" on each call to .AddRewrite. We should reconsidering adding .AddRewrite with a default skipProcessingRules = false.See https://github.com/aspnet/BasicMiddleware/pull/105#pullrequestreview-1880064 for more context.
5987	area-middleware	See if FileAttributes.ReparsePoint can allow for symbolic link checks	See title. Nate had this idea and I wanted to formally document it.
5986	area-middleware	Add support for outbound rules in rewrite middleware	As an extension on my implementation of UrlRewrite, Outbound rules will look through an Http response for any regex match, and replace them appropriately. Documentation here:http://www.iis.net/learn/extensions/url-rewrite-module/creating-outbound-rules-for-url-rewrite-modulehttp://www.iis.net/learn/extensions/url-rewrite-module/url-rewrite-module-20-configuration-referenceThe big problem here will be perf, as we are going to regex match on the whole body of the response. This would probably be an extension on top of the rewriter.
5985	area-middleware	Add/Modify Url Encoding/Decoding for IIS UrlRewrite	I didn't implement UrlDecode, a server variable in IISUrlRewrite, because there wasn't a great library (or static method) to do it. Right now I'm using Uri.Encode for encoding, which doesn't have the best perf.I think we can use Uri.EscapeDataString, but fundamentally I think this should be changed to a different library.
5984	area-middleware	Perf: add API to avoid regex matching rewrite rules unless necessary	Regex is an expensive part of the rewrite middleware a lot in order to do pattern matching. It is common for rewrite patterns to be led by a static prefix.Example:"blogs/(.*)" => "api/blogs?id=$1"For this rule, the middleware can avoid unnecessary regex allocations by only running the rule when the path begins with "/blogs/".Possible API design:``` c#RewriteOptions.AddRewrite(string prefix, string pattern, string urlResult) // prefix is static, doesn't container rules. If uri doesn't start with the prefix, skip this ruleRewriteOptions.Ignore(string prefix); // always skip rule processing for urls beginning with this prefix```Usage``` c#RewriteOptions.AddRewrite(prefix: "/blogs/", pattern: "(.*)", urlResult: "/api/blogs?id=$1")RewriteOptions.Ignore("/images/")```
5983	area-middleware	Perf: reduce string allocations in rewrite middleware	There are some small tweaks we could make to reduce string allocations.Cursory examination with this app``` c#    public void Configure(IApplicationBuilder app)    {        var options = new RewriteOptions();        options.Rewrite("app/(.+)", "app?q={R:1}");        app.UseRewriter(options);        app.Run(context => context.Response.WriteAsync(context.Request.QueryString.ToString()));    }```Requests: 100Total strings allocated: 1035Strings allocated by middleware: 600 (excluding calls made within Regex)Most allocating call = string.Substring - 400 allocations made in middleware
4676	area-security	OIDC MW: EndSession iss check	The OIDC front-channel signout spec was updated to include the `iss` param, so the MW should check for it: https://openid.net/specs/openid-connect-frontchannel-1_0-01.html#OPLogout
4677	area-security	OIDC MW: add HandleRemoteSignOutAsync event	Should emit cache control headers:```Cache-Control: no-cache, no-storePragma: no-cache```https://openid.net/specs/openid-connect-frontchannel-1_0-01.html#RPLogout
4678	area-security	OpenIdConnectEvents event for RemoteSignOut complete	A useful event to have would be one that fires after the sid checking is complete and the authentication cookie has been removed. 
4821	area-mvc	InputFormatter, OutputFormatter, and IApiRequestMetadata	I've been having some difficulty with these APIs when trying to use some custom media types.Here's a recap:- **InputFormatter**  - **CanRead**    `if (parsedContentType.IsSubsetOf(supportedMediaType))` (https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/Formatters/InputFormatter.cs#L78)  - **GetSupportedContentTypes**    `if (parsedMediaType.IsSubsetOf(parsedContentType))` (https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/Formatters/InputFormatter.cs#L153)- **OutputFormatter**  - **GetSupportedContentTypes**    `if (parsedMediaType.IsSubsetOf(parsedContentType))` (https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/Formatters/OutputFormatter.cs#L69)  - **CanWriteResult**    `if (supportedMediaType.IsSubsetOf(parsedContentType))` (https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Core/Formatters/OutputFormatter.cs#L122)Basically, the `InputFormatter` is liberal in what in can read because of `CanRead`, but when the time comes to use Api Explorer, the custom media type from the `Consumes` attribute does not show up because of `GetSupportedContentTypes`. Meanwhile, the `OutputFormatter` is very conservative and requires developers to either add every possible permutation of a custom media type to `SupportedMediaTypes` in order for it to allow it, or re-implement each formatter (XML, JSON) they wish to use with the custom media type (of course by inheriting and overriding the relevant methods.)Since the `InputFormatter` will say it `CanRead` _subsets_, I propose that `GetSupportedContentTypes` be modified to include the supplied content type in the `results` list when the supplied content type is a subset of a supported media type. I'm not sure about the `OutputFormatter`, I feel like there may be a good reason I'm not seeing for its current behavior. But for reference, to get around it, I've had to create a custom `OutputFormatter` that extends `JsonOutputFormatter`, which needs an `ArrayPool<char>` and `IOptions<MvcJsonOptions>`, and because formatters are registered on `MvcOptions`, I've also had to declare an `IConfigureOptions<MvcOptions>` class in order to get it all registered... kind of clunky.
4990	area-mvc	Support creating Tag Helpers using CSHTML files	Just an initial idea:**RepeatTagHelper.cshtml**``` html@tagHelper "repeat"@class {    [HtmlAttributeName("repeat")]    public int Repeat { get; set; }}@{    output.TagName = null;}@for (var i = 0; i < Repeat; i++) {    @await output.GetChildContentAsync(useCachedValue: false)}```
5982	area-middleware	Mod Rewrite Middleware Checklist	**Features implemented in mod_rewrite:**Types:- [x] RewriteCond- [x] RewriteRuleFlags:- [x] Cookie- [x] Escape Back References- [x] End- [x] Forbidden- [x] Gone- [x] Last- [x] No Case- [x] Query String Append- [x] Query String Delete- [x] RedirectServer Variables:- [x] HTTP_ACCEPT- [x] HTTP_COOKIE- [x] HTTP_FORWARDED- [x] HTTP_HOST- [x] HTTP_REFERER- [x] HTTP_USER_AGENT- [x] CONN_REMOTE_ADDR- [x] QUERY_STRING- [x] REMOTE_ADDR- [x] IPV6- [x] REMOTE_PORT- [x] REQUEST_METHOD- [x] SCRIPT_FILENAME- [x] SERVER_ADDR- [x] SERVER_PORT- [x] SERVER_PROTOCOL- [x] TIME_YEAR- [x] TIME_MON- [x] TIME_DAY- [x] TIME_HOUR- [x] TIME_MIN- [x] TIME_SEC- [x] TIME_WDAY- [x] TIME- [x] HTTPS- [x] REQUEST_FILENAME- [x] REQUEST_SCHEME- [x] REQUEST_URICondPattern:- [x] Integer Comparison- [x] String Comparison- [x] Is File- [x] Is Directory- [x] Size**Features that are not implemented in mod_rewrite:**Types:- [ ] RewriteBase- [ ] RewriteMap- [ ] RewriteEngineFlags:- [ ] Chain- [ ] Discard Path- [ ] Env- [ ] Next- [ ] No Escape- [ ] Pass Through- [ ] Query String Last- [ ] SkipServer Variables:- [ ] PATH_INFOCondPattern:- [ ] Symbolic Link**Features that will most likely not be implemented (not supported)**Types:- [ ] RewriteOptionsFlags:- [ ] Handler- [ ] No Subrequest- [ ] No Vary- [ ] Proxy- [ ] TypeServer Variables:- [ ] HTTP_PROXY_CONNECTION- [ ] AUTH_TYPE- [ ] CONTEXT_PREFIX- [ ] CONTEXT_DOCUMENT_ROOT- [ ] REMOTE_HOST- [ ] REMOTE_IDENT- [ ] REMOTE_USER- [ ] DOCUMENT_ROOT- [ ] SCRIPT_GROUP- [ ] SCRIPT_USER- [ ] SERVER_ADMIN- [ ] SERVER_NAME- [ ] SERVER_SOFTWARE- [ ] API_VERSION- [ ] CONN_REMOTE_ADDR- [ ] IS_SUBREQ- [ ] REMOTE_ADDR- [ ] THE_REQUEST- [ ] Segmented Lookups (Ex HTTP:header) CondPattern:- [ ] Existing Url via subrequest- [ ] Executable
5981	area-middleware	Performance of Rewrite Middleware	The whole rewrite middleware needs to be profiled. Specifically, checking for hotspots in the actual application of rules, which matters significantly more than startup time. Memory allocation should be checked too.
5980	area-middleware	Url Rewrite and Mod Rewrite Maps	Both `RewriteMap` in mod_rewrite and `rewriteMap` in UrlRewrite are not supported in our rewrite module. From the initial scraping of examples, both of these features were rarely used, but it would be a nice addition.From apache:> The RewriteMap directive defines an external function which can be called in the context of RewriteRule or RewriteCond directives to perform rewriting that is too complicated, or too specialized to be performed just by regular expressions. The source of this lookup can be any of the types listed in the sections below, and enumerated in the RewriteMap reference documentation.Ex: `RewriteMap MapName MapType:MapSource`From IIS:> A rewrite map is an arbitrary collection of name-value pairs that can be used within rewrite rules to generate the substitution URL during rewriting. Rewrite maps are particularly useful when you have a large set of rewrite rules and all of these rules use static strings (that is, when there is no pattern matching used). In those cases, instead of defining a large set of simple rewrite rules, you can put all the mappings into the rewrite map as keys and values between the input URL and the substitution URL. Then, to look up the substitution URL based on the input URL, you will have one rewrite rule that references the rewrite map.Ex:```<rewriteMap name="MyRewriteMap" defaultValue="">    <add key="a.html" value="b.html" /></rewriteMap>```
5723	area-identity	Give me all users and all of their roles...BY NAME	This is among the most simple of Use-Cases and yet does not appear to be allowed. When administering my site's users I need to be able to get a complete list of my users with their basic properties, one of which is the collection of roles assigned to the user. Using the  ApplicationUser and UserManager "out of the box" and this code: _(ok, yes, mgr and org represent properties which have been added to ApplicationUser, but they don't change the present case)_`var results = UserManager.Users.Where(u => u.mgr == appUser.org || appUser.org == "corp");`I get all of the expected users ... but their "role" property only gives me the "RoleId" (and UserId) NOT the role's name. Since the database does enforce referential integrity between AspNetUserRoles and AspNetRoles it really SHOULD be a simple matter of including role names as part of this query...but does not appear to be so. 
3793	area-servers	IIS -> Lock .NET Core application DLL file	When I try to overwrite .NET Core application DLL file using FTP on production IIS server file is locked and it cannot be overwritten.To deploy new version I need to stop application in IIS to release lock, then overwrite.It is not possible to deploy without stopping application.
4820	area-mvc	Make an option for SelectListGroup to be matched by name instead of reference	Hi,I'm aware that there're scenarios where you need to have multiple `<optgroup>` with the same name.But usually you don't.Since currently SelectListItem are grouped by reference type instead of the string property, we have all over our code stuff like this:```var limitationsList = Context.Limitations    .Where(x => x.ParentLimitationId != null)    .OrderBy(x => x.ParentLimitation.Name)    .ThenBy(x => x.Name)    .Select(x => new SelectListItem    {        Text = x.Name,        Value = x.Id.ToString(),        Group = new SelectListGroup { Name = x.ParentLimitation.Name }    }).ToList();foreach (var limitations in limitationsList.GroupBy(x => x.Group.Name)){    foreach (var selectListItem in limitations)    {        selectListItem.Group = limitations.First().Group;    }}```...```var categoriesList = Context.Categories    .Where(x => x.ParentCategoryId != null)    .OrderBy(x => x.ParentCategory.Name)    .ThenBy(x => x.Name)    .Select(x => new SelectListItem    {        Text = x.Name,        Value = x.Id.ToString(),        Group = new SelectListGroup { Name = x.ParentCategory.Name }    }).ToList();foreach (var categories in categoriesList.GroupBy(x => x.Group.Name)){    foreach (var selectListItem in categories)    {        selectListItem.Group = categories.First().Group;    }}```That's quite annoying and repetitive, can we have an option, to group by the `Name` instead of the reference?Thanks,Doron
4819	area-mvc	Future Investments - Form validation helper improvements	## OverviewThe validation helpers in MVC are due for some usability and capability improvements. We added Tag Helper-based validation helpers in the last release but they didn't really expand on the feature-set of the helpers themselves. Specifically, we're talking about the HTML Helpers and Tag Helpers that are used to enforce and show form validation on pages, including server-side and client-side validation.## Ideas- Address #575 Improvements to DateTime validation- Address #2372- Address #1469- Address #3377- Validation summary helpers should work better with client-side validation  - Hide validation errors once they've been fixed on the form  - Show new validation errors when form fields are modified- Support applying relevant validation CSS class names via server-side & client-side validation to elements associated with a form field, along with the form field input and label elements themselves:  - Containing elements like `<div>` or `<li>`, e.g. `<div class="form-group field-validation-error">...`. This makes it much simpler to style entire form fields based on their current validation state.  - The `<form>` element itself, e.g. `<form class="form-horizontal form-validation-error" ...>`. This makes it possible to style forms based on the validation state of the fields they contain.  - This will make it possible to easily apply [Bootstrap's Form Validation states](http://getbootstrap.com/css/#forms-control-validation) styles to elements associated with a form field- Support consistent tri-state CSS class names for validation states or all elements related to a form field. Currently, different class names are used to represent the three possible states of elements associated with a form field, e.g. "valid" for the `<input />` and "field-validation-valid" for the `<span>`. Also, the `<span>` is never represented with the initial state (untouched by user) but rather always starts as valid. This can make it difficult to achieve certain form field styles.- Make it easier to style and/or render markup for form fields that are required that is separate to the required validation message itself, e.g. showing a "required" glyph next to form label or form input element:  - Support adding a CSS class on elements associated with required fields, e.g. `<label for="FirstName" class="control-label form-field-required">First name:</label>`- Support easily adding custom markup associated with the validation state of form fields to allow for more interactive/informative field validation states, e.g. see the "With option icons" section of [Bootstrap's form validation states documentation](http://getbootstrap.com/css/#forms-control-validation)- Support alternate form submission behaviors when form is invalid using client-side validation:  - Suppress submit until form is valid (the only mode available today)  - Disable submit button until form is valid- Support initial focus:  - to first form field on page after document load   - to first invalid form field on page after document load (server-side validation)  - to first invalid form field on form submit (client-side validation) (this one already works I think)- Support adding attributes and/or CSS class for form fields marked as read-only in model metadata (see [Bootstrap support](http://getbootstrap.com/css/#forms-control-readonly))
4989	area-mvc	Hierarchical Tag Helper binding	## SummaryThis feature would add support for directly binding Tag Helper properties to child Tag Helper instances from the source document, thus making it much simpler to author related Tag Helpers that are designed to work together in a hierarchy.## BackgroundToday, we provide a number of features to assist with authoring sets of Tag Helpers that are intended to be used together in a logical hierarchy, including:- `RestrictChildrenAttribute` to restrict which tags are valid as children of the element a Tag Helper instance is attached to- `HtmlTargetElementAttribute.ParentTag` to restrict which tag is valid as a parent of an element a Tag Helper instance is attached to- `TagHelperContext.Items` to allow passing of data between different Tag Helpers attached to the same element, and between Tag Helpers attached to an element and Tag Helpers attached to that element's childrenThe use of `TagHelperContext.Items` to pass data between related Tag Helpers is somewhat cumbersome, e.g.:``` c#public class ParentChildContext{    public string SomeData { get; set; }}[RestrictChildren("child")]public class ParentTagHelper : TagHelper{    private ParentChildContext _context;    public override void Init(TagHelperContext context)    {        _context = new ParentChildContext();        context.Items.Add(typeof(ParentChildContext), _context);    }    public override async Task ProcessAsync(TagHelperContext context, TagHelperOutput output)    {        // Force children to process        var childContent = await output.GetChildContentAsync();        // Read context data set by child here        // _context.SomeData    }}[HtmlTargetElement("child", ParentTag = "parent", TagStructure = TagStructure.WithoutEndTag)]public class ChildTagHelper : TagHelper{    public string SomeData { get; set; }    public override void Process(TagHelperContext context, TagHelperOutput output)    {        var parentContext = context.Items[typeof(ParentChildContext)];        parentContext.SomeData = SomeData;    }}`````` html<parent>    <child some-data="This will be accessible to the parent" /></parent>```## ProposalTag Helper property binding would be expanded to support directly binding Tag Helper instances to properties on a Tag Helper using Tag Helpers attached to the current element's children as the source.Binding will:- Support the binding of any type that implements `ITagHelper`  - In the case where multiple children of the matching type are present, the first instance will be bound- Support the binding of `IEnumerable<T> where T : ITagHelper` to enable simple access to multiple child Tag Helper instances of the same type  - When the binding applies, it will always create and set an `IEnumerable<T>` instance to the property, irrespective of the property's initial value (i.e. it will overwrite any current value of the property)- Bind only the first level of children (i.e. it would not perform a "deep" or "recursive" bind)- Only support binding to `public` settable properties (like other bindings)- Be implied (i.e. automatic) based on the property being `public` and the type being derived from `ITagHelper`  - _Review: Should this be opt-in via a new attribute rather than implied?_- Support being disabled via `HtmlAttributeNotBoundAttribute` on the property that would otherwise be bound### ExampleHere is the example from above reimplemented with the proposed behavior implied:``` c#[RestrictChildren("child")]public class ParentTagHelper : TagHelper{    public ChildTagHelper Child { get; set; }    public override async Task ProcessAsync(TagHelperContext context, TagHelperOutput output)    {        // Force children to process        var childContent = await output.GetChildContentAsync();        // Read data directly from child here        // Child.SomeData    }}[HtmlTargetElement("child", ParentTag = "parent", TagStructure = TagStructure.WithoutEndTag)]public class ChildTagHelper : TagHelper{    public string SomeData { get; set; }}`````` html<parent>    <child some-data="This will be accessible to the parent" /></parent>```### More Examples``` c#/// <summary>This Tag Helper applies to all elements and effectively creates a server-side DOM, albeit with a single, forward-only pass rather than being stateful.</summary>[HtmlTargetElement("*")]public class DomTagHelper : TagHelper{    public DomTagHelper Parent { get; set; }    public IEnumerable<DomTagHelper> Children { get; set; }    public override void Init(TagHelperContext context)    {        // Set parent on all children        foreach (var child in children)        {            child.Parent = this;        }    }    public override async Task ProcessAsync(TagHelperContext context, TagHelperOutput output)    {        // Run children        var childContent = await output.GetChildContentAsync();        //     }}```
4988	area-mvc	Razor Templating Improvements	## IntroductionToday, Razor doesn't expose much functionality to enable app developers to leverage Razor templates at runtime. That is, Razor **is** a templating language, but it doesn't have many features that allow the developer to use templates written in Razor as a first-class primitive in view/page composition.The one feature that does exist is that of ["Templated Razor Delegates"](http://haacked.com/archive/2011/02/27/templated-razor-delegates.aspx/) (or "Template Expressions"), which allow for fragments of Razor to be captured as delegates and thus passed into functions, including HTML Helpers, and then executed to produce HTML output. E.g. in the following code, the block `@<li>@item</li>` is the "template expression".**Helpers.cs**``` c#public static class Helpers{    public static IHtmlContent ForEach<T>(IEnumerable<T> data, Func<T, IHtmlContent> template)    {        var builder = new HtmlBuilder();        foreach (var item in data)        {            builder.AppendHtml(template(item));        }        return builder;    }}```**View.cshtml**``` html<ul>@ForEach(new [] { "one", "two", "three" }, @<li>@item</li>)</ul>```This feature has a number of limitations that if addressed, and expanded upon, can provide a more powerful and expressive set of first-class templating features in Razor.## Support Declarative Template Authoring & Re-use via an `@template` DirectiveRather than trying to add new features to the existing template expressions feature, which could be limited by issues of backwards compatibility, we'll add a new directive to support declaratively creating Razor templates in CSHTML files:``` html@template HelloWorld(string name) {    <div>Hello @name!</div>}```This would be roughly equivalent to (and thus generate):``` c#public IHtmlContent HelloWorld(string name){    var builder = new HtmlBuilder();    builder.AppendHtml("<div>Hello ");    builder.Append(name);    builder.AppendHtml("!</div>")    return builder;}```This could be declared in any Razor file, including in `_ViewImports.cshtml` in an MVC application, to allow for easy re-use across the application.The templates could then be executed directly in Razor files. In this way they're very similar to the `@helper` directive from ASP.NET Web Pages:``` html@HelloWorld("Frank")```They can also be passed in to other methods that accept the template delegate signature:```@{ var names = new [] { "Frank", "Mary", "Jane" }; }@ForEach(names, HelloWorld)```## Support Truly Async Template ExpressionsCurrently, while the delegates generated by template expressions support async statements, they are always evaluated synchronously (i.e. the calling thread is blocked while the delegate is executed). This logic is [actually in MVC](https://github.com/aspnet/Mvc/blob/dev/src/Microsoft.AspNetCore.Mvc.Razor/HelperResult.cs#L61), so we'd need to make some changes to the contract between Razor and a Razor host, or limit this functionality to the new `@template` directive (see above).``` html@template async HelloWorldAsync(string name) {    await Task.Delay(100);    <div>Hello @name!</div>}```This would be roughly equivalent to (and thus generate):``` c#public async Task<IHtmlContent> HelloWorld(string name){    await Task.Delay(100);    var builder = new HtmlBuilder();    builder.AppendHtml("<div>Hello ");    builder.Append(name);    builder.AppendHtml("!</div>")    return builder;}```## Support Multiple ArgumentsTemplate expressions are currently limited to a single argument. We should extend this to support multiple arguments when using the `@template` directive, e.g.:``` html@template HelloWorld(string firstName, string lastName) {    <div>Hello @firstName @lastName!</div>}```This would be roughly equivalent to (and thus generate):``` c#public IHtmlContent HelloWorld(string firstName, string lastName){    var builder = new HtmlBuilder();    builder.AppendHtml("<div>Hello ");    builder.Append(firstName);    builder.AppendHtml(" ");    builder.Append(lastName);    builder.AppendHtml("!</div>")    return builder;}```The templates could then be executed directly in Razor files. In this way they're very similar to the `@helper` directive from ASP.NET Web Pages:``` html@HelloWorld("Mary", "Lou")```They can also be passed in to other methods that accept the template delegate signature:``` c#public static class Helpers{    public static IHtmlContent MyHelper<T1, T2>(T1 data, T2 state, Func<T1, T2, IHtmlContent> template)    {        var builder = new HtmlBuilder();        builder.AppendHtml(template(data, state));        return builder;    }}```## Support Templated Tag HelpersWe should extend Tag Helpers to make working with templates a first-class experience. Binding templates to properties as well as treating the content or even the entire element of a Tag Helper as a template should be possible.**Tag Helper with content as a template**``` c#[HtmlTargetElement("*", Attributes = "asp-repeat")]public class RepeatTagHelper<TItem> : TemplatedTagHelper<TItem>{    [HtmlTargetAttribute("asp-repeat")]    public IEnumerable<TItem> Items { get; set; }    public override async Task ProcessAsync(TagHelperContext<TItem> context, TagHelperOutput output)    {        foreach (var item in Items)        {            output.AppendHtml(await context.GetChildContentAsync(item));        }    }}`````` html@{    var customers = DB.GetCustomers().ToList();}<table>    <tbody asp-repeat="customers">        <tr>            <td>@item.FirstName</td>            <td>@item.LastName</td>        </tr>    </tbody></table>```**Tag Helper with template properties**``` c#public class ListViewTagHelper<TItem> : TagHelper{    public IEnumerable<TItem> Data { get; set; }    public Action<IHtmlContent> HeaderTemplate { get; set; }    public Func<TItem, IHtmlContent> ItemTemplate { get; set; }    public override async Task ProcessAsync(TagHelperContext context, TagHelperOutput output)    {        foreach (var item in Items)        {            output.AppendHtml(await context.GetChildContentAsync(item));        }    }}`````` html@model IEnumerable<Customer>@template ContentTemplate(IEnumerable<T> items, Func<T,IHtmlContent> rowTemplate) {    <tbody>        @foreach (var item in items)        {            rowTemplate(item);        }    </tbody>}@template HeaderTemplate() {    <thead>        <tr>            <th>@Html.DisplayNameFor(m => m.FirstName)</th>            <th>@Html.DisplayNameFor(m => m.LastName)</th>        </tr>    </thead>}@template CustomerRowTemplate(Customer customer) {    <tr>            <td>@item.FirstName</td>            <td>@item.LastName</td>        </tr>}<table><list-view data="customers" header-template="HeaderTemplate" content-template="ContentTemplate" item-template="CustomerRowTemplate" /></table>```_TODO: Update with some details about integration with #791_## Support Template Compilation & PackagingTo enable sharing of declared templates across projects without having to restore to writing them manually in C#, we should build a tool that allows compiling templates from CSHTML files directly to assemblies/NuGet packages. This could be a project tool that works with the .NET Core CLI (e.g. `dotnet razor compile-templates`) or a Roslyn compilation extension/module that allows for templates (and potentially other Razor primitives) to be compiled as part of project compilation.
4679	area-security	Add details to the JwtBearer error messages	JwtBearer adds error details to the response header for auth failures. Right now those errors are very generic based on exception types. We've asked IdentityModel to give us more details via exception properties.https://github.com/aspnet/Security/pull/845#issuecomment-222839724AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet#422https://github.com/aspnet/Security/issues/776
5380	area-mvc	remove pw from source	https://github.com/aspnet/MusicStore/blob/dev/src/MusicStore/config.json#L7https://github.com/aspnet/MusicStore/blob/dev/src/MusicStore/Models/SampleData.cs#L102@blowdart customers are copying this - should we move pw to secrets manager?
5979	area-middleware	ResponseBufferingMiddleware - Reading the Response Body	`ResponseBufferingMiddleware` uses `BufferingWriteStream` which is write-only. Any reason why it has to be that way? I'd need to read the buffered response and create an HMAC that needs to be sent in a response header.
4190	area-servers	Add a way to collect logs from kestrel running inside IISExpress 	It should make debugging functional tests easier@pranavkm @davidfowl @Tratcher 
4093	area-tooling	Deleting a folder with code is not triggering any change	Repro:- Create a folder with .cs files outside an app- start dotnet watch on the app- drop the folder that was created earlier and you should see its content getting picked up- delete this dropped folder and you should see the content not picked up.```C:\temp\DotnetWatchTestApp\src\ConsoleApp [master]> dotnet --info.NET Command Line Tools (1.0.0-rc2-002659)Product Information: Version:     1.0.0-rc2-002659 Commit Sha:  11a001706fRuntime Environment: OS Name:     Windows OS Version:  10.0.10586 OS Platform: Windows RID:         win10-x64```
4818	area-mvc	Need guidance about localization of model property names	Hello,I'm trying to localize a model like this one:```class Person{    [Display(Name = "First Name")]    public string FirstName { get; set; }    [Display(Name = "Last Name")]    public string LastName { get; set; }}```As descripted here: #3518, I think localization on `DisplayAttribute` is still not supported...I tried to add an implementation of `IDisplayMetadataProvider`. I can set `DisplayMetadataProviderContext.DisplayMetadata.DisplayName` successfully. But the problem is I can't access `IRequestCultureProvider` and my custom translator service. So I'm unable to translate my text because I don't have any access to `IServiceProvider` instance.If I must use `IDisplayMetadataProvider`, I also must find a way to access to services.Maybe there is an easier way to do this. Any suggestions please?Thanks :wink: 
5722	area-identity	AspNetClaims updating a claim from a role 	The fact that an extension method is needed to remove claims in either the aspnetuserclaim and aspnetuserroleclaims is not the best way to interact with the system. It would be best if just like there is pseudo codeRoleManager<ApplicationRole> _roleManager = Exist today_roleManager.AddClaimAsync_roleManager.RemoveClaimAsyncMy proposal: There should also be UpdateClaimAsynchttp://stackoverflow.com/questions/24587414/how-to-update-a-claim-in-asp-net-identityCan I do a PR?
5891	area-hosting	Resolve framework versions correctly in error page footer	Followup to https://github.com/aspnet/Hosting/pull/726.Currently we generate footers like![image](https://cloud.githubusercontent.com/assets/2030323/14864610/7f568244-0c6f-11e6-964b-b2946efb03eb.png)which uses assembly version as the .NET Framework version. This is not very useful and the version should look like 4.5.1, 4.6, ...cc @DamianEdwards 
5721	area-identity	Doc comments: Explain UserName is a unique login identity and different from User.Name	I spent a few hours trying to hunt down what was going wrong with my site - as no matter what I tried, when I would create a new user, their `Name` field continued to come up lowercase ('Normalized').Eventually I traced it back to the `UserManager<T>` and how it calls for `SetNormalizedUserNameAsync`, etc, on the implementation of `IUserStore<T>`.The problem here is one of interpretation. Obviously, now that I realize what is going on, I just update `SetNormalizedUserNameAsync`, `GetNormalizedUserNameAsync`, `SetUserName`, `GetUserName`, etc, to be the field I'm personally equating to a unique login identity.But this naming convention, I feel, could be clearer. I think the intent is that it's supposed to normalize whatever field you're using as a unique identifier (`username`). I actually translated it as a literal `User.Name` - a field where the user's name would be stored.It might be a bit clearer with a verbose `SetNormalizedUniqueIdentifierAsync` or something that makes it pretty apparent it's used for that purpose. Even the documentation isn't really obvious about its intent; Here is the actual docs for `SetNormalizedUserNameAsync````/// <summary>/// Sets the given normalized name for the specified <paramref name="user"/>./// </summary>/// <param name="user">The user whose name should be set.</param>/// <param name="normalizedName">The normalized name to set.</param>/// <param name="cancellationToken">The <see cref="CancellationToken"/> used to propagate notifications that the operation should be canceled.</param>/// <returns>The <see cref="Task"/> that represents the asynchronous operation.</returns>```
4680	area-security	Binding Secure cookies to ITlsTokenBindingFeature	Any protected cookie marked as Secure should also use ITlsTokenBindingFeature as part of its protection.Today CookieAuth always uses ITlsTokenBindingFeature if it's available, ignoring CookieSecureOption. Check CookieSecureOption before applying ITlsTokenBindingFeature.Other protected data to consider:OAuth state fieldOIDC state fieldsOIDC nonceTwitter request token
4681	area-security	Add OIDC test coverage	OIDC does not have sufficient test coverage. Many tests were removed or disabled due to breaking changes or redesigns. Check our coverage and fill in the gaps.Note there are some pseudo-functional tests in MusicStore that could be moved here.Related: https://github.com/aspnet/Security/issues/349 - Move OIDC tests to their own project.
4191	area-servers	Run server tests for Nginx on Windows	We currently only test nginx on non-windows systems. Since nginx also support windows, we should add test coverage for that. This may need some updates to the deployers in Hosting as well.
4817	area-mvc	Improve the ScriptTagHelper to support CSP & ordered, async downloading inc. fallback	It appears our use of `document.write` in the `ScriptTagHelper` to dynamically load JS files in to the browser (the CDN fallback feature) causes issues when trying to use [Content Security Policy](https://developer.mozilla.org/en-US/docs/Web/Security/CSP).It appears this could be somewhat addressed by switching to dynamically creating and appending `script` elements to the DOM (assuming the CSP policy that enables inline script blocks is enabled), however that results in the scripts being loaded asynchronously to the page rendering, which potentially causes errors in the page (e.g. if the scripts now run out of order to how they were declared).[This article](http://www.html5rocks.com/en/tutorials/speed/script-loading/) is a good write-up of the various methods that can be used to load scripts while controlling (or not) their execution order and they're affect on rendering.We should investigate whether we could enhance the `ScriptTagHelper` to better support these techniques, along with CSP, e.g.:- Have a way to toggle the method used to do the script loading, or just move to dynamically modifying the DOM and ignore the older browsers for which it introduces issues- Honor the `async` attribute on the `script` element when dynamically loading the fallback script, maybe even use it as part of the download method toggle (always use `document.write` unless `async` attribute is explicitly set, or something)- Maybe add a new attribute that forces scripts to be dynamically fetched async but with order preserved by the browser using these techniques, and use it combination with the above- Support deferring **all** scripts to the end of the page (or some marker element) where they can then be properly downloaded and executed in order, with fallbacks if necessary, using "all the tricks known to web developer-kind", or something- Give up and go shoppingPossible example that would render inline JS to do async downloads of the scripts while preserving their declared execution order:``` html<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.1/jquery.min.js"    asp-fallback-src="~/lib/jquery/jquery.min.js"    async asp-preserve-load-order></script><script src="~/js/needs-jquery.js" async asp-preserve-load-order></script>```
4188	area-servers	Test for OPTIONS *	Hopefully I will get a chance to try more of these scenarios. Right now I only know about kestrel:Kestrel: Passes \* through to PathString which throwsWe need to know what the other servers behavior is and decide on the right implementation to handle *.
5720	area-identity	Show all Users from a given Role (and all related query scenarios)	Hello, i spent the last day to figure out how to do it, but it seems with the given functions of UserManager and RoleManager, the only possible way to achieve this is to enumerate all Users and check if the user has specified role.Is there a way to do this better than enumerate over all user?
4816	area-mvc	ModelState cannot be added to TempData (cannot be serialized)	I found this when dealing with `ModelState` and transfering using `TempData` to follow `PRG` pattern.``` c#TempData.Add("ModelStateTransfer", ModelState);InvalidOperationException: The 'Microsoft.AspNet.Mvc.ViewFeatures.SessionStateTempDataProvider' cannot serialize an objectof type 'Microsoft.AspNet.Mvc.ModelBinding.ModelStateDictionary' to session state.```Shouldn't be `ModelState` serializable?I was pointed out to this tests:https://github.com/aspnet/Mvc/blob/25eb50120eceb62fd24ab5404210428fcdf0c400/test/Microsoft.AspNetCore.Mvc.Core.Test/SerializableErrorTests.csso I tried using `SerializableError` with no success``` C#TempData.Add("ModelStateTransfer", new SerializableError(ModelState));InvalidOperationException: The 'Microsoft.AspNet.Mvc.ViewFeatures.SessionStateTempDataProvider' cannot serialize an objectof type 'Microsoft.AspNet.Mvc.SerializableError' to session state.```Help? Ideas?
4682	area-security	RemoteError should expose raw error details	Currently, `FailureContext` - used by the `RemoteError` event - doesn't expose the raw protocol error details but an exception, which makes determining the root cause of the error much harder (one may want to detect `access_denied` errors, for instance)We should consider adding the error code to this class. Sadly, `RemoteAuthenticationHandler` and the `RemoteError` event are supposed to be protocol-agnostic and things like `error`/`error_description`/`error_uri` are OAuth2-specific, so adding `Error`/`ErrorDescription`/`ErrorUri` to `FailureContext` will likely break the existing layering.
4987	area-mvc	Allow C# to exist inside body of a [RestrictChildren] TagHelper	Version: rc1-finalMy taghelper definition is```[HtmlTargetElement("panel")][RestrictChildren("panel-heading", "panel-body", "panel-footer")]public class PanelTagHelper : TagHelper{    ...}```The problem is that I'd like to show the footer depends on something in the model:```<panel>   <panel-body>   ...   </panel-body>   @if(Model.NeedsFooter)   {   <panel-footer>      ...   </panel-footer>   }</panel>```The error message:> The parent <panel> tag helper does not allow non-tag content. Only child tag helper(s) targeting tag name(s) 'panel-heading, panel-body, panel-footer' are allowed.Please let us to use code block inside a taghelper (with restricted childrens).Thanks, Istvan
4815	area-mvc	Manual output cache busting?	_From @SimonOrdo on February 19, 2016 15:47_Is there any way to clear/flush/remove OutputCache? I have html fragments in a partial view that uses the output cache like so``` <cache vary-by="@Util.SomeID" expires-after="@TimeSpan.FromHours(1)">     <div>some content</div> </cache>```In the event that I need the content to be updated before the expiration of the cache, how do I go about busting the cache for that particular fragment (or the entire cache, if necessary) ?_Copied from original issue: aspnet/Caching#154_
4627	area-servers	HTTP/1.1 Allow Response Trailer Headers	Now (shortly?) reading request header trailers #619; ability to add them to chunked encoding responses?~~Currently supported by [`System.Web`](https://msdn.microsoft.com/sr-latn-rs/library/system.net.http.headers.httpresponseheaders.trailer%28v=vs.110%29.aspx)~~ (Misleading)Don't think browsers pay attention to them; but some discussion on https://github.com/whatwg/fetch/issues/34 as to their importance for CDNs etc; and whether to include them in the fetchapi
5978	area-middleware	Support the new "Forwarded" header (RFC 7239)	There is now a standard for the most common X-Forwarded-\* headers. It was introduced with RFC 7239: "[Forwarded HTTP Extension](https://tools.ietf.org/html/rfc7239)". Example: `Forwarded: for=192.0.2.60;proto=http;by=203.0.113.43`It would be great if this could be supported.
5977	area-middleware	ResponseBufferingMiddleware should expose buffered data or a message digest for HTTP ETags	I would like to use ResponseBufferingMiddleware to help me automatically calculate an ETag  (for caching) based on a messagedigest from the buffered data and add the ETag to a header. Unfortunately, ResponseBufferingMiddleware does not allow me to inspect the buffer. Could the buffer be exposed, an event with the buffer be exposed OR a messagedigest method be added ? BTW: Or are there other places in vnext suited for adding an ETags header based on a message digest of the body content ?
4814	area-mvc	Action with (missing) optional Dictionary param, ModelBinder maps all request params to Dict	**tldr**If an optional dictionary parameter is missing in the request, the ModelBinder tries to cram all other parameters into the dictionary. If the parameter is supplied in the request, even as empty or null value, everything works.**Details**Given an action like```public void SomeAction(string foo, string bar, Dictionary<Guid,string> problematicDict = null) {...}```any request with a payload of the form```foo = "something"bar = "something else"```results in a `System.FormatException`, as the ModelBinder tries to use `foo` and `bar` as dictionary keys with their respective values for `problematicDict`, but the keys are not valid `Guid` representations.This can be further illustrated if the dictionary is changed to accept string keys```public void SomeAction(string foo, string bar, Dictionary<string,string> problematicDict = null) {...}```The same request results in the parameters `foo` and `bar` having the correct values set In addition to that, the dictionary also has a Count of 2, with keys `foo` and `bar` and the values from the request parameters.**Workaround**If `problematicDict` is added to the request as a parameter, even with an empty value or `null` as value, everything works just fine. This leads to believe that the default specified in the action is not properly handled.
4986	area-mvc	Don't use Span.Content.	Today we use `Span.Content` in several locations where we don't need to during parse and code gen time. Instead we should be utilizing the Symbols that are available to us to prevent additional allocations.![image](https://cloud.githubusercontent.com/assets/2008729/12527131/1fd641e0-c12b-11e5-8389-fa1df48499a0.png)
4985	area-mvc	Cache Razor Tokens.	Today Razor has `ISymbol`s aka Tokens (should be renamed) and they are responsible for a large portion of allocations when compiling Razor pages (nearly 10%). We should cache these tokens to reduce their allocation numbers.I took a stab at doing this and ran into some risky issues which is the reason why I'm writing this issue now. See [here](https://github.com/aspnet/Razor/issues/635#issuecomment-171779141) for details on what the implications of doing this are.![image](https://cloud.githubusercontent.com/assets/2008729/12527027/a47785be-c129-11e5-9244-622efc217fc4.png)
4984	area-mvc	HtmlTargetElement ParentTag doesn't work with @tagHelperPrefix	Given the following `TagHelper`s:``` C#[HtmlTargetElement("row", ParentTag = "grid")]public class RowTagHelper : TagHelper{}public class GridTagHelper : TagHelper{}```Both of the following should work, but don't:![image](https://cloud.githubusercontent.com/assets/2008729/12279755/e6493fda-b93d-11e5-8c5d-a5901e7e7aff.png)
4983	area-mvc	Invalid script tag inside a TagHelper element invalidates parent	``` html<TagHelperTag>    <script src="" /></TagHelperTag>```If TagHelperTag is a TagHelper then you will get an exception stating that your TagHelperTag is invalid, and doesn't have a closing tag, when in fact it is the script tag that is invalid.
5976	area-middleware	QueryString based Http Method Override	Http Method Override is currently only possible by header or form. I recently had the case where I could not add a header (browser restriction) and utilized a JSON based body as an API interface. Consequently, I had no option to override the Method from POST to PUT (another browser restriction).Is it a good idea to support this? And should I provide a pull request?
5719	area-identity	XPlat tests: EntityFramework Store Tests need replacement for localdb	Currently Identity.EntityFramework provider tests are skipped for SqlServer since there's no LocalDb on xplat.  
4982	area-mvc	Go To Definition (F12) on TagHelpers	<kbd>F12</kbd> works on Html Helpers, but not on TagHelpers in Visual Studio.Should navigate to the definition of the helper.
3815	area-servers	Forward TLS token binding	http://tools.ietf.org/html/draft-popov-token-binding-00http://tools.ietf.org/html/draftbalfanz-https-token-binding-00http://www.ietf.org/proceedings/91/slides/slides-91-uta-2.pdfhttps://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.AspNetCore.Http.Features/ITlsTokenBindingFeature.csWin10+
4626	area-servers	Support token binding to provide greater protection for clients	Seehttp://tools.ietf.org/html/draft-popov-token-binding-00http://tools.ietf.org/html/draftbalfanz-https-token-binding-00http://www.ietf.org/proceedings/91/slides/slides-91-uta-2.pdf
4813	area-mvc	Consider requiring Antiforgery Validation by default	Current convention is that with any form submitted an Anti XSRF Token ist supposed to be sent along and evaluated at server side.So, instead of requiring the programmer to add countless `Html.AntiForgeryToken()` calls and `ValidateAntiForgeryToken` attributes, wouldn't it be an improvement to automatically send an Anti XSRF Token along with each `Html.BeginForm()` or `Ajax.BeginForm()` and to evaluate it with each `HttpPost` and similar?A configuration option could be added allowing to set whether this should automatically occur or (as in the current MVC/Web API implementation) manually.
4981	area-mvc	Hierarchical Parent Tag restriction	We're working on a custom Tag Helpers package, and one feature we really miss is a parent tag restriction based on tag hierarchy (not only immediate parent).We already described our problems here: https://github.com/aspnet/Razor/issues/474#issuecomment-144108209 and https://github.com/aspnet/Razor/issues/570.Currently, we choose the only appropriate Tag Helper in runtime (the `Process` method), but it is ineffective because all applicable Tag Helpers are already instantiated by the moment they are checked, and then rejected.We have made a research and found that it is fairly easy to implement hierarchical parent restriction:https://github.com/IlyaKhD/Razor/commit/53b8141aebab6823a1c6672d99cf7af5dc660c13Consider adding this feature, please.
4622	area-servers	Make HttpsConnectionFilter more configurable	- Support multiple certificates  - Allow certs to be specified for a given port and/or IP address  - Allow certs to be specified for a given hostname once SNI is supported- ~~Make allowed [SslProtocols](https://msdn.microsoft.com/en-us/library/system.security.authentication.sslprotocols%28v=vs.110%29.aspx) configurable~~- Use the options pattern (e.g. [Facebook Middleware](https://github.com/aspnet/Security/blob/6ed7d1f3c09c065c8e2c09f1cd09389947451746/src/Microsoft.AspNet.Authentication.Facebook/FacebookAppBuilderExtensions.cs)) which takes a `configureOptions` Action.
4980	area-mvc	RestrictChildren does not allow Razor comments	``` C#[RestrictChildren("div")public class MyTagHelper : TagHelper{}`````` HTML<my>   @* Some comment *@   <div>Child content</div></my>```Additionally, the error is repeated multiple times over in the intellisense dialog:![image](https://cloud.githubusercontent.com/assets/174281/10253667/6da5de16-68f3-11e5-9b35-908a54658d21.png)
5890	area-hosting	Support an OnApplicationStart[Async] method or similar pattern	Applications often need to run code once at application startup per web server, e.g. to setup or initialize some external resource to be used by the application. There are two main issues with doing so in `Startup.Configure()`:1. Lifetime of services can be incorrect at this stage, e.g. services that are registered as scoped will not be disposed correctly and will remain in memory2. It cannot execute asynchronously  One general idea that has been discussed is to have a middleware that will run this code on first request but use a lock to make sure it is only done once.The main example where this have come up is https://github.com/aspnet/EntityFramework/issues/3070 "Pattern for seeding database with EF7 and ASP.NET 5". Note that we cannot recommend a pattern like this in general because it is not safe unless you know there is only one web server, but for many customers this can be enough. Note also that MusicStore [currently uses a workaround](https://github.com/aspnet/MusicStore/blob/dev/src/MusicStore/Models/SampleData.cs#L23).Another possibly related scenario is described at https://github.com/aspnet/EntityFramework/issues/3070#issuecomment-140017643. Although it is not about code that needs to run at application start, it is about how to get services to be activated with the right lifetime on code that doesn't execute as part of a request:> Another problematic case is when you use a Timer. During the callback there have no scope. So the used instances are always the same, because you have to use the ServiceProvider of the application, so always the same context. What would be the best way to use DI with a Timer? The Timer sould perhaps create a scope during the callback and pass it in parameter? Use IServiceScopeFactory in the callback? cc @Eilon
4683	area-security	Offer a built-in JWKS endpoint to support encrypted tokens	Wilson doesn't support JWE yet, but at this moment, we'll probably want to offer a JWKS endpoint directly in the OIDC middleware (to allow the identity provider to retrieve the public key(s) used to encrypt the identity tokens) and in the JWT bearer middleware (for the access tokens) Related specs:- JWK/JWKS: http://tools.ietf.org/html/draft-ietf-jose-json-web-key-31- OIDC dynamic registration (though dynamic registration is not directly needed to support this feature, it's the only OIDC specs that contains valuable resources on JWKS): http://openid.net/specs/openid-connect-registration-1_0.html#ClientMetadataRelated tickets:- https://github.com/AzureAD/azure-activedirectory-identitymodel-extensions-for-dotnet/issues/46- https://github.com/aspnet-contrib/AspNet.Security.OpenIdConnect.Server/issues/120 (/cc @MonkeyJamboree)
5718	area-identity	Configure email/phone confirmation requrement separatelly for each authentication method	I would like to configure email/phone confirmation requrement separatelly for each authentication method. For example, require email confirmation for password based sign in and don't for google auth.I noticed it's impossible now, as there is check for all authentication methods - https://github.com/aspnet/Identity/blob/670614cdc59200f70a8045a7a5f346165d816fa1/src/Microsoft.AspNet.Identity/SignInManager.cs#L90-L94How about changing this to be able to configure per each method?
5975	area-middleware	Add response buffering option for buffer size limits	The ResponseBufferingMiddleware should have an optional limit of how much data it tries to buffer per request. The limit should not be set by default, but can be set via options. When the limit is exceeded then buffering should be disabled and the buffered data flushed.RE: https://github.com/aspnet/BasicMiddleware/issues/8, the threshold at which we switch the buffer from memory to disk should also be configurable.
5974	area-middleware	Add response buffering overflow to file	When buffering responses we only want to allow each request to consume so much memory. Once the response has exceeded a certain limit switch the buffer to disk instead. This should mirror what we do for request buffering: https://github.com/aspnet/HttpAbstractions/blob/dev/src/Microsoft.AspNet.WebUtilities/FileBufferingReadStream.cs
4979	area-mvc	Support for attribute grouping to aid in statement completion in editors	In cases where a Tag Helper has multiple attributes that must be used together to correctly configure and thus enable a particular function, it would be useful to be able to indicate this grouping so that editors could suggest that use of one attribute requires another.We tend not to throw runtime exceptions in Tag Helpers for these cases so as to not add extra "overhead" to the normal flow of using HTML & C# together, aka normal Razor.Some suggested approaches:``` C#// This approach allows any property to be associated with another (its partners) via an attribute.// Only one property in any given set needs to be decorated with the attribute, the inverse relationship is implied.public class MyTagHelper : TagHelper{    [PartnerAttributesHint("category")]    public string Name { get; set; }    public string Category { get; set; }    ...}// This attribute allows sets of attributes to be declared on the class, with the HTML attribute names passed in.// Multiple sets would be supported on the class.[AttributeSetHint("name", "category")]public class MyTagHelper : TagHelper{    public string Name { get; set; }    public string Category { get; set; }    ...}// This approach allows any property to be added to an arbitrary attribute set by name.// The name itself isn't important, they just need to be consistent across the properties in that set.public class MyTagHelper : TagHelper{    [AttributeSetHint("set1")]    public string Name { get; set; }    [AttributeSetHint("set1")]    public string Category { get; set; }    ...}```
4978	area-mvc	Log generic warnings for common errors when using tag helpers	- Output is not empty and self closing is set to true  ...
5717	area-identity	OAuth 2.0 Bearer Token authentication	I've been doing some digging, and I can't find anything regarding ASP.Net 5 and OAuth token based authentication.  Is this a planned feature for a later release, or am I missing something?
4977	area-mvc	Add ability to specify IntelliSense mode at design time for TagHelper attributes.	Much like #382 it'd be useful to provide a way to indicate what sort of IntelliSense an attribute should have at design time. This would enable the editor to provide auto-complete options that are useful to the `TagHelper` attribute being used.Ex:``` C#public class ScriptTagHelper : TagHelper{...    [AttributeIntelliSense(AttributeIntelliSenseModes.ScriptUrlPicker)]    public string AspFallbackSrc { get; set; }...}```Should discuss what modes are available and if we should allow multiple/conflicting `AttributeIntelliSenseAttribute`s.
4976	area-mvc	String interpolation with nested quotes breaks Razor blocks.	Today if you are to write the following:``` HTML@{    $"abc{"123\""}.def";}```You end up having a mismatch in curly braces. This is due to Razor not understanding the `{` syntax in string interpolation and therefore parsing the strings incorrectly.
4812	area-mvc	TagHelpers `<label>`: Should support nested `<input>` elements	as of tag helper label, when there is not content, the displayname is shown while if there's content the content is used.This is good because we can use```<label asp-for="RememberMe"></label>```and```<label asp-for="RememberMe">I want to be kept logged in on every visit</label>```but there is a 'case' when we may want both, having content and providing the displayname from metadata/modelstate like this```<label asp-for="RememberMe">    <input asp-for="RememberMe" /></label>```This will display a checkbox with empty text inside.I can do```<label asp-for="RememberMe">    <input asp-for="RememberMe" />    @Html.NameFor(m => m.RememberMe)</label>```This works but I need to use old HtmlHelpers to read from modelstate/metadata.Another problem is that label should only have one input inside and checkbox taghelper adds two for the model binder to work. This has no visual problem but is not valid html.the intended result html is:```<label for="RememberMe">    <input id="RememberMe" name="RememberMe" type="checkbox" value="true">    RememberMe</label><input name="RememberMe" type="hidden" value="false">```Is this kind of support added to the label taghelper somehow? Is there a plan to support this scenario ? (I know in MVC5 this was not possible with HtmlHelpers, but since you added tag helpers, I was hoping we have some way to sort this out)Note that bootstrap uses this structure so checkbox is aligned well on the form http://getbootstrap.com/css/#forms-example
5856	area-servers	Enable HTTP/2 & Push Promise	Edit: Proof of concept provided below https://github.com/aspnet/HttpSysServer/issues/106#issuecomment-291283012How do we detect if the request is HTTP/2 before calling the Push method?Also, should/can we expose things like request priority?Fowler has asked us to set the HttpContext.Request.Protocol to "http/2" rather than it's current "http/1.1". HttpClient is doing something similar.Response headers and body can be streamlined. HTTP/2 does not require us to manually chunk the response. All responses are treated like the old 1.0 connection:close mode.
4782	area-servers	HTTP/2	Are there any immediate plans to add HTTP/2 support?
4811	area-mvc	Using optional method parameters in F# project	Not sure if this is the right repo to post to...I was converting a C# webapi project to F# using the F# ASP.NET templates. Everything is working great except optional query parameters. I keep getting this error```{    "message": "The request is invalid.",    "messageDetail": "The parameters dictionary contains an invalid entry for parameter 'start' for method 'System.Threading.Tasks.Task`1[System.Net.Http.HttpResponseMessage] GetVendorFiles(Int32, System.Nullable`1[System.DateTime])' in 'Thor.WebApi.VendorFilesController'. The dictionary contains a value of type 'System.Reflection.Missing', but the parameter requires a value of type 'System.Nullable`1[System.DateTime]'."}```F# function signature:```[<HttpGet; Route("")>]member x.GetVendorFiles( [<Optional; DefaultParameterValue(100)>] count, [<Optional; DefaultParameterValue(null)>] start : Nullable<DateTime> ) =```C# function signature:```[HttpGet][Route("")]public async Task<HttpResponseMessage> GetVendorFiles(int count = 100,DateTime? start = null)```I tracked the issue down to the way ASP.NET extracts default values for controller actions using ParameterInfo. Apparently the F# compiler doesn't compile default values the same way as C# does (even with the DefaultParameterValueAttribute). I couldn't find the same code in this repo but it's in the aspnetwebstack repo: https://github.com/ASP-NET-MVC/aspnetwebstack/blob/0ee98f84b41b6bef6bde6945e2797de9dac7d48a/src/System.Web.Http/Controllers/ReflectedHttpParameterDescriptor.cs#L37What's the best way or working around this? Would it be some filter that I need to inject or implement my own ParameterBinding?
5855	area-servers	Expose HttpRequestInfoTypeSslProtocol	HTTP_REQUEST_V2.pRequestInfo points to an array of HTTP_REQUEST_INFO in the request. One of the new items is HttpRequestInfoTypeSslProtocol, where the pInfo field is a HTTP_SSL_PROTOCOL_INFO structure as outlined below. We haven't found the constant definitions yet to interpret the data though...``` Ctypedef struct _HTTP_SSL_PROTOCOL_INFO  {      ULONG Protocol;      ULONG CipherType;      ULONG CipherStrength;      ULONG HashType;      ULONG HashStrength;      ULONG KeyExchangeType;      ULONG KeyExchangeStrength;}```
4975	area-mvc	Make the TagHelperContext available to content of Tag Helpers	As part of #221, contents of all Tag Helper invocations will now be wrapped in a delegate to allow for conditional execution, retrieval, or even suppresion, of the content by the surround Tag Helper.This delegate should accept a `TagHelperContext tagHelperContext` parameter that is passed in by the page and shared with the surrounding `TagHelper`. When combined with #238, this enables the content to either receive or pass values back to the surrounding Tag Helper (depending on the order of execution).This feature would be used by the `CacheTagHelper` (aspnet/mvc#1552) to enable the contents to add cache invalidation triggers.e.g.### Tag Helper Declaration``` C#[TagName("my-tag")]public class MyTagHelper : TagHelper {    public override void Process(TagHelperContext context, TagHelperOutput output) {        context.Items["message"] = "This came from the MyTagHelper class!";    }}```### Consumption``` HTML<my-tag>    Message from the tag helper: @tagHelperContext.Items["message"]</my-tag>```
4974	area-mvc	Support a single Tag Helper having multiple properties bound to the same HTML attribute	Sometimes it's desirable to have multiple Tag Helper properties attached to the same HTML attribute within the scope of a single Tag Helper, especially when multiple types could be used to represent the same logical attribute.E.g.### Declaration``` C#public class CacheTagHelper : TagHelper {    [HtmlAttributeName("expires")]    public DateTime? ExpiresAbsolute { get; set; }    [HtmlAttributeName("expires")]    public DateTimeOffset? ExpiresAbsoluteOffset { get; set; }    [HtmlAttributeName("expires")]    public TimeSpan ExpiresIn { get; set; }    public overload void Process(TagHelperContext context, TagHelperOutput output) {        if (ExpiresAbsolute.HasValue) {            // Use the DateTime value            ...        }        else if (ExpiresAbsoluteOffset.HasValue) {            // Use the DateTimeOffset value            ...        }        else if (ExpiresIn != null) {            // Use the TimeSpan value            ...        }    }}```### Consumption``` HTML<cache expires="DateTime.Now"></cache><cache expires="DateTimeOffset.Now"></cache><cache expires="TimeSpan.FromSeconds(60)"></cache>```### Generated Pseudo-code``` C#private static class PropertyAssigner_CacheTagHelper {    public static void Set_expires(CacheTagHelper helper, DateTime? value) {         helper.ExpiresAbsolute = value;    }    public static void Set_expires(CacheTagHelper helper, DateTimeOffset? value) {         helper.ExpiresAbsoluteOffset = value;    }    public static void Set_expires(CacheTagHelper helper, TimeSpan value) {         helper.TimeSpan = value;    }}// public async Task ExecuteAsync(...) {var helper = new CacheTagHelper();PropertyAssigner_CacheTagHelper.Set_expires(helper, DateTime.Now);helper.Process(context, output);var helper = new CacheTagHelper();PropertyAssigner_CacheTagHelper.Set_expires(helper, DateTimeOffset.Now);helper.Process(context, output);var helper = new CacheTagHelper();PropertyAssigner_CacheTagHelper.Set_expires(helper, TimeSpane.FromSeconds(60));helper.Process(context, output);```
4684	area-security	Verify external providers are using latest APIs	RTM milestone.External login providers routinely update their APIs and deprecate the old ones. Before we ship RTM we need to verify that each of our implementations is targeting the latest provider API versions to ensure our packages have the longest useful lifespan.Example: #85
4973	area-mvc	Allow Tag Helper to specify a string property is in fact a type name reference and generate code that uses the C# 'nameof' keyword	Let’s assume that we introduce a new Tag Helper property attribute, `TypeNameStringAttribute`. This is an instruction to the parser to generate code using the `nameof` keyword by default. You can stack these and supply the name of another property on your tag helper and we’ll automatically concatenate them at generation time as type names (add the default() wrapper, separate with ‘.’, etc.) As usual, using ‘@’ would escape from this behavior.Then the anchor Tag Helper declares its Controller and Action properties as this type/attribute:``` C#public class ATagHelper : TagHelper {      [TypeNameString]      public string Controller { get; set; }      [TypeNameString("Controller")][TypeNameString]public string Action { get; set; }      public override Process(TagHelperOutput output, TagHelperContext context) {            ...      }}```Now the view could be like this, with the attribute values projected into the generated code as indicated:``` HTML@using WebApplication42.Controllers<a controller="HomeController" action="Index">Home</a>`````` C#// Generates...var __aTagHelper232 = new ATagHelper {    Controller = nameof(HomeController),    Action = nameof(default(HomeController).Index())};__aTagHelper232.Process(output, context);```Or it could be like this:``` HTML<a controller="WebApplication42.Controllers.HomeController" action="Index">Home</a>`````` C#// Generates...var __aTagHelper232 = new ATagHelper {    Controller = nameof((WebApplication42.Controllers.HomeController),    Action = nameof(default(WebApplication42.Controllers.HomeController).Index())};__aTagHelper232.Process(output, context);```Or they can escape out and go back to the property’s declared type with ‘@’ like this:``` HTML<a controller='@"Controller"' action='@"Index"'>Home</a>`````` C#// Generates...var __aTagHelper232 = new ATagHelper {    Controller = "Controller",    Action = "Index"};__aTagHelper232.Process(output, context);```Full color image that shows the projections:![image](https://cloud.githubusercontent.com/assets/249088/4710249/75e0a640-58a7-11e4-89a8-0e2fdb6e2591.png)
4972	area-mvc	Need to handle C# code in html element tag	We need to provide a way to handle "code" inside of an html tag that happens to be a tag helper.For instance:```@{ foo = "class=\"bar\""; }<div @foo style="...">```This can be handled as an empty "Key" or "Value" entry into the attributes dictionary OR we could throw an error.<!---@huboard:{"milestone_order":96.0,"order":96.0,"custom_state":""}-->
5716	area-identity	Support password expiration	

